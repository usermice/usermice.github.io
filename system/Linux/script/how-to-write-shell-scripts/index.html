<!doctype html><html lang=zh-CN data-theme=light><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: light)"><meta name=generator content="Hugo 0.125.4"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="How to Write Shell Scripts"><meta itemprop=description content="How-To-Write-Shell-Scripts"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="http://localhost:1313/imgs/s2-1.jpg"><meta itemprop=keywords content="Scripts,Shell"><meta property="og:type" content="article"><meta property="og:title" content="How to Write Shell Scripts"><meta property="og:description" content="How-To-Write-Shell-Scripts"><meta property="og:image" content="/imgs/s2-1.jpg"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="http://localhost:1313/system/linux/script/how-to-write-shell-scripts/"><meta property="og:site_name" content="二哥"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="二哥"><meta property="article:published_time" content="2019-07-25 14:24:59 +0800 CST"><meta property="article:modified_time" content="2019-07-25 14:24:59 +0800 CST"><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.css><link rel=stylesheet href=/css/main.css><style type=text/css>.post-footer,.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":true,"isHome":false,"isPage":true,"path":"how-to-write-shell-scripts","permalink":"http://localhost:1313/system/linux/script/how-to-write-shell-scripts/","title":"How to Write Shell Scripts","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>How to Write Shell Scripts - 二哥</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>二哥</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>Linux、Kubernetes、Docker、Python、CI/CD、Jenkins、Mysql、Nginx、Gitlab、Ansible、Zabbix</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-Home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-categories"><a href=/categories/ class=hvr-icon-pulse rel=section><i class="fa fa-th hvr-icon"></i>分类</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>0</span></a></li><li class="menu-item menu-item-tags"><a href=/tags/ class=hvr-icon-pulse rel=section><i class="fa fa-tags hvr-icon"></i>标签</a></li><li class="menu-item menu-item-tools"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-tools hvr-icon"></i>工具</a></li><li class="menu-item menu-item-flinks"><a href=/flinks.html class=hvr-icon-pulse rel=section><i class="fa fa-thumbs-up hvr-icon"></i>站点示例</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-Commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#shell脚本编写以及执行方式><code>Shell</code>脚本编写以及执行方式</a></li><li><a href=#crontab计划任务定义以及test命令使用><code>crontab</code>计划任务定义以及<code>test</code>命令使用</a></li><li><a href=#font-colorred运算符使用font><font color=red>运算符使用</font></a></li><li><a href=#shell脚本文字以及背景颜色><code>Shell</code>脚本文字以及背景颜色</a></li><li><a href=#变量>变量</a><ul><li><a href=#变量运算>变量运算</a></li><li><a href=#expect使用><code>expect</code>使用</a></li><li><a href=#删除替换变量>删除、替换变量</a></li><li><a href=#实战脚本>实战脚本</a></li></ul></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=二哥 src=/imgs/img-lazy-loading.gif data-src=/imgs/s2-1.jpg><p class=site-author-name itemprop=name>二哥</p><div class=site-description itemprop=description>The man who has made up his mind to win will never say impossible – Napoleon Bonaparte</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>0</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>52</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>149</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=qq%e5%8f%b7 title="QQ → qq号" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-qq fa-fw hvr-icon"></i>
QQ
</a></span><span class=links-of-social-item><a href=https://www.zhihu.com/people/lisenhui title="知乎 → https://www.zhihu.com/people/lisenhui" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎
</a></span><span class=links-of-social-item><a href=qq@qq.com title="E-Mail → qq@qq.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>
E-Mail
</a></span><span class=links-of-social-item><a href=https://weibo.com/yourname title="Weibo → https://weibo.com/yourname" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-weibo fa-fw hvr-icon"></i>
Weibo
</a></span><span class=links-of-social-item><a href="https://www.youtube.com/watch?v=RgKAFK5djSk" title="Youtube → https://www.youtube.com/watch?v=RgKAFK5djSk" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-youtube fa-fw hvr-icon"></i>
Youtube
</a></span><span class=links-of-social-item><a href=https://github.com/elkan1788 title="Github → https://github.com/elkan1788" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li><li class=links-of-blogroll-item><a href=https://lisenhui.cn title=https://lisenhui.cn target=_blank>凡梦星尘空间站</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=goto-gtranslate class=button title=多语言翻译><i class="fas fa-globe"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/hugo-next rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg>
</a><script type=text/javascript src=//sidecar.gitter.im/dist/sidecar.v1.js async></script><script type=text/javascript>((window.gitter={}).chat={}).options={room:"hugo-next/community"}</script><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=http://localhost:1313/system/linux/script/how-to-write-shell-scripts/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/s2-1.jpg"><meta itemprop=name content="二哥"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="二哥"><meta itemprop=description content="The man who has made up his mind to win will never say impossible – Napoleon Bonaparte"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="How to Write Shell Scripts"><meta itemprop=description content="How-To-Write-Shell-Scripts"></span><header class=post-header><h1 class=post-title itemprop="name headline">How to Write Shell Scripts
<a href=https://github.com/user-name/repo-name/tree/branch-name/subdirectory-name/System/Linux/Script/How-To-Write-Shell-Scripts.md rel="noopener external nofollow noreferrer" target=_blank class="exturl post-edit-link" title=编辑><i class="fa fa-pen-nib"></i></a></h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2019-07-25 14:24:59 +0800 CST" itemprop="dateCreated datePublished" datetime="2019-07-25 14:24:59 +0800 CST">2019-07-25
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/scripts itemprop=url rel=index><span itemprop=name>Scripts</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="far fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>5664</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="far fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>12分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="far fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=busuanzi_value_page_pv data-path=/system/linux/script/how-to-write-shell-scripts/><i class="fa fa-sync fa-spin"></i>
</span></span><span class=post-meta-item title><span class=post-meta-item-icon><i class="far fa-comments"></i>
</span><span class=post-meta-item-text title=评论>评论：
</span><span id=comments-count class=waline-comment-count data-path=/system/linux/script/how-to-write-shell-scripts/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><h2 id=shell脚本编写以及执行方式><code>Shell</code>脚本编写以及执行方式
<a class=header-anchor href=#shell%e8%84%9a%e6%9c%ac%e7%bc%96%e5%86%99%e4%bb%a5%e5%8f%8a%e6%89%a7%e8%a1%8c%e6%96%b9%e5%bc%8f></a></h2><div class="note info"><blockquote><ul><li><ol><li><code>sh -n bash.sh</code><font color=red><code># -n</code>调试模式运行</font></li></ol></li><li><ol start=2><li><code>sh -vx bash.sh</code><font color=red><code># -vx</code>打印调试模式运行日志</font></li></ol></li></ul></blockquote><ul><li><ol><li><font color=red>脚本补全、小游戏</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ yum install bash-completion  	<span style=color:#75715e># 脚本补全服务</span>
</span></span><span style=display:flex><span>$ yum -y install sl  	<span style=color:#75715e># 小火车</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ vim scripts.sh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>:set ff<span style=color:#f92672>=</span>unix  	<span style=color:#75715e># 转换换行符</span>
</span></span><span style=display:flex><span>:set paste  	<span style=color:#75715e># 解决文本粘贴后错乱</span>
</span></span></code></pre></div></blockquote><ul><li><ol start=2><li><font color=red>当前执行</font><code>shell</code><font color=red>脚本以及嵌入其他语言</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ source shell.sh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ echo <span style=color:#e6db74>&#34;#!/usr/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo &#34;</span>hello bash<span style=color:#e6db74>&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>. shell.sh  	# 在其他脚本中引用此脚本 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74># 嵌入python脚本
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/usr/bin/python &lt;&lt;-EOF  #&#34;</span>-<span style=color:#e6db74>&#34;支持Tab键,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>print &#34;</span>hello python<span style=color:#e6db74>&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF &#34;</span>&gt;bash.sh
</span></span></code></pre></div></blockquote><ul><li><ol start=3><li><code>bash</code><font color=red>执行环境</font></li></ol></li></ul><blockquote><ul><li>3.1 登录<code>bash</code>执行</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 系统级</span>
</span></span><span style=display:flex><span>/etc/profile
</span></span><span style=display:flex><span>/etc/bashrc
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 用户级</span>
</span></span><span style=display:flex><span>~/.bash_profile
</span></span><span style=display:flex><span>~/.bashrc
</span></span></code></pre></div><ul><li>3.2 退出<code>bash</code>执行</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>~/.bash_history
</span></span><span style=display:flex><span>~/.bash_logout
</span></span></code></pre></div><ul><li>3.3 获取文件名</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ basename  	<span style=color:#75715e># 获取最后文件名: basename /etc/passwd</span>
</span></span><span style=display:flex><span>$ dirname  	<span style=color:#75715e># 获取文件名前缀</span>
</span></span></code></pre></div></blockquote></div><h2 id=crontab计划任务定义以及test命令使用><code>crontab</code>计划任务定义以及<code>test</code>命令使用
<a class=header-anchor href=#crontab%e8%ae%a1%e5%88%92%e4%bb%bb%e5%8a%a1%e5%ae%9a%e4%b9%89%e4%bb%a5%e5%8f%8atest%e5%91%bd%e4%bb%a4%e4%bd%bf%e7%94%a8></a></h2><div class="note info"><ul><li><ol><li><code>crontab</code>计划任务</li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ man crontab
</span></span><span style=display:flex><span>@reboot ：重启后运行一次。
</span></span><span style=display:flex><span>@yearly ：每年运行一次，即。 “0 <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> *”。
</span></span><span style=display:flex><span>@annually ：每年运行一次，即。 “0 <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> *”。
</span></span><span style=display:flex><span>@monthly ：每月运行一次，即。 “0 <span style=color:#ae81ff>1</span> * *”。
</span></span><span style=display:flex><span>@weekly ：每周运行一次，即。 “0 * * 0”。
</span></span><span style=display:flex><span>@daily ：每天运行一次，即。 “0 * * *”。
</span></span><span style=display:flex><span>@hourly ：每小时运行一次，即。 “* * * *”。
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ ls -l /var/spool/cron/root
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ ls -l /var/spool/cron/crontabs/root  	<span style=color:#75715e># Debian系统</span>
</span></span></code></pre></div></blockquote><ul><li><ol start=2><li><code>test</code>命令使用</li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ man test
</span></span></code></pre></div></blockquote></div><h2 id=font-colorred运算符使用font><font color=red>运算符使用</font>
<a class=header-anchor href=#font-colorred%e8%bf%90%e7%ae%97%e7%ac%a6%e4%bd%bf%e7%94%a8font></a></h2><div class="note info"><ul><li><ol><li><font color=red>关系(数值)运算符</font></li></ol></li></ul><blockquote><table><thead><tr><th>关系(数值)运算符</th><th>说明</th><th>举例</th></tr></thead><tbody><tr><td><code>-eq</code>、<code>==</code></td><td>等于：检测两个数是否相等，相等返回<code>true</code></td><td><code>[ $a -eq $b ]</code> 返回：<code>false</code></td></tr><tr><td><code>-ne</code>、<code>!=</code></td><td>不等于： 检测两个数是否不相等，不相等返回<code>true</code></td><td><code>[ $a -ne $b ]</code> 返回：<code>true</code></td></tr><tr><td><code>-gt</code>、<code>></code></td><td>大于：检测左边的数是否大于右边的数，如果是返回：<code>true</code></td><td><code>[ $a -gt $b ]</code> 返回：<code>false</code></td></tr><tr><td><code>-lt</code>、<code>&lt;</code></td><td>小于：检测左边的数是否小于右边的，如果是返回：<code>true</code></td><td><code>[ $a -lt $b ]</code> 返回：<code>true</code></td></tr><tr><td><code>-ge</code>、<code>>=</code></td><td>大于等于：检测左边的数是否大于等于右边的，如果是返回：<code>true</code></td><td><code>[ $a -ge $b ]</code> 返回：<code>false</code></td></tr><tr><td><code>-le</code>、<code>&lt;=</code></td><td>小于等于：检测左边的数是否小于等于右边的，如果是返回：<code>true</code></td><td><code>[ $a -le $b ]</code> 返回：<code>frue</code></td></tr></tbody></table></blockquote><ul><li><ol start=2><li><font color=red>字符串运算符，字符串都用双引号引起来</font><code>" "</code></li></ol></li></ul><blockquote><table><thead><tr><th>字符串运算符</th><th>说明</th><th>举例</th></tr></thead><tbody><tr><td><code>=</code></td><td>等于：检测两个字符串是否相等，相等返回：<code>true</code></td><td><code>[ "$a" = "$b" ]</code> 返回：<code>false</code></td></tr><tr><td><code>!=</code></td><td>不等于：检测两个字符串是否相等，不相等返回：<code>true</code></td><td><code>[ "$a" != "$b" ]</code> 返回：<code>true</code></td></tr><tr><td><code>-z</code></td><td>表示 0：检测字符串长度是否为0，为0返回：<code>true</code></td><td><code>[ -z "$a" ]</code> 返回：<code>false</code></td></tr><tr><td><code>-n</code></td><td>表示非0：检测字符串长度是否为0，不为0返回：<code>true</code></td><td><code>[ -n "$a" ]</code></td></tr><tr><td><code>$</code></td><td>不为空：检测字符串是否为空，不为空返回：<code>true</code></td><td><code>[ $a ]</code> 返回：<code>true</code></td></tr><tr><td><code>str</code></td><td>检测<code>str</code>是否不是空字符串，如果为空返回：<code>false</code></td><td><code>[ $a ]</code> 不是假的</td></tr></tbody></table></blockquote><ul><li><ol start=3><li><font color=red>逻辑运算符</font></li></ol></li></ul><blockquote><table><thead><tr><th>逻辑运算符</th><th>说明</th><th>举例</th></tr></thead><tbody><tr><td><code>&&</code></td><td>逻辑的：<code>and</code>，和/并且：的意思</td><td><code>[[ $a -lt 100 && $b -gt 100 ]]</code> 返回：<code>false</code>，<br><code>./configure && make && make install</code></td></tr><tr><td><code>||</code></td><td>逻辑的：<code>or</code>，或者/否则：的意思</td><td><code>[[ $a -lt 100 || $b -gt 100 ]]</code> 返回：<code>true</code>，<br><code>cat /opt/a.txt || touch /opt/a.txt</code></td></tr></tbody></table></blockquote><ul><li><ol start=4><li><font color=red>布尔运算符只有：真(<code>True</code>)/假(<code>False</code>)</font></li></ol></li></ul><blockquote><table><thead><tr><th>布尔运算符</th><th>说明</th><th>举例</th></tr></thead><tbody><tr><td><code>!</code></td><td>非：运算符：表达式为<code>true</code>则返回<code>false</code>， 否则返回：<code>true</code></td><td><code>[ ! false ]</code> 返回：<code>true</code></td></tr><tr><td><code>-o</code></td><td>或：运算符：有一个表达式为：<code>true</code>则返回<code>true</code></td><td><code>[ $a -lt 20 -o $b -gt 100 ]</code>， 返回：<code>true</code></td></tr><tr><td><code>-a</code></td><td>与：运算符：两个表达式都为：<code>true</code>才返回：<code>true</code></td><td><code>[ $a -lt 20 -a $b -gt 100 ]</code>， 返回：<code>false</code></td></tr></tbody></table></blockquote><ul><li><ol start=5><li><font color=red>算数运算符</font></li></ol></li></ul><blockquote><table><thead><tr><th>算数运算符</th><th>说明</th><th>举例</th></tr></thead><tbody><tr><td><code>+</code></td><td>加法，<code>Python</code><font color=red>中支持：字符串、列表、元组合并</font></td><td><code>expr $a + $b</code>结果为30</td></tr><tr><td><code>-</code></td><td>减法，<code>Python</code><font color=red>中支持：集合，求差异</font></td><td><code>expr $a - $b</code>结果为<code>-10</code></td></tr><tr><td><code>*</code></td><td>乘法，<code>Python</code><font color=red>中支持：字符串、列表、元组，复制</font></td><td><code>expr $a \* $b</code>结果为200</td></tr><tr><td><code>/</code></td><td>除法，<code>Python</code><font color=red>中整数相除得到浮点数<code>float</code>，<code>//</code>为整除</font></td><td><code>expr $b / $a</code>结果为2</td></tr><tr><td><code>%</code></td><td>取余(模余)</td><td><code>expr $b % $a</code>结果为0</td></tr><tr><td><code>=</code></td><td>赋值</td><td><code>a=$b</code>将把变量<code>b</code>赋值给<code>a</code></td></tr><tr><td><code>==</code></td><td>相等：用于比较两个数字，相同则返回：<code>true</code></td><td><code>[ $a == $b ]</code> 返回：<code>false</code></td></tr><tr><td><code>**</code></td><td>幂运算，几的次方</td><td>2的5次方=<code>2*2</code>=<code>4*2</code>=<code>8*2</code>=<code>16*2</code>=32</td></tr></tbody></table></blockquote><ul><li><ol start=6><li><font color=red>文件参数</font></li></ol></li></ul><blockquote><table><thead><tr><th>文件参数</th><th>说明</th><th>举例</th></tr></thead><tbody><tr><td><code>-e</code></td><td>如果文件存在则为真</td><td>`[ -e dir</td></tr><tr><td><code>-r</code></td><td>如果文件存在且当前用户可读则为真，是否可以读取</td><td><code>[ -r $file ]</code></td></tr><tr><td><code>-w</code></td><td>如果文件存在且当前用户可写则为真，是否有可以写入</td><td>&mdash;</td></tr><tr><td><code>-x</code></td><td>如果文件存在且当前用户可执行则为真，是否有执行权限</td><td>&mdash;</td></tr><tr><td><code>-s</code></td><td>如果文件存在且至少有一个字符则为真</td><td>&mdash;</td></tr><tr><td><code>-d</code></td><td>如果文件存在且为目录则为真</td><td><code>[ -d /home ]</code> 是否为目录<br><code>[ ! -d /home ]</code> 取反</td></tr><tr><td><code>-f</code></td><td>如果文件存在且为普通文件则为真</td><td>&mdash;</td></tr><tr><td><code>-c</code></td><td>如果文件存在且为字符型特殊文件则为真</td><td>&mdash;</td></tr><tr><td><code>-b</code></td><td>如果文件存在且为块特殊文件则为真</td><td>&mdash;</td></tr><tr><td><code>-g</code></td><td>如果文件存在且设置<code>SGID</code>则为真</td><td>&mdash;</td></tr><tr><td><code>-k</code></td><td>如果文件存在且设置了<code>粘着位(Sticky Bit)</code>则为真</td><td>&mdash;</td></tr><tr><td><code>-p</code></td><td>如果文件存在且是：名管道，则为真</td><td>&mdash;</td></tr><tr><td><code>-u</code></td><td>如果文件存在且设置<code>SUID</code>则为真</td><td>&mdash;</td></tr><tr><td><code>-t</code></td><td>如果文件存在且文件描述符已打开并与终端关联则为真</td><td>&mdash;</td></tr><tr><td><code>-z</code></td><td>如果文件存在且大于<code>0</code>则为真</td><td>&mdash;</td></tr><tr><td><code>-o</code></td><td>如果文件存在且当前用户是文件所有者则为真</td><td>&mdash;</td></tr><tr><td><code>-S</code></td><td>如果文件存在且是<code>socket</code>文件则为真</td><td>&mdash;</td></tr><tr><td><code>-L</code></td><td>如果文件存在且是连接文件则为真</td><td>&mdash;</td></tr></tbody></table></blockquote><ul><li><ol start=7><li><font color=red>传参参数处理</font></li></ol></li></ul><blockquote><table><thead><tr><th>参数处理</th><th>说明</th><th>举例</th></tr></thead><tbody><tr><td><code>$#</code></td><td>传入脚本的参数个数</td><td><code>[ $# -eq 0 ]</code></td></tr><tr><td><code>$*</code></td><td>传入脚本的所有参数</td><td>如<code>"$*"</code>用<code>" "</code>括起来的情况，以<code>"$1 $2 ... $n"</code>的形式输出所有参数</td></tr><tr><td><code>$$</code></td><td>当前<code>shell</code>的进程号，对于<code>shell</code>脚本，这是它们执行的进程<code>ID</code></td><td>&mdash;</td></tr><tr><td><code>$!</code></td><td><code>Shell</code>后台运行的最后一个进程<code>Process</code>的<code>PID</code></td><td>&mdash;</td></tr><tr><td><code>$@</code></td><td>与<code>$*</code>相同，但是使用时加引号，并在引号中返回每个参数，如<code>"$@"</code>用<code>" "</code>括起来，以<code>"$1" "$2" ... "$n"</code>的形式输出所有参数</td><td>其中<code>$@</code>与<code>$*</code>正常情况下一样，当在脚本中将<code>$*</code>加上双引号作为<code>“$*”</code>引用时，此时将输入的所有参数当做一个整体字符串对待。比如输入参数有<code>a b c</code>三个参数，则<code>“$*”</code>表示<code>“a b c”</code>一个字符串</td></tr><tr><td><code>$-</code></td><td>显示<code>shell</code>使用的当前选项，与<code>set</code>命令功能相同</td><td>&mdash;</td></tr><tr><td><code>$?</code></td><td>显示最后命令退出状态，0表示没有错误，其他任何值表明有错误</td><td>&mdash;</td></tr><tr><td><code>$0</code></td><td>当前脚本文件名</td><td>&mdash;</td></tr><tr><td><code>$1～$n</code></td><td>这些变量对应调用脚本的参数，这里的<code>n</code>是对应于参数位置的正十进制数(第一个参数是<code>$1</code>，第二个参数是<code>$2</code>，依此类推)</td><td>&mdash;</td></tr><tr><td><code>$#</code></td><td>提供给脚本的参数数量</td><td>&mdash;</td></tr><tr><td><code>$</code></td><td>当前运行脚本的进程<code>ID</code>号</td><td>&mdash;</td></tr></tbody></table></blockquote><ul><li><ol start=8><li><code>Printf</code><font color=red>的转义序列</font></li></ol></li></ul><blockquote><table><thead><tr><th><code>printf</code>的转义序列</th><th>说明</th><th>举例</th></tr></thead><tbody><tr><td><code>\a</code></td><td>警告字符，通常为<code>ASCII</code>的<code>BEL</code>字符</td><td>&mdash;</td></tr><tr><td><code>\b</code></td><td>后退</td><td>&mdash;</td></tr><tr><td><code>\c</code></td><td>抑制(不显示)输出结果中任何结尾的换行字符(只在<code>%</code>格式指示符控制下的参数字符串中有效)，而且任何留在参数里的字符，任何接下来的参数以及任何留在格式字符串中的字符，都被忽略</td><td>&mdash;</td></tr><tr><td><code>\f</code></td><td>换页<code>formfedd</code></td><td>&mdash;</td></tr><tr><td><code>\n</code></td><td>换行</td><td>&mdash;</td></tr><tr><td><code>\r</code></td><td>回车<code>Carriage return</code></td><td>&mdash;</td></tr><tr><td><code>\t</code></td><td>水平制表符，类似：<code>Tab</code>键，四个空格键</td><td>&mdash;</td></tr><tr><td><code>\v</code></td><td>垂直制表符</td><td>&mdash;</td></tr><tr><td><code>\\</code></td><td>一个字面上的反斜杠字符</td><td>&mdash;</td></tr><tr><td><code>\ddd</code></td><td>表示1到3位数八进制值得字符，仅在格式字符串中有效</td><td>&mdash;</td></tr><tr><td><code>\0ddd</code></td><td>表示1到3位得八进制字符</td><td>&mdash;</td></tr></tbody></table><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 格式化输出两种方式</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 第一种</span>
</span></span><span style=display:flex><span>$ echo -e  <span style=color:#e6db74>&#34;a\tb&#34;</span>，<span style=color:#ae81ff>\t</span>:Tab<span style=color:#f92672>(</span>键<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 第二种</span>
</span></span><span style=display:flex><span>$ printf <span style=color:#e6db74>&#34;%-10s %-8s %-4s\n&#34;</span> 姓名 性别 体重kg  
</span></span><span style=display:flex><span>$ printf <span style=color:#e6db74>&#34;%-10s %-8s %-4.2f\n&#34;</span> 郭靖 男 66.1234
</span></span><span style=display:flex><span>$ printf <span style=color:#e6db74>&#34;%-10s %-8s %-4.2f\n&#34;</span> 杨过 男 48.6543
</span></span><span style=display:flex><span>$ printf <span style=color:#e6db74>&#34;%-10s %-8s %-4.2f\n&#34;</span> 郭芙 女 47.9876
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>%s %c %d %f  	<span style=color:#75715e># 都是格式替代符，</span>
</span></span><span style=display:flex><span>％s  	<span style=color:#75715e># 输出一个字符串，</span>
</span></span><span style=display:flex><span>％d  	<span style=color:#75715e># 整型输出，</span>
</span></span><span style=display:flex><span>％c  	<span style=color:#75715e># 输出一个字符，</span>
</span></span><span style=display:flex><span>％f  	<span style=color:#75715e># 输出实数，以小数形式输出。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>%-10s  	<span style=color:#75715e># 指一个宽度为 10 个字符（- 表示左对齐，没有则表示右对齐），任何字符都会被显示在 10 个字符宽的字符内，如果不足则自动以空格填充，超过也会将内容全部显示出来。</span>
</span></span><span style=display:flex><span>%-4.2f  	<span style=color:#75715e># 指格式化为小数，其中 .2 指保留2位小数。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ printf <span style=color:#e6db74>&#34;\e[?2004l&#34;</span>  	<span style=color:#75715e># 解决命令行终端复制粘贴出现 0~ 1~ 问题，括号粘贴模式</span>
</span></span></code></pre></div></blockquote><ul><li><ol start=9><li><font color=red>运算符描述</font></li></ol></li></ul><blockquote><table><thead><tr><th>运算符描述</th><th>说明</th><th>举例</th></tr></thead><tbody><tr><td><code>()</code></td><td>改变优先顺序，</td><td>小括号子<code>shell</code>中执行命令：<code>(ls)</code></td></tr><tr><td><code>(())</code></td><td>数值比较，运算</td><td>&mdash;</td></tr><tr><td><code>$()</code></td><td>命令替换、相当于反撇号: ``</td><td>&mdash;</td></tr><tr><td><code>$(())</code></td><td>整数运算</td><td>&mdash;</td></tr><tr><td><code>[]</code></td><td>条件测试、匹配方括号中任意<code>一个</code>字符</td><td><code>[a-z] [0-9] [a-zA-Z0-9] 取反:[^a-zA-Z0-9]</code></td></tr><tr><td><code>[[]]</code></td><td>条件测试，支持正则 <code>=~</code></td><td>&mdash;</td></tr><tr><td><code>$[]</code></td><td>整数运算</td><td>&mdash;</td></tr><tr><td><code>{}</code></td><td>打括号使用方式</td><td><code>mkdir -pv /opt/{aaa/{111,222},bbb}、cp nginx.conf{,.bak}、{1..9}</code></td></tr><tr><td><code>${}</code></td><td>&mdash;</td><td>&mdash;</td></tr><tr><td><code>~1</code></td><td>的补充</td><td>&mdash;</td></tr><tr><td><code>!</code></td><td>逻辑否定</td><td>&mdash;</td></tr><tr><td><code>!~</code></td><td>逻辑否定：二进制反转（一个补码）</td><td>&mdash;</td></tr><tr><td><code>&lt;&lt;</code></td><td>左移</td><td>&mdash;</td></tr><tr><td><code>>></code></td><td>右移</td><td>&mdash;</td></tr><tr><td><code>=~</code></td><td>匹配模式</td><td>&mdash;</td></tr><tr><td><code>&</code></td><td><code>Bitwise</code>和</td><td>&mdash;</td></tr><tr><td><code>^</code></td><td>按位"独占或"</td><td>&mdash;</td></tr><tr><td><code>|</code></td><td>按位"包容性" 或</td><td>&mdash;</td></tr><tr><td><code>++</code></td><td>递增</td><td>&mdash;</td></tr><tr><td><code>---</code></td><td>递减</td><td>&mdash;</td></tr><tr><td><code>*=</code></td><td>左侧乘以右侧并更新左侧</td><td>&mdash;</td></tr><tr><td><code>/=</code></td><td>将左侧除以</td><td>&mdash;</td></tr><tr><td><code>+=</code></td><td>将左侧添加到右侧并更新左侧</td><td>&mdash;</td></tr><tr><td><code>-+</code></td><td>将右侧减去左侧并更新左侧</td><td>&mdash;</td></tr><tr><td><code>^=</code></td><td>&ldquo;独占或"左侧到右侧并更新左侧</td><td>&mdash;</td></tr><tr><td><code>%=</code></td><td>左侧除以右侧，余数更新再左侧</td><td>&mdash;</td></tr><tr><td><code>;</code></td><td>执行多个命令</td><td><code>cat /etc/passwd; ls</code></td></tr><tr><td><code>\</code></td><td>转意符</td><td><code>"touch linux\ nginx、\t:Tab(键)、\n:(换行)、\c:(不换行输出)"</code></td></tr><tr><td><code>true</code></td><td>永远返回为真<code>0</code></td><td>&mdash;</td></tr><tr><td><code>false</code></td><td>永远返回为假<code>1</code></td><td>&mdash;</td></tr></tbody></table></blockquote><ul><li><ol start=10><li><font color=red>条件语句</font></li></ol></li></ul><blockquote><table><thead><tr><th>条件语句</th><th>说明</th><th>举例</th></tr></thead><tbody><tr><td><code>if</code></td><td>如果什么什么</td><td>&mdash;</td></tr><tr><td><code>then</code></td><td>然后怎么怎么</td><td>&mdash;</td></tr><tr><td><code>elif</code></td><td>其它怎么怎么，<code>elif</code>是<code>if</code>有多个语句条件</td><td>&mdash;</td></tr><tr><td><code>else</code></td><td>否则怎么怎么</td><td>&mdash;</td></tr><tr><td><code>fi</code></td><td>结束：<code>if</code>判断句结束语</td><td>&mdash;</td></tr><tr><td><code>case</code></td><td>循环语句开始定义</td><td>&mdash;</td></tr><tr><td><code>esac</code></td><td>循环语句结束定义</td><td>&mdash;</td></tr><tr><td><code>while</code></td><td>条件为真循环</td><td>外循环控制行数，内循环控制列数，内循环小于等于外循环</td></tr><tr><td><code>unitl</code></td><td>条件为假循环</td><td>&mdash;</td></tr><tr><td><code>select</code></td><td>循环、查询</td><td>&mdash;</td></tr><tr><td><code>in</code></td><td>在什么什么</td><td><code>Python</code><font color=red>中支持：字符串、列表、元组、字典，检测元素是否存在，与之相反的是：</font><code>not in</code></td></tr><tr><td><code>do</code></td><td>做/执行什么什么</td><td>&mdash;</td></tr><tr><td><code>done</code></td><td>结束循环</td><td>&mdash;</td></tr><tr><td><code>unset</code></td><td>删除变量</td><td>&mdash;</td></tr><tr><td><code>readonly</code></td><td>只读变量</td><td>&mdash;</td></tr><tr><td><code>read</code></td><td>读取输入变量名</td><td>&mdash;</td></tr><tr><td><code>clear</code></td><td>删除、清除</td><td>&mdash;</td></tr><tr><td><code>break</code></td><td>跳出整个循环，<code>n</code>指定的第<code>n</code>个封闭循环，退出可以是<code>1、2、3</code></td><td>&mdash;</td></tr><tr><td><code>continue</code></td><td>当前迭代循环退出</td><td>&mdash;</td></tr></tbody></table></blockquote><ul><li><ol start=11><li><font color=red>重定向参数</font></li></ol></li></ul><blockquote><table><thead><tr><th>重定向</th><th>说明</th><th>举例</th></tr></thead><tbody><tr><td><code>command > file</code></td><td>将输出重定向到：<code>file</code></td><td>&mdash;</td></tr><tr><td><code>command &lt; file</code></td><td>将输入重定向到：<code>file</code></td><td>&mdash;</td></tr><tr><td><code>command >> file</code></td><td>将输出以追加的方式重定向到：<code>file</code></td><td>&mdash;</td></tr><tr><td><code>n > file</code></td><td>将文件描述符为<code>n</code>的文件重定向到：<code>file</code></td><td>&mdash;</td></tr><tr><td><code>n >> file</code></td><td>将文件描述符为<code>n</code>的文件以追加的方式重定向到：<code>file</code></td><td>&mdash;</td></tr><tr><td><code>n >& m</code></td><td>将输出文件<code>m</code>和<code>n</code>合并</td><td>&mdash;</td></tr><tr><td><code>n &lt;& m</code></td><td>将输入文件<code>m</code>和<code>n</code>合并</td><td>&mdash;</td></tr><tr><td><code>&lt;&lt; tag</code></td><td>将开始标记<code>tag</code>和结束标记<code>tag</code>之间的内容作为输入</td><td>&mdash;</td></tr></tbody></table></blockquote><ul><li><ol start=12><li><font color=red>多行注释</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>:<span style=color:#e6db74>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>:&lt;&lt;<span style=color:#e6db74>&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>:&lt;&lt;!
</span></span><span style=display:flex><span>!
</span></span></code></pre></div></blockquote></div><h2 id=shell脚本文字以及背景颜色><code>Shell</code>脚本文字以及背景颜色
<a class=header-anchor href=#shell%e8%84%9a%e6%9c%ac%e6%96%87%e5%ad%97%e4%bb%a5%e5%8f%8a%e8%83%8c%e6%99%af%e9%a2%9c%e8%89%b2></a></h2><div class="note info"><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>30:黑色、31:红色、32:绿色、33:黄色、34:蓝色、35:紫色、36:浅蓝色、37:白色  	<span style=color:#75715e># 文字颜色 </span>
</span></span><span style=display:flex><span>40:黑色、41:红色、42:绿色、43:黄色、44:蓝色、45:紫色、46:浅蓝色、47:白色  	<span style=color:#75715e># 背景颜色</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>-e  	<span style=color:#75715e># 若字符串中出现以下字符，则特别加以处理，而不会将它当成一般文字输出</span>
</span></span><span style=display:flex><span>echo -e <span style=color:#e6db74>&#34;\e[1;30m我是灰色 \e[0m&#34;</span>  	<span style=color:#75715e># 文字色号30~37，&#34;\e[0m&#34;:恢复原本色号 </span>
</span></span><span style=display:flex><span>echo -e <span style=color:#e6db74>&#34;\e[1;40m我是灰色 \e[0m&#34;</span>  	<span style=color:#75715e># 背景色号40~47，&#34;\e[0m&#34;:恢复原本色号 </span>
</span></span></code></pre></div></blockquote></div><h2 id=变量>变量
<a class=header-anchor href=#%e5%8f%98%e9%87%8f></a></h2><div class="note info"><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>IP<span style=color:#f92672>=</span>192.168.1.1  	<span style=color:#75715e># 显示赋值</span>
</span></span><span style=display:flex><span>echo $IP
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>read -p <span style=color:#e6db74>&#34;请输入 IP: &#34;</span> IP 
</span></span><span style=display:flex><span><span style=color:#75715e># 键盘读入赋值: IP:为变量名, 一次性可以定义多个变量名：read -p &#34;请输入你的姓名，年龄，性别: &#34; name age sex  </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>./ping.sh  192.168.1.1  192.168.1.2  
</span></span><span style=display:flex><span>        $1           $2  <span style=color:#75715e># 位置变量</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 环境变量(系统变量)</span>
</span></span><span style=display:flex><span>设置环境变量
</span></span><span style=display:flex><span>export IP<span style=color:#f92672>=</span>192.168.1.1
</span></span><span style=display:flex><span>export IP  	<span style=color:#75715e># 变量名</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># /etc/profile</span>
</span></span><span style=display:flex><span>PATH<span style=color:#f92672>=</span>$PATH:/new/bin
</span></span><span style=display:flex><span>export PATH
</span></span><span style=display:flex><span>   
</span></span><span style=display:flex><span>           <span style=color:#75715e># 自定义变量</span>
</span></span></code></pre></div></blockquote></div><h3 id=变量运算>变量运算
<a class=header-anchor href=#%e5%8f%98%e9%87%8f%e8%bf%90%e7%ae%97></a></h3><div class="note info"><ul><li><ol><li>整数运算</li></ol></li></ul><blockquote><ul><li>1.1 <font color=red>方式一</font><code>expr</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ expr <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>\*</span> <span style=color:#ae81ff>2</span>
</span></span></code></pre></div><ul><li>1.2 <font color=red>方式二</font><code>$(())</code><font color=red># 脚本常用</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ echo <span style=color:#66d9ef>$((</span><span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2</span><span style=color:#66d9ef>))</span>
</span></span></code></pre></div><ul><li>1.3 <font color=red>方式三</font><code>let</code><font color=red> # 脚本常用</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>let i++ 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 先赋值,后运算: x=i :x=1、i=2</span>
</span></span><span style=display:flex><span>i<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>let x<span style=color:#f92672>=</span>i++
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 先运算,后赋值: ++j :y=2、j=2</span>
</span></span><span style=display:flex><span>j<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>let y<span style=color:#f92672>=</span>++j  	
</span></span></code></pre></div></blockquote><ul><li><ol start=2><li>小数运算</li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ echo <span style=color:#e6db74>&#34;2*4&#34;</span> |bc
</span></span><span style=display:flex><span>$ echo <span style=color:#e6db74>&#34;2^4&#34;</span> |bc  	<span style=color:#75715e># bc的次方: ^</span>
</span></span><span style=display:flex><span>$ echo <span style=color:#e6db74>&#34;scale=2;6/4&#34;</span> |bc
</span></span><span style=display:flex><span>$ awk <span style=color:#e6db74>&#39;BEGIN{print 1/2}&#39;</span>
</span></span></code></pre></div></blockquote></div><h3 id=expect使用><code>expect</code>使用
<a class=header-anchor href=#expect%e4%bd%bf%e7%94%a8></a></h3><div class="note info"><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ cat &gt;expect.sh<span style=color:#e6db74>&lt;&lt;-EOF
</span></span></span><span style=display:flex><span><span style=color:#e6db74>#!/use/bin/expect
</span></span></span><span style=display:flex><span><span style=color:#e6db74>spawn ssh  root@192.168.1.1  	# spawn:开启一个会话
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>expect {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       &#34;yes/no&#34; { send &#34;yes\r&#34;; exp_continue }  	# send:传送参数，\r:回车键, exp_continue:没出现&#34;yes/no&#34;也提交 第二次连接不会出现，
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       &#34;password:&#34; { send &#34;密码\r&#34; };
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>interact  	# 停留在被连接系统中
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span></code></pre></div></blockquote></div><h3 id=删除替换变量>删除、替换变量
<a class=header-anchor href=#%e5%88%a0%e9%99%a4%e6%9b%bf%e6%8d%a2%e5%8f%98%e9%87%8f></a></h3><div class="note info"><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e>#  	# 从头往后删除</span>
</span></span><span style=display:flex><span>%  	<span style=color:#75715e># 从后往头删除</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>:0:3<span style=color:#f92672>}</span>  	<span style=color:#75715e># 切片</span>
</span></span><span style=display:flex><span>/  	<span style=color:#75715e># 内容替换</span>
</span></span><span style=display:flex><span>-  	<span style=color:#75715e># 变量替代</span>
</span></span><span style=display:flex><span>:-  	<span style=color:#75715e>#变量替代，可替代空值、+、:+、=、:=、?、:?、</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 百度域名举例:www.baidu.com</span>
</span></span><span style=display:flex><span>url<span style=color:#f92672>=</span>www.baidu.com
</span></span><span style=display:flex><span>$ echo <span style=color:#e6db74>${</span>url#*.<span style=color:#e6db74>}</span>
</span></span><span style=display:flex><span>baidu.com
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ echo <span style=color:#e6db74>${</span>url#*bai<span style=color:#e6db74>}</span>
</span></span><span style=display:flex><span>du.com
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ echo <span style=color:#e6db74>${</span>url##*.<span style=color:#e6db74>}</span>
</span></span><span style=display:flex><span>com
</span></span></code></pre></div></blockquote></div><h3 id=实战脚本>实战脚本
<a class=header-anchor href=#%e5%ae%9e%e6%88%98%e8%84%9a%e6%9c%ac></a></h3><div class="note info"><ul><li><ol><li><font color=red>实战脚本一</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ echo <span style=color:#e6db74>&#39;#!/usr/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#e6db74># 提示用户没有加参数
</span></span></span><span style=display:flex><span><span style=color:#e6db74>if [ $# -eq 0 ]; then
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    echo &#34;执行方式: `basename $0` 文件名(file)&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    exit  # 退出
</span></span></span><span style=display:flex><span><span style=color:#e6db74>fi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74># 提示输入的不是文件: ! 取反:不是文件
</span></span></span><span style=display:flex><span><span style=color:#e6db74>if [ ! -f $1 ];then
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    echo &#34;错误的文件名&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    exit
</span></span></span><span style=display:flex><span><span style=color:#e6db74>fi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74># 正确执行
</span></span></span><span style=display:flex><span><span style=color:#e6db74>for IP in `cat $1`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>do 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    ping -c1 $IP &amp;&gt;/dev/null
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    if [ $? -eq 0 ];then
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        echo &#34;${IP} is up&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    else
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        echo &#34;${IP} is down&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    fi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>done
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;</span> &gt;ping.sh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ ./ping.sh ip.txt
</span></span></code></pre></div></blockquote><ul><li><ol start=2><li><font color=red>实战脚本二</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ echo <span style=color:#e6db74>&#39;#!/usr/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#e6db74>read -p &#34;请输入数字: &#34; num
</span></span></span><span style=display:flex><span><span style=color:#e6db74>while true
</span></span></span><span style=display:flex><span><span style=color:#e6db74>do
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       if [[ &#34;$num&#34; =~ ^[0-9]+$ ]];then
</span></span></span><span style=display:flex><span><span style=color:#e6db74>           break   # 跳出循环
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       else
</span></span></span><span style=display:flex><span><span style=color:#e6db74>           echo &#34;你输入的不是数字！！！&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>           read -p &#34;输入错误，请重新输入: &#34; num
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       fi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>done
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>read -p &#34;请输入创建的用户首字母: &#34; prefix
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>if [ -z &#34;$prefix&#34; ];then
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       echo &#34;错误的首字母(prefix)&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       exit
</span></span></span><span style=display:flex><span><span style=color:#e6db74>fi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>for i in `seq $num`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>do
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       user=$prefix$i
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       useradd $user
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       echo &#34;123&#34; |passwd --stdin $user &amp;&gt;/dev/null
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       if [ $? -eq 0 ];then
</span></span></span><span style=display:flex><span><span style=color:#e6db74>           echo &#34;$user 创建成功&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       fi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>done  &#39;</span> &gt;useradd.sh
</span></span></code></pre></div></blockquote><ul><li><ol start=3><li><font color=red>实战脚本三、清理</font><code>Nginx</code><font color=red>缓存</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ echo <span style=color:#e6db74>&#39;/opt/delete-cache.sh&#39;</span> &gt;&gt;/home/neek/.bash_profile  	<span style=color:#75715e># 登录即执行脚本</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cat &gt;delete-cache.sh<span style=color:#e6db74>&lt;&lt;-EOF
</span></span></span><span style=display:flex><span><span style=color:#e6db74>#!/usr/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#e6db74>#trap &#34;&#34; HUP INT OUIT TSTP #防止在脚本中退出
</span></span></span><span style=display:flex><span><span style=color:#e6db74>#clear
</span></span></span><span style=display:flex><span><span style=color:#e6db74>directory=/opt/data/cache
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/usr/bin/ansible web -i /etc/ansible/hosts -m shell  -a &#34;/usr/bin/rm -rf ${directory}/directory.log&#34; -f 5 &amp;&gt;/dev/null
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/usr/bin/rm -rf /opt/data/Tenant.txt
</span></span></span><span style=display:flex><span><span style=color:#e6db74>sleep 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/usr/bin/ls ${directory}/ |tee /opt/data/Tenant.txt
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo -e &#34;\e[1;36m \t\t\t+------------------------------------------+\t\t\t \e[0m&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo -e &#34;\e[1;31m \t\t\t|	      	清理租户缓存		   |\t\t\t \e[0m&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo -e &#34;\e[1;36m \t\t\t+------------------------------------------+\t\t\t \e[0m&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo -e &#34;\e[1;36m \t\t\t|   (0) 退出				   |\t\t\t \e[0m&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo -e &#34;\e[1;33m \t\t\t|   (1)输入要删除的目录例如：h5、web、ldy。|\t\t\t \e[0m&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo -e &#34;\e[1;31m \t\t\t|   (2)输入&#39;2&#39;删除租户目录下所有缓存	   |\t\t\t \e[0m&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo -e &#34;\e[1;31m \t\t\t|   (3)输入&#39;3&#39;删除所有租户缓存		   |\t\t\t \e[0m&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo -e &#34;\e[1;36m \t\t\t+------------------------------------------+\t\t\t \e[0m&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo -en &#34;\e[1;36m选择要清理的租户缓存[0-3]: \e[0m&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>read ID
</span></span></span><span style=display:flex><span><span style=color:#e6db74>while :;do
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	if [[ &#34;$ID&#34; =~ ^[0-9]$ ]];then
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		break
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	else
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		echo -en &#34;\e[1;31m输入错误请重新输入[0-3]: \e[0m&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		read ID
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	fi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>done
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>while :;do
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	case $ID in
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		0)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		 exit;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		1)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		 echo -en &#34;\e[1;36m请输入租户目录: \e[0m&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		 read  Name
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		 /usr/bin/ls ${directory}/${Name}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		 echo -en &#34;\e[1;36m请输入要清理缓存的终端:h5、web、ldy中的一个： \e[0m&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		 read  cache
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		 if [ -d ${directory}/${Name}/${cache}/ ];then
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			/usr/bin/ansible web -i /etc/ansible/hosts -m shell  -a &#34;rm -rf ${directory}/${Name}/${cache}&#34; -f 5 &amp;&gt;/dev/null
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			echo &#34;已清理租户${Name}目录下${cache}目录中的缓存&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			exit
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		 else
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			echo &#34;目录不存在&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			exit
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		 fi;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		2)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		 echo -en &#34;\e[1;36m请输入要清理缓存的租户目录: \e[0m&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		 read  Name
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	 	 if [ -d ${directory}/${Name} ];then
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			/usr/bin/ansible web -i /etc/ansible/hosts -m shell  -a &#34;rm -rf ${directory}/${Name}/*&#34; -f 5 &amp;&gt;/dev/null
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			echo &#34;已清理租户${Name}目录下所有缓存&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			exit
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		 fi;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		3)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		 echo -en &#34;\e[1;31m确认要清理所有租户缓存吗[y/n]: \e[0m&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		 read y
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		 if [ &#34;$y&#34; = &#34;y&#34; ];then
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			/usr/bin/ansible web -i /etc/ansible/hosts -m shell  -a &#34;rm -rf ${directory}/*&#34; -f 5 &amp;&gt;/dev/null
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			echo &#34;已清理所有租户缓存&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			for mk in `cat /opt/data/Tenant.txt`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			do
</span></span></span><span style=display:flex><span><span style=color:#e6db74>				/usr/bin/ansible web -i /etc/ansible/hosts -m shell  -a &#34;/usr/bin/mkdir -pv ${directory}/${mk} &gt;&gt;${directory}/directory.log&#34; -f 5 &amp;&gt;/dev/null
</span></span></span><span style=display:flex><span><span style=color:#e6db74>				if [ $? -eq 0 ];then
</span></span></span><span style=display:flex><span><span style=color:#e6db74>					echo &#34;${mk} create ok&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>				else
</span></span></span><span style=display:flex><span><span style=color:#e6db74>					echo &#34;${mk} create error&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>				fi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			done
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			exit
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		else
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			echo &#34;输入不是’y‘退出&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			exit
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		fi;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	esac
</span></span></span><span style=display:flex><span><span style=color:#e6db74>done
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span></code></pre></div></blockquote><ul><li><ol start=4><li>实战脚本四、修改系统<code>IP</code></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ cat &gt;Update-Ip.sh<span style=color:#e6db74>&lt;&lt;-EOF
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo &#34;###input ip you want change to ### &#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>ipfront=192.168.0.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>read -p &#34;请输入结尾IP:&#34; ip1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>ip=&#34;${ipfront}${ip1}&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo &#34;###ip====&#34; $ip &#34;###&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>eth=`find /etc/sysconfig/network-scripts/ -name &#34;ifcfg-e*&#34; |sort |head -1 |awk -F/ &#39;{print $5}&#39;`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>ethfile=&#34;/etc/sysconfig/network-scripts/$eth&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo &#34;${ethfile}&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>sed -i &#34;s/BOOTPROTO=&#39;dhcp&#39;/BOOTPROTO=&#39;static&#39;/g&#34; &#34;${ethfile}&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>sed -i &#34;s/^ONBOOT=no/ONBOOT=yes/g&#34; &#34;${ethfile}&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>testfile=&#34;/etc/sysconfig/network-scripts/test&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo &#34;IPADDR=${ip}&#34; &gt;&gt;${ethfile}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo &#34;NETMASK=255.255.255.0&#34; &gt;&gt;${ethfile}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo &#34;GATEWAY=192.168.0.1&#34; &gt;&gt;${ethfile}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo &#34;DNS1=8.8.8.8&#34; &gt;&gt;${ethfile}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo &#34;DNS2=1.1.1.1&#34; &gt;&gt;${ethfile}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>sleep 3
</span></span></span><span style=display:flex><span><span style=color:#e6db74>systemctl restart network
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo $?
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span></code></pre></div></blockquote></div></div><footer class=post-footer><div class=post-tags><a href=/tags/scripts>Scripts
</a><a href=/tags/shell>Shell</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=reward-container><div><i class="fa-solid fa-mug-hot"></i>请我喝杯咖啡吧 ヾ(^▽^*)))</div><button>
赞赏</button><div class=post-reward><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/ali-pay.png alt="二哥 - 支付宝">
<span>支付宝</span></div><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/wechat-pay.png alt="二哥 - 微信">
<span>微信</span></div></div></div><div class=post-copyright><img src=/imgs/cc/cc.svg width=75 height=75 align=right alt=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
How to Write Shell Scripts</li><li class=post-copyright-author><strong>本文作者： </strong>二哥</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=http://localhost:1313/system/linux/script/how-to-write-shell-scripts/ title="How to Write Shell Scripts">http://localhost:1313/system/linux/script/how-to-write-shell-scripts/</a></li><li class=post-copyright-license><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=/images/wechat_channel.jpg><span class=icon><i class="fab fa-weixin"></i>
</span><span class=label>WeChat</span></a></div><div class=social-item><a target=_blank class=social-link href=/atom.xml><span class=icon><i class="fa fa-rss"></i>
</span><span class=label>RSS</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/system/linux/gitlab/use-git-command/ rel=next title="Use Git Command"><i class="fa fa-chevron-left"></i> Use Git Command</a></div><div class="post-nav-prev post-nav-item"><a href=/system/linux/web/install-nginx/ rel=prev title="Install Nginx">Install Nginx
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div><div class=comment-switch><span class=first-comment>Giscus</span>
<span class=switch-btn></span>
<span class=second-comment>Waline</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=waline-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div id=gtranslate class=google-translate><i class="fa fa-language"></i><div id=google_translate_element></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2010 - 2024
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>二哥</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.125.4 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.5.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>粤ICP备 18047355-1 号</a>
<img src=/imgs/gongan.png alt=沪公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011402009770" target=_blank>沪公网安备 31011402009770 号</a></div><div class=vendors-list><a target=_blank href=https://vercel.com title=Vercel><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/vercel.svg alt=Vercel>
</a><a target=_blank href=https://upyun.com title=又拍云><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/upyun.png alt=又拍云>
</a><a target=_blank href=https://webify.cloudbase.net title=Webify>Webify
</a><span>提供CDN/云资源支持</span></div></div></footer><script type=text/javascript src=https://cdn.staticfile.org/animejs/3.2.1/anime.min.js defer></script><script type=text/javascript src=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.js defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":false,"giscus":{"cfg":{"category":"Comments","categoryid":null,"emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"username/repo-name","repoid":null,"theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"http://localhost:1313/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":true,"plugin":"waline"},"views":{"enable":true,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"qiniu","router":"https://cdn.staticfile.org"},"version":"4.5.3","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":null,"sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"waline","file":"dist/waline.css","name":"@waline/client","version":"2.13.0"},"js":{"alias":"waline","file":"dist/waline.js","name":"@waline/client","version":"2.13.0"}}}</script><script type=text/javascript src=/js/main.js defer></script></body></html>