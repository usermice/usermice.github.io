<!doctype html><html lang=zh-CN data-theme=light><head><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: light)"><meta name=generator content="Hugo 0.125.4"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="Configure K8s Helm"><meta itemprop=description content="Configure-K8s-Helm"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://erge.blog/imgs/s2-1.jpg"><meta itemprop=keywords content="Kubernetes,Helm"><meta property="og:type" content="article"><meta property="og:title" content="Configure K8s Helm"><meta property="og:description" content="Configure-K8s-Helm"><meta property="og:image" content="/imgs/s2-1.jpg"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://erge.blog/system/linux/kubernetes/configure-k8s-helm/"><meta property="og:site_name" content="二哥"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="二哥"><meta property="article:published_time" content="2022-05-29 19:31:37 +0800 CST"><meta property="article:modified_time" content="2022-11-14 19:31:37 +0800 CST"><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.css><link rel=stylesheet href=/css/main.min.0d420b6f564e6674edd4354ea71c0458a83f95ad464a75114b23d72515b1456c.css><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":true,"isHome":false,"isPage":true,"path":"configure-k8s-helm","permalink":"https://erge.blog/system/linux/kubernetes/configure-k8s-helm/","title":"Configure K8s Helm","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>Configure K8s Helm - 二哥</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>二哥</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>Linux、Kubernetes、Docker、Python、CI/CD、Jenkins、Mysql、Nginx、Gitlab、Ansible、Zabbix</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-Home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-categories"><a href=/categories/ class=hvr-icon-pulse rel=section><i class="fa fa-th hvr-icon"></i>分类</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>0</span></a></li><li class="menu-item menu-item-tags"><a href=/tags/ class=hvr-icon-pulse rel=section><i class="fa fa-tags hvr-icon"></i>标签</a></li><li class="menu-item menu-item-tools"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-tools hvr-icon"></i>工具</a></li><li class="menu-item menu-item-flinks"><a href=/flinks.html class=hvr-icon-pulse rel=section><i class="fa fa-thumbs-up hvr-icon"></i>站点示例</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-Commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#helm常用命令><code>Helm</code>常用命令</a></li><li><a href=#font-colorred安装fonthelm><font color=red>安装</font><code>Helm</code></a></li><li><a href=#配置chart仓库>配置<code>chart</code>仓库</a></li><li><a href=#helm基本使用><code>Helm</code>基本使用</a><ul><li><a href=#font-colorred安装fontchartfont-colorred形成fontrelease><font color=red>安装</font><code>chart</code><font color=red>，形成</font><code>release</code></a></li><li><a href=#font-colorred查看fontservicefont-colorred并将其改为fontnodeport><font color=red>查看</font><code>Service</code><font color=red>，并将其改为</font><code>NodePort</code></a></li><li><a href=#font-colorred应用示例font><font color=red>应用示例</font></a></li><li><a href=#font-colorred调试font><font color=red>调试</font></a></li><li><a href=#font-colorredvaluesfont><font color=red><code>Values</code></font></a></li></ul></li><li><a href=#升级回滚和卸载发行版本>升级、回滚和卸载发行版本</a></li><li><a href=#管道函数>管道、函数</a></li><li><a href=#流程控制>流程控制</a></li><li><a href=#命名模板>命名模板</a></li><li><a href=#使用helm安装jenkins>使用<code>Helm</code>安装<code>Jenkins</code></a></li><li><a href=#使用helm安装redis>使用<code>Helm</code>安装<code>Redis</code></a></li><li><a href=#使用helm安装prometheus>使用<code>Helm</code>安装<code>Prometheus</code></a></li><li><a href=#使用helm安装elk>使用<code>Helm</code>安装<code>ELK</code></a></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=二哥 src=/imgs/img-lazy-loading.gif data-src=/imgs/s2-1.jpg><p class=site-author-name itemprop=name>二哥</p><div class=site-description itemprop=description>The man who has made up his mind to win will never say impossible – Napoleon Bonaparte</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>0</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>51</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>149</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=qq%e5%8f%b7 title="QQ → qq号" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-qq fa-fw hvr-icon"></i>
QQ
</a></span><span class=links-of-social-item><a href=https://www.zhihu.com/people/lisenhui title="知乎 → https://www.zhihu.com/people/lisenhui" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎
</a></span><span class=links-of-social-item><a href=qq@qq.com title="E-Mail → qq@qq.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>
E-Mail
</a></span><span class=links-of-social-item><a href=https://weibo.com/yourname title="Weibo → https://weibo.com/yourname" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-weibo fa-fw hvr-icon"></i>
Weibo
</a></span><span class=links-of-social-item><a href="https://www.youtube.com/watch?v=RgKAFK5djSk" title="Youtube → https://www.youtube.com/watch?v=RgKAFK5djSk" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-youtube fa-fw hvr-icon"></i>
Youtube
</a></span><span class=links-of-social-item><a href=https://github.com/elkan1788 title="Github → https://github.com/elkan1788" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li><li class=links-of-blogroll-item><a href=https://lisenhui.cn title=https://lisenhui.cn target=_blank>凡梦星尘空间站</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=goto-gtranslate class=button title=多语言翻译><i class="fas fa-globe"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/hugo-next rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg>
</a><script type=text/javascript src=//sidecar.gitter.im/dist/sidecar.v1.js async></script><script type=text/javascript>((window.gitter={}).chat={}).options={room:"hugo-next/community"}</script><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://erge.blog/system/linux/kubernetes/configure-k8s-helm/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/s2-1.jpg"><meta itemprop=name content="二哥"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="二哥"><meta itemprop=description content="The man who has made up his mind to win will never say impossible – Napoleon Bonaparte"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="Configure K8s Helm"><meta itemprop=description content="Configure-K8s-Helm"></span><header class=post-header><h1 class=post-title itemprop="name headline">Configure K8s Helm
<a href=https://github.com/user-name/repo-name/tree/branch-name/subdirectory-name/System/Linux/Kubernetes/Configure-K8s-Helm.md rel="noopener external nofollow noreferrer" target=_blank class="exturl post-edit-link" title=编辑><i class="fa fa-pen-nib"></i></a></h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2022-05-29 19:31:37 +0800 CST" itemprop="dateCreated datePublished" datetime="2022-05-29 19:31:37 +0800 CST">2022-05-29
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar-check"></i>
</span><span class=post-meta-item-text title=更新于>更新于：
</span><time title=修改时间：2022-11-14T19:31:37+08:00 itemprop=dateModified datetime=2022-11-14T19:31:37+08:00>2022-11-14</time>
</span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/kubernetes itemprop=url rel=index><span itemprop=name>Kubernetes</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="far fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>7023</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="far fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>15分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="far fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=busuanzi_value_page_pv data-path=/system/linux/kubernetes/configure-k8s-helm/><i class="fa fa-sync fa-spin"></i>
</span></span><span class=post-meta-item title><span class=post-meta-item-icon><i class="far fa-comments"></i>
</span><span class=post-meta-item-text title=评论>评论：
</span><span id=comments-count class=waline-comment-count data-path=/system/linux/kubernetes/configure-k8s-helm/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><h1 id=使用helm配置管理k8s>使用<code>Helm</code>配置管理<code>K8s</code>
<a class=header-anchor href=#%e4%bd%bf%e7%94%a8helm%e9%85%8d%e7%bd%ae%e7%ae%a1%e7%90%86k8s></a></h1><div class="note info"><blockquote><table><thead><tr><th>名称地址</th><th>描述</th></tr></thead><tbody><tr><td><a href=https://github.com/bitnami/ title="<code>Bitnami</code>模板库" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>Bitnami</code>模板库
<i class="fa fa-external-link-alt"></i></a></td><td></td></tr><tr><td><a href=https://github.com/bitnami/charts/tree/main/bitnami title="<code>Kubernetes</code>的<code>Bitnami</code>库" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>Kubernetes</code>的<code>Bitnami</code>库
<i class="fa fa-external-link-alt"></i></a></td><td><code>Helm</code>安装<code>Kubernetes</code>服务<code>Zabbix</code>、<code>Redis</code>、<code>Mysql</code>模板</td></tr><tr><td><a href=https://github.com/bitnami/charts-docs/tree/main/charts title="<code>Kubernetes</code>的<code>Charts-docs</code>库" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>Kubernetes</code>的<code>Charts-docs</code>库
<i class="fa fa-external-link-alt"></i></a></td><td><code>Helm</code>安装<code>Kubernetes</code>服务<code>Zabbix</code>、<code>Redis</code>、<code>Mysql</code>模板</td></tr><tr><td><a href=https://artifacthub.io/ title="查找、安装和发布<code>Kubernetes</code>包" rel="noopener external nofollow noreferrer" target=_blank class=exturl>查找、安装和发布<code>Kubernetes</code>包
<i class="fa fa-external-link-alt"></i></a></td><td><code>Helm</code>安装<code>Kubernetes</code>服务<code>Zabbix</code>、<code>Redis</code>、<code>Mysql</code>模板</td></tr><tr><td></td><td></td></tr></tbody></table></blockquote><ul><li><ol><li><code>kubernetes</code>上的应用对象，都是由特定的资源描述组成，包括<code>Deployment</code>、<code>Service</code>等，都保存在各自文件中或者集中写在一个配置文件，然后通过<code>kubectl apply -f </code>部署。如果应用只由一个或几个这样的服务组成，上面的部署方式就足够了。但是对于一个复杂的应用，会有很多类似上面的资源描述文件，例如微服务架构应用，组成应用的服务可能多达几十、上百个，如果有更新或回滚应用的需求，可能要修改和维护所涉及到大量的资源文件，而这种组织和管理应用的方式就显得力不从心了。并且由于缺少对发布过的应用进行版本管理和控制，使得<code>kubernetes</code>上的应用维护和更新面临诸多的挑战，主要面临以下的问题：</li></ol></li></ul><blockquote><ul><li>如何将这些服务作为一个整体管理？</li><li>这些资源文件如何高效复用？</li><li>应用级别的版本如何管理？</li></ul></blockquote><ul><li><ol start=2><li><code>Helm</code><font color=red>是一个</font><code>kubernetes</code><font color=red>的包管理工具，就像</font><code>Linux</code><font color=red>下的包管理器，如</font><code>yum</code>、<code>apt</code><font color=red>等，可以很方便的将之前打包好的</font><code>yaml</code><font color=red>文件部署到</font><code>kubernetes</code>上</li></ol></li><li><ol start=3><li><code>Helm</code><font color=red>有3个重要概念</font></li></ol></li></ul><blockquote><ul><li><code>helm</code><font color=red>：一个命令行客户端工具，主要用于</font><code>kubernetes</code>应用<code>chart</code>的创建、打包、发布和管理</li><li><code>chart</code><font color=red>：应用描述，一系列用于描述</font><code>kubernetes</code>资源相关文件的集合，类似<code>Ansible</code>的<code>Playbook</code>剧本</li><li><code>release</code><font color=red>：基于</font><code>chart</code><font color=red>的部署实体，一个</font><code>chart</code>被<code>Helm</code>运行后将会生成对应的一个<code>release</code>，将在<code>kubernetes</code>中创建出真实运行的资源对象</li></ul></blockquote><ul><li><ol start=4><li><code>Helm v3</code><font color=red>变化</font></li></ol></li></ul><blockquote><ul><li>最明显变化删除<code>Tiller</code>组件</li><li><code>release</code>名称可以在不同的命名空间重用。</li><li>支持将<code>chart</code>推动到<code>Docker</code>镜像仓库中</li><li>使用<code>JSONSchema</code>验证<code>chart values</code></li></ul></blockquote></div><h2 id=helm常用命令><code>Helm</code>常用命令
<a class=header-anchor href=#helm%e5%b8%b8%e7%94%a8%e5%91%bd%e4%bb%a4></a></h2><div class="note info"><blockquote><table><thead><tr><th>命令</th><th>描述</th></tr></thead><tbody><tr><td><code>get</code></td><td>下载一个<code>release</code>。可用的子命令：<code>all</code>、<code>hooks</code>、<code>manifest</code>、<code>note</code>、<code>values</code></td></tr><tr><td><code>repo</code></td><td>添加、列出、移除、更新和索引<code>chart</code>仓库。可用的子命令：<code>add</code>、<code>index</code>、<code>list</code>、<code>remove</code>、<code>update</code></td></tr><tr><td><code>list</code></td><td>列出<code>release</code></td></tr><tr><td><code>pull</code></td><td>从远程仓库中下载<code>chart</code>并解压到本地。比如：<code>helm install stable/mysql --untar</code></td></tr><tr><td><code>show</code></td><td>查看<code>chart</code>的详细信息。可用的子命令：<code>all</code>、<code>chart</code>、<code>readme</code>、<code>values</code></td></tr><tr><td><code>search</code></td><td>根据关键字搜索<code>chart</code>。可用的子命令：<code>all</code>、<code>chart</code>、<code>readme</code>、<code>values</code></td></tr><tr><td><code>create</code></td><td>创建一个<code>chart</code>并指定名字</td></tr><tr><td><code>install</code></td><td>安装一个<code>chart</code></td></tr><tr><td><code>status</code></td><td>显示已命名版本的状态</td></tr><tr><td><code>upgrade</code></td><td>更新升级一个<code>release</code></td></tr><tr><td><code>history</code></td><td>获取<code>release</code>历史</td></tr><tr><td><code>package</code></td><td>将<code>chart</code>目录打包到<code>chart</code>存档文件中</td></tr><tr><td><code>template</code></td><td>本地呈现模板</td></tr><tr><td><code>rollback</code></td><td>从之前的版本回退</td></tr><tr><td><code>uninstall</code></td><td>卸载一个<code>release</code></td></tr><tr><td><code>dependency</code></td><td>管理<code>chart</code>依赖</td></tr><tr><td><code>version</code></td><td>查看<code>Helm</code>客户端版本</td></tr></tbody></table></blockquote></div><h2 id=font-colorred安装fonthelm><font color=red>安装</font><code>Helm</code>
<a class=header-anchor href=#font-colorred%e5%ae%89%e8%a3%85fonthelm></a></h2><div class="note info"><blockquote><ul><li><font color=red>使用二进制安装</font><code>Helm</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ wget https://get.helm.sh/helm-v3.9.0-linux-amd64.tar.gz  
</span></span><span style=display:flex><span>$ tar -zxvf helm-v3.9.0-linux-amd64.tar.gz
</span></span><span style=display:flex><span>$ mv linux-amd64/helm /usr/local/bin/helm
</span></span></code></pre></div><ul><li><font color=red>脚本安装</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3
</span></span><span style=display:flex><span>$ chmod <span style=color:#ae81ff>700</span> get_helm.sh
</span></span><span style=display:flex><span>$ ./get_helm.sh
</span></span></code></pre></div><ul><li><font color=red>源代码安装</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ git clone https://github.com/helm/helm.git
</span></span><span style=display:flex><span>$ cd helm
</span></span><span style=display:flex><span>$ make
</span></span></code></pre></div></blockquote></div><h2 id=配置chart仓库>配置<code>chart</code>仓库
<a class=header-anchor href=#%e9%85%8d%e7%bd%aechart%e4%bb%93%e5%ba%93></a></h2><div class="note info"><blockquote><ul><li><code>Helm</code><font color=red>添加仓库方式</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm repo add 仓库名 仓库地址
</span></span></code></pre></div><ul><li><font color=red>使用官方仓库</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm repo add helm https://hub.kubeapps.com/charts/incubator
</span></span></code></pre></div><ul><li><font color=red>添加其它仓库</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># Bitnami</span>
</span></span><span style=display:flex><span>$ helm repo add bitnami https://charts.bitnami.com/bitnami
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用微软仓库</span>
</span></span><span style=display:flex><span>$ helm repo add microsoft http://mirror.azure.cn/kubernetes/charts
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 国内添加阿里云、微软仓库</span>
</span></span><span style=display:flex><span>$ helm repo add aliyun https://kubernetes.oss-cn-hangzhou.aliyuncs.com/charts
</span></span></code></pre></div><ul><li><font color=red>更新仓库命令</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm repo update
</span></span></code></pre></div><ul><li><font color=red>删除存储库</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm repo remove 仓库名
</span></span></code></pre></div><ul><li><font color=red>获取配置的存储库</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm repo list
</span></span></code></pre></div></blockquote></div><h2 id=helm基本使用><code>Helm</code>基本使用
<a class=header-anchor href=#helm%e5%9f%ba%e6%9c%ac%e4%bd%bf%e7%94%a8></a></h2><div class="note info"><blockquote><ul><li><font color=red>根据关键字搜索</font><code>chart</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm search repo | hub chart名称
</span></span><span style=display:flex><span>$ helm search repo redis    <span style=color:#75715e># 示例</span>
</span></span><span style=display:flex><span>  DEPRECATED  	<span style=color:#75715e># 表示已过期</span>
</span></span></code></pre></div><ul><li><font color=red>查看</font><code>chart</code><font color=red>信息</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm show chart 仓库名/chart名称
</span></span><span style=display:flex><span>$ helm show chart bitnami/redis
</span></span></code></pre></div><ul><li><code>readme</code><font color=red>查看安装文档说明</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm show readme bitnami/redis
</span></span></code></pre></div></blockquote></div><h3 id=font-colorred安装fontchartfont-colorred形成fontrelease><font color=red>安装</font><code>chart</code><font color=red>，形成</font><code>release</code>
<a class=header-anchor href=#font-colorred%e5%ae%89%e8%a3%85fontchartfont-colorred%e5%bd%a2%e6%88%90fontrelease></a></h3><div class="note info"><ul><li><ol><li>自定义选项是因为并不是所有的<code>chart</code>都能按照默认配置运行成功，可能会需要一些环境依赖，例如<code>PV</code>。</li></ol></li><li><ol start=2><li>所以需要自定义<code>chart</code>配置选项，安装过程中有两种方法可以传递配置数据：</li></ol></li></ul><blockquote><ul><li><code>--values</code><font color=red>：的使用(麻烦、不推荐)</font></li><li><code>--set</code><font color=red>：在命令行上指定替代。如果两种都用，那么</font><code>--set</code>的优先级高</li><li><code>--values 或 -f</code><font color=red>：指定带有覆盖的</font><code>YAML</code>文件。这里可以多次指定，最右边的文件优先</li></ul></blockquote><ul><li><ol start=3><li><font color=red>安装可能报错，需要自己手动安装</font><code>PV</code></li></ol></li></ul><blockquote><ul><li><font color=red>先将修改的变量写到一个文件中，并修改此文件</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm show values stable/mysql &gt; config.yaml
</span></span></code></pre></div><ul><li><font color=red>修改</font><code>config.yaml</code><font color=red>文件</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span>-- <span style=color:#ae81ff>修改部分</span>
</span></span><span style=display:flex><span><span style=color:#f92672>persistence</span>:
</span></span><span style=display:flex><span><span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span><span style=color:#f92672>accessMode</span>: <span style=color:#ae81ff>ReadWriteOnce</span>
</span></span><span style=display:flex><span><span style=color:#f92672>size</span>: <span style=color:#ae81ff>8Gi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>mysqlUser</span>: <span style=color:#e6db74>&#34;k8s&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>mysqlPassword</span>: <span style=color:#e6db74>&#34;123456&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>mysqlDatabase</span>: <span style=color:#e6db74>&#34;k8s&#34;</span>
</span></span></code></pre></div><ul><li><font color=red>使用</font><code>-f</code><font color=red>来替换默认的配置</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm install -f config.yaml self-mysql stable/mysql
</span></span></code></pre></div></blockquote><ul><li><ol start=4><li><font color=red>推荐使用命令行替代变量</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm install db --set persistence.storageClass<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;managed-nfs-storage&#34;</span> stable/mysql
</span></span></code></pre></div></blockquote><ul><li><ol start=5><li><font color=red>安装</font><code>chart</code></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm install 安装之后的名称 仓库名/chart的名称<span style=color:#f92672>(</span>即搜索之后的应用名称<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>$ helm install k8s_ui stable/weave-scope  	<span style=color:#75715e># 安装 stable/weave-scope，并将其命名为 k8s_ui</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看当前的 release 列表</span>
</span></span><span style=display:flex><span>$ helm list
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看已命名 release 的状态</span>
</span></span><span style=display:flex><span>$ helm status k8s_ui 安装之后的名称
</span></span></code></pre></div></blockquote><ul><li><ol start=6><li><font color=red>使用</font><code>Helm</code><font color=red>构建一个</font><code>Chart</code></li></ol></li></ul><blockquote><ul><li><font color=red>使用</font><code>helm create</code><font color=red>创建</font><code>chart</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm create mychart  <span style=color:#75715e># chart名称</span>
</span></span></code></pre></div><ul><li><font color=red>进入自定义</font><code>chart</code><font color=red>目录的</font><code>templates</code><font color=red>目录中，修改其中的</font><code>deployment.yaml</code>和<code>service.yaml</code><font color=red>等文件</font></li></ul><blockquote><ul><li><code>charts</code><font color=red>：该目录保存其他依赖的</font><code>chart(子chart)</code></li><li><code>Chart.yaml</code><font color=red>：定义当前</font><code>Chart</code><font color=red>属性信息</font></li><li><code>templates</code><font color=red>：<code>chart</code>配置模板，目录存放所有</font><code>yaml</code><font color=red>文件</font></li></ul><blockquote><ul><li><code>Deployment.yaml</code><font color=red>：</font></li><li><code>_helpers.tpl</code><font color=red>：</font></li><li><code>hpa.yaml</code><font color=red>：</font></li><li><code>ingress.yaml</code><font color=red>：</font></li><li><code>NOTES.txt</code><font color=red>：用于介绍<code>Chart</code>的帮助信息，<code>Helm install</code>部署后展示给用户</font></li><li><code>serviceaccount.yaml</code><font color=red>：</font></li><li><code>service.yaml</code><font color=red>：</font></li><li><code>tests</code><font color=red>：</font></li></ul><blockquote><ul><li><code>tests-connection.yaml</code><font color=red>：</font></li></ul></blockquote></blockquote><ul><li><code>values.yaml</code><font color=red>：定义所有</font><code>yaml</code><font color=red>全局变量</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ cd chart名称/templates
</span></span></code></pre></div><p><img src=/imgs/img-lazy-loading.gif data-src=https://raw.githubusercontent.com/usermice/images/master/Kubernetes_server/Helm/Chart%e4%b8%ad%e7%9a%84%e4%bf%a1%e6%81%af.png alt=Chart中的信息></p></blockquote><ul><li><font color=red>通过刚才创建的</font><code>chart</code><font color=red>目录，将其部署</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm install web mychart  <span style=color:#75715e># web:自定义名称，chart名称</span>
</span></span></code></pre></div><ul><li><font color=red>打包</font><code>chart</code><font color=red>，让别人共享</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm package mychart  <span style=color:#75715e># chart名称</span>
</span></span></code></pre></div></blockquote></div><h3 id=font-colorred查看fontservicefont-colorred并将其改为fontnodeport><font color=red>查看</font><code>Service</code><font color=red>，并将其改为</font><code>NodePort</code>
<a class=header-anchor href=#font-colorred%e6%9f%a5%e7%9c%8bfontservicefont-colorred%e5%b9%b6%e5%b0%86%e5%85%b6%e6%94%b9%e4%b8%bafontnodeport></a></h3><div class="note info"><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ kubectl edit svc xxx
</span></span><span style=display:flex><span>$ kubectl edit svc ui-weave-scope
</span></span></code></pre></div></blockquote></div><h3 id=font-colorred应用示例font><font color=red>应用示例</font>
<a class=header-anchor href=#font-colorred%e5%ba%94%e7%94%a8%e7%a4%ba%e4%be%8bfont></a></h3><div class="note info"><ul><li><ol><li><code>root</code><font color=red>目录下操作的</font></li></ol></li><li><ol start=2><li>创建<code>chart</code></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm create nginx
</span></span></code></pre></div></blockquote><ul><li><ol start=3><li><font color=red>进入</font><code>chart</code><font color=red>目录，修改</font><code>values.yaml</code><font color=red>文件，内容如下</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ sudo cat &gt;&gt;nginx/values.yaml<span style=color:#e6db74>&lt;&lt;-EOF
</span></span></span><span style=display:flex><span><span style=color:#e6db74>replicas: 3
</span></span></span><span style=display:flex><span><span style=color:#e6db74>image: nginx 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>tag: 1.17 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>serviceport: 80 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>targetport: 80 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>label: nginx
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span></code></pre></div></blockquote><ul><li><ol start=4><li><font color=red>删除</font><code>templates</code><font color=red>目录中的文件和文件夹</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ rm -rf emplates/*
</span></span></code></pre></div></blockquote><ul><li><ol start=5><li><font color=red>修改</font><code>deployment.yaml</code><font color=red>文件，内容如下</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ sudo cat &gt;&gt;deployment.yaml<span style=color:#e6db74>&lt;&lt;-EOF
</span></span></span><span style=display:flex><span><span style=color:#e6db74>apiVersion: apps/v1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>kind: Deployment
</span></span></span><span style=display:flex><span><span style=color:#e6db74>metadata:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    labels:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        app: {{ .Values.label }} 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    name: {{ .Release.Name }}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>spec:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    replicas: {{ .Values.replicas }} 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    selector:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        matchLabels:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            app: {{ .Values.label }} 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    strategy: {}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    template:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        metadata:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            labels:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                app: {{ .Values.label }} 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    spec:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        containers:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        - image: {{ .Values.image }}:{{ .Values.tag }} 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          name: {{ .Values.image }}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span></code></pre></div></blockquote><ul><li><ol start=6><li><font color=red>修改</font><code>service.yaml</code><font color=red>文件，内容如下：</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ sudo cat &gt;&gt;service.yaml<span style=color:#e6db74>&lt;&lt;-EOF
</span></span></span><span style=display:flex><span><span style=color:#e6db74>apiVersion:   v1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>kind: Service
</span></span></span><span style=display:flex><span><span style=color:#e6db74>metadata:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    labels:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        app: {{ .Values.label }} 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    name:  {{ .Release.Name }}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>spec: 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    ports:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        -  port: {{ .Values.serviceport }} 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>           protocol: TCP
</span></span></span><span style=display:flex><span><span style=color:#e6db74>           targetPort: {{ .Values.targetport }} 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    selector:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        app: {{ .Values.label }} 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    type: NodePort
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span></code></pre></div></blockquote><ul><li><ol start=7><li><font color=red>切换到</font><code>chart</code><font color=red>目录的上一层目录、并且安装</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ cd ~
</span></span><span style=display:flex><span>$ helm install nginx nginx/
</span></span></code></pre></div></blockquote></div><h3 id=font-colorred调试font><font color=red>调试</font>
<a class=header-anchor href=#font-colorred%e8%b0%83%e8%af%95font></a></h3><div class="note info"><ul><li><ol><li><code>Helm</code>也提供了<code>--dry-run</code>和<code>--debug</code>调试参数，帮助你验证模板的正确性。在执行<code>helm install</code>的时候带上这两个参数就可以把对应的<code>values</code>值和渲染的资源清单打印出来，而不是真正的做部署一个<code>release</code></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm install nginx nginx/ --dry-run --debug
</span></span></code></pre></div></blockquote><ul><li><ol start=2><li><font color=red>一些常用的内置对象：</font></li></ol></li></ul><blockquote><table><thead><tr><th>内置对象</th><th>描述</th></tr></thead><tbody><tr><td><code>Release.Name</code></td><td><code>release</code>的名称</td></tr><tr><td><code>Release.Namespace</code></td><td><code>release</code>的命名空间</td></tr><tr><td><code>Release.Service</code></td><td><code>release</code>的服务的名称</td></tr><tr><td><code>Release.Revision</code></td><td><code>release</code>的修订版本号，从1开始累加</td></tr></tbody></table></blockquote></div><h3 id=font-colorredvaluesfont><font color=red><code>Values</code></font>
<a class=header-anchor href=#font-colorredvaluesfont></a></h3><div class="note info"><ul><li><ol><li><code>Values</code>对象是为<code>Chart</code>模板提供值，这个对象的值有<code>4</code>个来源：</li></ol></li></ul><blockquote><ul><li><code>chart</code>包中的<code>values.yaml</code>文件</li><li>父<code>chart</code>包的<code>values.yaml</code>文件</li><li>通过<code>helm install</code>或者<code>helm upgrade</code>的<code>-f</code>或者<code>--values</code>参数传入的自定义的<code>yaml</code>文件</li><li>通过<code>--set</code>参数传入的值</li></ul></blockquote><ul><li><ol start=2><li><code>Chart</code>的<code>values.yaml</code>提供的值可以被用户提供的<code>values</code>文件覆盖，而该文件同样可以被<code>--set</code>参数所覆盖，换言之，<code>--set</code>参数的优先级高</li></ol></li></ul></div><h2 id=升级回滚和卸载发行版本>升级、回滚和卸载发行版本
<a class=header-anchor href=#%e5%8d%87%e7%ba%a7%e5%9b%9e%e6%bb%9a%e5%92%8c%e5%8d%b8%e8%bd%bd%e5%8f%91%e8%a1%8c%e7%89%88%e6%9c%ac></a></h2><div class="note info"><ul><li><ol><li><font color=red>升级</font>发布新版本的<code>chart</code>时，或者当我们需要更改发布的配置，可以使用<code>helm upgrade</code>命令</li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm upgrade --set imageTag<span style=color:#f92672>=</span>1.18 nginx nginx
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ helm upgrade web mychart  <span style=color:#75715e># web:自定义名称，chart名称</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ helm upgrade -f values.yaml nginx nginx
</span></span></code></pre></div></blockquote><ul><li><ol start=2><li><font color=red>回滚</font>如果在发布后没有达到预期的效果，则可以使用<code>helm rollback</code>回滚到之前的版本</li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm history redis -n default  	<span style=color:#75715e># 查看历史版本</span>
</span></span><span style=display:flex><span>$ helm rollback nginx <span style=color:#ae81ff>1</span>
</span></span></code></pre></div></blockquote><ul><li><ol start=3><li><font color=red>卸载</font>可以使用<code>helm uninstall</code>命令</li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm uninstall nginx
</span></span></code></pre></div></blockquote><ul><li><ol start=3><li><font color=red>查看历史版本配置信息</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm get all --revision <span style=color:#ae81ff>1</span> nginx
</span></span></code></pre></div></blockquote></div><h2 id=管道函数>管道、函数
<a class=header-anchor href=#%e7%ae%a1%e9%81%93%e5%87%bd%e6%95%b0></a></h2><div class="note info"><ul><li><ol><li><font color=red>管道</font></li></ol></li></ul><blockquote><ul><li><code>quote</code> <code>.Values.label.app</code><font color=red>将后面的值作为参数传递过</font><code>quote</code><font color=red>函数</font></li><li><font color=red>模板函数调用语法为：</font><code>functionName arg1 arg2...</code></li><li>在上面的案例中，其实是将值传递给模板引擎进行渲染，模板引擎还支持对拿到的数据进行二次处理，示例：从<code>.Values</code>中读取的值变成字符串，可以使用<code>quote</code>函数实现</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ cat templates/deployment.yaml
</span></span><span style=display:flex><span><span style=color:#75715e># 略...</span>
</span></span><span style=display:flex><span>app: <span style=color:#f92672>{{</span> quote  .Values.label.app    <span style=color:#f92672>}}</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 略...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ helm install --dry-run nginx ../nginx/ app:<span style=color:#e6db74>&#34;nginx&#34;</span>
</span></span></code></pre></div></blockquote><ul><li><ol start=2><li><font color=red>函数</font></li></ol></li></ul><blockquote><ul><li><code>default</code><font color=red>函数运行在模板中指定默认值，以防止该值会忽略掉。如果忘记定义，执行</font><code>helm install</code><font color=red>的时候会因为缺少字段而无法创建资源，这时就可以定义一个默认值了，示例：</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ sudo cat &gt;&gt;templates/deployment.yaml<span style=color:#e6db74>&lt;&lt;-EOF
</span></span></span><span style=display:flex><span><span style=color:#e6db74>apiVersion: apps/v1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>kind: Deployment
</span></span></span><span style=display:flex><span><span style=color:#e6db74>metadata:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    labels:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        app: {{ .Values.label }}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    name: {{ .Release.Name }}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>spec:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    replicas: {{ .Values.replicas }}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    selector:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        matchLabels:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            app: {{ .Values.label }}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    strategy: {}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    template:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        metadata:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            labels:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                app: {{ .Values.label }}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        spec:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            containers:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            - image: {{ .Values.image| default &#34;nginx&#34; }}:{{ .Values.tag }}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              name: {{ .Values.image }}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span></code></pre></div><ul><li><font color=red>缩进函数：</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span>{{ <span style=color:#ae81ff>.Values.resources | indent 12 }}</span>
</span></span></code></pre></div><ul><li><font color=red>大写函数</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span>{{ <span style=color:#ae81ff>upper .Values.resources }}</span>
</span></span></code></pre></div><ul><li><font color=red>首字母大写函数</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span>{{ <span style=color:#ae81ff>title .Values.resources }}</span>
</span></span></code></pre></div></blockquote></div><h2 id=流程控制>流程控制
<a class=header-anchor href=#%e6%b5%81%e7%a8%8b%e6%8e%a7%e5%88%b6></a></h2><div class="note info"><ul><li><ol><li>流程控制是为模板提供了一种能力，满足更复杂的数据逻辑处理</li></ol></li><li><ol start=2><li><code>Helm</code>模板语言提供以下流程控制语句：</li></ol></li></ul><blockquote><ul><li><code>if/else</code><font color=red>条件块</font></li><li><code>with</code><font color=red>指定范围</font></li><li><code>range</code><font color=red>循环块</font></li></ul></blockquote><ul><li><ol start=3><li><code>if/else</code><font color=red>：块是用于在模板有条件的包含文本块的方法</font></li></ol></li></ul><blockquote><ul><li><font color=red>条件判断：</font>就是判断条件是否为真，如果值为以下几种情况则为<code>false</code>，否则为<code>true</code>：</li></ul><blockquote><ul><li><font color=red>一个布尔类型的</font><code>false</code></li><li><font color=red>一个数字</font><code>0</code></li><li><font color=red>一个空的字符串</font></li><li>一个空的集合(<code>map</code>、<code>slice</code>、<code>tuple</code>、<code>dict</code>、<code>array</code>)</li></ul></blockquote><ul><li>还可以使用<code>ne</code>、<code>lt</code>、<code>gt</code>、<code>and</code>、<code>or</code>等运算符</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span>{{ <span style=color:#ae81ff>if 条件表达式 }}</span>
</span></span><span style=display:flex><span><span style=color:#75715e># xxx</span>
</span></span><span style=display:flex><span>{{ <span style=color:#ae81ff>else if 条件表达式 }}</span>
</span></span><span style=display:flex><span><span style=color:#75715e># xxx</span>
</span></span><span style=display:flex><span>{{ <span style=color:#ae81ff>else }}</span>
</span></span><span style=display:flex><span><span style=color:#75715e># xxx</span>
</span></span><span style=display:flex><span>{{ <span style=color:#ae81ff>end }}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 示例</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>app</span>: {{ <span style=color:#ae81ff>.Values.label }}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: {{ <span style=color:#ae81ff>.Release.Name }}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>replicas</span>: {{ <span style=color:#ae81ff>.Values.replicas }}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>app</span>: {{ <span style=color:#ae81ff>.Values.label }}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>strategy</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>template</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>app</span>: {{ <span style=color:#ae81ff>.Values.label }}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>image</span>: {{ <span style=color:#ae81ff>.Values.image| default &#34;nginx&#34; }}:{{ .Values.tag }}</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>name</span>: {{ <span style=color:#ae81ff>.Values.image }}</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>                  {{ <span style=color:#ae81ff>if eq .Values.devops &#34;k8s&#34; }}</span>
</span></span><span style=display:flex><span>              - <span style=color:#f92672>name </span>: <span style=color:#ae81ff>hello</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;123&#34;</span>
</span></span><span style=display:flex><span>                {{ <span style=color:#ae81ff>else }}</span>
</span></span><span style=display:flex><span>              - <span style=color:#f92672>name </span>: <span style=color:#ae81ff>hello</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;456&#34;</span>
</span></span><span style=display:flex><span>                {{ <span style=color:#ae81ff>end }}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 模板引擎渲染一下，会得到如下的结果：</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>$ helm install --dry-run nginx nginx</span>
</span></span></code></pre></div><ul><li>可以看到渲染出来会有多余的空行，这是因为当模板引擎运行的时候，会将控制指令删除，所以之前占的位置也就空白了，需要使用<code>{{- if ...}}</code>的方式消除此空行</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>app</span>: {{ <span style=color:#ae81ff>.Values.label }}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: {{ <span style=color:#ae81ff>.Release.Name }}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>replicas</span>: {{ <span style=color:#ae81ff>.Values.replicas }}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>app</span>: {{ <span style=color:#ae81ff>.Values.label }}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>strategy</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>template</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>app</span>: {{ <span style=color:#ae81ff>.Values.label }}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>                - <span style=color:#f92672>image</span>: {{ <span style=color:#ae81ff>.Values.image| default &#34;nginx&#34; }}:{{ .Values.tag }}</span>
</span></span><span style=display:flex><span>                  <span style=color:#f92672>name</span>: {{ <span style=color:#ae81ff>.Values.image }}</span>
</span></span><span style=display:flex><span>                  <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>                      {{- <span style=color:#ae81ff>if eq .Values.devops &#34;k8s&#34; }}</span>
</span></span><span style=display:flex><span>                - <span style=color:#f92672>name </span>: <span style=color:#ae81ff>hello</span>
</span></span><span style=display:flex><span>                  <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;123&#34;</span>
</span></span><span style=display:flex><span>                  {{- <span style=color:#ae81ff>else }}</span>
</span></span><span style=display:flex><span>                - <span style=color:#f92672>name </span>: <span style=color:#ae81ff>hello</span>
</span></span><span style=display:flex><span>                  <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;456&#34;</span>
</span></span><span style=display:flex><span>                  {{- <span style=color:#ae81ff>end }}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 通过模板引擎渲染，会得到如下的结果</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>$ helm install --dry-run nginx nginx</span>
</span></span></code></pre></div><ul><li>如果使用<code>{{- if ... -}}</code>那么就需要谨慎，比如：</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>app</span>: {{ <span style=color:#ae81ff>.Values.label }}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: {{ <span style=color:#ae81ff>.Release.Name }}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>replicas</span>: {{ <span style=color:#ae81ff>.Values.replicas }}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>app</span>: {{ <span style=color:#ae81ff>.Values.label }}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>strategy</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>template</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>app</span>: {{ <span style=color:#ae81ff>.Values.label }}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>                - <span style=color:#f92672>image</span>: {{ <span style=color:#ae81ff>.Values.image| default &#34;nginx&#34; }}:{{ .Values.tag }}</span>
</span></span><span style=display:flex><span>                  <span style=color:#f92672>name</span>: {{ <span style=color:#ae81ff>.Values.image }}</span>
</span></span><span style=display:flex><span>                  <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>                      {{- <span style=color:#ae81ff>if eq .Values.devops &#34;k8s&#34; -}}</span>
</span></span><span style=display:flex><span>                  - <span style=color:#f92672>name </span>: <span style=color:#ae81ff>hello</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;123&#34;</span>
</span></span><span style=display:flex><span>                    {{- <span style=color:#ae81ff>else }}</span>
</span></span><span style=display:flex><span>                  - <span style=color:#f92672>name </span>: <span style=color:#ae81ff>hello</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;456&#34;</span>
</span></span><span style=display:flex><span>                    {{- <span style=color:#ae81ff>end }}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 通过模板引擎渲染，会得到如下的结果：</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>$ helm install --dry-run nginx nginx</span>
</span></span></code></pre></div><ul><li>相当于下面这种格式</li></ul><blockquote><ul><li>当然不对，因为<code>{{- if ... -}}</code>删除了双方的换行符</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>NAME</span>: <span style=color:#ae81ff>nginx</span>
</span></span><span style=display:flex><span><span style=color:#f92672>LAST DEPLOYED</span>: <span style=color:#ae81ff>Mon Jan 11 20:46:10 2021</span>
</span></span><span style=display:flex><span><span style=color:#f92672>NAMESPACE</span>: <span style=color:#ae81ff>default</span>
</span></span><span style=display:flex><span><span style=color:#f92672>STATUS</span>: <span style=color:#ae81ff>pending-install</span>
</span></span><span style=display:flex><span><span style=color:#f92672>REVISION</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>TEST SUITE</span>: <span style=color:#ae81ff>None</span>
</span></span><span style=display:flex><span><span style=color:#f92672>HOOKS</span>:
</span></span><span style=display:flex><span><span style=color:#f92672>MANIFEST</span>:
</span></span><span style=display:flex><span>---  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Source: nginx/templates/service.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>:   <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Service</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>app</span>: <span style=color:#ae81ff>nginx </span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>:  <span style=color:#ae81ff>nginx</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>: 
</span></span><span style=display:flex><span>    <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>        -  <span style=color:#f92672>port</span>: <span style=color:#ae81ff>80</span> 
</span></span><span style=display:flex><span>           <span style=color:#f92672>protocol</span>: <span style=color:#ae81ff>TCP</span>
</span></span><span style=display:flex><span>           <span style=color:#f92672>targetPort</span>: <span style=color:#ae81ff>80</span> 
</span></span><span style=display:flex><span>    <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>app</span>: <span style=color:#ae81ff>nginx </span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>NodePort</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#75715e># Source: nginx/templates/deployment.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>app</span>: <span style=color:#ae81ff>nginx</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>nginx</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>app</span>: <span style=color:#ae81ff>nginx</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>strategy</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>template</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>app</span>: <span style=color:#ae81ff>nginx</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>                - <span style=color:#f92672>image</span>: <span style=color:#ae81ff>nginx:1.17</span>
</span></span><span style=display:flex><span>                  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>nginx</span>
</span></span><span style=display:flex><span>                  <span style=color:#f92672>env: - name: hello value</span>: <span style=color:#ae81ff>123</span>
</span></span></code></pre></div></blockquote></blockquote><ul><li><ol start=4><li><code>range</code><font color=red>循环块</font></li></ol></li></ul><blockquote><ul><li>在<code>Helm</code>模板语言中，使用<code>range</code>关键字来进行循环操作</li><li>在<code>values.yaml</code>中添加一个变量列表：</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>test</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>1</span> 
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>2</span> 
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>3</span>
</span></span></code></pre></div><ul><li>4.3 循环打印该列表：</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1 </span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ConfigMap </span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>:    {{   <span style=color:#ae81ff>.Release.Name    }} </span>
</span></span><span style=display:flex><span><span style=color:#f92672>data</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>test</span>:    
</span></span><span style=display:flex><span>        {{- <span style=color:#ae81ff>range . Values.test }}</span>
</span></span><span style=display:flex><span>            {{   <span style=color:#ae81ff>.    }}</span>
</span></span><span style=display:flex><span>        {{-   <span style=color:#ae81ff>end   }}</span>
</span></span></code></pre></div></blockquote><ul><li><ol start=5><li><code>with</code><font color=red>指定范围</font></li></ol></li></ul><blockquote><ul><li><code>with</code><font color=red>可以用来控制变量作用域</font></li><li>前面我们使用<code>{{ .Release.xxx }}</code>或者<code>{{ .Values.xxx }}</code>，其中.就是表示对当前范围的引用，<code>.values</code>就是告诉模板在当前范围中查找Values对象的值</li><li><code>with</code><font color=red>语句就可以用来控制变量的作用域范围，其语法和一个简单的if语句类似：</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span>{{ <span style=color:#ae81ff>with 条件表达式 }}</span>
</span></span><span style=display:flex><span><span style=color:#75715e># xxx</span>
</span></span><span style=display:flex><span>{{ <span style=color:#ae81ff>end }}</span>
</span></span></code></pre></div><ul><li><code>with</code><font color=red>语句可以允许将当前范围的.设置为特定的对象，比如我们前面一直使用的<code>.Values.label</code>，我们可以使用with来将.范围指向</font><code>.Values.label</code>示例：<code>values.yaml</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>nodeSelector</span>: 
</span></span><span style=display:flex><span>    <span style=color:#f92672>team</span>: <span style=color:#ae81ff>a </span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>gpu</span>:   <span style=color:#66d9ef>yes</span>
</span></span></code></pre></div><ul><li><code>deployment.yaml</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>:   <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>:   <span style=color:#ae81ff>Deployment </span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: {{ <span style=color:#ae81ff>.Release.Name }}-deployment </span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>1</span> 
</span></span><span style=display:flex><span>    <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>matchLabels</span>: 
</span></span><span style=display:flex><span>            <span style=color:#f92672>app</span>: <span style=color:#ae81ff>nginx</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>template</span>: 
</span></span><span style=display:flex><span>        <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>labels</span>: 
</span></span><span style=display:flex><span>                <span style=color:#f92672>app</span>: <span style=color:#ae81ff>nginx</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>            {{- <span style=color:#ae81ff>with .Values.nodeSelector }}</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>nodeSelector</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>team</span>: {{  <span style=color:#ae81ff>.team }}</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>gpu</span>: {{  <span style=color:#ae81ff>.gpu  }}</span>
</span></span><span style=display:flex><span>            {{- <span style=color:#ae81ff>end }}</span>
</span></span></code></pre></div></blockquote></div><h2 id=命名模板>命名模板
<a class=header-anchor href=#%e5%91%bd%e5%90%8d%e6%a8%a1%e6%9d%bf></a></h2><div class="note info"><ul><li><ol><li>需要复用代码的地方可以使用命名模板</li></ol></li><li><ol start=2><li><font color=red>命名模板：</font>使用<code>define</code>定义，<code>template</code>引入，在<code>templates</code>目录中默认下划线开头的文件为公共模板,比如：<code>_helpers.tpl</code>。</li></ol></li><li><ol start=3><li>示例：<code> _helpers.tpl</code></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span>{{-   <span style=color:#ae81ff>define   &#34;demo.fullname&#34;   -}}</span>
</span></span><span style=display:flex><span>{{- <span style=color:#ae81ff>.Chart.Name -}}-{{ .Release.Name }}</span>
</span></span><span style=display:flex><span>{{-   <span style=color:#ae81ff>end   -}}</span>
</span></span></code></pre></div></blockquote><ul><li><ol start=4><li><code>deployment.yaml</code></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>:   <span style=color:#ae81ff>apps/v1 </span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>:   <span style=color:#ae81ff>Deployment </span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>:  {{   <span style=color:#ae81ff>template&#34;demo.fullname&#34;   .    }}</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 其他略</span>
</span></span></code></pre></div><ul><li><code>template</code><font color=red>指令是将一个模板包含在另一个模板中的方法。但是，<code>template</code>函数不能用于<code>Go</code>模板管道，为了解决该问题，增加了<code>include</code>功能</font></li><li><code>_helpers.tpl：</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span>{{-   <span style=color:#ae81ff>define   &#34;demo.labels&#34;    -}}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>app</span>:   {{   <span style=color:#ae81ff>template&#34;demo.fullname&#34;   .   }}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>chart</span>:   <span style=color:#e6db74>&#34;{{   .Chart.Name   }}-{{    .Chart.Version   }}&#34;</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>release</span>:   <span style=color:#e6db74>&#34;{{   .Release.Name   }}&#34;</span>
</span></span><span style=display:flex><span>{{-   <span style=color:#ae81ff>end   -}}</span>
</span></span></code></pre></div><ul><li>4.3 <code>deployment.yaml</code></li></ul><blockquote><p>下面包含一个名为<code>demo.labels</code>的模板，然后将值 . 传递给模板，最后将该模板的 输出传递给<code>nindent</code>函数。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>:   <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>:   <span style=color:#ae81ff>Deployment </span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>:    {{   <span style=color:#ae81ff>include&#34;demo.fullname&#34;   .    }} </span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>           {{-   <span style=color:#ae81ff>include   &#34;demo.labels&#34;   .    |   nindent   4    }}</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div></blockquote></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>graph LR
</span></span><span style=display:flex><span>A(创建模板) --&gt;B(修改Chart.yaml &lt;p&gt;Values.yaml文件&lt;br&gt; &lt;p&gt;添加常用变量&lt;br&gt;)
</span></span><span style=display:flex><span>    B --&gt; C(在Templates目录下&lt;p&gt;创建部署镜像所需的yaml文件&lt;br&gt; &lt;p&gt;并且使用变量&lt;br&gt;&lt;p&gt;引用yaml文件里面的常变动字段&lt;br&gt;)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    C --&gt;|a=1| D{暂未启用}
</span></span><span style=display:flex><span>    C --&gt;|a=2| E[暂未启用]
</span></span><span style=display:flex><span>    F[开发自己的chart]
</span></span></code></pre></div></div><h2 id=使用helm安装jenkins>使用<code>Helm</code>安装<code>Jenkins</code>
<a class=header-anchor href=#%e4%bd%bf%e7%94%a8helm%e5%ae%89%e8%a3%85jenkins></a></h2><div class="note info"><ul><li><ol><li><font color=red>获取更新仓库信息</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm repo add jenkins https://charts.jenkins.io
</span></span><span style=display:flex><span>$ helm repo update
</span></span></code></pre></div></blockquote><ul><li><ol start=2><li><font color=red>查看已经添加的</font><code>helm</code><font color=red>仓库</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm repo list
</span></span></code></pre></div></blockquote><ul><li><ol start=3><li><font color=red>搜索仓库中的</font><code>Jenkins</code></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm search repo jenkins
</span></span><span style=display:flex><span>NAME           	CHART VERSION	APP VERSION	DESCRIPTION                                       
</span></span><span style=display:flex><span>jenkins/jenkins	4.2.5        	2.361.1    	Jenkins - Build great things at any scale! The ...
</span></span></code></pre></div></blockquote><ul><li><ol start=4><li><font color=red>查看、下载</font><code>Jenkins</code></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm show values jenkins/jenkins
</span></span><span style=display:flex><span>$ helm pull jenkins/jenkins  	<span style=color:#75715e># 下载 Jenkins 安装包</span>
</span></span><span style=display:flex><span>$ tar -zxvf jenkins-3.5.9.tgz
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ sed -i -e <span style=color:#e6db74>&#39;/#/d;/^$/d&#39;</span> values.yaml  	<span style=color:#75715e># 去掉注释和空行后修改</span>
</span></span></code></pre></div></blockquote><ul><li><ol start=5><li><font color=red>安装以及查看登录名和密码</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm install jenkins ./jenkins
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看登录的用户名</span>
</span></span><span style=display:flex><span>$  kubectl exec jenkins-0 -- cat /run/secrets/chart-admin-username
</span></span><span style=display:flex><span><span style=color:#75715e># 查看登录的密码</span>
</span></span><span style=display:flex><span>$  kubectl exec jenkins-0 -- cat /run/secrets/chart-admin-password
</span></span></code></pre></div></blockquote></div><h2 id=使用helm安装redis>使用<code>Helm</code>安装<code>Redis</code>
<a class=header-anchor href=#%e4%bd%bf%e7%94%a8helm%e5%ae%89%e8%a3%85redis></a></h2><div class="note info"><blockquote><ul><li><font color=red>添加</font><code>Bitnami</code><font color=red>仓库</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm repo add bitnami https://charts.bitnami.com/bitnami
</span></span><span style=display:flex><span>$ helm repo list
</span></span><span style=display:flex><span>$ helm search repo redis
</span></span></code></pre></div><ul><li><font color=red>下载、配置安装包</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm pull bitnami/redis
</span></span><span style=display:flex><span>$ tar xvf redis-18.8.0.tgz
</span></span></code></pre></div><ul><li><font color=red>修改</font><code>values.yaml</code></li></ul><blockquote><ul><li><code>StorageClass</code><font color=red>的名字，如果</font><code>storageClass</code><font color=red>不正常，</font><code>redis</code><font color=red>启动不了</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>global</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>imageRegistry</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>imagePullSecrets</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>storageClass</span>: <span style=color:#e6db74>&#34;nfs-storage-template&#34;</span>    <span style=color:#75715e># StorageClass 的名字，如果storageClass不正常，redis启动不了</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>redis</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>password</span>: <span style=color:#e6db74>&#34;Password&#34;</span>    <span style=color:#75715e># redis 连接密码</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>kubeVersion</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>nameOverride</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>fullnameOverride</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>namespaceOverride</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>commonLabels</span>: {}
</span></span><span style=display:flex><span><span style=color:#f92672>commonAnnotations</span>: {}
</span></span><span style=display:flex><span><span style=color:#f92672>secretAnnotations</span>: {}
</span></span><span style=display:flex><span><span style=color:#f92672>clusterDomain</span>: <span style=color:#ae81ff>cluster.local</span>
</span></span><span style=display:flex><span><span style=color:#f92672>extraDeploy</span>: []
</span></span><span style=display:flex><span><span style=color:#f92672>useHostnames</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span><span style=color:#f92672>nameResolutionThreshold</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span><span style=color:#f92672>nameResolutionTimeout</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span><span style=color:#f92672>diagnosticMode</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>command</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>sleep</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>args</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>infinity</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>image</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>registry</span>: <span style=color:#ae81ff>docker.io</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>repository</span>: <span style=color:#ae81ff>bitnami/redis</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>tag</span>: <span style=color:#ae81ff>7.2.4</span>-<span style=color:#ae81ff>debian-11-r2</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>digest</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>pullPolicy</span>: <span style=color:#ae81ff>IfNotPresent</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>pullSecrets</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>debug</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span><span style=color:#f92672>architecture</span>: <span style=color:#ae81ff>replication  </span> <span style=color:#75715e># standalone:单节点部署，replication：一主三从配置</span>
</span></span><span style=display:flex><span><span style=color:#f92672>auth</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>sentinel</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>password</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>existingSecret</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>existingSecretPasswordKey</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>usePasswordFiles</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span><span style=color:#f92672>commonConfiguration</span>: |-<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  appendonly yes
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  save &#34;&#34;</span>  
</span></span><span style=display:flex><span><span style=color:#f92672>existingConfigmap</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>master</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>count</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>configuration</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>disableCommands</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>FLUSHDB</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>FLUSHALL</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>command</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>args</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>enableServiceLinks</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>preExecCmds</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraFlags</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraEnvVars</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraEnvVarsCM</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraEnvVarsSecret</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>containerPorts</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>redis</span>: <span style=color:#ae81ff>6379</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>startupProbe</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>initialDelaySeconds</span>: <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>periodSeconds</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>timeoutSeconds</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>successThreshold</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>failureThreshold</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>livenessProbe</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>initialDelaySeconds</span>: <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>periodSeconds</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>timeoutSeconds</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>successThreshold</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>failureThreshold</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>readinessProbe</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>initialDelaySeconds</span>: <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>periodSeconds</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>timeoutSeconds</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>successThreshold</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>failureThreshold</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>customStartupProbe</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>customLivenessProbe</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>customReadinessProbe</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>limits</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>requests</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>podSecurityContext</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>fsGroupChangePolicy</span>: <span style=color:#ae81ff>Always</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>sysctls</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>supplementalGroups</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>fsGroup</span>: <span style=color:#ae81ff>1001</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>containerSecurityContext</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>seLinuxOptions</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>runAsUser</span>: <span style=color:#ae81ff>1001</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runAsGroup</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runAsNonRoot</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>allowPrivilegeEscalation</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>seccompProfile</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>type</span>: <span style=color:#ae81ff>RuntimeDefault</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>capabilities</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>drop</span>:
</span></span><span style=display:flex><span>        - <span style=color:#ae81ff>ALL</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>StatefulSet</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>schedulerName</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>updateStrategy</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>RollingUpdate</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>minReadySeconds</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>priorityClassName</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>automountServiceAccountToken</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>hostAliases</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>podLabels</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>podAnnotations</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>shareProcessNamespace</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>podAffinityPreset</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>podAntiAffinityPreset</span>: <span style=color:#ae81ff>soft</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>nodeAffinityPreset</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>key</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>values</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>affinity</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>nodeSelector</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>tolerations</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>topologySpreadConstraints</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>dnsPolicy</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>dnsConfig</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>lifecycleHooks</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraVolumes</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraVolumeMounts</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>sidecars</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>initContainers</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>persistence</span>:    <span style=color:#75715e># 持久化配置</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>   <span style=color:#75715e># 默认启用</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>medium</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>sizeLimit</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/data  </span> <span style=color:#75715e># 存储目录</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>subPath</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>subPathExpr</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>storageClass</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>accessModes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>ReadWriteOnce</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>size</span>: <span style=color:#ae81ff>2Gi  </span> <span style=color:#75715e># Master 主节点默认使用空间</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>annotations</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>labels</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>selector</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>dataSource</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>existingClaim</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>persistentVolumeClaimRetentionPolicy</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>whenScaled</span>: <span style=color:#ae81ff>Retain</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>whenDeleted</span>: <span style=color:#ae81ff>Retain</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>:    <span style=color:#75715e># 服务端口配置</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>ClusterIP</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>redis</span>: <span style=color:#ae81ff>6379</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>nodePorts</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>redis</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>externalTrafficPolicy</span>: <span style=color:#ae81ff>Cluster</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>extraPorts</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>internalTrafficPolicy</span>: <span style=color:#ae81ff>Cluster</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>clusterIP</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>loadBalancerIP</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>loadBalancerClass</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>loadBalancerSourceRanges</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>externalIPs</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>annotations</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>sessionAffinity</span>: <span style=color:#ae81ff>None</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>sessionAffinityConfig</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>terminationGracePeriodSeconds</span>: <span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>serviceAccount</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>create</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>automountServiceAccountToken</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>annotations</span>: {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>replica</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>StatefulSet</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>replicaCount</span>: <span style=color:#ae81ff>2</span>  	<span style=color:#75715e># 从节点副本数量</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>configuration</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>disableCommands</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>FLUSHDB</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>FLUSHALL</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>command</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>args</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>enableServiceLinks</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>preExecCmds</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraFlags</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraEnvVars</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraEnvVarsCM</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraEnvVarsSecret</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>externalMaster</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>host</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>port</span>: <span style=color:#ae81ff>6379</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>containerPorts</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>redis</span>: <span style=color:#ae81ff>6379</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>startupProbe</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>initialDelaySeconds</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>periodSeconds</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>timeoutSeconds</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>successThreshold</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>failureThreshold</span>: <span style=color:#ae81ff>22</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>livenessProbe</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>initialDelaySeconds</span>: <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>periodSeconds</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>timeoutSeconds</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>successThreshold</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>failureThreshold</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>readinessProbe</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>initialDelaySeconds</span>: <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>periodSeconds</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>timeoutSeconds</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>successThreshold</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>failureThreshold</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>customStartupProbe</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>customLivenessProbe</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>customReadinessProbe</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>limits</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#75715e>#   cpu: 250m</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#   memory: 256Mi</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>requests</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#75715e>#   cpu: 250m</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#   memory: 256Mi</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>podSecurityContext</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>fsGroupChangePolicy</span>: <span style=color:#ae81ff>Always</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>sysctls</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>supplementalGroups</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>fsGroup</span>: <span style=color:#ae81ff>1001</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>containerSecurityContext</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>seLinuxOptions</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>runAsUser</span>: <span style=color:#ae81ff>1001</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runAsGroup</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runAsNonRoot</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>allowPrivilegeEscalation</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>seccompProfile</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>type</span>: <span style=color:#ae81ff>RuntimeDefault</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>capabilities</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>drop</span>:
</span></span><span style=display:flex><span>        - <span style=color:#ae81ff>ALL</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>schedulerName</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>updateStrategy</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>RollingUpdate</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>minReadySeconds</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>priorityClassName</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>podManagementPolicy</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>automountServiceAccountToken</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>hostAliases</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>podLabels</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>podAnnotations</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>shareProcessNamespace</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>podAffinityPreset</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>podAntiAffinityPreset</span>: <span style=color:#ae81ff>soft</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>nodeAffinityPreset</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>key</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>values</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>affinity</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>nodeSelector</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>tolerations</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>topologySpreadConstraints</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>dnsPolicy</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>dnsConfig</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>lifecycleHooks</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraVolumes</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraVolumeMounts</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>sidecars</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>initContainers</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>persistence</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>medium</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>sizeLimit</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/data</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>subPath</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>subPathExpr</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>storageClass</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>accessModes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>ReadWriteOnce</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>size</span>: <span style=color:#ae81ff>2Gi  	# 从节点使用磁盘空间</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>annotations</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>labels</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>selector</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>dataSource</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>existingClaim</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>persistentVolumeClaimRetentionPolicy</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>whenScaled</span>: <span style=color:#ae81ff>Retain</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>whenDeleted</span>: <span style=color:#ae81ff>Retain</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>ClusterIP</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>redis</span>: <span style=color:#ae81ff>6379</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>nodePorts</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>redis</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>externalTrafficPolicy</span>: <span style=color:#ae81ff>Cluster</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>internalTrafficPolicy</span>: <span style=color:#ae81ff>Cluster</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>extraPorts</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>clusterIP</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>loadBalancerIP</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>loadBalancerClass</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>loadBalancerSourceRanges</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>annotations</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>sessionAffinity</span>: <span style=color:#ae81ff>None</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>sessionAffinityConfig</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>terminationGracePeriodSeconds</span>: <span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>autoscaling</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>minReplicas</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>maxReplicas</span>: <span style=color:#ae81ff>11</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>targetCPU</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>targetMemory</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>serviceAccount</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>create</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>automountServiceAccountToken</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>annotations</span>: {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>sentinel</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>image</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>registry</span>: <span style=color:#ae81ff>docker.io</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>repository</span>: <span style=color:#ae81ff>bitnami/redis-sentinel</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>tag</span>: <span style=color:#ae81ff>7.2.4</span>-<span style=color:#ae81ff>debian-11-r3</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>digest</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>pullPolicy</span>: <span style=color:#ae81ff>IfNotPresent</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>pullSecrets</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>debug</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>annotations</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>masterSet</span>: <span style=color:#ae81ff>mymaster</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>quorum</span>: <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>getMasterTimeout</span>: <span style=color:#ae81ff>90</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>automateClusterRecovery</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>redisShutdownWaitFailover</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>downAfterMilliseconds</span>: <span style=color:#ae81ff>60000</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>failoverTimeout</span>: <span style=color:#ae81ff>180000</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>parallelSyncs</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>configuration</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>command</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>args</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>enableServiceLinks</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>preExecCmds</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraEnvVars</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraEnvVarsCM</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraEnvVarsSecret</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>externalMaster</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>host</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>port</span>: <span style=color:#ae81ff>6379</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>containerPorts</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>sentinel</span>: <span style=color:#ae81ff>26379</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>startupProbe</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>initialDelaySeconds</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>periodSeconds</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>timeoutSeconds</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>successThreshold</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>failureThreshold</span>: <span style=color:#ae81ff>22</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>livenessProbe</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>initialDelaySeconds</span>: <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>periodSeconds</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>timeoutSeconds</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>successThreshold</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>failureThreshold</span>: <span style=color:#ae81ff>6</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>readinessProbe</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>initialDelaySeconds</span>: <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>periodSeconds</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>timeoutSeconds</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>successThreshold</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>failureThreshold</span>: <span style=color:#ae81ff>6</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>customStartupProbe</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>customLivenessProbe</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>customReadinessProbe</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>persistence</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>storageClass</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>accessModes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>ReadWriteOnce</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>size</span>: <span style=color:#ae81ff>100Mi</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>annotations</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>labels</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>selector</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>dataSource</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>medium</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>sizeLimit</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>persistentVolumeClaimRetentionPolicy</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>whenScaled</span>: <span style=color:#ae81ff>Retain</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>whenDeleted</span>: <span style=color:#ae81ff>Retain</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>limits</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>requests</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>containerSecurityContext</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>seLinuxOptions</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>runAsUser</span>: <span style=color:#ae81ff>1001</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runAsGroup</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runAsNonRoot</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>allowPrivilegeEscalation</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>seccompProfile</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>type</span>: <span style=color:#ae81ff>RuntimeDefault</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>capabilities</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>drop</span>:
</span></span><span style=display:flex><span>        - <span style=color:#ae81ff>ALL</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>lifecycleHooks</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraVolumes</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraVolumeMounts</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>ClusterIP</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>redis</span>: <span style=color:#ae81ff>6379</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>sentinel</span>: <span style=color:#ae81ff>26379</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>nodePorts</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>redis</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>sentinel</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>externalTrafficPolicy</span>: <span style=color:#ae81ff>Cluster</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>extraPorts</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>clusterIP</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>loadBalancerIP</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>loadBalancerClass</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>loadBalancerSourceRanges</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>annotations</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>sessionAffinity</span>: <span style=color:#ae81ff>None</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>sessionAffinityConfig</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>headless</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>annotations</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>terminationGracePeriodSeconds</span>: <span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>serviceBindings</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>networkPolicy</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>allowExternal</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraIngress</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraEgress</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>ingressNSMatchLabels</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>ingressNSPodMatchLabels</span>: {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>metrics</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>allowExternal</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ingressNSMatchLabels</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>ingressNSPodMatchLabels</span>: {}
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#f92672>podSecurityPolicy</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>create</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span><span style=color:#f92672>rbac</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>create</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>rules</span>: []
</span></span><span style=display:flex><span><span style=color:#f92672>serviceAccount</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>create</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>automountServiceAccountToken</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>annotations</span>: {}
</span></span><span style=display:flex><span><span style=color:#f92672>pdb</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>create</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>minAvailable</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>maxUnavailable</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>tls</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>authClients</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>autoGenerated</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>existingSecret</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>certificatesSecret</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>certFilename</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>certKeyFilename</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>certCAFilename</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>dhParamsFilename</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>metrics</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>image</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>registry</span>: <span style=color:#ae81ff>docker.io</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>repository</span>: <span style=color:#ae81ff>bitnami/redis-exporter</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>tag</span>: <span style=color:#ae81ff>1.56.0</span>-<span style=color:#ae81ff>debian-11-r1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>digest</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>pullPolicy</span>: <span style=color:#ae81ff>IfNotPresent</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>pullSecrets</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>startupProbe</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>initialDelaySeconds</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>periodSeconds</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>timeoutSeconds</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>successThreshold</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>failureThreshold</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>livenessProbe</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>initialDelaySeconds</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>periodSeconds</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>timeoutSeconds</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>successThreshold</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>failureThreshold</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>readinessProbe</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>initialDelaySeconds</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>periodSeconds</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>timeoutSeconds</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>successThreshold</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>failureThreshold</span>: <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>customStartupProbe</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>customLivenessProbe</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>customReadinessProbe</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>command</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>redisTargetHost</span>: <span style=color:#e6db74>&#34;localhost&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraArgs</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraEnvVars</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>containerSecurityContext</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>seLinuxOptions</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>runAsUser</span>: <span style=color:#ae81ff>1001</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runAsGroup</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runAsNonRoot</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>allowPrivilegeEscalation</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>seccompProfile</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>type</span>: <span style=color:#ae81ff>RuntimeDefault</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>capabilities</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>drop</span>:
</span></span><span style=display:flex><span>        - <span style=color:#ae81ff>ALL</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraVolumes</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>extraVolumeMounts</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>limits</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>requests</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>podLabels</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>podAnnotations</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>prometheus.io/scrape</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>prometheus.io/port</span>: <span style=color:#e6db74>&#34;9121&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>ClusterIP</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>port</span>: <span style=color:#ae81ff>9121</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>externalTrafficPolicy</span>: <span style=color:#ae81ff>Cluster</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>extraPorts</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>loadBalancerIP</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>loadBalancerClass</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>loadBalancerSourceRanges</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>annotations</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>clusterIP</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>serviceMonitor</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>namespace</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>interval</span>: <span style=color:#ae81ff>30s</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>scrapeTimeout</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>relabellings</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>metricRelabelings</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>honorLabels</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>additionalLabels</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>podTargetLabels</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>sampleLimit</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>targetLimit</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>podMonitor</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>namespace</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>interval</span>: <span style=color:#ae81ff>30s</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>scrapeTimeout</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>relabellings</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>metricRelabelings</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>honorLabels</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>additionalLabels</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>podTargetLabels</span>: []
</span></span><span style=display:flex><span>    <span style=color:#f92672>sampleLimit</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>targetLimit</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>prometheusRule</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>namespace</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>additionalLabels</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>rules</span>: []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>volumePermissions</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>image</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>registry</span>: <span style=color:#ae81ff>docker.io</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>repository</span>: <span style=color:#ae81ff>bitnami/os-shell</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>tag</span>: <span style=color:#ae81ff>11</span>-<span style=color:#ae81ff>debian-11-r94</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>digest</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>pullPolicy</span>: <span style=color:#ae81ff>IfNotPresent</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>pullSecrets</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>limits</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>requests</span>: {}
</span></span><span style=display:flex><span>  <span style=color:#f92672>containerSecurityContext</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>seLinuxOptions</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>runAsUser</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>sysctl</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>image</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>registry</span>: <span style=color:#ae81ff>docker.io</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>repository</span>: <span style=color:#ae81ff>bitnami/os-shell</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>tag</span>: <span style=color:#ae81ff>11</span>-<span style=color:#ae81ff>debian-11-r94</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>digest</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>pullPolicy</span>: <span style=color:#ae81ff>IfNotPresent</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>pullSecrets</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>command</span>: []
</span></span><span style=display:flex><span>  <span style=color:#f92672>mountHostSys</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>limits</span>: {}
</span></span><span style=display:flex><span>    <span style=color:#f92672>requests</span>: {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>useExternalDNS</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>suffix</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>annotationKey</span>: <span style=color:#ae81ff>external-dns.alpha.kubernetes.io/</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>additionalAnnotations</span>: {}
</span></span></code></pre></div></blockquote><ul><li><font color=red>安装</font><code>Redis</code><font color=red>形成</font><code>Release</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm install release-name project-dir -n namespace
</span></span><span style=display:flex><span>$ helm install redis ./redis/ -n default
</span></span></code></pre></div><ul><li><font color=red>登录</font><code>Redis</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ kubectl exec --tty -i redis-master-0 --namespace default -- bash
</span></span><span style=display:flex><span>$ kubectl exec --tty -i redis-replicas-1 --namespace default -- bash
</span></span></code></pre></div><ul><li><font color=red>升级</font><code>Redis</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ helm upgrade redis ./redis/ -n default
</span></span></code></pre></div></blockquote></div><h2 id=使用helm安装prometheus>使用<code>Helm</code>安装<code>Prometheus</code>
<a class=header-anchor href=#%e4%bd%bf%e7%94%a8helm%e5%ae%89%e8%a3%85prometheus></a></h2><div class="note info"><blockquote><table><thead><tr><th>名称地址</th><th>描述</th></tr></thead><tbody><tr><td><a href=https://github.com/prometheus-operator/kube-prometheus title="<code>kube-prometheus</code>" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>kube-prometheus</code>
<i class="fa fa-external-link-alt"></i></a></td><td></td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr></tbody></table></blockquote></div><h2 id=使用helm安装elk>使用<code>Helm</code>安装<code>ELK</code>
<a class=header-anchor href=#%e4%bd%bf%e7%94%a8helm%e5%ae%89%e8%a3%85elk></a></h2><div class="note info"><blockquote><table><thead><tr><th>名称地址</th><th>描述</th></tr></thead><tbody><tr><td></td><td></td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr></tbody></table></blockquote></div></div><footer class=post-footer><div class=post-tags><a href=/tags/kubernetes>Kubernetes
</a><a href=/tags/helm>Helm</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=reward-container><div><i class="fa-solid fa-mug-hot"></i>请我喝杯咖啡吧 ヾ(^▽^*)))</div><button>
赞赏</button><div class=post-reward><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/ali-pay.png alt="二哥 - 支付宝">
<span>支付宝</span></div><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/wechat-pay.png alt="二哥 - 微信">
<span>微信</span></div></div></div><div class=post-copyright><img src=/imgs/cc/cc.svg width=75 height=75 align=right alt=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
Configure K8s Helm</li><li class=post-copyright-author><strong>本文作者： </strong>二哥</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://erge.blog/system/linux/kubernetes/configure-k8s-helm/ title="Configure K8s Helm">https://erge.blog/system/linux/kubernetes/configure-k8s-helm/</a></li><li class=post-copyright-license><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=/images/wechat_channel.jpg><span class=icon><i class="fab fa-weixin"></i>
</span><span class=label>WeChat</span></a></div><div class=social-item><a target=_blank class=social-link href=/atom.xml><span class=icon><i class="fa fa-rss"></i>
</span><span class=label>RSS</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/system/linux/kubernetes/configure-k8s-auth/ rel=next title="Configure K8s Auth"><i class="fa fa-chevron-left"></i> Configure K8s Auth</a></div><div class="post-nav-prev post-nav-item"><a href=/system/linux/kubernetes/configure-k8s-storage/ rel=prev title="Configure K8s Storage">Configure K8s Storage
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div><div class=comment-switch><span class=first-comment>Giscus</span>
<span class=switch-btn></span>
<span class=second-comment>Waline</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=waline-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div id=gtranslate class=google-translate><i class="fa fa-language"></i><div id=google_translate_element></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2010 - 2024
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>二哥</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.125.4 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.5.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>粤ICP备 18047355-1 号</a>
<img src=/imgs/gongan.png alt=沪公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011402009770" target=_blank>沪公网安备 31011402009770 号</a></div><div class=vendors-list><a target=_blank href=https://vercel.com title=Vercel><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/vercel.svg alt=Vercel>
</a><a target=_blank href=https://upyun.com title=又拍云><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/upyun.png alt=又拍云>
</a><a target=_blank href=https://webify.cloudbase.net title=Webify>Webify
</a><span>提供CDN/云资源支持</span></div></div></footer><script type=text/javascript src=https://cdn.staticfile.org/animejs/3.2.1/anime.min.js defer></script><script type=text/javascript src=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.js defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":false,"giscus":{"cfg":{"category":"Comments","categoryid":null,"emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"username/repo-name","repoid":null,"theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"https://erge.blog/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":true,"plugin":"waline"},"views":{"enable":true,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"qiniu","router":"https://cdn.staticfile.org"},"version":"4.5.3","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":null,"sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"waline","file":"dist/waline.css","name":"@waline/client","version":"2.13.0"},"js":{"alias":"waline","file":"dist/waline.js","name":"@waline/client","version":"2.13.0"}}}</script><script type=text/javascript src=/js/main.min.b0c78e5a4df586ee46d02716ffa91a4a322e56763e04e91eb2ba052c9469ed02.js defer></script></body></html>