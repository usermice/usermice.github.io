<!DOCTYPE html>
<html lang="en" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.125.4">
    <meta name="generator" content="Relearn 6.0.0+tip">
    <meta name="robots" content="noindex, nofollow, noarchive, noimageindex">
    <meta name="description" content="é…ç½®elasticsearch&#43;redis elasticsearchå‡ºç°é—®é¢˜æ€ä¹ˆå¤„ç† æ¥ä¸‹æ¥æè¿°ä¼šé‡è§åˆ°çš„ä¸€ä¸ªé—®é¢˜ï¼šä¸€æ—¦æˆ‘ä»¬çš„elasticsearchå‡ºç°é—®é¢˜ï¼Œå°±ä¸èƒ½è¿›è¡Œæ—¥å¿—é‡‡é›†å¤„ç†äº†ï¼è¿™ç§æƒ…å†µä¸‹è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ è§£å†³æ–¹æ¡ˆï¼šå¯ä»¥åœ¨clientå’Œelasticsearchä¹‹é—´æ·»åŠ ä¸€ä¸ªä¸­é—´ä»¶ä½œä¸ºç¼“å­˜ï¼Œå…ˆå°†é‡‡é›†åˆ°çš„æ—¥å¿—å†…å®¹å†™åˆ°ä¸­é—´ä»¶ä¸Šï¼Œç„¶åå†ä»ä¸­é—´ä»¶è¾“å…¥åˆ°elasticsearchä¸­ã€‚ è¿™å°±å®Œç¾çš„è§£å†³äº†ä¸Šè¿°çš„é—®é¢˜äº†ã€‚ELKä¸­ä½¿ç”¨redisä½œä¸ºä¸­é—´ä»¶ï¼Œç¼“å­˜æ—¥å¿—é‡‡é›†å†…å®¹ $ curl &#39;localhost:9200/_cat/health?v&#39; # æ£€æµ‹é›†ç¾¤æ˜¯å¦å¥åº· $ curl &#39;localhost:9200/_cat/nodes?">
    <meta name="author" content="äºŒå“¥">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://usermice.github.io/images/s2-1.png">
    <meta name="twitter:title" content="Configure_ELK :: Hugo Relearn Theme">
    <meta name="twitter:description" content="é…ç½®elasticsearch&#43;redis elasticsearchå‡ºç°é—®é¢˜æ€ä¹ˆå¤„ç† æ¥ä¸‹æ¥æè¿°ä¼šé‡è§åˆ°çš„ä¸€ä¸ªé—®é¢˜ï¼šä¸€æ—¦æˆ‘ä»¬çš„elasticsearchå‡ºç°é—®é¢˜ï¼Œå°±ä¸èƒ½è¿›è¡Œæ—¥å¿—é‡‡é›†å¤„ç†äº†ï¼è¿™ç§æƒ…å†µä¸‹è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ è§£å†³æ–¹æ¡ˆï¼šå¯ä»¥åœ¨clientå’Œelasticsearchä¹‹é—´æ·»åŠ ä¸€ä¸ªä¸­é—´ä»¶ä½œä¸ºç¼“å­˜ï¼Œå…ˆå°†é‡‡é›†åˆ°çš„æ—¥å¿—å†…å®¹å†™åˆ°ä¸­é—´ä»¶ä¸Šï¼Œç„¶åå†ä»ä¸­é—´ä»¶è¾“å…¥åˆ°elasticsearchä¸­ã€‚ è¿™å°±å®Œç¾çš„è§£å†³äº†ä¸Šè¿°çš„é—®é¢˜äº†ã€‚ELKä¸­ä½¿ç”¨redisä½œä¸ºä¸­é—´ä»¶ï¼Œç¼“å­˜æ—¥å¿—é‡‡é›†å†…å®¹ $ curl &#39;localhost:9200/_cat/health?v&#39; # æ£€æµ‹é›†ç¾¤æ˜¯å¦å¥åº· $ curl &#39;localhost:9200/_cat/nodes?">
    <meta property="og:url" content="https://usermice.github.io/systems/linux/logs/configure_elk/">
    <meta property="og:site_name" content="Hugo Relearn Theme">
    <meta property="og:title" content="Configure_ELK :: Hugo Relearn Theme">
    <meta property="og:description" content="é…ç½®elasticsearch&#43;redis elasticsearchå‡ºç°é—®é¢˜æ€ä¹ˆå¤„ç† æ¥ä¸‹æ¥æè¿°ä¼šé‡è§åˆ°çš„ä¸€ä¸ªé—®é¢˜ï¼šä¸€æ—¦æˆ‘ä»¬çš„elasticsearchå‡ºç°é—®é¢˜ï¼Œå°±ä¸èƒ½è¿›è¡Œæ—¥å¿—é‡‡é›†å¤„ç†äº†ï¼è¿™ç§æƒ…å†µä¸‹è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ è§£å†³æ–¹æ¡ˆï¼šå¯ä»¥åœ¨clientå’Œelasticsearchä¹‹é—´æ·»åŠ ä¸€ä¸ªä¸­é—´ä»¶ä½œä¸ºç¼“å­˜ï¼Œå…ˆå°†é‡‡é›†åˆ°çš„æ—¥å¿—å†…å®¹å†™åˆ°ä¸­é—´ä»¶ä¸Šï¼Œç„¶åå†ä»ä¸­é—´ä»¶è¾“å…¥åˆ°elasticsearchä¸­ã€‚ è¿™å°±å®Œç¾çš„è§£å†³äº†ä¸Šè¿°çš„é—®é¢˜äº†ã€‚ELKä¸­ä½¿ç”¨redisä½œä¸ºä¸­é—´ä»¶ï¼Œç¼“å­˜æ—¥å¿—é‡‡é›†å†…å®¹ $ curl &#39;localhost:9200/_cat/health?v&#39; # æ£€æµ‹é›†ç¾¤æ˜¯å¦å¥åº· $ curl &#39;localhost:9200/_cat/nodes?">
    <meta property="og:locale" content="en">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Systems">
    <meta property="article:published_time" content="2024-06-20T18:24:37+08:00">
    <meta property="article:modified_time" content="2024-06-20T18:24:37+08:00">
    <meta property="og:image" content="https://usermice.github.io/images/s2-1.png">
    <meta itemprop="name" content="Configure_ELK :: Hugo Relearn Theme">
    <meta itemprop="description" content="é…ç½®elasticsearch&#43;redis elasticsearchå‡ºç°é—®é¢˜æ€ä¹ˆå¤„ç† æ¥ä¸‹æ¥æè¿°ä¼šé‡è§åˆ°çš„ä¸€ä¸ªé—®é¢˜ï¼šä¸€æ—¦æˆ‘ä»¬çš„elasticsearchå‡ºç°é—®é¢˜ï¼Œå°±ä¸èƒ½è¿›è¡Œæ—¥å¿—é‡‡é›†å¤„ç†äº†ï¼è¿™ç§æƒ…å†µä¸‹è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ è§£å†³æ–¹æ¡ˆï¼šå¯ä»¥åœ¨clientå’Œelasticsearchä¹‹é—´æ·»åŠ ä¸€ä¸ªä¸­é—´ä»¶ä½œä¸ºç¼“å­˜ï¼Œå…ˆå°†é‡‡é›†åˆ°çš„æ—¥å¿—å†…å®¹å†™åˆ°ä¸­é—´ä»¶ä¸Šï¼Œç„¶åå†ä»ä¸­é—´ä»¶è¾“å…¥åˆ°elasticsearchä¸­ã€‚ è¿™å°±å®Œç¾çš„è§£å†³äº†ä¸Šè¿°çš„é—®é¢˜äº†ã€‚ELKä¸­ä½¿ç”¨redisä½œä¸ºä¸­é—´ä»¶ï¼Œç¼“å­˜æ—¥å¿—é‡‡é›†å†…å®¹ $ curl &#39;localhost:9200/_cat/health?v&#39; # æ£€æµ‹é›†ç¾¤æ˜¯å¦å¥åº· $ curl &#39;localhost:9200/_cat/nodes?">
    <meta itemprop="datePublished" content="2024-06-20T18:24:37+08:00">
    <meta itemprop="dateModified" content="2024-06-20T18:24:37+08:00">
    <meta itemprop="wordCount" content="769">
    <meta itemprop="image" content="https://usermice.github.io/images/s2-1.png">
    <title>Configure_ELK :: Hugo Relearn Theme</title>
    <link href="../../../../images/favicon.ico?1724933323" rel="icon" type="image/x-icon" sizes="any">
    <link href="../../../../css/fontawesome-all.min.css?1724933324" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/fontawesome-all.min.css?1724933324" rel="stylesheet"></noscript>
    <link href="../../../../css/nucleus.css?1724933324" rel="stylesheet">
    <link href="../../../../css/auto-complete.css?1724933324" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/auto-complete.css?1724933324" rel="stylesheet"></noscript>
    <link href="../../../../css/perfect-scrollbar.min.css?1724933324" rel="stylesheet">
    <link href="../../../../css/fonts.css?1724933324" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/fonts.css?1724933324" rel="stylesheet"></noscript>
    <link href="../../../../css/theme.css?1724933324" rel="stylesheet">
    <link href="../../../../css/theme-relearn-auto.css?1724933324" rel="stylesheet" id="R-variant-style">
    <link href="../../../../css/chroma-relearn-auto.css?1724933324" rel="stylesheet" id="R-variant-chroma-style">
    <link href="../../../../css/variant.css?1724933324" rel="stylesheet">
    <link href="../../../../css/print.css?1724933324" rel="stylesheet" media="print">
    <link href="../../../../css/format-print.css?1724933324" rel="stylesheet">
    <script src="../../../../js/variant.js?1724933324"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..\/..\/..';
      window.relearn.relBaseUri='..\/..\/..\/..';
      window.relearn.absBaseUri='https:\/\/usermice.github.io';
      window.index_js_url="../../../../index.search.js";
      // variant stuff
      window.variants && variants.init( [ 'relearn-auto', 'relearn-light', 'relearn-dark', 'relearn-bright', 'zen-auto', 'zen-light', 'zen-dark', 'retro-auto', 'neon', 'learn', 'blue', 'green', 'red', 'my-branding' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>Partial intended to be overwritten to add custom headers, like CSS or any other info
<style>
    
</style>


  </head>
  <body class="mobile-support print disableInlineCopyToClipboard" data-url="../../../../systems/linux/logs/configure_elk/">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="show" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>



          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../../../systems/"><span itemprop="name">Systems</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../../../systems/linux/"><span itemprop="name">Linux</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../../../systems/linux/logs/"><span itemprop="name">Logs</span></a><meta itemprop="position" content="3">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Configure_ELK</span><meta itemprop="position" content="4"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">


            <div class="topbar-button topbar-button-prev" data-content-empty="show" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="../../../../systems/linux/logs/install_elk/" title="Install_ELK (ğŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>

            <div class="topbar-button topbar-button-next" data-content-empty="show" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="../../../../systems/linux/message_queue/" title="Message_Queue (ğŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>



          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>

<h1 id="configure_elk">Configure_ELK</h1>

<h2 id="é…ç½®elasticsearchredis">é…ç½®<code>elasticsearch+redis</code></h2>
<ul>
<li>
<ol>
<li><code>elasticsearch</code><!-- raw HTML omitted -->å‡ºç°é—®é¢˜æ€ä¹ˆå¤„ç†<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<ul>
<li>æ¥ä¸‹æ¥æè¿°ä¼šé‡è§åˆ°çš„ä¸€ä¸ªé—®é¢˜ï¼šä¸€æ—¦æˆ‘ä»¬çš„<code>elasticsearch</code>å‡ºç°é—®é¢˜ï¼Œå°±ä¸èƒ½è¿›è¡Œæ—¥å¿—é‡‡é›†å¤„ç†äº†ï¼è¿™ç§æƒ…å†µä¸‹è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</li>
<li><!-- raw HTML omitted -->è§£å†³æ–¹æ¡ˆï¼š<!-- raw HTML omitted -->å¯ä»¥åœ¨<code>client</code>å’Œ<code>elasticsearch</code>ä¹‹é—´æ·»åŠ ä¸€ä¸ªä¸­é—´ä»¶ä½œä¸ºç¼“å­˜ï¼Œå…ˆå°†é‡‡é›†åˆ°çš„æ—¥å¿—å†…å®¹å†™åˆ°ä¸­é—´ä»¶ä¸Šï¼Œç„¶åå†ä»ä¸­é—´ä»¶è¾“å…¥åˆ°<code>elasticsearch</code>ä¸­ã€‚
è¿™å°±å®Œç¾çš„è§£å†³äº†ä¸Šè¿°çš„é—®é¢˜äº†ã€‚<code>ELK</code>ä¸­ä½¿ç”¨<code>redis</code>ä½œä¸ºä¸­é—´ä»¶ï¼Œç¼“å­˜æ—¥å¿—é‡‡é›†å†…å®¹</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ curl <span style="color:#e6db74">&#39;localhost:9200/_cat/health?v&#39;</span>  	<span style="color:#75715e"># æ£€æµ‹é›†ç¾¤æ˜¯å¦å¥åº·</span>
</span></span><span style="display:flex;"><span>$ curl <span style="color:#e6db74">&#39;localhost:9200/_cat/nodes?v&#39;</span>  	<span style="color:#75715e"># è·å–é›†ç¾¤èŠ‚ç‚¹åˆ—è¡¨</span>
</span></span><span style="display:flex;"><span>$ curl <span style="color:#e6db74">&#39;localhost:9200/_cat/indices?v&#39;</span>  	<span style="color:#75715e"># åˆ—å‡ºæ‰€æœ‰ç´¢å¼•</span>
</span></span><span style="display:flex;"><span>$ curl -u user_name:password -X GET <span style="color:#e6db74">&#34;http://localhost:9200/_cluster/health?pretty&#34;</span>
</span></span><span style="display:flex;"><span>$ curl -XPUT <span style="color:#e6db74">&#39;localhost:9200/customer?pretty&#39;</span>  	<span style="color:#75715e"># åˆ›å»ºä¸€ä¸ªåä¸º&#34;customer&#34;çš„ç´¢å¼•</span>
</span></span><span style="display:flex;"><span>$ curl -XDELETE <span style="color:#e6db74">&#39;localhost:9200/customer?pretty&#39;</span>  	<span style="color:#75715e"># åˆ é™¤ä¸€ä¸ªåä¸º&#34;customer&#34;çš„ç´¢å¼•</span>
</span></span><span style="display:flex;"><span>$ curl localhost:9200/_cat/segments/<span style="color:#f92672">{</span>indexName<span style="color:#f92672">}</span>|wc -l  	<span style="color:#75715e"># æŸ¥çœ‹æŸä¸ªç´¢å¼•çš„æ®µæ•°é‡ï¼šGET /nginx-2022-*/_segments</span>
</span></span><span style="display:flex;"><span>$ curl -XPOST 192.168.60.7:9200/indexName/_forcemerge?max_num_segments<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>  	<span style="color:#75715e"># åˆå¹¶æŸä¸ªç´¢å¼•çš„æ®µ</span>
</span></span><span style="display:flex;"><span>POST /nginx-2022-*/_forcemerge?max_num_segments<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>  	<span style="color:#75715e"># æ”¯æŒé€šé…ç¬¦</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ cat &gt;delete_es_index.sh<span style="color:#e6db74">&lt;&lt;-EOF 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">##!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">## å®šæœŸåˆ é™¤ä¸¤ä¸ªæœˆä¹‹å‰elasticsearchç´¢å¼•
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">date=`date -d &#34;-2 months&#34; &#34;+%Y.%m&#34;`
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">/usr/bin/curl -v --user elastic:elasticç”¨æˆ·å¯†ç  -XDELETE &#34;http://esæœºå™¨IP:9200/*-$date&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span></span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="2">
<li><!-- raw HTML omitted -->é…ç½®<!-- raw HTML omitted --><code>Redis</code></li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cat /etc/redis.conf  	<span style="color:#75715e"># ä¿®æ”¹ä¸‹é¢ä¸¤è¡Œå†…å®¹</span>
</span></span><span style="display:flex;"><span>daemonize yes
</span></span><span style="display:flex;"><span>bind 192.168.1.160
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ systemctl start redis
</span></span><span style="display:flex;"><span>$ lsof -i:6379
</span></span><span style="display:flex;"><span>COMMAND     PID  USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
</span></span><span style="display:flex;"><span>redis-ser <span style="color:#ae81ff">19474</span> redis    4u  IPv4 <span style="color:#ae81ff">1344465</span>      0t0  TCP elk-node1:6379 <span style="color:#f92672">(</span>LISTEN<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ redis-cli -h 192.168.1.160
</span></span><span style="display:flex;"><span>192.168.1.160:6379&gt; info
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Server</span>
</span></span><span style="display:flex;"><span>redis_version:2.8.19
</span></span><span style="display:flex;"><span>.......</span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="3">
<li><!-- raw HTML omitted -->ç¼–å†™ä»<!-- raw HTML omitted --><code>Client</code><!-- raw HTML omitted -->ç«¯æ”¶é›†æ•°æ®çš„æ–‡ä»¶<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cat /opt/logstash/data/redis-out.conf
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>stdin <span style="color:#f92672">{}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>output <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>redis <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>host <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;192.168.1.160&#34;</span>
</span></span><span style="display:flex;"><span>port <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6379&#34;</span>
</span></span><span style="display:flex;"><span>db <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6&#34;</span>
</span></span><span style="display:flex;"><span>data_type <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;list&#34;</span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;demo&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="4">
<li><!-- raw HTML omitted -->æ‰§è¡Œæ”¶é›†æ•°æ®çš„æ–‡ä»¶ï¼Œå¹¶è¾“å…¥æ•°æ®<!-- raw HTML omitted --><code>hello redis</code></li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ /opt/logstash/bin/logstash -f redis-out.conf 
</span></span><span style="display:flex;"><span>Settings: Default filter workers: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Logstash startup completed  	<span style="color:#75715e"># ä¸‹é¢è¾“å…¥æ•°æ®hello redis</span>
</span></span><span style="display:flex;"><span>hello redis</span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="5">
<li><!-- raw HTML omitted -->åœ¨<!-- raw HTML omitted --><code>redis</code><!-- raw HTML omitted -->ä¸­æŸ¥çœ‹æ•°æ®<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ redis-cli -h 192.168.1.160
</span></span><span style="display:flex;"><span>192.168.1.160:6379&gt; info
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Server</span>
</span></span><span style="display:flex;"><span>.......
</span></span><span style="display:flex;"><span>.......
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Keyspace</span>
</span></span><span style="display:flex;"><span>db6:keys<span style="color:#f92672">=</span>1,expires<span style="color:#f92672">=</span>0,avg_ttl<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>  	<span style="color:#75715e"># åœ¨æœ€ä¸‹é¢ä¸€è¡Œï¼Œæ˜¾ç¤ºæ˜¯db6</span>
</span></span><span style="display:flex;"><span>192.168.1.160:6379&gt; <span style="color:#66d9ef">select</span> <span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>OK
</span></span><span style="display:flex;"><span>192.168.1.160:6379<span style="color:#f92672">[</span>6<span style="color:#f92672">]</span>&gt; keys *
</span></span><span style="display:flex;"><span>1<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;demo&#34;</span>
</span></span><span style="display:flex;"><span>192.168.1.160:6379<span style="color:#f92672">[</span>6<span style="color:#f92672">]</span>&gt; LINDEX demo -1
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;{\&#34;message\&#34;:\&#34;hello redis\&#34;,\&#34;@version\&#34;:\&#34;1\&#34;,\&#34;@timestamp\&#34;:\&#34;2016-11-14T08:04:25.981Z\&#34;,\&#34;host\&#34;:\&#34;elk-node1\&#34;}&#34;</span></span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="6">
<li><!-- raw HTML omitted -->ç»§ç»­éšä¾¿å†™ç‚¹æ•°æ®æµ‹è¯•<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ /opt/logstash/bin/logstash -f redis-out.conf
</span></span><span style="display:flex;"><span>Settings: Default filter workers: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Logstash startup completed
</span></span><span style="display:flex;"><span>hello redis
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">123456</span>
</span></span><span style="display:flex;"><span>asdf
</span></span><span style="display:flex;"><span>ert
</span></span><span style="display:flex;"><span>wang
</span></span><span style="display:flex;"><span>shi
</span></span><span style="display:flex;"><span>bo
</span></span><span style="display:flex;"><span>guohuihui
</span></span><span style="display:flex;"><span>as
</span></span><span style="display:flex;"><span>we
</span></span><span style="display:flex;"><span>r
</span></span><span style="display:flex;"><span>g
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>asdfjkdfsak
</span></span><span style="display:flex;"><span>5423wer
</span></span><span style="display:flex;"><span>34rt3
</span></span><span style="display:flex;"><span>6y
</span></span><span style="display:flex;"><span>7uj
</span></span><span style="display:flex;"><span>u
</span></span><span style="display:flex;"><span>io9
</span></span><span style="display:flex;"><span>sdjfhsdk890
</span></span><span style="display:flex;"><span>huanqiu
</span></span><span style="display:flex;"><span>huanqiuchain
</span></span><span style="display:flex;"><span>hqsb
</span></span><span style="display:flex;"><span>asda    </span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="7">
<li><!-- raw HTML omitted -->åœ¨<!-- raw HTML omitted --><code>redis</code><!-- raw HTML omitted -->ä¸­æŸ¥çœ‹é•¿åº¦<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ redis-cli -h 192.168.1.160
</span></span><span style="display:flex;"><span>192.168.1.160:6379&gt; info
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Server</span>
</span></span><span style="display:flex;"><span>redis_version:2.8.19
</span></span><span style="display:flex;"><span>.......
</span></span><span style="display:flex;"><span>.......
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Keyspace</span>
</span></span><span style="display:flex;"><span>db6:keys<span style="color:#f92672">=</span>1,expires<span style="color:#f92672">=</span>0,avg_ttl<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>  	<span style="color:#75715e"># æ˜¾ç¤ºæ˜¯db6</span>
</span></span><span style="display:flex;"><span>192.168.1.160:6379&gt; <span style="color:#66d9ef">select</span> <span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>OK
</span></span><span style="display:flex;"><span>192.168.1.160:6379<span style="color:#f92672">[</span>6<span style="color:#f92672">]</span>&gt; keys *
</span></span><span style="display:flex;"><span>1<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;demo&#34;</span>
</span></span><span style="display:flex;"><span>192.168.1.160:6379<span style="color:#f92672">[</span>6<span style="color:#f92672">]</span>&gt; LLEN demo
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>integer<span style="color:#f92672">)</span> <span style="color:#ae81ff">24</span></span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="8">
<li><!-- raw HTML omitted -->å°†<!-- raw HTML omitted --><code>redis</code><!-- raw HTML omitted -->ä¸­çš„å†…å®¹å†™åˆ°<!-- raw HTML omitted --><code>elasticsearch</code><!-- raw HTML omitted -->ä¸­<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ vim redis-in.conf
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>redis <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span> host <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;192.168.1.160&#34;</span>
</span></span><span style="display:flex;"><span> port <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6379&#34;</span>
</span></span><span style="display:flex;"><span> db <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6&#34;</span>
</span></span><span style="display:flex;"><span> data_type <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;list&#34;</span>
</span></span><span style="display:flex;"><span> key <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;demo&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>output <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>elasticsearch <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span> hosts <span style="color:#f92672">=</span>&gt; <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;192.168.1.160:9200&#34;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span> index <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;redis-in-%{+YYYY.MM.dd}&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="9">
<li><!-- raw HTML omitted -->æ‰§è¡Œ<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ /opt/logstash/bin/logstash -f  redis-in.conf --configtest
</span></span><span style="display:flex;"><span>Configuration OK
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ /opt/logstash/bin/logstash -f  redis-in.conf &amp;
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åœ¨redisä¸­æŸ¥çœ‹ï¼Œå‘ç°æ•°æ®å·²è¢«è¯»å‡ºï¼š</span>
</span></span><span style="display:flex;"><span>192.168.1.160:6379<span style="color:#f92672">[</span>6<span style="color:#f92672">]</span>&gt; LLEN demo
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>integer<span style="color:#f92672">)</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç™»é™†elasticsearchç•Œé¢æŸ¥çœ‹</span></span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="10">
<li><!-- raw HTML omitted -->å°†æ”¶é›†åˆ°çš„æ‰€æœ‰æ—¥å¿—å†™å…¥åˆ°<!-- raw HTML omitted --><code>redis</code><!-- raw HTML omitted -->ä¸­ã€‚è¿™äº†é‡æ–°å®šä¹‰ä¸€ä¸ªæ·»åŠ <!-- raw HTML omitted --><code>redis</code><!-- raw HTML omitted -->ç¼“å­˜åçš„æ€»æ–‡ä»¶<!-- raw HTML omitted --><code>shipper.conf</code><!-- raw HTML omitted -->ã€‚ï¼ˆå¯ä»¥å°†ä¹‹å‰æ‰§è¡Œçš„æ€»æ–‡ä»¶<!-- raw HTML omitted --><code>file.conf</code><!-- raw HTML omitted -->åœæ‰ï¼‰<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ vim shipper.conf
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>file <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span> path <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;/var/log/messages&#34;</span>
</span></span><span style="display:flex;"><span> type <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;system&#34;</span>
</span></span><span style="display:flex;"><span> start_position <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;beginning&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>file <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  path <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;/var/log/elasticsearch/huanqiu.log&#34;</span>
</span></span><span style="display:flex;"><span>  type <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;es-error&#34;</span>
</span></span><span style="display:flex;"><span>  start_position <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;beginning&#34;</span>
</span></span><span style="display:flex;"><span>  codec <span style="color:#f92672">=</span>&gt; multiline <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      pattern <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;^\[&#34;</span>
</span></span><span style="display:flex;"><span>      negate <span style="color:#f92672">=</span>&gt; true
</span></span><span style="display:flex;"><span>      what <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;previous&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>file <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>   path <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;/var/log/nginx/access_json.log&#34;</span>
</span></span><span style="display:flex;"><span>   codec <span style="color:#f92672">=</span>&gt; json
</span></span><span style="display:flex;"><span>   start_position <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;beginning&#34;</span>
</span></span><span style="display:flex;"><span>   type <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;nginx-log&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>syslog <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    type <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;system-syslog&#34;</span>
</span></span><span style="display:flex;"><span>    host <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;192.168.1.160&#34;</span>
</span></span><span style="display:flex;"><span>    port <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;514&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>output <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span>type<span style="color:#f92672">]</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;system&#34;</span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span> redis <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    host <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;192.168.1.160&#34;</span>
</span></span><span style="display:flex;"><span>    port <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6379&#34;</span>
</span></span><span style="display:flex;"><span>    db <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6&#34;</span>
</span></span><span style="display:flex;"><span>    data_type <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;list&#34;</span>
</span></span><span style="display:flex;"><span>    key <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;system&#34;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span>type<span style="color:#f92672">]</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;es-error&#34;</span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  redis <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>   host <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;192.168.1.160&#34;</span>
</span></span><span style="display:flex;"><span>   port <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6379&#34;</span>
</span></span><span style="display:flex;"><span>   db <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6&#34;</span>
</span></span><span style="display:flex;"><span>   data_type <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;list&#34;</span>
</span></span><span style="display:flex;"><span>   key <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;demo&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span>type<span style="color:#f92672">]</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;nginx-log&#34;</span><span style="color:#f92672">{</span>   
</span></span><span style="display:flex;"><span>   redis <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      host <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;192.168.1.160&#34;</span>
</span></span><span style="display:flex;"><span>      port <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6379&#34;</span>
</span></span><span style="display:flex;"><span>      db <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6&#34;</span>
</span></span><span style="display:flex;"><span>      data_type <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;list&#34;</span>
</span></span><span style="display:flex;"><span>      key <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;nginx-log&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span>type<span style="color:#f92672">]</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;system-syslog&#34;</span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>   redis <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      host <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;192.168.1.160&#34;</span>
</span></span><span style="display:flex;"><span>      port <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6379&#34;</span>
</span></span><span style="display:flex;"><span>      db <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6&#34;</span>
</span></span><span style="display:flex;"><span>      data_type <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;list&#34;</span>
</span></span><span style="display:flex;"><span>      key <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;system-syslog&#34;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">}</span>   
</span></span><span style="display:flex;"><span> <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="11">
<li><!-- raw HTML omitted -->æ‰§è¡Œä¸Šé¢çš„æ–‡ä»¶ï¼ˆæå‰å°†ä¸Šé¢ä¹‹å‰å¯åŠ¨çš„<!-- raw HTML omitted --><code>file.conf</code><!-- raw HTML omitted -->æ–‡ä»¶çš„æ‰§è¡Œç»™ç»“æŸæ‰ï¼ï¼‰<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$  /opt/logstash/bin/logstash -f shipper.conf --configtest
</span></span><span style="display:flex;"><span>Configuration OK
</span></span><span style="display:flex;"><span>$ /opt/logstash/bin/logstash -f shipper.conf
</span></span><span style="display:flex;"><span>Settings: Default filter workers: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Logstash startup completed
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åœ¨redisä¸­æŸ¥çœ‹ï¼š</span>
</span></span><span style="display:flex;"><span>$ redis-cli -h 192.168.1.160
</span></span><span style="display:flex;"><span>192.168.1.160:6379&gt; info
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Server</span>
</span></span><span style="display:flex;"><span>redis_version:2.8.19
</span></span><span style="display:flex;"><span>.......
</span></span><span style="display:flex;"><span>.......
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Keyspace</span>
</span></span><span style="display:flex;"><span>db6:keys<span style="color:#f92672">=</span>1,expires<span style="color:#f92672">=</span>0,avg_ttl<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>  	<span style="color:#75715e"># æ˜¾ç¤ºæ˜¯db6</span>
</span></span><span style="display:flex;"><span>192.168.1.160:6379&gt; <span style="color:#66d9ef">select</span> <span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>OK
</span></span><span style="display:flex;"><span>192.168.1.160:6379<span style="color:#f92672">[</span>6<span style="color:#f92672">]</span>&gt; keys *
</span></span><span style="display:flex;"><span>1<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;demo&#34;</span>
</span></span><span style="display:flex;"><span>2<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;system&#34;</span>
</span></span><span style="display:flex;"><span>192.168.1.160:6379<span style="color:#f92672">[</span>6<span style="color:#f92672">]</span>&gt; keys *
</span></span><span style="display:flex;"><span>1<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;nginx-log&#34;</span>
</span></span><span style="display:flex;"><span>2<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;demo&#34;</span>
</span></span><span style="display:flex;"><span>3<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;system&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å¦å¼€ä¸€ä¸ªçª—å£ï¼Œæ·»åŠ ç‚¹æ—¥å¿—:</span>
</span></span><span style="display:flex;"><span>$ logger <span style="color:#e6db74">&#34;12325423&#34;</span>
</span></span><span style="display:flex;"><span>$ logger <span style="color:#e6db74">&#34;12325423&#34;</span>
</span></span><span style="display:flex;"><span>$ logger <span style="color:#e6db74">&#34;12325423&#34;</span>
</span></span><span style="display:flex;"><span>$ logger <span style="color:#e6db74">&#34;12325423&#34;</span>
</span></span><span style="display:flex;"><span>$ logger <span style="color:#e6db74">&#34;12325423&#34;</span>
</span></span><span style="display:flex;"><span>$ logger <span style="color:#e6db74">&#34;12325423&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆä¼šå¢åŠ æ—¥å¿—ï¼š</span>
</span></span><span style="display:flex;"><span>192.168.1.160:6379<span style="color:#f92672">[</span>6<span style="color:#f92672">]</span>&gt; keys *
</span></span><span style="display:flex;"><span>1<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;system-syslog&#34;</span>
</span></span><span style="display:flex;"><span>2<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;nginx-log&#34;</span>
</span></span><span style="display:flex;"><span>3<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;demo&#34;</span>
</span></span><span style="display:flex;"><span>4<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;system&#34;</span></span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="12">
<li><!-- raw HTML omitted -->å¯ä»¥åœ¨ä»»æ„çš„ä¸€å°<!-- raw HTML omitted --><code>ES</code><!-- raw HTML omitted -->ä¸­å°†æ•°æ®ä»<!-- raw HTML omitted --><code>redis</code><!-- raw HTML omitted -->è¯»å–åˆ°<!-- raw HTML omitted --><code>ES</code><!-- raw HTML omitted -->ä¸­ã€‚
ä¸‹é¢å’±ä»¬åœ¨<!-- raw HTML omitted --><code>elk-node2</code><!-- raw HTML omitted -->èŠ‚ç‚¹ï¼Œå°†æ•°æ®ä»<!-- raw HTML omitted --><code>redis</code><!-- raw HTML omitted -->è¯»å–åˆ°<!-- raw HTML omitted --><code>ES</code><!-- raw HTML omitted -->ä¸­ï¼š
ç¼–å†™æ–‡ä»¶ï¼š<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cat file.conf
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>redis <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>   type <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;system&#34;</span>
</span></span><span style="display:flex;"><span>   host <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;192.168.1.160&#34;</span>
</span></span><span style="display:flex;"><span>   port <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6379&#34;</span>
</span></span><span style="display:flex;"><span>   db <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6&#34;</span>
</span></span><span style="display:flex;"><span>   data_type <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;list&#34;</span>
</span></span><span style="display:flex;"><span>   key <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;system&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> redis <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>   type <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;es-error&#34;</span>
</span></span><span style="display:flex;"><span>   host <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;192.168.1.160&#34;</span>
</span></span><span style="display:flex;"><span>   port <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6379&#34;</span>
</span></span><span style="display:flex;"><span>   db <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6&#34;</span>
</span></span><span style="display:flex;"><span>   data_type <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;list&#34;</span>
</span></span><span style="display:flex;"><span>   key <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;es-error&#34;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>   redis <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      type <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;nginx-log&#34;</span>
</span></span><span style="display:flex;"><span>      host <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;192.168.1.160&#34;</span>
</span></span><span style="display:flex;"><span>      port <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6379&#34;</span>
</span></span><span style="display:flex;"><span>      db <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6&#34;</span>
</span></span><span style="display:flex;"><span>      data_type <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;list&#34;</span>
</span></span><span style="display:flex;"><span>      key <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;nginx-log&#34;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>  redis <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      type <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;system-syslog&#34;</span>
</span></span><span style="display:flex;"><span>      host <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;192.168.1.160&#34;</span>
</span></span><span style="display:flex;"><span>      port <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6379&#34;</span>
</span></span><span style="display:flex;"><span>      db <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;6&#34;</span>
</span></span><span style="display:flex;"><span>      data_type <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;list&#34;</span>
</span></span><span style="display:flex;"><span>      key <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;system-syslog&#34;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">}</span>   
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>output <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span>type<span style="color:#f92672">]</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;system&#34;</span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    elasticsearch <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>       hosts <span style="color:#f92672">=</span>&gt; <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;192.168.1.160:9200&#34;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>       index <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;system-%{+YYYY.MM.dd}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span>type<span style="color:#f92672">]</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;es-error&#34;</span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    elasticsearch <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>       hosts <span style="color:#f92672">=</span>&gt; <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;192.168.1.160:9200&#34;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>       index <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;es-error-%{+YYYY.MM.dd}&#34;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span>type<span style="color:#f92672">]</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;nginx-log&#34;</span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>   elasticsearch <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      hosts <span style="color:#f92672">=</span>&gt; <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;192.168.1.160:9200&#34;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>      index <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;nignx-log-%{+YYYY.MM.dd}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span>type<span style="color:#f92672">]</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;system-syslog&#34;</span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    elasticsearch <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>       hosts <span style="color:#f92672">=</span>&gt; <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;192.168.1.160:9200&#34;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>       index <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;system-syslog-%{+YYYY.MM.dd}&#34;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ‰§è¡Œ</span>
</span></span><span style="display:flex;"><span>$ /opt/logstash/bin/logstash -f file.conf --configtest
</span></span><span style="display:flex;"><span>Configuration OK
</span></span><span style="display:flex;"><span>$ /opt/logstash/bin/logstash -f file.conf &amp;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å»redisä¸­æ£€æŸ¥ï¼Œå‘ç°æ•°æ®å·²ç»è¢«è¯»å‡ºåˆ°elasticsearchä¸­äº†ã€åŒæ—¶ç™»é™†logstashå’Œkibanaçœ‹ï¼Œå‘ç°å¯ä»¥æ­£å¸¸æ”¶é›†åˆ°æ—¥å¿—äº†ã€‚</span>
</span></span><span style="display:flex;"><span>192.168.1.160:6379<span style="color:#f92672">[</span>6<span style="color:#f92672">]</span>&gt; keys *
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>empty list or set<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å¯ä»¥æ‰§è¡Œè¿™ä¸ª å»æŸ¥çœ‹nginxæ—¥å¿—ã€ä¹Ÿå¯ä»¥å¯åŠ¨å¤šä¸ªrediså†™åˆ°ESä¸­ï¼Œå…·ä½“æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µè€Œå®šã€‚</span>
</span></span><span style="display:flex;"><span>$ ab -n10000 -c1 http://192.168.1.160/ </span></span></code></pre></div></blockquote>
<hr>

            <footer class="footline">
            </footer>
          </article>

        </div>
      </main>
    </div>
    <script src="../../../../js/clipboard.min.js?1724933324" defer></script>
    <script src="../../../../js/perfect-scrollbar.min.js?1724933324" defer></script>
    <script src="../../../../js/theme.js?1724933324" defer></script>
  </body>
</html>
