<!DOCTYPE html>
<html lang="en" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.125.4">
    <meta name="generator" content="Relearn 6.0.0+tip">
    <meta name="robots" content="noindex, nofollow, noarchive, noimageindex">
    <meta name="description" content="å®‰è£…HAProxy åç§°åœ°å€ æè¿° HAProxyå®˜ç½‘ haproxyã€nginxã€proxy protocolè·å¾—å®¢æˆ·çœŸå®IPæ–¹æ³• è´Ÿè½½å‡è¡¡
HAProxyå¯ä»¥å°†å…¥ç«™è¯·æ±‚åˆ†å‘åˆ°å¤šä¸ªåç«¯æœåŠ¡å™¨ï¼Œå®ç°è´Ÿè½½å‡è¡¡ã€‚å®ƒæ”¯æŒå¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œå¦‚è½®è¯¢round-robinã€æœ€å°è¿æ¥æ•°leastconnã€æºIPå“ˆå¸Œsourceã€æƒé‡ç­‰
é«˜å¯ç”¨æ€§
HAProxyæ”¯æŒå¥åº·æ£€æŸ¥health checksï¼Œå¯ä»¥å®šæœŸæ£€æŸ¥åç«¯æœåŠ¡å™¨çš„çŠ¶æ€ï¼Œå¹¶æ ¹æ®æ£€æŸ¥ç»“æœåŠ¨æ€è°ƒæ•´è´Ÿè½½å‡è¡¡ç­–ç•¥ã€‚å½“åç«¯æœåŠ¡å™¨å‡ºç°æ•…éšœæˆ–ä¸å¯ç”¨æ—¶ï¼ŒHAProxyå¯ä»¥è‡ªåŠ¨å°†æµé‡è½¬ç§»åˆ°å¥åº·çš„æœåŠ¡å™¨ä¸Šï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§">
    <meta name="author" content="äºŒå“¥">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://usermice.github.io/images/s2-1.png">
    <meta name="twitter:title" content="Install_HAProxy :: Hugo Relearn Theme">
    <meta name="twitter:description" content="å®‰è£…HAProxy åç§°åœ°å€ æè¿° HAProxyå®˜ç½‘ haproxyã€nginxã€proxy protocolè·å¾—å®¢æˆ·çœŸå®IPæ–¹æ³• è´Ÿè½½å‡è¡¡
HAProxyå¯ä»¥å°†å…¥ç«™è¯·æ±‚åˆ†å‘åˆ°å¤šä¸ªåç«¯æœåŠ¡å™¨ï¼Œå®ç°è´Ÿè½½å‡è¡¡ã€‚å®ƒæ”¯æŒå¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œå¦‚è½®è¯¢round-robinã€æœ€å°è¿æ¥æ•°leastconnã€æºIPå“ˆå¸Œsourceã€æƒé‡ç­‰
é«˜å¯ç”¨æ€§
HAProxyæ”¯æŒå¥åº·æ£€æŸ¥health checksï¼Œå¯ä»¥å®šæœŸæ£€æŸ¥åç«¯æœåŠ¡å™¨çš„çŠ¶æ€ï¼Œå¹¶æ ¹æ®æ£€æŸ¥ç»“æœåŠ¨æ€è°ƒæ•´è´Ÿè½½å‡è¡¡ç­–ç•¥ã€‚å½“åç«¯æœåŠ¡å™¨å‡ºç°æ•…éšœæˆ–ä¸å¯ç”¨æ—¶ï¼ŒHAProxyå¯ä»¥è‡ªåŠ¨å°†æµé‡è½¬ç§»åˆ°å¥åº·çš„æœåŠ¡å™¨ä¸Šï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§">
    <meta property="og:url" content="https://usermice.github.io/systems/linux/haproxy/install_haproxy/">
    <meta property="og:site_name" content="Hugo Relearn Theme">
    <meta property="og:title" content="Install_HAProxy :: Hugo Relearn Theme">
    <meta property="og:description" content="å®‰è£…HAProxy åç§°åœ°å€ æè¿° HAProxyå®˜ç½‘ haproxyã€nginxã€proxy protocolè·å¾—å®¢æˆ·çœŸå®IPæ–¹æ³• è´Ÿè½½å‡è¡¡
HAProxyå¯ä»¥å°†å…¥ç«™è¯·æ±‚åˆ†å‘åˆ°å¤šä¸ªåç«¯æœåŠ¡å™¨ï¼Œå®ç°è´Ÿè½½å‡è¡¡ã€‚å®ƒæ”¯æŒå¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œå¦‚è½®è¯¢round-robinã€æœ€å°è¿æ¥æ•°leastconnã€æºIPå“ˆå¸Œsourceã€æƒé‡ç­‰
é«˜å¯ç”¨æ€§
HAProxyæ”¯æŒå¥åº·æ£€æŸ¥health checksï¼Œå¯ä»¥å®šæœŸæ£€æŸ¥åç«¯æœåŠ¡å™¨çš„çŠ¶æ€ï¼Œå¹¶æ ¹æ®æ£€æŸ¥ç»“æœåŠ¨æ€è°ƒæ•´è´Ÿè½½å‡è¡¡ç­–ç•¥ã€‚å½“åç«¯æœåŠ¡å™¨å‡ºç°æ•…éšœæˆ–ä¸å¯ç”¨æ—¶ï¼ŒHAProxyå¯ä»¥è‡ªåŠ¨å°†æµé‡è½¬ç§»åˆ°å¥åº·çš„æœåŠ¡å™¨ä¸Šï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§">
    <meta property="og:locale" content="en">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Systems">
    <meta property="article:published_time" content="2024-06-18T12:41:18+08:00">
    <meta property="article:modified_time" content="2024-06-18T12:41:18+08:00">
    <meta property="og:image" content="https://usermice.github.io/images/s2-1.png">
    <meta itemprop="name" content="Install_HAProxy :: Hugo Relearn Theme">
    <meta itemprop="description" content="å®‰è£…HAProxy åç§°åœ°å€ æè¿° HAProxyå®˜ç½‘ haproxyã€nginxã€proxy protocolè·å¾—å®¢æˆ·çœŸå®IPæ–¹æ³• è´Ÿè½½å‡è¡¡
HAProxyå¯ä»¥å°†å…¥ç«™è¯·æ±‚åˆ†å‘åˆ°å¤šä¸ªåç«¯æœåŠ¡å™¨ï¼Œå®ç°è´Ÿè½½å‡è¡¡ã€‚å®ƒæ”¯æŒå¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œå¦‚è½®è¯¢round-robinã€æœ€å°è¿æ¥æ•°leastconnã€æºIPå“ˆå¸Œsourceã€æƒé‡ç­‰
é«˜å¯ç”¨æ€§
HAProxyæ”¯æŒå¥åº·æ£€æŸ¥health checksï¼Œå¯ä»¥å®šæœŸæ£€æŸ¥åç«¯æœåŠ¡å™¨çš„çŠ¶æ€ï¼Œå¹¶æ ¹æ®æ£€æŸ¥ç»“æœåŠ¨æ€è°ƒæ•´è´Ÿè½½å‡è¡¡ç­–ç•¥ã€‚å½“åç«¯æœåŠ¡å™¨å‡ºç°æ•…éšœæˆ–ä¸å¯ç”¨æ—¶ï¼ŒHAProxyå¯ä»¥è‡ªåŠ¨å°†æµé‡è½¬ç§»åˆ°å¥åº·çš„æœåŠ¡å™¨ä¸Šï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§">
    <meta itemprop="datePublished" content="2024-06-18T12:41:18+08:00">
    <meta itemprop="dateModified" content="2024-06-18T12:41:18+08:00">
    <meta itemprop="wordCount" content="373">
    <meta itemprop="image" content="https://usermice.github.io/images/s2-1.png">
    <title>Install_HAProxy :: Hugo Relearn Theme</title>
    <link href="../../../../images/favicon.ico?1734019084" rel="icon" type="image/x-icon" sizes="any">
    <link href="../../../../css/fontawesome-all.min.css?1734019085" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/fontawesome-all.min.css?1734019085" rel="stylesheet"></noscript>
    <link href="../../../../css/nucleus.css?1734019085" rel="stylesheet">
    <link href="../../../../css/auto-complete.css?1734019085" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/auto-complete.css?1734019085" rel="stylesheet"></noscript>
    <link href="../../../../css/perfect-scrollbar.min.css?1734019085" rel="stylesheet">
    <link href="../../../../css/fonts.css?1734019085" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/fonts.css?1734019085" rel="stylesheet"></noscript>
    <link href="../../../../css/theme.css?1734019085" rel="stylesheet">
    <link href="../../../../css/theme-relearn-auto.css?1734019085" rel="stylesheet" id="R-variant-style">
    <link href="../../../../css/chroma-relearn-auto.css?1734019085" rel="stylesheet" id="R-variant-chroma-style">
    <link href="../../../../css/variant.css?1734019085" rel="stylesheet">
    <link href="../../../../css/print.css?1734019085" rel="stylesheet" media="print">
    <link href="../../../../css/format-print.css?1734019085" rel="stylesheet">
    <script src="../../../../js/variant.js?1734019085"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..\/..\/..';
      window.relearn.relBaseUri='..\/..\/..\/..';
      window.relearn.absBaseUri='https:\/\/usermice.github.io';
      window.index_js_url="../../../../index.search.js";
      // variant stuff
      window.variants && variants.init( [ 'relearn-auto', 'relearn-light', 'relearn-dark', 'relearn-bright', 'zen-auto', 'zen-light', 'zen-dark', 'retro-auto', 'neon', 'learn', 'blue', 'green', 'red', 'my-branding' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>Partial intended to be overwritten to add custom headers, like CSS or any other info
<style>
    
</style>


  </head>
  <body class="mobile-support print disableInlineCopyToClipboard" data-url="../../../../systems/linux/haproxy/install_haproxy/">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="show" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>



          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../../../systems/"><span itemprop="name">Systems</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../../../systems/linux/"><span itemprop="name">Linux</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../../../systems/linux/haproxy/"><span itemprop="name">HAProxy</span></a><meta itemprop="position" content="3">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Install_HAProxy</span><meta itemprop="position" content="4"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">


            <div class="topbar-button topbar-button-prev" data-content-empty="show" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="../../../../systems/linux/haproxy/install_proxy/" title="Install_Proxy (ğŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>

            <div class="topbar-button topbar-button-next" data-content-empty="show" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="../../../../systems/linux/install_system/" title="Install_System (ğŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>



          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>

<h1 id="install_haproxy">Install_HAProxy</h1>

<h2 id="å®‰è£…haproxy">å®‰è£…<code>HAProxy</code></h2>
<blockquote>
<table>
<thead>
<tr>
<th>åç§°åœ°å€</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://www.haproxy.org/#desc" rel="external" target="_self"><code>HAProxy</code>å®˜ç½‘</a></td>
<td></td>
</tr>
<tr>
<td><a href="https://www.cnblogs.com/hh2737/p/8951872.html" rel="external" target="_self"><code>haproxyã€nginxã€proxy protocol</code>è·å¾—å®¢æˆ·çœŸå®<code>IP</code>æ–¹æ³•</a></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li>
<p><strong>è´Ÿè½½å‡è¡¡</strong></p>
<p><code>HAProxy</code>å¯ä»¥å°†å…¥ç«™è¯·æ±‚åˆ†å‘åˆ°å¤šä¸ªåç«¯æœåŠ¡å™¨ï¼Œå®ç°è´Ÿè½½å‡è¡¡ã€‚å®ƒæ”¯æŒå¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œå¦‚è½®è¯¢<code>round-robin</code>ã€æœ€å°è¿æ¥æ•°<code>leastconn</code>ã€æºIPå“ˆå¸Œ<code>source</code>ã€æƒé‡ç­‰</p>
</li>
<li>
<p><strong>é«˜å¯ç”¨æ€§</strong></p>
<p><code>HAProxy</code>æ”¯æŒå¥åº·æ£€æŸ¥<code>health checks</code>ï¼Œå¯ä»¥å®šæœŸæ£€æŸ¥åç«¯æœåŠ¡å™¨çš„çŠ¶æ€ï¼Œå¹¶æ ¹æ®æ£€æŸ¥ç»“æœåŠ¨æ€è°ƒæ•´è´Ÿè½½å‡è¡¡ç­–ç•¥ã€‚å½“åç«¯æœåŠ¡å™¨å‡ºç°æ•…éšœæˆ–ä¸å¯ç”¨æ—¶ï¼Œ<code>HAProxy</code>å¯ä»¥è‡ªåŠ¨å°†æµé‡è½¬ç§»åˆ°å¥åº·çš„æœåŠ¡å™¨ä¸Šï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§</p>
</li>
<li>
<p><strong>SSL/TLS ç»ˆç«¯</strong></p>
<p><code>HAProxy</code>å¯ä»¥ä½œä¸º<code>SSL/TLS</code>çš„ç»ˆç«¯<code>Termination</code>ï¼Œè´Ÿè´£å¤„ç†å’Œç®¡ç†ä¼ å…¥å’Œä¼ å‡ºçš„åŠ å¯†æµé‡ã€‚å®ƒæ”¯æŒ<code>SSL</code>æ¡æ‰‹å’Œè¯ä¹¦ç®¡ç†ï¼Œå¯ä»¥æä¾›å®‰å…¨çš„<code>HTTPS</code>æœåŠ¡</p>
</li>
<li>
<p><strong>åå‘ä»£ç†</strong></p>
<p><code>HAProxy</code>ä½œä¸ºåå‘ä»£ç†<code>reverse proxy</code>ï¼Œå¯ä»¥éšè—åç«¯æœåŠ¡å™¨çš„å®é™…<code>IP</code>åœ°å€å’Œç»†èŠ‚ï¼Œæä¾›æ›´å®‰å…¨çš„æœåŠ¡è®¿é—®æ¥å£ã€‚å®¢æˆ·ç«¯è¯·æ±‚é¦–å…ˆåˆ°è¾¾<code>HAProxy</code>ï¼Œå†ç”±<code>HAProxy</code>è½¬å‘åˆ°åç«¯æœåŠ¡å™¨</p>
</li>
<li>
<p><strong><code>TCP</code>å’Œ<code>HTTP</code>æ”¯æŒ</strong></p>
<p><code>HAProxy</code>ä¸ä»…æ”¯æŒ<code>HTTP</code>å’Œ<code>HTTPS</code>æµé‡çš„è´Ÿè½½å‡è¡¡ï¼Œè¿˜å¯ä»¥è´Ÿè´£<code>TCP</code>æµé‡çš„è´Ÿè½½å‡è¡¡ã€‚è¿™ä½¿å¾—å®ƒéå¸¸é€‚åˆäºæ”¯æŒ<code>Web</code>åº”ç”¨ç¨‹åºã€<code>API</code>å’Œå…¶ä»–ç½‘ç»œæœåŠ¡çš„é«˜æ€§èƒ½å’Œé«˜å¯ç”¨æ€§éƒ¨ç½²</p>
</li>
<li>
<p><strong>çµæ´»é…ç½®å’ŒåŠ¨æ€æ›´æ–°</strong></p>
<p><code>HAProxy</code>çš„é…ç½®æ–‡ä»¶æ”¯æŒçµæ´»çš„é…ç½®é€‰é¡¹ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´è´Ÿè½½å‡è¡¡ç­–ç•¥å’Œå‚æ•°ã€‚æ­¤å¤–ï¼Œ<code>HAProxy</code>æ”¯æŒåŠ¨æ€æ›´æ–°é…ç½®ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ï¼Œæ— éœ€é‡å¯æœåŠ¡å³å¯ç”Ÿæ•ˆ</p>
</li>
</ul>
</blockquote>
<ul>
<li>
<ol>
<li><!-- raw HTML omitted -->å®‰è£…é…ç½®<!-- raw HTML omitted --><code>HAProxy</code></li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ yum install -y haproxy</span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="2">
<li><!-- raw HTML omitted -->ä¸¾ä¾‹ï¼šç›‘æ§<!-- raw HTML omitted --><code>Rabbit</code><!-- raw HTML omitted -->æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡é…ç½®<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cat &gt;/etc/haproxy/haproxy.cfg<span style="color:#e6db74">&lt;&lt;-EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">global
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # log /yougo/haproxy/home/log    local0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # log /yougo/haproxy/home/log    local1 notice
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # chroot /yougo/haproxy  	# æ”¹å˜å½“å‰å·¥ä½œç›®å½•
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # stats socket /yougo/haproxy/home/admin.sock mode 660 level admin  	# åˆ›å»ºç›‘æ§æ‰€ç”¨çš„å¥—æ¥å­—ç›®å½•
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> pidfile  /var/run/haproxy.pid  	# haproxyçš„pidå­˜æ”¾è·¯å¾„,å¯åŠ¨è¿›ç¨‹çš„ç”¨æˆ·å¿…é¡»æœ‰æƒé™è®¿é—®æ­¤æ–‡ä»¶ 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> maxconn  4000  	# æœ€å¤§è¿æ¥æ•°ï¼Œé»˜è®¤4000
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> #  user   haproxy  	# é»˜è®¤ç”¨æˆ·
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> #  group   haproxy  	# é»˜è®¤ç”¨æˆ·ç»„
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> daemon  	# åˆ›å»º1ä¸ªè¿›ç¨‹è¿›å…¥deamonæ¨¡å¼è¿è¡Œã€‚æ­¤å‚æ•°è¦æ±‚å°†è¿è¡Œæ¨¡å¼è®¾ç½®ä¸º&#34;daemon
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # Default SSL material locations
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # ca-base /etc/ssl/certs
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # crt-base /etc/ssl/private
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # Default ciphers to use on SSL-enabled listening sockets.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # For more information, see ciphers(1SSL). This list is from:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> #  https://hynek.me/articles/hardening-your-web-servers-ssl-ciphers/
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # ssl-default-bind-ciphers ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:ECDH+3DES:DH+3DES:RSA+AESGCM:RSA+AES:RSA+3DES:!aNULL:!MD5:!DSS
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # ssl-default-bind-options no-sslv3
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">###########é»˜è®¤é…ç½®#########
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">defaults
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> log global
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> mode    http  	# é»˜è®¤çš„æ¨¡å¼mode { tcp|http|health }ï¼Œtcpæ˜¯4å±‚ï¼Œhttpæ˜¯7å±‚ï¼Œhealthåªä¼šè¿”å›OK
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> option  httplog  	# é‡‡ç”¨httpæ—¥å¿—æ ¼å¼
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> option  dontlognull  	# å¯ç”¨è¯¥é¡¹ï¼Œæ—¥å¿—ä¸­å°†ä¸ä¼šè®°å½•ç©ºè¿æ¥ã€‚æ‰€è°“ç©ºè¿æ¥å°±æ˜¯åœ¨ä¸Šæ¸¸çš„è´Ÿè½½å‡è¡¡å™¨æˆ–è€…ç›‘æ§ç³»ç»Ÿä¸ºäº†æ¢æµ‹è¯¥æœåŠ¡æ˜¯å¦å­˜æ´»å¯ç”¨æ—¶,éœ€è¦å®šæœŸçš„è¿æ¥æˆ–è€…è·å–æŸä¸€å›ºå®šçš„ç»„ä»¶æˆ–é¡µé¢,æˆ–è€…æ¢æµ‹æ‰«æç«¯å£æ˜¯å¦åœ¨ç›‘å¬æˆ–å¼€æ”¾ç­‰åŠ¨ä½œè¢«ç§°ä¸ºç©ºè¿æ¥;å®˜æ–¹æ–‡æ¡£ä¸­æ ‡æ³¨ï¼Œå¦‚æœè¯¥æœåŠ¡ä¸Šæ¸¸æ²¡æœ‰å…¶ä»–çš„è´Ÿè½½å‡è¡¡å™¨çš„è¯ï¼Œå»ºè®®ä¸è¦ä½¿ç”¨è¯¥å‚æ•°ï¼Œå› ä¸ºäº’è”ç½‘ä¸Šçš„æ¶æ„æ‰«ææˆ–å…¶ä»–åŠ¨ä½œå°±ä¸ä¼šè¢«è®°å½•ä¸‹æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> timeout connect 5000  	# è¿æ¥è¶…æ—¶æ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> timeout client  50000  	# å®¢æˆ·ç«¯è¿æ¥è¶…æ—¶æ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> timeout server  50000  	# æœåŠ¡å™¨ç«¯è¿æ¥è¶…æ—¶æ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> option  httpclose  	# æ¯æ¬¡è¯·æ±‚å®Œæ¯•åä¸»åŠ¨å…³é—­httpé€šé“ 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> option  httplog  	# æ—¥å¿—ç±»åˆ«httpæ—¥å¿—æ ¼å¼ 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> #option  forwardfor  	# å¦‚æœåç«¯æœåŠ¡å™¨éœ€è¦è·å¾—å®¢æˆ·ç«¯çœŸå®ipéœ€è¦é…ç½®çš„å‚æ•°ï¼Œå¯ä»¥ä»Http Headerä¸­è·å¾—å®¢æˆ·ç«¯ip  
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> option  redispatch  	# serverIdå¯¹åº”çš„æœåŠ¡å™¨æŒ‚æ‰å,å¼ºåˆ¶å®šå‘åˆ°å…¶ä»–å¥åº·çš„æœåŠ¡å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> timeout connect 10000  	# default 10 second timeout if a backend is not found
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> maxconn     60000  	# æœ€å¤§è¿æ¥æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> retries     3  	# 3æ¬¡è¿æ¥å¤±è´¥å°±è®¤ä¸ºæœåŠ¡ä¸å¯ç”¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡åé¢è®¾ç½® 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # errorfile 400 /yougo/haproxy/home/errors/400.http
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # errorfile 403 /yougo/haproxy/home/errors/403.http
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # errorfile 408 /yougo/haproxy/home/errors/408.http
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # errorfile 500 /yougo/haproxy/home/errors/500.http
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # errorfile 502 /yougo/haproxy/home/errors/502.http
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # errorfile 503 /yougo/haproxy/home/errors/503.http
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # errorfile 504 /yougo/haproxy/home/errors/504.http
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">################################################
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">listen http_front
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     bind 0.0.0.0:8888  	# HAProxy æœåŠ¡ç«¯å£  
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     stats refresh 30s  	# ç»Ÿè®¡é¡µé¢è‡ªåŠ¨åˆ·æ–°æ—¶é—´  
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     stats uri /haproxy?stats  	# ç»Ÿè®¡é¡µé¢url  
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     stats realm Haproxy Manager  	# ç»Ÿè®¡é¡µé¢å¯†ç æ¡†ä¸Šæç¤ºæ–‡æœ¬  
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     stats auth admin:admin  	# ç»Ÿè®¡é¡µé¢ç”¨æˆ·åå’Œå¯†ç è®¾ç½®  
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     #stats hide-version  	# éšè—ç»Ÿè®¡é¡µé¢ä¸ŠHAProxyçš„ç‰ˆæœ¬ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">##########  RabbitMQçš„ç®¡ç†ç•Œé¢ä¹Ÿæ”¾åœ¨HAProxyåé¢äº† ################
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#listen rabbitmq_admin 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#    bind 0.0.0.0:8004
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#   server node1 192.168.0.31:15672
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#    server node2 192.168.0.32:15672
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#    server node3 192.168.0.33:15672
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#################################################
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">listen rabbitmq_cluster
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> bind 0.0.0.0:8889  	# rabbitmqé›†ç¾¤è°ƒç”¨çš„ç«¯å£
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> option tcplog
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> mode tcp
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> timeout client  3h
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> timeout server  3h
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> option          clitcpka
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> balance roundrobin  	# è´Ÿè½½å‡è¡¡ç®—æ³•ï¼ˆ#banlance roundrobin è½®è¯¢ï¼Œbalance source ä¿å­˜sessionå€¼ï¼Œæ”¯æŒstatic-rrï¼Œleastconnï¼Œfirstï¼Œuriç­‰å‚æ•°ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # balance url_param userid
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # balance url_param session_id check_post 64
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # balance hdr(User-Agent)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # balance hdr(host)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # balance hdr(Host) use_domain_only
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # balance rdp-cookie
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # balance leastconn
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> # balance source //ip
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> server   rabbitmq1  172.16.0.30:5672 check inter 5s rise 2 fall 3  	# check inter 2000 æ˜¯æ£€æµ‹å¿ƒè·³é¢‘ç‡ï¼Œrise 2æ˜¯2æ¬¡æ­£ç¡®è®¤ä¸ºæœåŠ¡å™¨å¯ç”¨ï¼Œfall 3æ˜¯3æ¬¡å¤±è´¥è®¤ä¸ºæœåŠ¡å™¨ä¸å¯ç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> server   rabbitmq2  172.16.0.31:5672 check inter 5s rise 2 fall 3  
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> server   rabbitmq3  172.16.0.32:5672 check inter 5s rise 2 fall 3
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span> </span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="3">
<li><!-- raw HTML omitted -->å¯åŠ¨<!-- raw HTML omitted --><code>HAProxy</code></li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ systemctl enable haproxy <span style="color:#f92672">&amp;&amp;</span> systemctl start haproxy</span></span></code></pre></div></blockquote>
<hr>

            <footer class="footline">
            </footer>
          </article>

        </div>
      </main>
    </div>
    <script src="../../../../js/clipboard.min.js?1734019085" defer></script>
    <script src="../../../../js/perfect-scrollbar.min.js?1734019085" defer></script>
    <script src="../../../../js/theme.js?1734019085" defer></script>
  </body>
</html>
