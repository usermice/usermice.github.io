<!DOCTYPE html>
<html lang="en" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.125.4">
    <meta name="generator" content="Relearn 6.0.0+tip">
    <meta name="robots" content="noindex, nofollow, noarchive, noimageindex">
    <meta name="description" content="ä½¿ç”¨Rabbitmq Rabbitmqæ·»åŠ ç™»å½•è´¦æˆ· åœ¨/etc/rabbitmq/rabbitmq.configé…ç½®æ–‡ä»¶ä¸‹æ·»åŠ ï¼Œå¦‚æœä¸å­˜åœ¨å°±è‡ªè¡Œåˆ›å»ºæ·»åŠ  adminå°±æ˜¯ç”¨æˆ·åç§° $ cat /etc/rabbitmq/rabbitmq.config [ {rabbit,[{tcp_listeners,[5672]},{loopback_users,[&#34;admin&#34;]}]} ] ä½¿ç”¨å‘½ä»¤æ·»åŠ ç”¨æˆ·å¹¶æˆæƒ æ·»åŠ ç”¨æˆ· $ rabbitmqctl add_user admin admin è®¾ç½®permissions $ rabbitmqctl set_permissions -p &#34;/&#34; admin &#34;.">
    <meta name="author" content="äºŒå“¥">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://erge.blog/images/s2-1.png">
    <meta name="twitter:title" content="Configure_Rabbitmq :: Hugo Relearn Theme">
    <meta name="twitter:description" content="ä½¿ç”¨Rabbitmq Rabbitmqæ·»åŠ ç™»å½•è´¦æˆ· åœ¨/etc/rabbitmq/rabbitmq.configé…ç½®æ–‡ä»¶ä¸‹æ·»åŠ ï¼Œå¦‚æœä¸å­˜åœ¨å°±è‡ªè¡Œåˆ›å»ºæ·»åŠ  adminå°±æ˜¯ç”¨æˆ·åç§° $ cat /etc/rabbitmq/rabbitmq.config [ {rabbit,[{tcp_listeners,[5672]},{loopback_users,[&#34;admin&#34;]}]} ] ä½¿ç”¨å‘½ä»¤æ·»åŠ ç”¨æˆ·å¹¶æˆæƒ æ·»åŠ ç”¨æˆ· $ rabbitmqctl add_user admin admin è®¾ç½®permissions $ rabbitmqctl set_permissions -p &#34;/&#34; admin &#34;.">
    <meta property="og:url" content="https://erge.blog/systems/linux/message_queue/configure_rabbitmq/">
    <meta property="og:site_name" content="Hugo Relearn Theme">
    <meta property="og:title" content="Configure_Rabbitmq :: Hugo Relearn Theme">
    <meta property="og:description" content="ä½¿ç”¨Rabbitmq Rabbitmqæ·»åŠ ç™»å½•è´¦æˆ· åœ¨/etc/rabbitmq/rabbitmq.configé…ç½®æ–‡ä»¶ä¸‹æ·»åŠ ï¼Œå¦‚æœä¸å­˜åœ¨å°±è‡ªè¡Œåˆ›å»ºæ·»åŠ  adminå°±æ˜¯ç”¨æˆ·åç§° $ cat /etc/rabbitmq/rabbitmq.config [ {rabbit,[{tcp_listeners,[5672]},{loopback_users,[&#34;admin&#34;]}]} ] ä½¿ç”¨å‘½ä»¤æ·»åŠ ç”¨æˆ·å¹¶æˆæƒ æ·»åŠ ç”¨æˆ· $ rabbitmqctl add_user admin admin è®¾ç½®permissions $ rabbitmqctl set_permissions -p &#34;/&#34; admin &#34;.">
    <meta property="og:locale" content="en">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Systems">
    <meta property="article:published_time" content="2024-06-20T21:22:58+08:00">
    <meta property="article:modified_time" content="2024-06-20T21:22:58+08:00">
    <meta property="og:image" content="https://erge.blog/images/s2-1.png">
    <meta itemprop="name" content="Configure_Rabbitmq :: Hugo Relearn Theme">
    <meta itemprop="description" content="ä½¿ç”¨Rabbitmq Rabbitmqæ·»åŠ ç™»å½•è´¦æˆ· åœ¨/etc/rabbitmq/rabbitmq.configé…ç½®æ–‡ä»¶ä¸‹æ·»åŠ ï¼Œå¦‚æœä¸å­˜åœ¨å°±è‡ªè¡Œåˆ›å»ºæ·»åŠ  adminå°±æ˜¯ç”¨æˆ·åç§° $ cat /etc/rabbitmq/rabbitmq.config [ {rabbit,[{tcp_listeners,[5672]},{loopback_users,[&#34;admin&#34;]}]} ] ä½¿ç”¨å‘½ä»¤æ·»åŠ ç”¨æˆ·å¹¶æˆæƒ æ·»åŠ ç”¨æˆ· $ rabbitmqctl add_user admin admin è®¾ç½®permissions $ rabbitmqctl set_permissions -p &#34;/&#34; admin &#34;.">
    <meta itemprop="datePublished" content="2024-06-20T21:22:58+08:00">
    <meta itemprop="dateModified" content="2024-06-20T21:22:58+08:00">
    <meta itemprop="wordCount" content="1463">
    <meta itemprop="image" content="https://erge.blog/images/s2-1.png">
    <title>Configure_Rabbitmq :: Hugo Relearn Theme</title>
    <link href="../../../../images/favicon.ico?1721046092" rel="icon" type="image/x-icon" sizes="any">
    <link href="../../../../css/fontawesome-all.min.css?1721046093" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/fontawesome-all.min.css?1721046093" rel="stylesheet"></noscript>
    <link href="../../../../css/nucleus.css?1721046093" rel="stylesheet">
    <link href="../../../../css/auto-complete.css?1721046093" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/auto-complete.css?1721046093" rel="stylesheet"></noscript>
    <link href="../../../../css/perfect-scrollbar.min.css?1721046093" rel="stylesheet">
    <link href="../../../../css/fonts.css?1721046093" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/fonts.css?1721046093" rel="stylesheet"></noscript>
    <link href="../../../../css/theme.css?1721046093" rel="stylesheet">
    <link href="../../../../css/theme-relearn-auto.css?1721046093" rel="stylesheet" id="R-variant-style">
    <link href="../../../../css/chroma-relearn-auto.css?1721046093" rel="stylesheet" id="R-variant-chroma-style">
    <link href="../../../../css/variant.css?1721046093" rel="stylesheet">
    <link href="../../../../css/print.css?1721046093" rel="stylesheet" media="print">
    <link href="../../../../css/format-print.css?1721046093" rel="stylesheet">
    <script src="../../../../js/variant.js?1721046093"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..\/..\/..';
      window.relearn.relBaseUri='..\/..\/..\/..';
      window.relearn.absBaseUri='https:\/\/erge.blog';
      window.index_js_url="../../../../index.search.js";
      // variant stuff
      window.variants && variants.init( [ 'relearn-auto', 'relearn-light', 'relearn-dark', 'relearn-bright', 'zen-auto', 'zen-light', 'zen-dark', 'retro-auto', 'neon', 'learn', 'blue', 'green', 'red', 'my-branding' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>Partial intended to be overwritten to add custom headers, like CSS or any other info
<style>
    
</style>


  </head>
  <body class="mobile-support print disableInlineCopyToClipboard" data-url="../../../../systems/linux/message_queue/configure_rabbitmq/">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="show" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>



          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../../../systems/"><span itemprop="name">Systems</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../../../systems/linux/"><span itemprop="name">Linux</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../../../systems/linux/message_queue/"><span itemprop="name">Message_Queue</span></a><meta itemprop="position" content="3">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Configure_Rabbitmq</span><meta itemprop="position" content="4"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">


            <div class="topbar-button topbar-button-prev" data-content-empty="show" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="../../../../systems/linux/message_queue/install_kafka/" title="Install_Kafka (ğŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>

            <div class="topbar-button topbar-button-next" data-content-empty="show" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="../../../../systems/linux/monitor/" title="Monitor (ğŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>



          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>

<h1 id="configure_rabbitmq">Configure_Rabbitmq</h1>

<h2 id="ä½¿ç”¨rabbitmq">ä½¿ç”¨<code>Rabbitmq</code></h2>
<h3 id="rabbitmqæ·»åŠ ç™»å½•è´¦æˆ·"><code>Rabbitmq</code>æ·»åŠ ç™»å½•è´¦æˆ·</h3>
<blockquote>
<ul>
<li><!-- raw HTML omitted -->åœ¨<!-- raw HTML omitted --><code>/etc/rabbitmq/rabbitmq.config</code><!-- raw HTML omitted -->é…ç½®æ–‡ä»¶ä¸‹æ·»åŠ ï¼Œ<!-- raw HTML omitted -->å¦‚æœä¸å­˜åœ¨å°±è‡ªè¡Œåˆ›å»º<!-- raw HTML omitted -->æ·»åŠ <!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li><code>admin</code><!-- raw HTML omitted -->å°±æ˜¯ç”¨æˆ·åç§°<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cat /etc/rabbitmq/rabbitmq.config
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">{</span>rabbit,<span style="color:#f92672">[{</span>tcp_listeners,<span style="color:#f92672">[</span>5672<span style="color:#f92672">]}</span>,<span style="color:#f92672">{</span>loopback_users,<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;admin&#34;</span><span style="color:#f92672">]}]}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">]</span></span></span></code></pre></div></blockquote>
</blockquote>
<ul>
<li><!-- raw HTML omitted -->ä½¿ç”¨å‘½ä»¤æ·»åŠ ç”¨æˆ·å¹¶æˆæƒ æ·»åŠ ç”¨æˆ·<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ rabbitmqctl add_user admin admin</span></span></code></pre></div></blockquote>
<ul>
<li><!-- raw HTML omitted -->è®¾ç½®<!-- raw HTML omitted --><code>permissions</code></li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ rabbitmqctl set_permissions -p <span style="color:#e6db74">&#34;/&#34;</span> admin <span style="color:#e6db74">&#34;.*&#34;</span> <span style="color:#e6db74">&#34;.*&#34;</span> <span style="color:#e6db74">&#34;.*&#34;</span></span></span></code></pre></div></blockquote>
<ul>
<li><!-- raw HTML omitted -->è®¾ç½®ç”¨æˆ·è§’è‰²<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ rabbitmqctl set_user_tags admin administrator</span></span></code></pre></div></blockquote>
<ul>
<li><!-- raw HTML omitted -->æŸ¥çœ‹æ–°æ·»åŠ çš„<!-- raw HTML omitted --><code>admin</code></li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ rabbitmqctl list_users</span></span></code></pre></div></blockquote>
<ul>
<li><!-- raw HTML omitted -->æŸ¥çœ‹ç”¨äºçš„æƒé™<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ./rabbitmqctl list_permissions -p /</span></span></code></pre></div></blockquote>
</blockquote>
<hr>
<h3 id="rabbitmqé—®é¢˜"><code>RabbitMQ</code>é—®é¢˜</h3>
<h4 id="rabbitmqæ— æ³•æ–°å»ºè¿æ¥é—®é¢˜å¤„ç†è¿‡ç¨‹è®°å½•"><code>RabbitMQ</code>æ— æ³•æ–°å»ºè¿æ¥é—®é¢˜å¤„ç†è¿‡ç¨‹è®°å½•</h4>
<blockquote>
<ul>
<li><!-- raw HTML omitted -->ç—‡çŠ¶æè¿°<!-- raw HTML omitted -->å®¢æˆ·åé¦ˆæ— æ³•äº‘å¹³å°<code>VNC</code>æ§åˆ¶å°çª—å£ä¸€ç›´å¤„äº<code>loading</code>çŠ¶æ€ï¼Œæ— æ³•æ‰“å¼€.</li>
<li>å®šä½è¿‡ç¨‹</li>
</ul>
<blockquote>
<ul>
<li><!-- raw HTML omitted -->é¦–å…ˆæŸ¥çœ‹<!-- raw HTML omitted --><code>nova-api</code><!-- raw HTML omitted -->æœåŠ¡æ˜¯å¦æ­£å¸¸<!-- raw HTML omitted --><code>nova list</code><!-- raw HTML omitted -->æ­£å¸¸<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->æŸ¥çœ‹<!-- raw HTML omitted --><code>nova service-list</code><!-- raw HTML omitted -->è¾“å‡ºï¼Œæ‰€æœ‰æœåŠ¡åœ¨çº¿<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->ä½¿ç”¨<!-- raw HTML omitted --><code>nova get-vnc-console</code><!-- raw HTML omitted -->è·å–äº‘ä¸»æœº<!-- raw HTML omitted --><code>vnc</code><!-- raw HTML omitted -->é“¾æ¥ï¼Œè¶…æ—¶æ— æ³•è·å–<!-- raw HTML omitted --></li>
</ul>
</blockquote>
<ul>
<li>åˆæ­¥æ‰¾åˆ°æ§åˆ¶å°çª—å£æ— æ³•æ‰“å¼€çš„åŸå› ï¼Œç»§ç»­åˆ†æé—®é¢˜</li>
</ul>
<blockquote>
<ul>
<li><!-- raw HTML omitted -->æŸ¥çœ‹äº‘ä¸»æœºæ‰€åœ¨èŠ‚ç‚¹çš„<!-- raw HTML omitted --><code>nova-compute</code><!-- raw HTML omitted -->æœåŠ¡ï¼Œä¸€åˆ‡æ­£å¸¸<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->æŸ¥çœ‹<!-- raw HTML omitted --><code>nova-compute</code><!-- raw HTML omitted -->æ—¥å¿—ï¼Œæ²¡æœ‰æ”¶åˆ°åˆ›å»º<!-- raw HTML omitted --><code>vnc</code><!-- raw HTML omitted -->é“¾æ¥è¯·æ±‚<!-- raw HTML omitted --><code>vnc</code><!-- raw HTML omitted -->æ§åˆ¶å°é“¾æ¥æ˜¯åœ¨äº‘ä¸»æœºæ‰€åœ¨è®¡ç®—èŠ‚ç‚¹ç”Ÿæˆçš„ï¼Œå› ä¸ºè¦æŸ¥è¯¢äº‘ä¸»æœº<!-- raw HTML omitted --><code>qemu</code><!-- raw HTML omitted -->è¿›ç¨‹åˆ›å»ºçš„<!-- raw HTML omitted --><code>vnc server</code><!-- raw HTML omitted -->ç«¯å£å·ï¼Œåˆ›å»ºå®Œæˆåè¦æŠŠ<!-- raw HTML omitted --><code>token</code><!-- raw HTML omitted -->å’Œç«¯å£å·å¯¹åº”å…³ç³»ä¿å­˜åˆ°<!-- raw HTML omitted --><code>nova-consoleauth</code><!-- raw HTML omitted -->è¿›ç¨‹ï¼Œ<!-- raw HTML omitted --><code>nova-consoleauth</code><!-- raw HTML omitted -->è¿›ç¨‹ä¼šæ ¹æ®é…ç½®é¡¹å†³å®šæŠŠå¯¹åº”å…³ç³»ä¿å­˜åˆ°è¿›ç¨‹å†…å­˜è¿˜æ˜¯<!-- raw HTML omitted --><code>memcache</code><!-- raw HTML omitted -->æœåŠ¡ï¼Œä¹‹å‰å¤„ç†è¿‡ä¸€æ¬¡æ§åˆ¶èŠ‚ç‚¹å†…å­˜ä¸è¶³å¯¼è‡´<!-- raw HTML omitted --><code>token</code><!-- raw HTML omitted -->ä¿å­˜å¤±è´¥çš„é—®é¢˜ï¼Œè¿™æ¬¡ä¹Ÿå…ˆæŸ¥äº†ä¸‹<!-- raw HTML omitted --><code>nova-consoleauth</code><!-- raw HTML omitted -->æ—¥å¿—ï¼Œæ²¡æœ‰å‘ç°ç±»ä¼¼æƒ…å†µ<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->æŸ¥çœ‹<!-- raw HTML omitted --><code>nova-api</code><!-- raw HTML omitted -->èŠ‚ç‚¹æ—¥å¿—ï¼Œå‘ç°æ”¶åˆ°äº†è¯·æ±‚ä½†æ²¡æœ‰è¿”å›<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->æ‰“å¼€<!-- raw HTML omitted --><code>nova-api</code><!-- raw HTML omitted -->å’Œ<!-- raw HTML omitted --><code>nova-compute</code><!-- raw HTML omitted -->çš„<!-- raw HTML omitted --><code>debug</code><!-- raw HTML omitted -->æ—¥å¿—ç»§ç»­åˆ†æ<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->å‘ç°<!-- raw HTML omitted --><code>nova-api</code><!-- raw HTML omitted -->ä¸€ç›´åœ¨å°è¯•è¿æ¥åˆ°<!-- raw HTML omitted --><code>RabbitMQ</code><!-- raw HTML omitted -->ï¼Œä¸€ç›´å¡åœ¨<!-- raw HTML omitted --><code>connecting</code><!-- raw HTML omitted -->ï¼Œæ²¡æœ‰<!-- raw HTML omitted --><code>connected</code><!-- raw HTML omitted -->æ—¥å¿—<!-- raw HTML omitted --></li>
</ul>
</blockquote>
<ul>
<li>æ‰¾åˆ°æ›´è¿›ä¸€æ­¥çš„é—®é¢˜åŸå› ï¼Œç»§ç»­åˆ†æé—®é¢˜</li>
</ul>
<blockquote>
<ul>
<li><!-- raw HTML omitted -->é¦–å…ˆé‡å¯<!-- raw HTML omitted --><code>nova-api</code><!-- raw HTML omitted -->æœåŠ¡ï¼Œè¯•éªŒä¸‹èƒ½å¦æ¢å¤ï¼Œå‘ç°å¯åŠ¨è¿›ç¨‹æ—¶å¯ä»¥è¿æ¥åˆ°<!-- raw HTML omitted --><code>MQ</code>ï¼Œ<!-- raw HTML omitted -->ä½†è·å–<!-- raw HTML omitted --><code>vnc</code><!-- raw HTML omitted -->é“¾æ¥æ—¶é—®é¢˜ä»ç„¶å­˜åœ¨<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->é€šè¿‡<!-- raw HTML omitted --><code>rabbitmqctl</code><!-- raw HTML omitted -->å‘½ä»¤è¡ŒæŸ¥çœ‹<!-- raw HTML omitted --><code>queue</code><!-- raw HTML omitted -->å’Œ<!-- raw HTML omitted --><code>exchange</code><!-- raw HTML omitted -->æƒ…å†µï¼Œä¹Ÿæ²¡å‘ç°å¼‚å¸¸ï¼Œäº‘ä¸»æœºèŠ‚ç‚¹çš„<!-- raw HTML omitted --><code>compute</code><!-- raw HTML omitted -->é˜Ÿåˆ—ä¹Ÿæœ‰<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->é‡å¯<!-- raw HTML omitted --><code>MQ</code><!-- raw HTML omitted -->æœåŠ¡ï¼Œè¯•éªŒèƒ½å¦æ¢å¤ï¼Œé‡å¯åå‘ç°<!-- raw HTML omitted --><code>vnc</code><!-- raw HTML omitted -->é“¾æ¥è·å–å‘½ä»¤æ¢å¤æ­£å¸¸ï¼Œé¡µé¢æ‰“å¼€æ§åˆ¶å°çª—å£æ­£å¸¸<!-- raw HTML omitted --></li>
</ul>
</blockquote>
<ul>
<li>é—®é¢˜è§£å†³ä½†æ²¡æ‰¾åˆ°åŸå› ï¼Œäºæ˜¯ç»§ç»­è§‚å¯Ÿï¼Œç­‰äº†å¤§æ¦‚2åˆ†é’Ÿï¼Œå†æ¬¡å°è¯•æ‰“å¼€<code>vnc</code>æ§åˆ¶å°çª—å£ï¼Œå‘ç°è€é—®é¢˜è¿˜åœ¨ï¼Œä¸€ç›´<code>loading</code>ï¼Œç»§ç»­åˆ†æé—®é¢˜ï¼Œ</li>
</ul>
<blockquote>
<ul>
<li><!-- raw HTML omitted -->æŸ¥çœ‹<!-- raw HTML omitted --><code>MQ</code><!-- raw HTML omitted -->æœåŠ¡å™¨æ—¥å¿—ï¼Œå‘ç°å¼‚å¸¸<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->å‘ç°é—®é¢˜æ ¹æœ¬åŸå› ï¼Œæ–‡ä»¶å¥æŸ„æ•°é‡è¶…å‡ºé™åˆ¶ï¼Œ<!-- raw HTML omitted --><code>google</code><!-- raw HTML omitted -->æœç´¢è¿™ä¸ªé”™è¯¯ï¼Œå‘ç°äº†è§£å†³æ–¹æ³•<!-- raw HTML omitted --><a href="https://my.oschina.net/moooofly/blog/678513" rel="external" target="_self">åŸåˆ›<code>RabbitMQ</code>ä¹‹<code>file descriptor limit alarm</code>åˆ†æ</a></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0"><code>=WARNING REPORT==== 25-Oct-2017::10:35:48 ===
file descriptor limit alarm set.

********************************************************************
*** New connections will not be accepted until this alarm clears ***
********************************************************************</code></pre></div></blockquote>
<ul>
<li><!-- raw HTML omitted -->é¦–å…ˆä¿®æ”¹<!-- raw HTML omitted --><code>MQ</code><!-- raw HTML omitted -->èŠ‚ç‚¹ç‰©ç†æœºæ–‡ä»¶å¥æŸ„æ•°é‡é…ç½®ï¼ˆå¢åŠ å¦‚ä¸‹ä¸¤è¡Œï¼‰<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cat /etc/security/limits.conf  | grep nofile
</span></span><span style="display:flex;"><span>* soft nofile <span style="color:#ae81ff">262144</span>
</span></span><span style="display:flex;"><span>* hard nofile <span style="color:#ae81ff">262144</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ ulimit -n <span style="color:#ae81ff">65536</span>  	<span style="color:#75715e"># ä¹Ÿä¿®æ”¹</span></span></span></code></pre></div></blockquote>
<ul>
<li>é‡å¯<code>RabbitMQ</code>ï¼Œ<code>rabbitmqctl status</code>å‘½ä»¤æŸ¥çœ‹é™åˆ¶ï¼Œå‘ç°ä¸ç”Ÿæ•ˆï¼š</li>
</ul>
<blockquote>
<ul>
<li><!-- raw HTML omitted -->æŒ‰ç…§æœç´¢ç»“æœä¸­çš„æç¤ºæ‰§è¡Œï¼š<!-- raw HTML omitted --><code>rabbitmqctl stopã€rabbitmq-server -detached</code><!-- raw HTML omitted -->å†æ¬¡æŸ¥çœ‹ï¼Œå‘ç°å¥æŸ„æ•°é™åˆ¶å·²ä¿®æ”¹<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->å°è¯•<!-- raw HTML omitted --><code>web</code><!-- raw HTML omitted -->æ‰“å¼€<!-- raw HTML omitted --><code>vnc</code><!-- raw HTML omitted -->çª—å£ï¼Œå‘ç°æ¢å¤æ­£å¸¸ï¼Œ<!-- raw HTML omitted --><code>nova-api</code><!-- raw HTML omitted -->å’Œ<!-- raw HTML omitted --><code>nova-compute</code><!-- raw HTML omitted -->æ—¥å¿—æ­£å¸¸<!-- raw HTML omitted --><code>connected</code><!-- raw HTML omitted -->åˆ°<!-- raw HTML omitted --><code>MQ</code><!-- raw HTML omitted -->ç­‰å¾…å‡ åˆ†é’Ÿä»ç„¶æ­£å¸¸ï¼Œé—®é¢˜è§£å†³<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0"><code> {file_descriptors,
     [{total_limit,924},
      {total_used,525},</code></pre></div></blockquote>
<ul>
<li>å°è¯•ä¿®æ”¹å®‰è£…éƒ¨ç½²è„šæœ¬ï¼Œå‘ç°å…ˆä¿®æ”¹ç³»ç»Ÿå¥æŸ„æ•°é…ç½®å†å®‰è£…<code>MQ</code>ï¼Œä»ç„¶æ— æ³•ä¿®æ”¹<code>MQ</code>å¥æŸ„é™åˆ¶
ç»§ç»­<code>google</code>ï¼Œ<a href="https://www.rabbitmq.com/install-rpm.html" rel="external" target="_self">æŸ¥çœ‹åˆ°<code>RabbitMQ</code>å®˜æ–¹æ–‡æ¡£</a> æœ‰å¦‚ä¸‹æè¿°ï¼š</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0"><code>æ§åˆ¶ Linux ä¸Šçš„ç³»ç»Ÿé™åˆ¶

è¿è¡Œç”Ÿäº§å·¥ä½œè´Ÿè½½çš„ RabbitMQ å®‰è£…å¯èƒ½éœ€è¦ç³»ç»Ÿé™åˆ¶å’Œå†…æ ¸å‚æ•°è°ƒæ•´ï¼Œä»¥ä¾¿å¤„ç†ç›¸å½“æ•°é‡çš„å¹¶å‘è¿æ¥å’Œé˜Ÿåˆ—ã€‚éœ€è¦è°ƒæ•´çš„ä¸»è¦è®¾ç½®æ˜¯æœ€å¤§æ‰“å¼€æ–‡ä»¶æ•°ï¼Œä¹Ÿç§°ä¸ºulimit -nã€‚è®¸å¤šæ“ä½œç³»ç»Ÿä¸Šçš„é»˜è®¤å€¼å¯¹äºæ¶ˆæ¯ä¼ é€’ä»£ç†æ¥è¯´å¤ªä½äº†ï¼ˆä¾‹å¦‚ï¼Œåœ¨å‡ ä¸ª Linux å‘è¡Œç‰ˆä¸Šä¸º 1024ï¼‰ã€‚æˆ‘ä»¬å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¸ºç”¨æˆ· rabbitmq å…è®¸è‡³å°‘ 65536 ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚å¯¹äºå¤§å¤šæ•°å¼€å‘å·¥ä½œè´Ÿè½½ï¼Œ4096 åº”è¯¥è¶³å¤Ÿäº†ã€‚

æœ‰ä¸¤ä¸ªé™åˆ¶ï¼šæ“ä½œç³»ç»Ÿå†…æ ¸å…è®¸æ‰“å¼€æ–‡ä»¶çš„æœ€å¤§æ•°é‡ï¼ˆfs.file-maxï¼‰å’Œæ¯ä¸ªç”¨æˆ·çš„é™åˆ¶ï¼ˆulimit -nï¼‰ã€‚å‰è€…å¿…é¡»é«˜äºåè€…ã€‚

ä½¿ç”¨ systemdï¼ˆæœ€è¿‘çš„ Linux å‘è¡Œç‰ˆï¼‰

åœ¨ä½¿ç”¨ systemd çš„å‘è¡Œç‰ˆä¸Šï¼Œæ“ä½œç³»ç»Ÿé™åˆ¶æ˜¯é€šè¿‡ /etc/systemd/system/rabbitmq-server.service.d/limits.conf ä¸­çš„é…ç½®æ–‡ä»¶æ§åˆ¶çš„ï¼Œä¾‹å¦‚ï¼š

[Service]
LimitNOFILE=300000</code></pre></div></blockquote>
<ul>
<li>æ®æ­¤ä¿®æ”¹æ­£å¸¸</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ mkdir /etc/systemd/system/rabbitmq-server.service.d -p
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ cat  &gt;/etc/systemd/system/rabbitmq-server.service.d/limits.conf<span style="color:#e6db74">&lt;&lt;EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[Service]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">LimitNOFILE=300000
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ setenforce <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ sed -i <span style="color:#e6db74">&#34;s#enforcing#disabled#g&#34;</span>  /etc/selinux/config
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ cat &gt;/etc/security/limits.conf<span style="color:#e6db74">&lt;&lt;EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">* soft nofile 204800
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">* hard nofile 204800
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ ulimit -n <span style="color:#ae81ff">204800</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ systemctl daemon-reload
</span></span><span style="display:flex;"><span>$ systemctl restart rabbitmq-server.service</span></span></code></pre></div></blockquote>
</blockquote>
<hr>
<h3 id="zabbixç›‘æ§-rabbitmq"><code>Zabbix</code>ç›‘æ§<code> Rabbitmq</code></h3>
<blockquote>
<ul>
<li><a href="http://www.lstop.pub/2016/10/10/%E8%87%AA%E5%B7%B1%E5%86%99%E4%B8%80%E4%B8%AA%E7%9B%91%E6%8E%A7RabbitMQ%E7%9A%84%E8%84%9A%E6%9C%AC/" rel="external" target="_self"><code>Rabbitmq-python</code>ç›‘æ§è„šæœ¬</a></li>
<li><code>RabbitMQ</code>è‡ªå·±å·²ç»æœ‰ä¸€ä¸ªæŒºå¥½çš„ç®¡ç†ç›‘æ§ç•Œé¢ï¼Œå¯ä»¥çœ‹åˆ°éå¸¸è¯¦ç»†çš„æ¶ˆæ¯é˜Ÿåˆ—ä¿¡æ¯ï¼Œä½†æ˜¯å¯¹äºè¿ç»´äººå‘˜æ¥è¯´ï¼Œè¿˜ç¼ºå°‘äº†å¾ˆé‡è¦çš„å‘Šè­¦åŠŸèƒ½ã€‚ è‡ªå·±å†™ä¸€ä¸ªè„šæœ¬ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œåœ¨ç½‘ä¸Šä¹Ÿæœ‰å¾ˆå¤šå‚è€ƒï¼Œä¸»è¦æ€è·¯æ˜¯åˆ©ç”¨<code>RabbitMQ</code>è‡ªå¸¦ç®¡ç†æ¨¡å—çš„<code>RESTful API</code>å–å€¼ï¼Œå‘é€åˆ°<code>zabbix</code>ï¼Œç”±<code>zabbix</code>è´Ÿè´£å‘Šè­¦é˜€å€¼åˆ¤æ–­å’Œå‘é€å‘Šè­¦</li>
<li><!-- raw HTML omitted --><code>RabbitMQ RESTful API</code><!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li>é¦–å…ˆè®¤è¯†<code>RabbitMQ</code>çš„<code>API</code>ï¼Œçœ‹çœ‹èƒ½å–åˆ°ä»€ä¹ˆï¼Œæ¨èçœ‹å®˜æ–¹<code>help</code></li>
<li><!-- raw HTML omitted -->æŸ¥çœ‹<!-- raw HTML omitted --><code>MQ</code><!-- raw HTML omitted -->æ€»ä½“æƒ…å†µ<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li>å®˜æ–¹è§£æï¼š<code>/api/overview Various random bits of information that describe the whole system</code></li>
<li>ä¾‹å­ï¼š<code>curl -u guest:guest http://192.168.55.241:15672/api/overview</code> ç„¶åè¿”å›dçš„<code>json</code>æ ¼å¼å“åº”æ˜¯ï¼š</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;management_version&#34;</span>: <span style="color:#e6db74">&#34;3.0.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;statistics_level&#34;</span>: <span style="color:#e6db74">&#34;fine&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;exchange_types&#34;</span>: [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;topic&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;AMQP topic exchange, as per the AMQP specification&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;enabled&#34;</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;fanout&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;AMQP fanout exchange, as per the AMQP specification&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;enabled&#34;</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;direct&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;AMQP direct exchange, as per the AMQP specification&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;enabled&#34;</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;headers&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;AMQP headers exchange, as per the AMQP specification&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;enabled&#34;</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;rabbitmq_version&#34;</span>: <span style="color:#e6db74">&#34;3.0.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;erlang_version&#34;</span>: <span style="color:#e6db74">&#34;R15B01&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;message_stats&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;publish&#34;</span>: <span style="color:#ae81ff">1104833</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;publish_details&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;rate&#34;</span>: <span style="color:#ae81ff">12.262779782167032</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;interval&#34;</span>: <span style="color:#ae81ff">298146914019</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;last_event&#34;</span>: <span style="color:#ae81ff">1476068131606</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;ack&#34;</span>: <span style="color:#ae81ff">1177571</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;ack_details&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;rate&#34;</span>: <span style="color:#ae81ff">11.230039450092189</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;interval&#34;</span>: <span style="color:#ae81ff">57927468985</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;last_event&#34;</span>: <span style="color:#ae81ff">1476068130882</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;deliver&#34;</span>: <span style="color:#ae81ff">1177572</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;deliver_details&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;rate&#34;</span>: <span style="color:#ae81ff">11.027518607238914</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;interval&#34;</span>: <span style="color:#ae81ff">57927468985</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;last_event&#34;</span>: <span style="color:#ae81ff">1476068130882</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;deliver_get&#34;</span>: <span style="color:#ae81ff">1207878</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;deliver_get_details&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;rate&#34;</span>: <span style="color:#ae81ff">11.027518607238914</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;interval&#34;</span>: <span style="color:#ae81ff">57927468985</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;last_event&#34;</span>: <span style="color:#ae81ff">1476068130882</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;deliver_no_ack&#34;</span>: <span style="color:#ae81ff">30306</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;deliver_no_ack_details&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;rate&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;interval&#34;</span>: <span style="color:#ae81ff">1067361970</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;last_event&#34;</span>: <span style="color:#ae81ff">1476068115093</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;redeliver&#34;</span>: <span style="color:#ae81ff">8</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;redeliver_details&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;rate&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;interval&#34;</span>: <span style="color:#ae81ff">115179973</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;last_event&#34;</span>: <span style="color:#ae81ff">1476068099504</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;queue_totals&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;messages&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;messages_ready&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;messages_unacknowledged&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;messages_details&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;rate&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;interval&#34;</span>: <span style="color:#ae81ff">255911999</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;last_event&#34;</span>: <span style="color:#ae81ff">1476068131232</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;messages_ready_details&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;rate&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;interval&#34;</span>: <span style="color:#ae81ff">255911999</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;last_event&#34;</span>: <span style="color:#ae81ff">1476068131232</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;messages_unacknowledged_details&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;rate&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;interval&#34;</span>: <span style="color:#ae81ff">255911999</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;last_event&#34;</span>: <span style="color:#ae81ff">1476068131232</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;object_totals&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;consumers&#34;</span>: <span style="color:#ae81ff">70</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;queues&#34;</span>: <span style="color:#ae81ff">27</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;exchanges&#34;</span>: <span style="color:#ae81ff">13</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;connections&#34;</span>: <span style="color:#ae81ff">176</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;channels&#34;</span>: <span style="color:#ae81ff">236</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;node&#34;</span>: <span style="color:#e6db74">&#34;rabbit@rabbit01&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;statistics_db_node&#34;</span>: <span style="color:#e6db74">&#34;rabbit@rabbit01&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;listeners&#34;</span>: [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;node&#34;</span>: <span style="color:#e6db74">&#34;rabbit@rabbit01&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;protocol&#34;</span>: <span style="color:#e6db74">&#34;amqp&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;ip_address&#34;</span>: <span style="color:#e6db74">&#34;::&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;port&#34;</span>: <span style="color:#ae81ff">5672</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;contexts&#34;</span>: [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;node&#34;</span>: <span style="color:#e6db74">&#34;rabbit@rabbit01&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;RabbitMQ Management&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;path&#34;</span>: <span style="color:#e6db74">&#34;/&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;port&#34;</span>: <span style="color:#ae81ff">15672</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;node&#34;</span>: <span style="color:#e6db74">&#34;rabbit@rabbit01&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;Redirect to port 15672&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;path&#34;</span>: <span style="color:#e6db74">&#34;/&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;port&#34;</span>: <span style="color:#ae81ff">55672</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;ignore_in_use&#34;</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div></blockquote>
</blockquote>
<ul>
<li><!-- raw HTML omitted -->æŸ¥çœ‹å•ä¸ªé˜Ÿåˆ—<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li>å®˜æ–¹è§£æï¼š<code>/api/queues/vhost/name An individual queue. To PUT a queue, you will need a body looking something like this: {â€œauto_deleteâ€:false,â€durableâ€:true,â€argumentsâ€:[],â€nodeâ€:â€rabbit@smacmullenâ€} All keys are optional</code></li>
<li>ä¾‹å­ï¼š<code>%2Fä»£è¡¨vhostä¸º/ curl -u guest:guest http://192.168.55.241:15672/api/queues/%2F/wxq.msgweb.push.wgw.0</code> ç„¶åè¿”å›dçš„<code>json</code>æ ¼å¼å“åº”æ˜¯ï¼š</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;policy&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;exclusive_consumer_tag&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;messages_ready&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;messages_unacknowledged&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;messages&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;consumers&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;active_consumers&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;memory&#34;</span>: <span style="color:#ae81ff">55680</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;backing_queue_status&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;q1&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;q2&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;delta&#34;</span>: [
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;delta&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;undefined&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;undefined&#34;</span>
</span></span><span style="display:flex;"><span>        ],
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;q3&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;q4&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;len&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;pending_acks&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;target_ram_count&#34;</span>: <span style="color:#e6db74">&#34;infinity&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;ram_msg_count&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;ram_ack_count&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;next_seq_id&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;persistent_count&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;avg_ingress_rate&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;avg_egress_rate&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;avg_ack_ingress_rate&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;avg_ack_egress_rate&#34;</span>: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;messages_details&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;rate&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;interval&#34;</span>: <span style="color:#ae81ff">10001981</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;last_event&#34;</span>: <span style="color:#ae81ff">1476068574166</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;messages_ready_details&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;rate&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;interval&#34;</span>: <span style="color:#ae81ff">10001981</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;last_event&#34;</span>: <span style="color:#ae81ff">1476068574166</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;messages_unacknowledged_details&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;rate&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;interval&#34;</span>: <span style="color:#ae81ff">10001981</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;last_event&#34;</span>: <span style="color:#ae81ff">1476068574166</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;incoming&#34;</span>: [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;stats&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;publish&#34;</span>: <span style="color:#ae81ff">763</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;publish_details&#34;</span>: {
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#34;rate&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#34;interval&#34;</span>: <span style="color:#ae81ff">75305976</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#34;last_event&#34;</span>: <span style="color:#ae81ff">1476068545922</span>
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;exchange&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;wxq_appmsg_exchange&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;vhost&#34;</span>: <span style="color:#e6db74">&#34;/&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;deliveries&#34;</span>: [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;stats&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;deliver_get&#34;</span>: <span style="color:#ae81ff">774</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;deliver_get_details&#34;</span>: {
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#34;rate&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#34;interval&#34;</span>: <span style="color:#ae81ff">44411017</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#34;last_event&#34;</span>: <span style="color:#ae81ff">1476068470753</span>
</span></span><span style="display:flex;"><span>                },
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;deliver_no_ack&#34;</span>: <span style="color:#ae81ff">774</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;deliver_no_ack_details&#34;</span>: {
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#34;rate&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#34;interval&#34;</span>: <span style="color:#ae81ff">44411017</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#34;last_event&#34;</span>: <span style="color:#ae81ff">1476068470753</span>
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;channel_details&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;192.168.65.158:64326 -&gt; 192.168.55.241:5672 (1)&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;number&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;connection_name&#34;</span>: <span style="color:#e6db74">&#34;192.168.65.158:64326 -&gt; 192.168.55.241:5672&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;peer_port&#34;</span>: <span style="color:#ae81ff">64326</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;peer_host&#34;</span>: <span style="color:#e6db74">&#34;192.168.65.158&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;message_stats&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;deliver_get&#34;</span>: <span style="color:#ae81ff">774</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;deliver_get_details&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;rate&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;interval&#34;</span>: <span style="color:#ae81ff">44411017</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;last_event&#34;</span>: <span style="color:#ae81ff">1476068470753</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;deliver_no_ack&#34;</span>: <span style="color:#ae81ff">774</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;deliver_no_ack_details&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;rate&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;interval&#34;</span>: <span style="color:#ae81ff">44411017</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;last_event&#34;</span>: <span style="color:#ae81ff">1476068470753</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;publish&#34;</span>: <span style="color:#ae81ff">763</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;publish_details&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;rate&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;interval&#34;</span>: <span style="color:#ae81ff">75305976</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;last_event&#34;</span>: <span style="color:#ae81ff">1476068545922</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;consumer_details&#34;</span>: [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;channel_details&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;192.168.65.158:64326 -&gt; 192.168.55.241:5672 (1)&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;number&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;connection_name&#34;</span>: <span style="color:#e6db74">&#34;192.168.65.158:64326 -&gt; 192.168.55.241:5672&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;peer_port&#34;</span>: <span style="color:#ae81ff">64326</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;peer_host&#34;</span>: <span style="color:#e6db74">&#34;192.168.65.158&#34;</span>
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;queue_details&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;wxq.msgweb.push.wgw.0&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;vhost&#34;</span>: <span style="color:#e6db74">&#34;/&#34;</span>
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;consumer_tag&#34;</span>: <span style="color:#e6db74">&#34;amq.ctag-jKVWrQSs7dbX9VaFfOZiYA&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;exclusive&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;ack_required&#34;</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;wxq.msgweb.push.wgw.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;vhost&#34;</span>: <span style="color:#e6db74">&#34;/&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;durable&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;auto_delete&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;arguments&#34;</span>: {},
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;node&#34;</span>: <span style="color:#e6db74">&#34;rabbit@rabbit01&#34;</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div></blockquote>
</blockquote>
<hr>
<h4 id="zabbix-sender"><code>zabbix sender</code></h4>
<blockquote>
<ul>
<li><code>zabbix sender</code>åŒºåˆ«äºåœ¨<code>zabbix agent</code>æ·»åŠ <code>item</code>ï¼Œ<code>sender</code>å¯ä»¥ä¸»åŠ¨å‘é€<code>item</code>å€¼åˆ°<code>zabbix server</code>
å¯ä»¥å…ˆè§„åˆ’å¥½åœ¨<code>zabbix server</code>ä¸­ä½¿ç”¨çš„<code>host</code>å’Œ<code>item</code>åå­—</li>
<li><!-- raw HTML omitted -->ä¾‹å¦‚ï¼š<!-- raw HTML omitted -->è¿™æ ·å°±å¯ä»¥é€šè¿‡pythonå–å€¼ï¼Œä¿å­˜åœ¨ä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œå†<code>send</code>åˆ°<code>zabbix server</code></li>
</ul>
<blockquote>
<ul>
<li><code>rabbitmq.[rabbit@wx-pro-server01,messages_ready]</code>å¾…å¤„ç†æ¶ˆæ¯æ€»æ•°</li>
<li><code>rabbitmq.[rabbit@wx-pro-server01,messages_unacknowledged]</code>æœªæ”¶åˆ°<code>ack</code>å“åº”æ¶ˆæ¯æ€»æ•°</li>
<li><code>rabbitmq.queues[/,queue_messages_ready,wxq_msg_send] wxq_msg_send</code>é˜Ÿåˆ—çš„å¾…å¤„ç†æ¶ˆæ¯æ•°</li>
<li><code>rabbitmq.queues[/,queue_active_consumers,wxq_msg_send] wxq_msg_send</code>é˜Ÿåˆ—çš„æ´»åŠ¨è¿æ¥æ•°</li>
</ul>
</blockquote>
<ul>
<li><code>zabbix_sender</code><!-- raw HTML omitted -->ä½¿ç”¨æ–¹æ³•<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li><code>-c</code>ï¼š<code>agent</code><!-- raw HTML omitted -->é…ç½®æ–‡ä»¶<!-- raw HTML omitted --></li>
<li><code>-i</code> ï¼š<!-- raw HTML omitted -->ä¸´æ—¶æ–‡ä»¶ï¼Œç”¨äºä¿å­˜å¤šä¸ª<!-- raw HTML omitted --><code>item</code><!-- raw HTML omitted -->å’Œå¯¹åº”å€¼ï¼Œæ¯è¡Œä¸€ä¸ª<!-- raw HTML omitted --><code>item</code></li>
<li><code>-s</code>ï¼š<!-- raw HTML omitted -->åœ¨<!-- raw HTML omitted --><code>zabbix server</code><!-- raw HTML omitted -->ä¸Šé…ç½®çš„<!-- raw HTML omitted --><code>host</code><!-- raw HTML omitted -->åå­—<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>/usr/bin/zabbix_sender -c /etc/zabbix/zabbix_agentd.conf -i /tmp/tmp5ai4uI -s ser01-rabbitmq</span></span></code></pre></div></blockquote>
</blockquote>
<hr>
<h4 id="pythonä»£ç "><code>python</code>ä»£ç </h4>
<blockquote>
<ul>
<li><a href="https://blog.51cto.com/john88wang/1745824" rel="external" target="_self">ä½¿ç”¨<code>Zabbix</code>ç›‘æ§<code>RabbitMQ</code></a></li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/python</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># coding=utf-8</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">RabbitMqç›‘æ§è„šæœ¬ v1.0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">v1.1 ç›‘æ§channelçš„unacknowledged
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">v1.0 ç›‘æ§overviewã€queue
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> urllib2
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> socket
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> tempfile
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> logging
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> subprocess
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> optparse
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span>logging<span style="color:#f92672">.</span>basicConfig(filename<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;/var/log/zabbix/rabbitmq_zabbix.log&#39;</span>, level<span style="color:#f92672">=</span>logging<span style="color:#f92672">.</span>WARNNING, format<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%(asctime)s</span><span style="color:#e6db74"> </span><span style="color:#e6db74">%(levelname)s</span><span style="color:#e6db74">: </span><span style="color:#e6db74">%(message)s</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RabbitMqApi</span>(object):
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39; è°ƒç”¨RabbitMQçš„APIç±» &#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">######## json.loads()  transfer json data to python data</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">######## json.dump()   transfer python data to json data</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> __init__(self, user_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;guest&#39;</span>, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;guest&#39;</span>, host_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;192.168.55.241&#39;</span>, 
</span></span><span style="display:flex;"><span>           protocol<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;http&#39;</span>, port<span style="color:#f92672">=</span><span style="color:#ae81ff">15672</span>, senderhostname<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;ser01-rabbitmq&#39;</span>,
</span></span><span style="display:flex;"><span>                       zbconf<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;/etc/zabbix/zabbix_agentd.conf&#39;</span>):
</span></span><span style="display:flex;"><span>self<span style="color:#f92672">.</span>user_name <span style="color:#f92672">=</span> user_name
</span></span><span style="display:flex;"><span>self<span style="color:#f92672">.</span>password <span style="color:#f92672">=</span> password
</span></span><span style="display:flex;"><span>self<span style="color:#f92672">.</span>host_name <span style="color:#f92672">=</span> host_name <span style="color:#f92672">or</span> socket<span style="color:#f92672">.</span>gethostname()
</span></span><span style="display:flex;"><span>self<span style="color:#f92672">.</span>protocol <span style="color:#f92672">=</span> protocol
</span></span><span style="display:flex;"><span>self<span style="color:#f92672">.</span>port <span style="color:#f92672">=</span> port
</span></span><span style="display:flex;"><span>self<span style="color:#f92672">.</span>senderhostname <span style="color:#f92672">=</span> senderhostname <span style="color:#66d9ef">if</span> senderhostname <span style="color:#66d9ef">else</span> host_name
</span></span><span style="display:flex;"><span>self<span style="color:#f92672">.</span>conf <span style="color:#f92672">=</span> zbconf
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è°ƒç”¨RabbitMQçš„APIç±»å–åŸå§‹æ•°æ®ï¼Œjsonæ ¼å¼</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">call_api</span>(self, path):
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  All URIs will server only resource of type application/json,and will require HTTP basic authentication. The default username and password is guest/guest.  /</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">f is encoded for the default virtual host &#39;/&#39; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{0}</span><span style="color:#e6db74">://</span><span style="color:#e6db74">{1}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{2}</span><span style="color:#e6db74">/api/</span><span style="color:#e6db74">{3}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(self<span style="color:#f92672">.</span>protocol, self<span style="color:#f92672">.</span>host_name, self<span style="color:#f92672">.</span>port, path)
</span></span><span style="display:flex;"><span>password_mgr <span style="color:#f92672">=</span> urllib2<span style="color:#f92672">.</span>HTTPPasswordMgrWithDefaultRealm()
</span></span><span style="display:flex;"><span>password_mgr<span style="color:#f92672">.</span>add_password(<span style="color:#66d9ef">None</span>, url, self<span style="color:#f92672">.</span>user_name, self<span style="color:#f92672">.</span>password)
</span></span><span style="display:flex;"><span>handler <span style="color:#f92672">=</span> urllib2<span style="color:#f92672">.</span>HTTPBasicAuthHandler(password_mgr)
</span></span><span style="display:flex;"><span>logging<span style="color:#f92672">.</span>debug(<span style="color:#e6db74">&#39;Issue a rabbit API call to get data on &#39;</span> <span style="color:#f92672">+</span> url)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">return</span> json<span style="color:#f92672">.</span>loads(urllib2<span style="color:#f92672">.</span>build_opener(handler)<span style="color:#f92672">.</span>open(url)<span style="color:#f92672">.</span>read())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è°ƒç”¨RabbitMQçš„APIç±»å–åŸå§‹æ•°æ®ï¼Œjsonæ ¼å¼</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">call_api_queue</span>(self, queue_name):
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  get queue detail
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{0}</span><span style="color:#e6db74">://</span><span style="color:#e6db74">{1}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{2}</span><span style="color:#e6db74">/api/queues/</span><span style="color:#e6db74">%2F</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{3}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(self<span style="color:#f92672">.</span>protocol, self<span style="color:#f92672">.</span>host_name, self<span style="color:#f92672">.</span>port, queue_name)
</span></span><span style="display:flex;"><span>password_mgr <span style="color:#f92672">=</span> urllib2<span style="color:#f92672">.</span>HTTPPasswordMgrWithDefaultRealm()
</span></span><span style="display:flex;"><span>password_mgr<span style="color:#f92672">.</span>add_password(<span style="color:#66d9ef">None</span>, url, self<span style="color:#f92672">.</span>user_name, self<span style="color:#f92672">.</span>password)
</span></span><span style="display:flex;"><span>handler <span style="color:#f92672">=</span> urllib2<span style="color:#f92672">.</span>HTTPBasicAuthHandler(password_mgr)
</span></span><span style="display:flex;"><span>logging<span style="color:#f92672">.</span>debug(<span style="color:#e6db74">&#39;Issue a rabbit API call to get data on &#39;</span> <span style="color:#f92672">+</span> url)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">return</span> json<span style="color:#f92672">.</span>loads(urllib2<span style="color:#f92672">.</span>build_opener(handler)<span style="color:#f92672">.</span>open(url)<span style="color:#f92672">.</span>read())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">call_api_channel</span>(self, channel_name):
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  get channel detail
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{0}</span><span style="color:#e6db74">://</span><span style="color:#e6db74">{1}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{2}</span><span style="color:#e6db74">/api/channels/</span><span style="color:#e6db74">{3}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(self<span style="color:#f92672">.</span>protocol, self<span style="color:#f92672">.</span>host_name, self<span style="color:#f92672">.</span>port, urllib2<span style="color:#f92672">.</span>quote(channel_name))
</span></span><span style="display:flex;"><span>password_mgr <span style="color:#f92672">=</span> urllib2<span style="color:#f92672">.</span>HTTPPasswordMgrWithDefaultRealm()
</span></span><span style="display:flex;"><span>password_mgr<span style="color:#f92672">.</span>add_password(<span style="color:#66d9ef">None</span>, url, self<span style="color:#f92672">.</span>user_name, self<span style="color:#f92672">.</span>password)
</span></span><span style="display:flex;"><span>handler <span style="color:#f92672">=</span> urllib2<span style="color:#f92672">.</span>HTTPBasicAuthHandler(password_mgr)
</span></span><span style="display:flex;"><span>logging<span style="color:#f92672">.</span>debug(<span style="color:#e6db74">&#39;Issue a rabbit API call to get data on &#39;</span> <span style="color:#f92672">+</span> url)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">return</span> json<span style="color:#f92672">.</span>loads(urllib2<span style="color:#f92672">.</span>build_opener(handler)<span style="color:#f92672">.</span>open(url)<span style="color:#f92672">.</span>read())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æŠŠæ•°æ®ä¸itemå¯¹åº”å†™è¿›ä¸´æ—¶æ–‡ä»¶</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_get_queue_data</span>(self, queue, tmpfile):
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> [ <span style="color:#e6db74">&#39;memory&#39;</span>,<span style="color:#e6db74">&#39;messages&#39;</span>,<span style="color:#e6db74">&#39;messages_ready&#39;</span>,<span style="color:#e6db74">&#39;messages_unacknowledged&#39;</span>,<span style="color:#e6db74">&#39;consumers&#39;</span>,<span style="color:#e6db74">&#39;active_consumers&#39;</span> ]:
</span></span><span style="display:flex;"><span><span style="color:#75715e">#key = rabbitmq.queues[/,queue_memory,queue.helloWorld]</span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#34;rabbitmq.queues[</span><span style="color:#e6db74">{0}</span><span style="color:#e6db74">,queue_</span><span style="color:#e6db74">{1}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{2}</span><span style="color:#e6db74">]&#34;&#39;</span><span style="color:#f92672">.</span>format(queue[<span style="color:#e6db74">&#39;vhost&#39;</span>], item, queue[<span style="color:#e6db74">&#39;name&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#75715e">### if item is in queue,value=queue[item],else value=0</span>
</span></span><span style="display:flex;"><span>value <span style="color:#f92672">=</span> queue<span style="color:#f92672">.</span>get(item, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>logging<span style="color:#f92672">.</span>debug(<span style="color:#e6db74">&#34;SENDER_DATA: - </span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (key,value))
</span></span><span style="display:flex;"><span>tmpfile<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;- </span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> </span><span style="color:#e6db74">%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (key, value))
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  This is a non standard bit of information added after the standard items</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> [<span style="color:#e6db74">&#39;deliver_get&#39;</span>, <span style="color:#e6db74">&#39;publish&#39;</span>]:
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#34;rabbitmq.queues[</span><span style="color:#e6db74">{0}</span><span style="color:#e6db74">,queue_message_stats_</span><span style="color:#e6db74">{1}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{2}</span><span style="color:#e6db74">]&#34;&#39;</span><span style="color:#f92672">.</span>format(queue[<span style="color:#e6db74">&#39;vhost&#39;</span>], item, queue[<span style="color:#e6db74">&#39;name&#39;</span>])
</span></span><span style="display:flex;"><span>value <span style="color:#f92672">=</span> queue<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;message_stats&#39;</span>, {})<span style="color:#f92672">.</span>get(item, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>logging<span style="color:#f92672">.</span>debug(<span style="color:#e6db74">&#34;SENDER_DATA: - </span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (key,value))
</span></span><span style="display:flex;"><span>tmpfile<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;- </span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> </span><span style="color:#e6db74">%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (key, value))
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä½¿ç”¨zabbix_senderæŠŠitemå‘é€åˆ°zabbix server</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_send_queue_data</span>(self, tmpfile):
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;Send the queue data to Zabbix.&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;Get key value from temp file. &#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>args <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/usr/bin/zabbix_sender -c </span><span style="color:#e6db74">{0}</span><span style="color:#e6db74"> -i </span><span style="color:#e6db74">{1}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>senderhostname:
</span></span><span style="display:flex;"><span>args <span style="color:#f92672">=</span> args <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; -s &#34;</span> <span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>senderhostname
</span></span><span style="display:flex;"><span>return_code <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>process <span style="color:#f92672">=</span> subprocess<span style="color:#f92672">.</span>Popen(args<span style="color:#f92672">.</span>format(self<span style="color:#f92672">.</span>conf, tmpfile<span style="color:#f92672">.</span>name),
</span></span><span style="display:flex;"><span>                                  shell<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, stdout<span style="color:#f92672">=</span>subprocess<span style="color:#f92672">.</span>PIPE,
</span></span><span style="display:flex;"><span>                                  stderr<span style="color:#f92672">=</span>subprocess<span style="color:#f92672">.</span>PIPE)
</span></span><span style="display:flex;"><span>out, err <span style="color:#f92672">=</span> process<span style="color:#f92672">.</span>communicate()
</span></span><span style="display:flex;"><span>logging<span style="color:#f92672">.</span>debug(<span style="color:#e6db74">&#34;Finished sending data&#34;</span>)
</span></span><span style="display:flex;"><span>return_code <span style="color:#f92672">=</span> process<span style="color:#f92672">.</span>wait()
</span></span><span style="display:flex;"><span>logging<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#34;Found return code of &#34;</span> <span style="color:#f92672">+</span> str(return_code))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> return_code <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>logging<span style="color:#f92672">.</span>warning(out)
</span></span><span style="display:flex;"><span>logging<span style="color:#f92672">.</span>warning(err)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>logging<span style="color:#f92672">.</span>debug(err)
</span></span><span style="display:flex;"><span>logging<span style="color:#f92672">.</span>debug(out)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">return</span> return_code
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check_queue</span>(self, queueName):
</span></span><span style="display:flex;"><span>rdatafile <span style="color:#f92672">=</span> tempfile<span style="color:#f92672">.</span>NamedTemporaryFile(delete<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>return_code <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>queue <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>call_api_queue(queueName)
</span></span><span style="display:flex;"><span>self<span style="color:#f92672">.</span>_get_queue_data(queue, rdatafile)
</span></span><span style="display:flex;"><span>self<span style="color:#f92672">.</span>_get_channel_data(queue, rdatafile)
</span></span><span style="display:flex;"><span>rdatafile<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>return_code <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_send_queue_data(rdatafile)
</span></span><span style="display:flex;"><span>os<span style="color:#f92672">.</span>unlink(rdatafile<span style="color:#f92672">.</span>name)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">return</span> return_code
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check_overview</span>(self):
</span></span><span style="display:flex;"><span>return_code <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>rdatafile <span style="color:#f92672">=</span> tempfile<span style="color:#f92672">.</span>NamedTemporaryFile(delete<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>queue <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>call_api(<span style="color:#e6db74">&#39;overview&#39;</span>)
</span></span><span style="display:flex;"><span>self<span style="color:#f92672">.</span>_get_overview_data(queue, rdatafile)
</span></span><span style="display:flex;"><span>rdatafile<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>return_code <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_send_queue_data(rdatafile)
</span></span><span style="display:flex;"><span>os<span style="color:#f92672">.</span>unlink(rdatafile<span style="color:#f92672">.</span>name)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">return</span> return_code
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_get_overview_data</span>(self, queue, tmpfile):
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> [<span style="color:#e6db74">&#39;publish_details&#39;</span>, <span style="color:#e6db74">&#39;ack_details&#39;</span>, <span style="color:#e6db74">&#39;deliver_get_details&#39;</span>]:
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;rabbitmq.[</span><span style="color:#e6db74">{0}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{1}</span><span style="color:#e6db74">_rate]&#34;</span><span style="color:#f92672">.</span>format(queue[<span style="color:#e6db74">&#39;node&#39;</span>], item)
</span></span><span style="display:flex;"><span>value <span style="color:#f92672">=</span> queue<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;message_stats&#39;</span>)<span style="color:#f92672">.</span>get(item)<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;rate&#39;</span>, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>logging<span style="color:#f92672">.</span>debug(<span style="color:#e6db74">&#34;SENDER_DATA: - </span><span style="color:#e6db74">{0}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">{1:.2f}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(key, value))
</span></span><span style="display:flex;"><span>tmpfile<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;- </span><span style="color:#e6db74">{0}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">{1:.2f}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(key, value))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> [<span style="color:#e6db74">&#39;messages&#39;</span>,<span style="color:#e6db74">&#39;messages_ready&#39;</span>,<span style="color:#e6db74">&#39;messages_unacknowledged&#39;</span>]:
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;rabbitmq.[</span><span style="color:#e6db74">{0}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{1}</span><span style="color:#e6db74">]&#34;</span><span style="color:#f92672">.</span>format(queue[<span style="color:#e6db74">&#39;node&#39;</span>], item)
</span></span><span style="display:flex;"><span>value <span style="color:#f92672">=</span> queue<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;queue_totals&#39;</span>)<span style="color:#f92672">.</span>get(item,<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>logging<span style="color:#f92672">.</span>debug(<span style="color:#e6db74">&#34;SENDER_DATA: - </span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (key,value))
</span></span><span style="display:flex;"><span>tmpfile<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;- </span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> </span><span style="color:#e6db74">%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (key, value))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_get_channel_data</span>(self, queue, tmpfile): 
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">ä»queueè·å–queue nameå’Œchannel nameï¼Œç»„è£…zabbixçš„k-vå¹¶å†™è¿›ä¸´æ—¶æ–‡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> ch_detail <span style="color:#f92672">in</span> queue[<span style="color:#e6db74">&#39;consumer_details&#39;</span>]:
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;rabbitmq.[</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">]&#34;</span><span style="color:#f92672">.</span>format(queue[<span style="color:#e6db74">&#39;name&#39;</span>], ch_detail<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;channel_details&#39;</span>)<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;name&#39;</span>,<span style="color:#e6db74">&#39;no_name&#39;</span>))
</span></span><span style="display:flex;"><span>value <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_get_channel_ack(ch_detail<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;channel_details&#39;</span>)<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;name&#39;</span>,<span style="color:#e6db74">&#39;no_name&#39;</span>))
</span></span><span style="display:flex;"><span>logging<span style="color:#f92672">.</span>debug(<span style="color:#e6db74">&#34;SENDER_DATA: - </span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (key,value))
</span></span><span style="display:flex;"><span>tmpfile<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;- </span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> </span><span style="color:#e6db74">%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (key, value))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_get_channel_ack</span>(self, channel_name):
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">ä½¿ç”¨apiè·å–messages_unacknowledgedå€¼
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>d <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>call_api_channel(channel_name)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">return</span> d[<span style="color:#e6db74">&#39;messages_unacknowledged&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;Command-line parameters and decoding for Zabbix use/consumption.&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#testapi = RabbitMqApi()</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#testapi.check_queue(&#39;wxq_msg_send&#39;)</span>
</span></span><span style="display:flex;"><span>parser <span style="color:#f92672">=</span> optparse<span style="color:#f92672">.</span>OptionParser()
</span></span><span style="display:flex;"><span>parser<span style="color:#f92672">.</span>add_option(<span style="color:#e6db74">&#39;-u&#39;</span>, <span style="color:#e6db74">&#39;--username&#39;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;RabbitMQ API username,default=guest&#39;</span>,default<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;guest&#39;</span>)
</span></span><span style="display:flex;"><span>parser<span style="color:#f92672">.</span>add_option(<span style="color:#e6db74">&#39;-p&#39;</span>, <span style="color:#e6db74">&#39;--password&#39;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;RabbitMQ API password,default=guest&#39;</span>,default<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;guest&#39;</span>)
</span></span><span style="display:flex;"><span>parser<span style="color:#f92672">.</span>add_option(<span style="color:#e6db74">&#39;--mqhost&#39;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;RabbitMQ API hostname,default=hostname&#39;</span>,default<span style="color:#f92672">=</span>socket<span style="color:#f92672">.</span>gethostname())
</span></span><span style="display:flex;"><span>parser<span style="color:#f92672">.</span>add_option(<span style="color:#e6db74">&#39;--protocol&#39;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;RabbitMQ API protocol,default=http&#39;</span>,default<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;http&#39;</span>)
</span></span><span style="display:flex;"><span>parser<span style="color:#f92672">.</span>add_option(<span style="color:#e6db74">&#39;--port&#39;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;RabbitMQ API port,default=15672&#39;</span>,default<span style="color:#f92672">=</span><span style="color:#ae81ff">15672</span>)
</span></span><span style="display:flex;"><span>parser<span style="color:#f92672">.</span>add_option(<span style="color:#e6db74">&#39;--host&#39;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Zabbix Host name which the item belongs to,no default&#39;</span>)
</span></span><span style="display:flex;"><span>parser<span style="color:#f92672">.</span>add_option(<span style="color:#e6db74">&#39;--conf&#39;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Zabbix agent configure file,default=/etc/zabbix/zabbix_agentd.conf&#39;</span>,default<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;/etc/zabbix/zabbix_agentd.conf&#39;</span>)
</span></span><span style="display:flex;"><span>parser<span style="color:#f92672">.</span>add_option(<span style="color:#e6db74">&#39;--queue&#39;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;RabbitMQ queue which you want to check,no default&#39;</span>)
</span></span><span style="display:flex;"><span>parser<span style="color:#f92672">.</span>add_option(<span style="color:#e6db74">&#39;-o&#39;</span>,<span style="color:#e6db74">&#39;--overview&#39;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;check RabbitMQ overview&#39;</span>,action<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;store_true&#34;</span>)
</span></span><span style="display:flex;"><span>parser<span style="color:#f92672">.</span>add_option(<span style="color:#e6db74">&#39;-c&#39;</span>,<span style="color:#e6db74">&#39;--count&#39;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;How many times to execute command&#39;</span>, type<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int&#39;</span>, default<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>parser<span style="color:#f92672">.</span>add_option(<span style="color:#e6db74">&#39;-i&#39;</span>,<span style="color:#e6db74">&#39;--interval&#39;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Command execute interval&#39;</span>, type<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;int&#39;</span>, default<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>(options, args) <span style="color:#f92672">=</span> parser<span style="color:#f92672">.</span>parse_args()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> options<span style="color:#f92672">.</span>host:
</span></span><span style="display:flex;"><span>parser<span style="color:#f92672">.</span>error(<span style="color:#e6db74">&#34;è¯·è¾“å…¥zabbixé‡Œå®šä¹‰çš„hostname&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">elif</span> (<span style="color:#f92672">not</span> options<span style="color:#f92672">.</span>queue <span style="color:#f92672">and</span> <span style="color:#f92672">not</span> options<span style="color:#f92672">.</span>overview):
</span></span><span style="display:flex;"><span>parser<span style="color:#f92672">.</span>error(<span style="color:#e6db74">&#34;è¯·æŒ‡å®š-oæˆ–è€…--queueï¼Œé€‰æ‹©æ£€æŸ¥mqæ€»ä½“æŒ‡æ ‡æˆ–è€…æŸä¸ªé˜Ÿåˆ—æŒ‡æ ‡&#34;</span>)
</span></span><span style="display:flex;"><span>logging<span style="color:#f92672">.</span>debug(<span style="color:#e6db74">&#34;Started trying to process data&#34;</span>)
</span></span><span style="display:flex;"><span>api <span style="color:#f92672">=</span> RabbitMqApi(user_name<span style="color:#f92672">=</span>options<span style="color:#f92672">.</span>username, password<span style="color:#f92672">=</span>options<span style="color:#f92672">.</span>password, host_name<span style="color:#f92672">=</span>options<span style="color:#f92672">.</span>mqhost, 
</span></span><span style="display:flex;"><span>               protocol<span style="color:#f92672">=</span>options<span style="color:#f92672">.</span>protocol, port<span style="color:#f92672">=</span>options<span style="color:#f92672">.</span>port, senderhostname<span style="color:#f92672">=</span>options<span style="color:#f92672">.</span>host,
</span></span><span style="display:flex;"><span>               zbconf<span style="color:#f92672">=</span>options<span style="color:#f92672">.</span>conf)
</span></span><span style="display:flex;"><span>cnt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> cnt <span style="color:#f92672">&lt;</span> options<span style="color:#f92672">.</span>count:                                               
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> options<span style="color:#f92672">.</span>overview:
</span></span><span style="display:flex;"><span>api<span style="color:#f92672">.</span>check_overview()
</span></span><span style="display:flex;"><span>time<span style="color:#f92672">.</span>sleep(options<span style="color:#f92672">.</span>interval)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">elif</span> options<span style="color:#f92672">.</span>queue:
</span></span><span style="display:flex;"><span>api<span style="color:#f92672">.</span>check_queue(options<span style="color:#f92672">.</span>queue)
</span></span><span style="display:flex;"><span>time<span style="color:#f92672">.</span>sleep(options<span style="color:#f92672">.</span>interval)
</span></span><span style="display:flex;"><span>cnt <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span> main()</span></span></code></pre></div></blockquote>
<ul>
<li><!-- raw HTML omitted -->è„šæœ¬ä½¿ç”¨æ–¹å¼<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li><code>--mqhost</code>ï¼š<code>RabbitMQ</code><!-- raw HTML omitted -->æœåŠ¡å™¨<!-- raw HTML omitted --><code>ip</code></li>
<li><code>--host</code>ï¼š<code>zabbix server</code><!-- raw HTML omitted -->ä¸Šé…ç½®çš„<!-- raw HTML omitted --><code>host</code><!-- raw HTML omitted -->åå­—<!-- raw HTML omitted --></li>
<li><code>--queue</code>ï¼š<!-- raw HTML omitted -->é˜Ÿåˆ—åå­—<!-- raw HTML omitted --></li>
<li><code>-o</code>ï¼š<!-- raw HTML omitted -->è·å–<!-- raw HTML omitted --><code>overview</code><!-- raw HTML omitted -->æ•°æ®<!-- raw HTML omitted --></li>
<li><code>-c</code>ï¼š<!-- raw HTML omitted -->æ‰§è¡Œ<code>5</code>æ¬¡<!-- raw HTML omitted --></li>
<li><code>-i</code>ï¼š<!-- raw HTML omitted -->é—´éš”<code>12</code>ç§’<!-- raw HTML omitted --></li>
<li><code>--help</code>ï¼š<!-- raw HTML omitted -->æŸ¥çœ‹å¸®åŠ©ï¼Œæœ‰å…¶ä»–å‚æ•°å¯é€‰<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ mqMon.py -o â€“mqhost 192.168.55.241 â€“host ser01-rabbitmq -c <span style="color:#ae81ff">5</span> -i <span style="color:#ae81ff">12</span>  	<span style="color:#75715e"># ç›‘æ§`mq`æ€»ä½“æƒ…å†µ</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ mqMon.py â€“queue wxq_msg_send â€“mqhost 192.168.55.241 â€“host ser01-rabbitmq -c <span style="color:#ae81ff">5</span> -i <span style="color:#ae81ff">12</span>  	<span style="color:#75715e"># ç›‘æ§é˜Ÿåˆ—æƒ…å†µ</span></span></span></code></pre></div></blockquote>
</blockquote>
<hr>

            <footer class="footline">
            </footer>
          </article>

        </div>
      </main>
    </div>
    <script src="../../../../js/clipboard.min.js?1721046093" defer></script>
    <script src="../../../../js/perfect-scrollbar.min.js?1721046093" defer></script>
    <script src="../../../../js/theme.js?1721046093" defer></script>
  </body>
</html>
