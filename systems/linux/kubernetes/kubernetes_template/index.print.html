<!DOCTYPE html>
<html lang="en" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.125.4">
    <meta name="generator" content="Relearn 6.0.0+tip">
    <meta name="robots" content="noindex, nofollow, noarchive, noimageindex">
    <meta name="description" content="èµ„æºæ§åˆ¶å™¨ graph LR A[æ€ç»´å¯¼å›¾] --&gt;B[1.å‰è¨€] A[æ€ç»´å¯¼å›¾] --&gt;C[2.Namespace] A[æ€ç»´å¯¼å›¾] --&gt;D[3.Deployment] A[æ€ç»´å¯¼å›¾] --&gt;E[4.">
    <meta name="author" content="äºŒå“¥">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://erge.blog/images/s2-1.png">
    <meta name="twitter:title" content="Kubernetes_Template :: Hugo Relearn Theme">
    <meta name="twitter:description" content="èµ„æºæ§åˆ¶å™¨ graph LR A[æ€ç»´å¯¼å›¾] --&gt;B[1.å‰è¨€] A[æ€ç»´å¯¼å›¾] --&gt;C[2.Namespace] A[æ€ç»´å¯¼å›¾] --&gt;D[3.Deployment] A[æ€ç»´å¯¼å›¾] --&gt;E[4.">
    <meta property="og:url" content="https://erge.blog/systems/linux/kubernetes/kubernetes_template/">
    <meta property="og:site_name" content="Hugo Relearn Theme">
    <meta property="og:title" content="Kubernetes_Template :: Hugo Relearn Theme">
    <meta property="og:description" content="èµ„æºæ§åˆ¶å™¨ graph LR A[æ€ç»´å¯¼å›¾] --&gt;B[1.å‰è¨€] A[æ€ç»´å¯¼å›¾] --&gt;C[2.Namespace] A[æ€ç»´å¯¼å›¾] --&gt;D[3.Deployment] A[æ€ç»´å¯¼å›¾] --&gt;E[4.">
    <meta property="og:locale" content="en">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Systems">
    <meta property="article:published_time" content="2024-06-25T17:38:23+08:00">
    <meta property="article:modified_time" content="2024-06-25T17:38:23+08:00">
    <meta property="og:image" content="https://erge.blog/images/s2-1.png">
    <meta itemprop="name" content="Kubernetes_Template :: Hugo Relearn Theme">
    <meta itemprop="description" content="èµ„æºæ§åˆ¶å™¨ graph LR A[æ€ç»´å¯¼å›¾] --&gt;B[1.å‰è¨€] A[æ€ç»´å¯¼å›¾] --&gt;C[2.Namespace] A[æ€ç»´å¯¼å›¾] --&gt;D[3.Deployment] A[æ€ç»´å¯¼å›¾] --&gt;E[4.">
    <meta itemprop="datePublished" content="2024-06-25T17:38:23+08:00">
    <meta itemprop="dateModified" content="2024-06-25T17:38:23+08:00">
    <meta itemprop="wordCount" content="3600">
    <meta itemprop="image" content="https://erge.blog/images/s2-1.png">
    <title>Kubernetes_Template :: Hugo Relearn Theme</title>
    <link href="../../../../images/favicon.ico?1721045974" rel="icon" type="image/x-icon" sizes="any">
    <link href="../../../../css/fontawesome-all.min.css?1721045975" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/fontawesome-all.min.css?1721045975" rel="stylesheet"></noscript>
    <link href="../../../../css/nucleus.css?1721045975" rel="stylesheet">
    <link href="../../../../css/auto-complete.css?1721045975" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/auto-complete.css?1721045975" rel="stylesheet"></noscript>
    <link href="../../../../css/perfect-scrollbar.min.css?1721045975" rel="stylesheet">
    <link href="../../../../css/fonts.css?1721045975" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/fonts.css?1721045975" rel="stylesheet"></noscript>
    <link href="../../../../css/theme.css?1721045975" rel="stylesheet">
    <link href="../../../../css/theme-relearn-auto.css?1721045975" rel="stylesheet" id="R-variant-style">
    <link href="../../../../css/chroma-relearn-auto.css?1721045975" rel="stylesheet" id="R-variant-chroma-style">
    <link href="../../../../css/variant.css?1721045975" rel="stylesheet">
    <link href="../../../../css/print.css?1721045975" rel="stylesheet" media="print">
    <link href="../../../../css/format-print.css?1721045975" rel="stylesheet">
    <script src="../../../../js/variant.js?1721045975"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..\/..\/..';
      window.relearn.relBaseUri='..\/..\/..\/..';
      window.relearn.absBaseUri='https:\/\/erge.blog';
      window.index_js_url="../../../../index.search.js";
      // variant stuff
      window.variants && variants.init( [ 'relearn-auto', 'relearn-light', 'relearn-dark', 'relearn-bright', 'zen-auto', 'zen-light', 'zen-dark', 'retro-auto', 'neon', 'learn', 'blue', 'green', 'red', 'my-branding' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>Partial intended to be overwritten to add custom headers, like CSS or any other info
<style>
    
</style>


  </head>
  <body class="mobile-support print disableInlineCopyToClipboard" data-url="../../../../systems/linux/kubernetes/kubernetes_template/">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="show" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>



          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../../../systems/"><span itemprop="name">Systems</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../../../systems/linux/"><span itemprop="name">Linux</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../../../systems/linux/kubernetes/"><span itemprop="name">Kubernetes</span></a><meta itemprop="position" content="3">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Kubernetes_Template</span><meta itemprop="position" content="4"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">


            <div class="topbar-button topbar-button-prev" data-content-empty="show" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="../../../../systems/linux/kubernetes/" title="Kubernetes (ğŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>

            <div class="topbar-button topbar-button-next" data-content-empty="show" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="../../../../systems/linux/kubernetes/kubernetes_command/" title="Kubernetes_Command (ğŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>



          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>

<h1 id="kubernetes_template">Kubernetes_Template</h1>

<h1 id="èµ„æºæ§åˆ¶å™¨">èµ„æºæ§åˆ¶å™¨</h1>
<blockquote>

<pre class="mermaid align-center zoomable">graph LR
A[æ€ç»´å¯¼å›¾] --&gt;B[1.å‰è¨€]
A[æ€ç»´å¯¼å›¾] --&gt;C[2.Namespace]
A[æ€ç»´å¯¼å›¾] --&gt;D[3.Deployment]
A[æ€ç»´å¯¼å›¾] --&gt;E[4.StatefulSet]
A[æ€ç»´å¯¼å›¾] --&gt;F[5.DaemonSet]
A[æ€ç»´å¯¼å›¾] --&gt;G[6.HorizontalPodAutoscaler]
A[æ€ç»´å¯¼å›¾] --&gt;H[7.EndPoint]
A[æ€ç»´å¯¼å›¾] --&gt;I[8.Service]
A[æ€ç»´å¯¼å›¾] --&gt;J[9.Labelæ ‡ç­¾/Selectoré€‰æ‹©å™¨]
C[2.Namespace] --&gt;|a=1|C1[2.1æ¦‚è¿°]
C[2.Namespace] --&gt;|a=2|C2[2.2åº”ç”¨ç¤ºä¾‹]
D[3.Deployment] --&gt;|a=1|D1[3.1æ¦‚è¿°]
D[3.Deployment] --&gt;|a=2|D2[3.2è¯­æ³•ä»¥åŠåº”ç”¨ç¤ºä¾‹]
E[4.StatefulSet] --&gt;|a=1|E1[4.1æ¦‚è¿°]
E[4.StatefulSet] --&gt;|a=2|E2[4.2è¯­æ³•ä»¥åŠåº”ç”¨ç¤ºä¾‹]
F[5.DaemonSet] --&gt;|a=1|F1[5.1æ¦‚è¿°]
F[5.DaemonSet] --&gt;|a=2|F2[5.2è¯­æ³•ä»¥åŠåº”ç”¨ç¤ºä¾‹]
G[6.HorizontalPodAutoscaler] --&gt;|a=1|G1[6.1æ¦‚è¿°]
G[6.HorizontalPodAutoscaler] --&gt;|a=2|G2[6.2è¯­æ³•ä»¥åŠåº”ç”¨]
H[7.EndPoint] --&gt;|a=1|H1[7.1æ¦‚è¿°]
H[7.EndPoint] --&gt;|a=2|H2[7.2è¯­æ³•ä»¥åŠåº”ç”¨]
I[8.Service] --&gt;|a=1|I1[8.1æ¦‚è¿°]
I[8.Service] --&gt;|a=2|I2[8.2è¯­æ³•ä»¥åŠåº”ç”¨]
J[9.Labelæ ‡ç­¾/Selectoré€‰æ‹©å™¨] --&gt;|a=1|J1[9.1æ¦‚è¿°]
J[9.Labelæ ‡ç­¾/Selectoré€‰æ‹©å™¨] --&gt;|a=2|J2[9.2è¯­æ³•ä»¥åŠåº”ç”¨]

Z[æ¨ªå‘æµç¨‹å›¾]</pre>
<pre class="mermaid align-center zoomable">graph TD
A[Deployment] --&gt; D[ReplicaSet]
B[CronJob] --&gt; E[Job]
C[DaemonSet] --&gt; G{{å®¹å™¨}}
D[ReplicaSet] --&gt; G{{å®¹å™¨}}
E[Job] --&gt; G{{å®¹å™¨}}
F[StatefulSet] --&gt; G{{å®¹å™¨}}

G{{å®¹å™¨}} --&gt; J[/Volume\]
G{{å®¹å™¨}} --&gt; H(ServiceæœåŠ¡)

J[/Volume\] --&gt; K[/configMap\]
J[/Volume\] --&gt; L[/PVC\]
J[/Volume\] --&gt; M[/Secret\]

Z[Kubernetesæ§åˆ¶æµç¨‹]</pre><ul>
<li><!-- raw HTML omitted -->æ ‡ç­¾é€‰æ‹©å™¨<!-- raw HTML omitted --></li>
</ul>

<pre class="mermaid align-center zoomable">graph LR
A[Deployment&lt;br&gt;seletor:env=dev] -.- C[Label&lt;br&gt;]  
B{Service&lt;br&gt;seletor:env=dev} --- C[Label&lt;br&gt;]
C[Label&lt;br&gt;] --- C1((Pod&lt;br&gt;labe:env=dev))
C[Label&lt;br&gt;] --- C2((Pod&lt;br&gt;labe:env=dev))
C[Label&lt;br&gt;] --- C3((Pod&lt;br&gt;labe:env=dev))
    Z[Service]</pre>
<pre class="mermaid align-center zoomable">graph TD

A[user containerN&lt;br&gt;user ImageN&lt;br&gt;user container1&lt;br&gt;user Image1&lt;br&gt;Pause&lt;br&gt;gcr.io/google_containers/pause-amd64&lt;br&gt;] 
    Z[Pod]</pre></blockquote>
<hr>
<h2 id="èµ„æºåç§°">èµ„æºåç§°</h2>
<blockquote>
<ul>
<li>
<ol>
<li><code>kubectl api-resources -o wide</code><!-- raw HTML omitted -->ï¼šè·å–å‚æ•°å®šä¹‰å‘½ä»¤<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<table>
<thead>
<tr>
<th><code>Name</code>(åç§°)</th>
<th><code>ShortNames</code>(ç®€å†™)</th>
<th><code>apiVersion</code>(<code>API</code>ç‰ˆæœ¬)</th>
<th><code>NameSpaced</code>(å‘½åç©ºé—´)</th>
<th>kind(ç±»å‹)</th>
<th>Verbs(å¯æ‰§è¡Œæ“ä½œå‘½ä»¤)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>configmaps</code></td>
<td>cm</td>
<td>v1</td>
<td>true</td>
<td>ConfigMap</td>
<td>createã€deleteã€deletecollectionã€getã€listã€patchã€updateã€watch</td>
</tr>
<tr>
<td>events</td>
<td>ev</td>
<td>v1</td>
<td>true</td>
<td>Event</td>
<td>createã€deleteã€deletecollectionã€getã€listã€patchã€updateã€watch</td>
</tr>
<tr>
<td><code>limitranges</code></td>
<td>limits</td>
<td>v1</td>
<td>true</td>
<td>LimitRange</td>
<td>createã€deleteã€deletecollectionã€getã€listã€patchã€updateã€watch</td>
</tr>
<tr>
<td>pods</td>
<td>po</td>
<td>v1</td>
<td>true</td>
<td>Pod</td>
<td>createã€deleteã€deletecollectionã€getã€listã€patchã€updateã€watch</td>
</tr>
<tr>
<td>serviceaccounts</td>
<td>sa</td>
<td>v1</td>
<td>true</td>
<td>ServiceAccount</td>
<td>createã€deleteã€deletecollectionã€getã€listã€patchã€updateã€watch</td>
</tr>
<tr>
<td>services</td>
<td>svc</td>
<td>v1</td>
<td>true</td>
<td>Service</td>
<td>createã€deleteã€deletecollectionã€getã€listã€patchã€updateã€watch</td>
</tr>
<tr>
<td>daemonsets</td>
<td>ds</td>
<td>apps/v1</td>
<td>true</td>
<td>DaemonSet</td>
<td>createã€deleteã€deletecollectionã€getã€listã€patchã€updateã€watch</td>
</tr>
<tr>
<td>deployments</td>
<td>deploy</td>
<td>apps/v1</td>
<td>true</td>
<td>Deployment</td>
<td>createã€deleteã€deletecollectionã€getã€listã€patchã€updateã€watch</td>
</tr>
<tr>
<td>replicasets</td>
<td>rs</td>
<td>apps/v1</td>
<td>true</td>
<td>ReplicaSet</td>
<td>createã€deleteã€deletecollectionã€getã€listã€patchã€updateã€watch</td>
</tr>
<tr>
<td>statefulsets</td>
<td>sts</td>
<td>apps/v1</td>
<td>true</td>
<td>StatefulSet</td>
<td>createã€deleteã€deletecollectionã€getã€listã€patchã€updateã€watch</td>
</tr>
<tr>
<td>horizontalpodautoscalers</td>
<td>hpa</td>
<td>autoscaling/v2</td>
<td>true</td>
<td>HorizontalPodAutoscaler</td>
<td>create,delete,deletecollection,get,list,patch,update,watch   all</td>
</tr>
<tr>
<td>cronjobs</td>
<td>cj</td>
<td>batch/v1</td>
<td>true</td>
<td>CronJob</td>
<td>createã€deleteã€deletecollectionã€getã€listã€patchã€updateã€watch</td>
</tr>
<tr>
<td>jobs</td>
<td></td>
<td>batch/v1</td>
<td>true</td>
<td>Job</td>
<td>createã€deleteã€deletecollectionã€getã€listã€patchã€updateã€watch</td>
</tr>
<tr>
<td>events</td>
<td>ev</td>
<td>events.k8s.io/v1</td>
<td>true</td>
<td>Event</td>
<td>createã€deleteã€deletecollectionã€getã€listã€patchã€updateã€watch</td>
</tr>
<tr>
<td>ingresses</td>
<td>ing</td>
<td>networking.k8s.io/v1</td>
<td>true</td>
<td>Ingress</td>
<td>createã€deleteã€deletecollectionã€getã€listã€patchã€updateã€watch</td>
</tr>
<tr>
<td>networkpolicies</td>
<td>netpol</td>
<td>networking.k8s.io/v1</td>
<td>true</td>
<td>NetworkPolicy</td>
<td>createã€deleteã€deletecollectionã€getã€listã€patchã€updateã€watch</td>
</tr>
<tr>
<td>poddisruptionbudgets</td>
<td>pdb</td>
<td>policy/v1</td>
<td>true</td>
<td>PodDisruptionBudget</td>
<td>createã€deleteã€deletecollectionã€getã€listã€patchã€updateã€watch</td>
</tr>
</tbody>
</table>
<ul>
<li><!-- raw HTML omitted -->èµ„æºæ§åˆ¶å™¨ä½œç”¨<!-- raw HTML omitted --></li>
</ul>
<table>
<thead>
<tr>
<th>èµ„æºåˆ†ç±»</th>
<th>èµ„æºåç§°</th>
<th>ç¼©å†™</th>
<th>èµ„æºä½œç”¨</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Pod</code>èµ„æºæ§åˆ¶å™¨</td>
<td><code>replicasets</code></td>
<td><code>rs</code></td>
<td>ä¿è¯æŒ‡å®šæ•°é‡çš„<code>Pod</code>è¿è¡Œï¼Œå¹¶æ”¯æŒ<code>Pod</code>æ•°é‡å˜æ›´ï¼Œé•œåƒç‰ˆæœ¬å˜æ›´</td>
</tr>
<tr>
<td>&mdash;</td>
<td><code>deployments</code></td>
<td><code>deploy</code></td>
<td>é€šè¿‡æ§åˆ¶<code>ReplicaSet</code>æ¥æ§åˆ¶<code>Pod</code>ï¼Œå¹¶æ”¯æŒæ»šåŠ¨å‡çº§ã€ç‰ˆæœ¬å›é€€</td>
</tr>
<tr>
<td>&mdash;</td>
<td><code>daemonsets</code></td>
<td><code>ds</code></td>
<td>åœ¨é›†ç¾¤ä¸­çš„æŒ‡å®š<code>Node</code>ä¸Šéƒ½è¿è¡Œä¸€ä¸ªå‰¯æœ¬ï¼Œä¸€èˆ¬ç”¨äºæ—¥å¿—é‡‡é›†ã€ç›‘æ§ã€å®ˆæŠ¤è¿›ç¨‹ç±»çš„ä»»åŠ¡ã€‚</td>
</tr>
<tr>
<td>&mdash;</td>
<td><code>jobs</code></td>
<td>&mdash;</td>
<td>å®ƒåˆ›å»ºå‡ºæ¥çš„<code>Pod</code>åªè¦å®Œæˆä»»åŠ¡å°±ç«‹å³é€€å‡ºï¼Œç”¨äºæ‰§è¡Œä¸€æ¬¡æ€§ä»»åŠ¡</td>
</tr>
<tr>
<td>&mdash;</td>
<td><code>cronjobs</code></td>
<td><code>cj</code></td>
<td>å®ƒåˆ›å»ºçš„Podä¼šå‘¨æœŸæ€§çš„æ‰§è¡Œï¼Œç”¨äºæ‰§è¡Œå‘¨æœŸæ€§çš„ä»»åŠ¡</td>
</tr>
<tr>
<td>&mdash;</td>
<td><code>horizontalpodautoscalers</code></td>
<td><code>hpa</code></td>
<td>å¯ä»¥æ ¹æ®é›†ç¾¤è´Ÿè½½è‡ªåŠ¨è°ƒæ•´<code>Pod</code>çš„æ•°é‡ï¼Œå®ç°å‰Šå³°å¡«è°·</td>
</tr>
<tr>
<td><code>Pod</code>èµ„æºæ§åˆ¶å™¨</td>
<td><code>statefulsets</code></td>
<td><code>sts</code></td>
<td>ç®¡ç†æœ‰çŠ¶æ€çš„åº”ç”¨ã€‚</td>
</tr>
</tbody>
</table>
</blockquote>
<hr>
<h2 id="èµ„æºæ§åˆ¶å™¨å­—æ®µç±»å‹ä½œç”¨">èµ„æºæ§åˆ¶å™¨å­—æ®µç±»å‹ä½œç”¨</h2>
<blockquote>
<ul>
<li><!-- raw HTML omitted -->ä½¿ç”¨<!-- raw HTML omitted --><code>explain</code><!-- raw HTML omitted -->é€‰é¡¹è·å–å­—æ®µä½¿ç”¨æ–¹å¼<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl explain deployment.metadata  	<span style="color:#75715e"># è·å– deploymentçš„metadataä½¿ç”¨æ–¹å¼ï¼Œ è¿˜å¯ä»¥è·å–ï¼šspecã€kind</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ kubectl explain deployment.spec.selector  <span style="color:#75715e"># è·å–yamlåŸºç¡€æ ¼å¼å‘½ä»¤ </span></span></span></code></pre></div></blockquote>
<ul>
<li>
<ol>
<li><!-- raw HTML omitted -->èµ„æºæ§åˆ¶å™¨<!-- raw HTML omitted --><!-- raw HTML omitted -->å¿…é€‰å­—æ®µ<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<table>
<thead>
<tr>
<th>å‚æ•°å</th>
<th>å­—æ®µç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>version</code></td>
<td><code>String</code></td>
<td><code>Kubernetes API </code>çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ç”¨<code>kubectl api-versions</code>å‘½ä»¤æŸ¥è¯¢</td>
</tr>
<tr>
<td><code>kind</code></td>
<td><code>String</code></td>
<td>æ ‡æ˜<code>YAML</code>å®šä¹‰çš„èµ„æºç±»å‹å’Œè§’è‰²ï¼Œå¦‚<code>Pod</code>ã€<code>Deployment</code>ç­‰</td>
</tr>
<tr>
<td><code>metadata</code></td>
<td><code>String</code></td>
<td>å…ƒæ•°æ®å¯¹è±¡</td>
</tr>
<tr>
<td><code>metadata.name</code></td>
<td><code>String</code></td>
<td>å…ƒæ•°æ®å¯¹è±¡çš„åå­—ï¼Œå¯è‡ªå®šä¹‰ï¼Œæ¯”å¦‚å‘½å<code>Pod</code>çš„åå­—</td>
</tr>
<tr>
<td><code>spec</code></td>
<td><code>Object</code></td>
<td>è¯¦ç»†å®šä¹‰å¯¹è±¡</td>
</tr>
<tr>
<td><code>spec.containers[]</code></td>
<td><code>List</code></td>
<td>å®¹å™¨åˆ—è¡¨å®šä¹‰</td>
</tr>
<tr>
<td><code>spec.containers[].name</code></td>
<td><code>String</code></td>
<td>å®šä¹‰å®¹å™¨çš„åå­—</td>
</tr>
<tr>
<td><code>spec.containers[].image</code></td>
<td><code>String</code></td>
<td>å®šä¹‰å®¹å™¨ä½¿ç”¨çš„é•œåƒ</td>
</tr>
</tbody>
</table>
</blockquote>
<ul>
<li>
<ol start="2">
<li><code>metadata</code><!-- raw HTML omitted -->å­—æ®µé€‰æ‹©<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<table>
<thead>
<tr>
<th>å‚æ•°åç§°</th>
<th>å­—æ®µç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>metadata.name</code></td>
<td></td>
<td><code>Pod</code>åç§°</td>
</tr>
<tr>
<td><code>metadata.uid</code></td>
<td></td>
<td><code>Pod</code>çš„<code>UID</code></td>
</tr>
<tr>
<td><code>metadata.namespace</code></td>
<td></td>
<td><code>Pod</code>åå­—ç©ºé—´</td>
</tr>
<tr>
<td><code>metadata.labels['&lt;KEY&gt;']</code></td>
<td></td>
<td><code>Pod</code>æ ‡ç­¾ <code>&lt;KEY&gt;</code> çš„å€¼ (ä¾‹å¦‚<code>metadata.labels['mylabel']</code>ï¼‰</td>
</tr>
<tr>
<td><code>metadata.annotations['&lt;KEY&gt;']</code></td>
<td></td>
<td><code>Pod</code>çš„æ³¨è§£ <code>&lt;KEY&gt;</code> çš„å€¼ï¼ˆä¾‹å¦‚, <code>metadata.annotations['myannotation']</code>ï¼‰</td>
</tr>
</tbody>
</table>
</blockquote>
<ul>
<li>
<ol start="3">
<li><code>spec.containers</code><!-- raw HTML omitted -->å­—æ®µå®šä¹‰<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<table>
<thead>
<tr>
<th>å‚æ•°åç§°</th>
<th>å­—æ®µç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>spec.containers[].name</td>
<td>String</td>
<td>å®šä¹‰å®¹å™¨çš„åå­—ã€‚</td>
</tr>
<tr>
<td>spec.containers[].image</td>
<td>String</td>
<td>å®šä¹‰å®¹å™¨ä½¿ç”¨çš„é•œåƒã€‚</td>
</tr>
<tr>
<td>spec.containers[].imagePullSecrets</td>
<td></td>
<td>è¦ä»ç§æœ‰ä»“åº“æ‹‰å–é•œåƒï¼Œ<code>Kubernetes</code>éœ€è¦å‡­è¯ã€‚ é…ç½®æ–‡ä»¶ä¸­çš„ <code>imagePullSecrets</code>å­—æ®µè¡¨æ˜<code>Kubernetes</code>åº”è¯¥é€šè¿‡åä¸º <code>regcred</code> çš„ Secret è·å–å‡­è¯</td>
</tr>
<tr>
<td>spec.containers[].imagePullPolicy</td>
<td>S</td>
<td>å®šé•œåƒæ‹‰å–æœ‰3ä¸ªå€¼å¯é€‰:<!-- raw HTML omitted --> <!-- raw HTML omitted --><code>Always</code><!-- raw HTML omitted -->ï¼šæ€»æ˜¯ä»è¿œç¨‹ä»“åº“æ‹‰å–é•œåƒã€<!-- raw HTML omitted --><!-- raw HTML omitted --><code>IfNotPresent</code><!-- raw HTML omitted -->ï¼šæœ¬åœ°æœ‰åˆ™ä½¿ç”¨æœ¬åœ°é•œåƒï¼Œæœ¬åœ°æ²¡æœ‰åˆ™ä»è¿œç¨‹ä»“åº“æ‹‰å–é•œåƒã€‚å¦‚ä¸Šé¢ 3ä¸ªå€¼éƒ½æ²¡è®¾ç½®ï¼Œé»˜è®¤æ˜¯<code>Always</code><!-- raw HTML omitted --><!-- raw HTML omitted --><code>Never</code><!-- raw HTML omitted -->ï¼šä»…ä½¿ç”¨æœ¬åœ°é•œåƒï¼Œæœ¬åœ°æ²¡æœ‰å°±æŠ¥é”™</td>
</tr>
<tr>
<td>spec.containers[].command[]</td>
<td>List</td>
<td>æŒ‡å®šå®¹å™¨å¯åŠ¨å‘½ä»¤ï¼Œå› ä¸ºæ˜¯æ•°ç»„å½¢å¼ï¼Œæ‰€ä»¥å¯ä»¥æŒ‡å®šå¤šä¸ªå¯åŠ¨å‘½ä»¤ï¼Œä¸æŒ‡å®šåˆ™ä½¿ç”¨é•œåƒæ‰“åŒ…æ—¶çš„å¯åŠ¨å‘½ä»¤ã€‚</td>
</tr>
<tr>
<td>spec.containers[].args[]</td>
<td>List</td>
<td>æŒ‡å®šå®¹å™¨å¯åŠ¨å‘½ä»¤å‚æ•°ï¼Œå› ä¸ºæ˜¯æ•°ç»„å½¢å¼ï¼Œæ‰€ä»¥å¯ä»¥æŒ‡å®šå¤šä¸ªå‚æ•°ã€‚</td>
</tr>
</tbody>
</table>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">spec</span>:   	<span style="color:#75715e"># å¿…é€‰ï¼ŒPodä¸­å®¹å™¨çš„è¯¦ç»†å®šä¹‰</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">imagePullSecrets</span>:  	<span style="color:#75715e"># é…ç½®ç™»å½• docker registry çš„ secret ä»“åº“</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">docker-harbor  	# æŒ‡å®šä½¿ç”¨çš„secretåº“æˆ¿åç§°</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">containers</span>:   	<span style="color:#75715e"># å¿…é€‰ï¼ŒPodä¸­å®¹å™¨åˆ—è¡¨ï¼Œä¸€ä¸ªPodä¸­å¯ä»¥å®šä¹‰å¤šä¸ªå®¹å™¨</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">tomcat-demo   	# æŒ‡å®šå®¹å™¨åç§°ï¼Œä¸å¯æ›´æ–°</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">192.168.80.210</span>:<span style="color:#ae81ff">8080</span><span style="color:#ae81ff">/test/tomcat-demo:v1 </span> <span style="color:#75715e"># é•œåƒä»“åº“åœ°å€</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">imagePullPolicy</span>: <span style="color:#ae81ff">Always   	# å®¹å™¨ä¸‹è½½ç­–ç•¥ï¼šAlways|Never|IfNotPresentï¼Œä¸ç®¡æœ¬åœ°å­˜ä¸å­˜åœ¨ï¼Œéƒ½ä»ä»“åº“æ‹‰å–é•œåƒ</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">command</span>: [<span style="color:#ae81ff">string]   	# å®¹å™¨çš„å¯åŠ¨å‘½ä»¤åˆ—è¡¨ï¼Œæ›¿ä»£dockerçš„ENTRYPOINTæŒ‡ä»¤ã€å¦‚ä¸æŒ‡å®šï¼Œä½¿ç”¨æ‰“åŒ…æ—¶ä½¿ç”¨çš„å¯åŠ¨å‘½ä»¤</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">args</span>:   	<span style="color:#75715e"># å®¹å™¨çš„å¯åŠ¨å‘½ä»¤å‚æ•°åˆ—è¡¨ã€æ›¿ä»£dockerçš„CMDæŒ‡ä»¤</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">/bin/sh</span>
</span></span><span style="display:flex;"><span>    - -<span style="color:#ae81ff">c</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">touch /tmp/healthy; sleep 30; rm -fr /tmp/healthy; sleep 600</span></span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="4">
<li><code>spec.containers.volumeMounts</code><!-- raw HTML omitted -->å®¹å™¨å·¥ä½œç›®å½•å®šä¹‰<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<table>
<thead>
<tr>
<th>å‚æ•°åç§°</th>
<th>å­—æ®µç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>spec.containers[].workingDir</td>
<td>String</td>
<td>æŒ‡å®šå®¹å™¨çš„å·¥ä½œç›®å½•</td>
</tr>
<tr>
<td>spec.containers[].volumeMounts[]</td>
<td>List</td>
<td>æŒ‡å®šå®¹å™¨å†…éƒ¨çš„å­˜å‚¨å·é…ç½®</td>
</tr>
<tr>
<td>spec.containers[].volumeMounts[].name</td>
<td>String</td>
<td>æŒ‡å®šå¯ä»¥è¢«å®¹å™¨æŒ‚è½½çš„å­˜å‚¨å·çš„åç§°</td>
</tr>
<tr>
<td>spec.containers[].volumeMounts[].mountPath</td>
<td>String</td>
<td>æŒ‡å®šå¯ä»¥è¢«å®¹å™¨æŒ‚è½½çš„å­˜å‚¨å·çš„è·¯å¾„ã€‚</td>
</tr>
<tr>
<td>spec.containers[].volumeMountsf].readOnly</td>
<td>String</td>
<td>è®¾ç½®å­˜å‚¨å·è·¯å¾„çš„è¯»å†™æ¨¡å¼ï¼Œtrue æˆ–è€… falseï¼Œé»˜è®¤ä¸ºè¯»å†™æ¨¡å¼ã€‚</td>
</tr>
</tbody>
</table>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">spec</span>:   	<span style="color:#75715e"># å¿…é€‰ï¼ŒPodä¸­å®¹å™¨çš„è¯¦ç»†å®šä¹‰</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">containers</span>:   	<span style="color:#75715e"># å¿…é€‰ï¼ŒPodä¸­å®¹å™¨åˆ—è¡¨</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">workingDir</span>: <span style="color:#ae81ff">string   	# å®¹å™¨çš„å·¥ä½œç›®å½•ã€ä¸æŒ‡å®šåˆ™ä½¿ç”¨é•œåƒé»˜è®¤å€¼</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">volumeMounts</span>:   	<span style="color:#75715e"># æŒ‚è½½åˆ°å®¹å™¨å†…éƒ¨çš„å­˜å‚¨å·é…ç½®</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">data   	# å¼•ç”¨podå®šä¹‰çš„å…±äº«å­˜å‚¨å·çš„åç§°ï¼Œéœ€ç”¨volumes[]éƒ¨åˆ†å®šä¹‰çš„çš„å·å</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/opt/data   	# å­˜å‚¨å·åœ¨å®¹å™¨å†…mountçš„ç»å¯¹è·¯å¾„ï¼Œåº”å°‘äº512å­—ç¬¦</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">readOnly</span>: <span style="color:#ae81ff">boolean   	# æ˜¯å¦ä¸ºåªè¯»æ¨¡å¼</span></span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="5">
<li><code>spec.containers.ports</code><!-- raw HTML omitted -->å®¹å™¨ç«¯å£å®šä¹‰<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl explain deployment.spec.containers.ports  	<span style="color:#75715e"># è·å–ç«¯å£ä½¿ç”¨æ–¹å¼</span></span></span></code></pre></div><table>
<thead>
<tr>
<th>å‚æ•°åç§°</th>
<th>å­—æ®µç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>spec.containers[].ports[]</td>
<td>List</td>
<td>æŒ‡å®šå®¹å™¨éœ€è¦ç”¨åˆ°çš„ç«¯å£åˆ—è¡¨ã€‚</td>
</tr>
<tr>
<td>spec.containers[].ports[].name</td>
<td>String</td>
<td>æŒ‡å®šç«¯å£åç§°ã€‚</td>
</tr>
<tr>
<td>spec.containers[].ports[].containerPort</td>
<td>String</td>
<td>æŒ‡å®šå®¹å™¨éœ€è¦ç›‘å¬çš„ç«¯å£å·ã€‚</td>
</tr>
<tr>
<td>spec.containers[].ports[].hostPort</td>
<td>String</td>
<td>æŒ‡å®šå®¹å™¨æ‰€åœ¨ä¸»æœºéœ€è¦ç›‘å¬çš„ç«¯å£å·ï¼Œé»˜è®¤å’Œ spec.containers[].ports[].containerPort ç›¸åŒã€‚æ³¨æ„ï¼Œè®¾ç½®äº†åˆ™åŒä¸€å°ä¸»æœºæ— æ³•å¯åŠ¨è¯¥å®¹å™¨çš„ç›¸åŒå‰¯æœ¬ï¼ˆä¸»æœºçš„ç«¯å£å·ä¸èƒ½ç›¸åŒï¼Œè‹¥ç›¸åŒï¼Œä¼šå¼•å‘å†²çªï¼‰ã€‚</td>
</tr>
<tr>
<td>spec.containers[].ports[].protocol</td>
<td>String</td>
<td>æŒ‡å®šç«¯å£åè®®ï¼Œæ”¯æŒ TCP å’Œ UDPï¼Œé»˜è®¤å€¼ä¸º TCP ã€‚</td>
</tr>
</tbody>
</table>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">spec</span>:  	<span style="color:#75715e"># å¿…é€‰ï¼ŒPodä¸­å®¹å™¨çš„è¯¦ç»†å®šä¹‰</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">containers</span>:  	<span style="color:#75715e"># å¿…é€‰ï¼ŒPodä¸­å®¹å™¨åˆ—è¡¨</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ports</span>:  	<span style="color:#75715e"># å®¹å™¨æš´éœ²çš„ç«¯å£</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">http  	# æœåŠ¡åç§°ã€è¯¥åç§°å¯ä»¥åœ¨serviceç§è¢«å¼•ç”¨</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">80</span>  	<span style="color:#75715e"># å®¹å™¨éœ€è¦ç›‘å¬çš„ç«¯å£å·</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">hostPort</span>: <span style="color:#ae81ff">int  	# å®¹å™¨æ‰€åœ¨ä¸»æœºéœ€è¦ç›‘å¬çš„ç«¯å£å·ï¼Œé»˜è®¤ä¸Containerç›¸åŒ</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">protocol</span>: <span style="color:#ae81ff">TCP  	# ç«¯å£åè®®ï¼Œæ”¯æŒTCPå’ŒUDPï¼Œé»˜è®¤TCP</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">port</span>: <span style="color:#ae81ff">80</span>  	<span style="color:#75715e"># é›†ç¾¤ç«¯å£</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">targetPort</span>: <span style="color:#ae81ff">80</span>  	<span style="color:#75715e"># Podç«¯å£</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">nodePort</span>: <span style="color:#ae81ff">30080</span>  	<span style="color:#75715e"># èŠ‚ç‚¹å¯¹å¤–ç«¯å£</span></span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="6">
<li><code>spec.containers.env</code><!-- raw HTML omitted -->å®¹å™¨å˜é‡å®šä¹‰<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<table>
<thead>
<tr>
<th>å‚æ•°åç§°</th>
<th>å­—æ®µç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>spec.containers[].env[]</td>
<td>List</td>
<td>æŒ‡å®šå®¹å™¨è¿è¡Œå‰éœ€è¦è®¾ç½®çš„ç¯å¢ƒå˜é‡åˆ—è¡¨ã€‚</td>
</tr>
<tr>
<td>spec.containers[].env[].name</td>
<td>String</td>
<td>æŒ‡å®šç¯å¢ƒå˜é‡åç§°ã€‚</td>
</tr>
<tr>
<td>spec.containers[].env[].value</td>
<td>String</td>
<td>æŒ‡å®šç¯å¢ƒå˜é‡å€¼ã€‚</td>
</tr>
</tbody>
</table>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">spec</span>:   	<span style="color:#75715e"># å¿…é€‰ï¼ŒPodä¸­å®¹å™¨çš„è¯¦ç»†å®šä¹‰</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">containers</span>:   	<span style="color:#75715e"># å¿…é€‰ï¼ŒPodä¸­å®¹å™¨åˆ—è¡¨</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">env</span>:   	<span style="color:#75715e"># å®¹å™¨è¿è¡Œå‰éœ€è®¾ç½®çš„ç¯å¢ƒå˜é‡åˆ—è¡¨</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">JAVA_OPTS   	# ç¯å¢ƒå˜é‡åç§°</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#34;-Xmx1g&#34;</span>   	<span style="color:#75715e"># å®šä¹‰ä½¿ç”¨å†…å­˜ã€ç¯å¢ƒå˜é‡çš„å€¼</span></span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="7">
<li><code>spec.containers.resources</code><!-- raw HTML omitted -->å®¹å™¨èµ„æºé™åˆ¶<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<table>
<thead>
<tr>
<th>å‚æ•°åç§°</th>
<th>å­—æ®µç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>spec.containers[].resources</td>
<td>Object</td>
<td>æŒ‡å®šèµ„æºé™åˆ¶å’Œèµ„æºè¯·æ±‚çš„å€¼ï¼ˆè¿™é‡Œå¼€å§‹å°±æ˜¯è®¾ç½®å®¹å™¨çš„èµ„æºä¸Šé™ï¼‰ã€‚</td>
</tr>
<tr>
<td>spec.containers[].resources.limits</td>
<td>Object</td>
<td>æŒ‡å®šè®¾ç½®å®¹å™¨è¿è¡Œæ—¶èµ„æºçš„è¿è¡Œä¸Šé™ã€‚</td>
</tr>
<tr>
<td>spec.containers[].resources.limits.cpu</td>
<td>String</td>
<td>æŒ‡å®š<code>CPU</code>çš„é™åˆ¶ï¼Œå•ä½ä¸º<code>core</code>ï¼Œæ˜¯ç”¨äºè¿è¡Œ <code>docker run --cpu-shares</code>å‘½ä»¤çš„å‚æ•°ã€‚</td>
</tr>
<tr>
<td>spec.containers[].resources.limits.memory</td>
<td>String</td>
<td>æŒ‡å®šå†…å­˜çš„é™åˆ¶ï¼Œå•ä½ä¸º MiB æˆ– GiBã€‚</td>
</tr>
<tr>
<td>spec.containers[].resources.requests</td>
<td>Object</td>
<td>æŒ‡å®šå®¹å™¨å¯åŠ¨å’Œè°ƒåº¦æ—¶çš„é™åˆ¶ã€‚</td>
</tr>
<tr>
<td>spec.containers[].resources.requests.cpu</td>
<td>String</td>
<td>CPU è¯·æ±‚ï¼Œå•ä½ä¸º coreï¼Œå®¹å™¨å¯åŠ¨æ—¶åˆå§‹åŒ–å¯ç”¨æ•°é‡ã€‚</td>
</tr>
<tr>
<td>spec.containers[].resources.requests.memory</td>
<td>String</td>
<td>å†…å­˜è¯·æ±‚ï¼Œå•ä½ä¸º MiB æˆ– GiBï¼Œå®¹å™¨å¯åŠ¨çš„åˆå§‹åŒ–å¯ç”¨æ•°é‡ã€‚</td>
</tr>
</tbody>
</table>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># è®¾å®šé»˜è®¤requestå’Œlimit</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Namespace</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span><span style="color:#f92672">name</span>: <span style="color:#ae81ff">apps</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">LimitRange</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span><span style="color:#f92672">name</span>: <span style="color:#ae81ff">limit-resource  	# åœ¨ä¸€ä¸ªåç§°ç©ºé—´ä¸èƒ½é‡å¤</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">default  	# æŒ‡å®šåç§°ç©ºé—´ï¼Œé»˜è®¤defalut</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">labels</span>:      <span style="color:#ae81ff">&lt;map[string]string&gt;  	# æ ‡ç­¾</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">annotations</span>: <span style="color:#ae81ff">&lt;map[string]string&gt;  	# æ³¨é‡Š</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span><span style="color:#f92672">limits</span>:
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®¾å®šé»˜è®¤requestå’Œlimit</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">default</span>:  	<span style="color:#75715e"># é»˜è®¤çš„èµ„æºä¸Šé™, limit</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">memory</span>: <span style="color:#ae81ff">1024Mi</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">cpu</span>: <span style="color:#ae81ff">500m</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">defaultRequest</span>:  	<span style="color:#75715e"># é»˜è®¤çš„èµ„æºç”³è¯·å€¼, required</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">memory</span>: <span style="color:#ae81ff">128Mi</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">cpu</span>: <span style="color:#ae81ff">100m</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">max</span>:  	<span style="color:#75715e"># å£°æ˜çš„limitä¸Šé™</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">memory</span>: <span style="color:#ae81ff">2048Mi</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">cpu</span>: <span style="color:#ae81ff">1000m</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">min</span>:  	<span style="color:#75715e"># å£°æ˜çš„requiredä¸‹çº¿</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">memory</span>: <span style="color:#ae81ff">64Mi</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">cpu</span>: <span style="color:#ae81ff">50m</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">type</span>: <span style="color:#ae81ff">Container  	# è¢«é™åˆ¶çš„å¯¹è±¡ï¼ŒContainer</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">###############################################</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:   	<span style="color:#75715e"># Podä¸­å®¹å™¨çš„è¯¦ç»†å®šä¹‰</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">containers</span>:   	<span style="color:#75715e"># Podä¸­å®¹å™¨åˆ—è¡¨</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">resources</span>:   	<span style="color:#75715e"># èµ„æºé™åˆ¶å’Œè¯·æ±‚çš„è®¾ç½®</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">limits</span>:   	<span style="color:#75715e"># é™å®šPodæœ€å¤§ä½¿ç”¨ç¡¬ä»¶èµ„æºã€é€šå¸¸è®¾ç½®cpuå’Œmemory</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">cpu</span>: <span style="color:#e6db74">&#34;1&#34;</span>   	<span style="color:#75715e"># Cpuçš„é™åˆ¶ï¼Œå•ä½ä¸ºcoreæ•°</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">memory</span>: <span style="color:#e6db74">&#34;1Gi&#34;</span>   	<span style="color:#75715e"># å†…å­˜é™åˆ¶ï¼Œå•ä½å¯ä»¥ä¸ºMib/Gib</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">requests</span>:   	<span style="color:#75715e"># æœ€ä½èµ„æºè¦æ±‚ï¼Œåœ¨schedulerä¸­è¢«ç”¨åˆ°ï¼Œé€šå¸¸è®¾ç½®cpuå’Œmemory</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">cpu</span>: <span style="color:#e6db74">&#34;0.5&#34;</span>   	<span style="color:#75715e"># é™å®šä½¿ç”¨å‡ ä¸ªæ ¸å¿ƒCPUã€å®¹å™¨å¯åŠ¨çš„åˆå§‹å¯ç”¨æ•°é‡</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">memory</span>: <span style="color:#e6db74">&#34;256Mi&#34;</span>   	<span style="color:#75715e"># è®¾å®šä½¿ç”¨å†…å­˜ã€å®¹å™¨å¯åŠ¨çš„åˆå§‹å¯ç”¨æ•°é‡</span></span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="8">
<li><!-- raw HTML omitted -->å®¹å™¨å¥åº·æ£€æŸ¥è®¾ç½®<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<ul>
<li>
<p><code>startupProbe</code><!-- raw HTML omitted -->ï¼š å¯åŠ¨æ¢æµ‹ï¼š<!-- raw HTML omitted -->å®¹å™¨å¯åŠ¨å®Œæ¯•çš„é…ç½®ï¼Œè¯¥é…ç½®ä¸<code>readinessProbe</code>ä¸€è‡´ï¼Œåœ¨<code>lifecycle</code>å’Œ<code>Probe</code>ä¹‹å‰è¿è¡Œï¼Œå¤±è´¥åˆ™é‡å¯</p>
<p><code>k8s1.16</code>ç‰ˆæœ¬åæ–°åŠ <code>startupProbe</code>æ¢æµ‹æ–¹å¼ï¼Œç”¨äºåˆ¤æ–­å®¹å™¨å†…åº”ç”¨ç¨‹åºæ˜¯å¦å·²ç»å¯åŠ¨ï¼Œå¦‚æœé…ç½®äº†<code>startuprobe</code>ï¼Œå°±ä¼šå…ˆç¦ç”¨å…¶ä»–çš„æ¢æµ‹ï¼Œç›´åˆ°å®ƒæˆåŠŸä¸ºæ­¢</p>
</li>
<li>
<p><code>liveness probe</code><!-- raw HTML omitted -->(å­˜æ´»æ¢é’ˆ)<!-- raw HTML omitted --><code>Kubelet</code> ä½¿ç”¨<code>liveness probe</code>ï¼ˆå­˜æ´»æ¢é’ˆï¼‰æ¥ç¡®å®šä½•æ—¶é‡å¯å®¹å™¨ã€‚ä¾‹å¦‚ï¼Œå½“åº”ç”¨ç¨‹åºå¤„äºè¿è¡ŒçŠ¶æ€ä½†æ— æ³•åšè¿›ä¸€æ­¥æ“ä½œï¼Œ<code>liveness</code>æ¢é’ˆå°†æ•è·åˆ°<code>deadlock</code>é‡å¯å¤„äºè¯¥çŠ¶æ€ä¸‹çš„å®¹å™¨ï¼Œä½¿åº”ç”¨ç¨‹åºåœ¨å­˜åœ¨<code>bug</code>çš„æƒ…å†µä¸‹ä¾ç„¶èƒ½å¤Ÿç»§ç»­è¿è¡Œä¸‹å»ï¼ˆè°çš„ç¨‹åºè¿˜æ²¡å‡ ä¸ª<code>bug</code>å‘¢ï¼‰</p>
</li>
<li>
<p><code>readiness probe</code><!-- raw HTML omitted -->(å°±ç»ªæ¢é’ˆ)<!-- raw HTML omitted --><code>Kubelet</code>ä½¿ç”¨<code>readiness probe(å°±ç»ªæ¢é’ˆ)</code>æ¥ç¡®å®šå®¹å™¨æ˜¯å¦å·²ç»å°±ç»ªå¯ä»¥æ¥å—æµé‡ã€‚åªæœ‰å½“<code>Pod</code>ä¸­çš„å®¹å™¨éƒ½å¤„äºå°±ç»ªçŠ¶æ€æ—¶<code>kubelet</code>æ‰ä¼šè®¤å®šè¯¥<code>Pod</code>å¤„äºå°±ç»ªçŠ¶æ€ã€‚è¯¥ä¿¡å·çš„ä½œç”¨æ˜¯æ§åˆ¶å“ªäº›<code>Pod</code>åº”è¯¥ä½œä¸º<code>service</code>çš„åç«¯ã€‚å¦‚æœ<code>Pod</code>å¤„äºéå°±ç»ªçŠ¶æ€ï¼Œé‚£ä¹ˆå®ƒä»¬å°†ä¼šè¢«ä»<code>service</code>çš„<code>load balancer</code>ä¸­ç§»é™¤</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>å‚æ•°åç§°</th>
<th>å­—æ®µç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>spec.containers[].livenessProbe(å­˜æ´»æ¢é’ˆ)</td>
<td>Object</td>
<td>æŒ‡å®š<code>Pod</code>å†…å®¹å™¨å¥åº·æ£€æŸ¥çš„è®¾ç½®ï¼Œå½“æ¢æµ‹å‡ æ¬¡æ— å“åº”åï¼Œç³»ç»Ÿå°†è‡ªåŠ¨é‡å¯è¯¥å®¹å™¨ã€‚å‚æ•°å¯ä»¥è®¾ç½®ä¸º<code>exec</code>ã€<code>httpGet</code>ã€<code>tcpSocket</code>ã€‚</td>
</tr>
<tr>
<td>spec.containers[].livenessProbe.exec</td>
<td>Object</td>
<td>æŒ‡å®š<code>Pod</code>å†…å®¹å™¨å¥åº·æ£€æŸ¥çš„è®¾ç½®ï¼Œç¡®å®šæ˜¯<code>exec</code>æ–¹å¼ã€‚</td>
</tr>
<tr>
<td>spec.containers[].livenessProbe.exec.command[]</td>
<td>String</td>
<td>æŒ‡å®š<code>exec</code>æ–¹å¼åç”¨è¿™ä¸ªå‚æ•°è®¾ç½®éœ€è¦æŒ‡å®šçš„å‘½ä»¤æˆ–è€…è„šæœ¬ã€‚</td>
</tr>
<tr>
<td>spec.containers[].livenessProbe.httpGet</td>
<td>Object</td>
<td>æŒ‡å®š Pod å†…å®¹å™¨å¥åº·æ£€æŸ¥çš„è®¾ç½®ï¼Œç¡®å®šæ˜¯<code>httpGet</code>æ–¹å¼ã€‚</td>
</tr>
<tr>
<td>spec.containers[].livenessProbe.tcpSocket</td>
<td>Object</td>
<td>æŒ‡å®š Pod å†…å®¹å™¨å¥åº·æ£€æŸ¥çš„è®¾ç½®ï¼Œç¡®å®šæ˜¯ <code>tcpSocket</code>æ–¹å¼ã€‚</td>
</tr>
<tr>
<td>spec.containers[].livenessProbe.initialDelaySeconds</td>
<td>Number</td>
<td>æŒ‡å®šå®¹å™¨å¯åŠ¨å®Œæˆåå»¶è¿Ÿå¤šä¹…å¼€å§‹é¦–æ¬¡æ¢æµ‹çš„æ—¶é—´é—´éš”ï¼Œå•ä½ä¸ºç§’ã€‚</td>
</tr>
<tr>
<td>spec.containers[].livenessProbe.timeoutSeconds</td>
<td>Number</td>
<td>å®¹å™¨å¥åº·æ£€æŸ¥çš„æ¢æµ‹ç­‰å¾…æ—¶é—´ï¼Œå•ä½ä¸ºç§’ï¼Œé»˜è®¤ä¸º 1 ç§’ã€‚è‹¥è¶…è¿‡è¯¥æ—¶é—´ï¼Œåˆ™è®¤ä¸ºè¯¥æ¬¡æ¢æµ‹å¤±è´¥ã€‚</td>
</tr>
<tr>
<td>spec.containers[].livenessProbe.periodSeconds</td>
<td>Number</td>
<td>å¯¹å®¹å™¨å¥åº·æ£€æŸ¥çš„å®šæœŸæ¢æµ‹æ—¶é—´è®¾ç½®ï¼Œå•ä½ä¸ºç§’ï¼Œé»˜è®¤æ¯ 10 ç§’æ¢æµ‹ä¸€æ¬¡ã€‚<code>Kubernetes</code>å¦‚æœè¿ç»­æ‰§è¡Œ3æ¬¡Livenessæ¢æµ‹å‡å¤±è´¥ï¼Œåˆ™ä¼šæ€æ‰å¹¶é‡å¯å®¹å™¨</td>
</tr>
<tr>
<td>spec.containers[].livenessProbe.failureThreshold</td>
<td>Number</td>
<td>è¿ç»­æ¢æµ‹å¤±è´¥å¤šå°‘æ¬¡æ‰è¢«è®¤å®šä¸ºå¤±è´¥ã€‚é»˜è®¤æ˜¯3ã€‚æœ€å°å€¼æ˜¯1</td>
</tr>
<tr>
<td>spec.containers[].livenessProbe.successThreshold</td>
<td>Number</td>
<td>è¿ç»­æ¢æµ‹æˆåŠŸå¤šå°‘æ¬¡æ‰è¢«è®¤å®šä¸ºæˆåŠŸã€‚é»˜è®¤æ˜¯1</td>
</tr>
</tbody>
</table>
<ul>
<li><code>infrastructure Container:</code><!-- raw HTML omitted -->åŸºç¡€å®¹å™¨ï¼Œç»´æŠ¤æ•´ä¸ª<code>Pod</code>ç½‘ç»œç©ºé—´<!-- raw HTML omitted --></li>
<li><code>initContainers:</code><!-- raw HTML omitted -->åˆå§‹åŒ–å®¹å™¨ï¼Œå…ˆäºä¸šåŠ¡å®¹å™¨å¼€å§‹è¿è¡Œ<!-- raw HTML omitted --></li>
<li><code>Containers:</code><!-- raw HTML omitted -->ä¸šåŠ¡å®¹å™¨ï¼Œå¹¶è¡Œå¯åŠ¨<!-- raw HTML omitted --></li>
<li><code>Pod</code><!-- raw HTML omitted -->å†…æ‰€æœ‰å®¹å™¨å…¬ç”¨ä¸€ä¸ª<!-- raw HTML omitted --><code>ip</code></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Pod</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">initc-template</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">default</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">initc-template</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">initContainers</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">initc-template</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">busybox</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">imagePullPolicy</span>: <span style="color:#ae81ff">IfNotPresent</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">command</span>: [<span style="color:#e6db74">&#39;sh&#39;</span>, <span style="color:#e6db74">&#39;-c&#39;</span>, <span style="color:#e6db74">&#39;sleep 10; echo &#34;Hello&#34; &gt;&gt;/tmp/hello.txt&#39;</span>]
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">my-container</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">busybox</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">command</span>: [<span style="color:#e6db74">&#39;sh&#39;</span>, <span style="color:#e6db74">&#39;-c&#39;</span>, <span style="color:#e6db74">&#39;echo The app is running! &amp;&amp; sleep 3600&#39;</span>]</span></span></code></pre></div><ul>
<li><code>exec</code><!-- raw HTML omitted -->å‘½ä»¤ï¼šåœ¨å®¹å™¨å†…æ‰§è¡Œä¸€æ¬¡å‘½ä»¤ï¼Œå¦‚æœå‘½ä»¤æ‰§è¡Œçš„é€€å‡ºç ä¸º<code>0</code>ï¼Œåˆ™è®¤ä¸ºç¨‹åºæ­£å¸¸ï¼Œå¦åˆ™ä¸æ­£å¸¸<!-- raw HTML omitted --></li>
<li><code>Pod</code><!-- raw HTML omitted -->äº”ç§çŠ¶æ€<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li><code>Pending(æŒ‚èµ·)</code>ï¼š<code>API Server</code><!-- raw HTML omitted -->å·²ç»åˆ›å»ºäº†<code>Pod</code>èµ„æºå¯¹è±¡ï¼Œä½†å®ƒå°šæœªè¢«è°ƒåº¦å®Œæˆæˆ–è€…ä»å¤„äºä¸‹è½½é•œåƒçš„è¿‡ç¨‹ä¸­<!-- raw HTML omitted --></li>
<li><code>Running(è¿è¡Œä¸­)</code>ï¼š<code>Pod</code><!-- raw HTML omitted -->å·²ç»è¢«è°ƒåº¦åˆ°æŸèŠ‚ç‚¹ï¼Œå¹¶ä¸”æ‰€æœ‰å®¹å™¨éƒ½å·²ç»è¢«<code>kubelet</code>åˆ›å»ºå®Œæˆ<!-- raw HTML omitted --></li>
<li><code>Succeeded(æˆåŠŸç»ˆæ­¢)</code>ï¼š<code>Pod</code><!-- raw HTML omitted -->ä¸­çš„æ‰€æœ‰å®¹å™¨éƒ½å·²ç»æˆåŠŸç»ˆæ­¢å¹¶ä¸”ä¸ä¼šè¢«é‡å¯<!-- raw HTML omitted --></li>
<li><code>Failed(å¤±è´¥)</code><!-- raw HTML omitted -->ï¼šæ‰€æœ‰å®¹å™¨éƒ½å·²ç»ç»ˆæ­¢ï¼Œä½†è‡³å°‘æœ‰ä¸€ä¸ªå®¹å™¨ç»ˆæ­¢å¤±è´¥ï¼Œå³å®¹å™¨è¿”å›äº†é<code>0</code>å€¼çš„é€€å‡ºçŠ¶æ€<!-- raw HTML omitted --></li>
<li><code>Unknown(æœªçŸ¥)</code>ï¼š<code>API Server</code><!-- raw HTML omitted -->æ— æ³•æ­£å¸¸è·å–åˆ°<code>Pod</code>å¯¹è±¡çš„çŠ¶æ€ä¿¡æ¯ï¼Œé€šå¸¸ç”±äºç½‘ç»œé€šä¿¡å¤±è´¥æ‰€å¯¼è‡´<!-- raw HTML omitted --></li>
</ul>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">spec</span>:   	<span style="color:#75715e"># å¿…é€‰ï¼ŒPodä¸­å®¹å™¨çš„è¯¦ç»†å®šä¹‰</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">containers</span>:   	<span style="color:#75715e"># å¿…é€‰ï¼ŒPodä¸­å®¹å™¨åˆ—è¡¨</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">lifecycle</span>:   	<span style="color:#75715e"># ç”Ÿå‘½å‘¨æœŸé’©å­</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">postStart</span>:  	<span style="color:#75715e"># å®¹å™¨å¯åŠ¨åç«‹å³æ‰§è¡Œæ­¤é’©å­,å¦‚æœæ‰§è¡Œå¤±è´¥,ä¼šæ ¹æ®é‡å¯ç­–ç•¥è¿›è¡Œé‡å¯</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f92672">exec</span>:  	<span style="color:#75715e"># é€šè¿‡æ‰§è¡Œç‰¹å®šå‘½ä»¤æ¥æ¢æµ‹å®¹å™¨å¥åº·çŠ¶æ€</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">command</span>: [<span style="color:#e6db74">&#34;/bin/sh&#34;</span>,<span style="color:#e6db74">&#34;-c&#34;</span>,<span style="color:#e6db74">&#34;echo Hello from the postStart handler&gt; /usr/share/message&#34;</span>]
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">preStop</span>:  	<span style="color:#75715e"># å®¹å™¨ç»ˆæ­¢å‰æ‰§è¡Œæ­¤é’©å­,æ— è®ºç»“æœå¦‚ä½•,å®¹å™¨éƒ½ä¼šç»ˆæ­¢</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f92672">exec</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">command</span>: [<span style="color:#e6db74">&#34;/bin/sh&#34;</span>,<span style="color:#e6db74">&#34;-c&#34;</span>,<span style="color:#e6db74">&#34;nginx -s quit; while killall -0 nginx; do sleep 1; done&#34;</span>]
</span></span><span style="display:flex;"><span><span style="color:#75715e">#################  		å¯åŠ¨æ¢é’ˆ	  #####################</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">startupProbe</span>:  	<span style="color:#75715e"># å®¹å™¨å¯åŠ¨å®Œæ¯•çš„é…ç½®ï¼Œè¯¥é…ç½®ä¸readinessProbeä¸€è‡´ï¼Œåœ¨lifecycleå’ŒProbeä¹‹å‰è¿è¡Œï¼Œå¤±è´¥åˆ™é‡å¯</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">tcpSocket</span>:   		<span style="color:#75715e"># ä½¿ç”¨TcpSocketã€httpGetå¥åº·æ£€æŸ¥</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">port</span>: <span style="color:#ae81ff">8010</span>   	<span style="color:#75715e"># æ¢æµ‹8010ç«¯å£</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">failureThreshold</span>: <span style="color:#ae81ff">5</span>  	<span style="color:#75715e"># æ£€æµ‹å¤±è´¥5æ¬¡è¡¨ç¤ºæœªå°±ç»ª</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">initialDelaySeconds</span>: <span style="color:#ae81ff">60</span>   	<span style="color:#75715e"># æŒ‡å®šå®¹å™¨å¯åŠ¨60sä¹‹åå¼€å§‹æ‰§è¡ŒLivenessæ¢æµ‹ï¼Œ</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">periodSeconds</span>: <span style="color:#ae81ff">10</span>  	<span style="color:#75715e"># ä¸¤æ¬¡æ¢æµ‹çš„é—´éš”å¤šå°‘ç§’ï¼Œé»˜è®¤å€¼ä¸º10</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">successThreshold</span>: <span style="color:#ae81ff">1</span>  	<span style="color:#75715e"># è¿ç»­å¤šå°‘æ¬¡æ£€æµ‹æˆåŠŸè®¤ä¸ºå®¹å™¨æ­£å¸¸ï¼Œé»˜è®¤å€¼ä¸º1ã€‚ä¸æ”¯æŒä¿®æ”¹</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">failureThreshold</span>: <span style="color:#ae81ff">3</span>  	<span style="color:#75715e"># è¿ç»­å¤šå°‘æ¬¡æ£€æµ‹å¤±è´¥è®¤ä¸ºå®¹å™¨å¼‚å¸¸ï¼Œé»˜è®¤å€¼ä¸º3</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">timeoutSeconds</span>: <span style="color:#ae81ff">5</span>  	<span style="color:#75715e"># æ¢æµ‹è¯·æ±‚è¶…æ—¶æ—¶é—´</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##################  	å­˜æ´»æ¢é’ˆç¼–å†™æ–¹å¼  	################</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">livenessprobe</span>:  	<span style="color:#75715e"># å­˜æ´»æ¢é’ˆæ£€æŸ¥,ä¸é€šè¿‡ä¸è½¬å‘æµé‡</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">tcpSocket</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">port</span>: <span style="color:#ae81ff">8010</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">failureThreshold</span>: <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">initialDelaySeconds</span>: <span style="color:#ae81ff">60</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">periodSeconds</span>: <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">successThreshold</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">timeoutSeconds</span>: <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#####################  		å°±ç»ªæ¢é’ˆç¼–å†™æ–¹å¼  		################</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">readinessProbe</span>:   	<span style="color:#75715e"># å°±ç»ªæ¢é’ˆæ£€æŸ¥ã€ä¸é€šè¿‡é‡å»ºpod</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">tcpSocket</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">port</span>: <span style="color:#ae81ff">8010</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">failureThreshold</span>: <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">initialDelaySeconds</span>: <span style="color:#ae81ff">60</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">periodSeconds</span>: <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">successThreshold</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">timeoutSeconds</span>: <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">####################  		httpGetç¼–å†™  		###########################</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">httpGet</span>:
</span></span><span style="display:flex;"><span>       <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/  	# URIåœ°å€</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f92672">port</span>: <span style="color:#ae81ff">80</span>  	<span style="color:#75715e"># ç«¯å£å·,æˆ–è€…åè®®ï¼šhttp/https</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f92672">host</span>: <span style="color:#ae81ff">192.168.109.100</span>  	<span style="color:#75715e"># ä¸»æœºåœ°å€  </span>
</span></span><span style="display:flex;"><span>       <span style="color:#f92672">scheme</span>: <span style="color:#ae81ff">HTTP  	# æ”¯æŒçš„åè®®ï¼Œhttpæˆ–è€…https</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">failureThreshold</span>: <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">initialDelaySeconds</span>: <span style="color:#ae81ff">60</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">periodSeconds</span>: <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">successThreshold</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">timeoutSeconds</span>: <span style="color:#ae81ff">5</span></span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="9">
<li><code>spec.volumes</code><!-- raw HTML omitted -->æŒ‚è½½ç›®å½•å­—æ®µ<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<table>
<thead>
<tr>
<th>å‚æ•°å</th>
<th>å­—æ®µç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>spec.volumes[].name</td>
<td>String</td>
<td>å®šä¹‰<code>Pod</code>å…±äº«å­˜å‚¨å·çš„åç§°ï¼Œå®¹å™¨å®šä¹‰éƒ¨åˆ† <code>spec.containers[].volumeMounts[].name</code>çš„å€¼å’Œè¿™é‡Œæ˜¯ä¸€æ ·çš„ã€‚</td>
</tr>
<tr>
<td>spec.volumes[].emptyDir</td>
<td>Object</td>
<td>æŒ‡å®š<code>Pod</code>çš„ä¸´æ—¶ç›®å½•ï¼Œå€¼ä¸ºä¸€ä¸ªç©ºå¯¹è±¡ï¼š<code>emptyDir:{}</code></td>
</tr>
<tr>
<td>spec.volumes[].hostPath</td>
<td>Object</td>
<td>æŒ‡å®šæŒ‚è½½<code>Pod</code>æ‰€åœ¨å®¿ä¸»æœºçš„ç›®å½•ã€‚</td>
</tr>
<tr>
<td>spec.volumes[].hostPath.path</td>
<td>String</td>
<td>æŒ‡å®š<code>Pod</code>æ‰€åœ¨ä¸»æœºçš„ç›®å½•ï¼Œå°†è¢«ç”¨äºå®¹å™¨ä¸­<code>mount</code>çš„ç›®å½•ã€‚</td>
</tr>
<tr>
<td>spec.volumes.nfs</td>
<td></td>
<td></td>
</tr>
<tr>
<td>spec.volumes[]</td>
<td>Object</td>
<td>æŒ‡å®šç±»å‹ä¸º<code>Secret</code>çš„å­˜å‚¨å·ï¼Œ<code>Secret</code>æ„ä¸ºç§å¯†ã€ç§˜å¯†ï¼Œè¿™å¾ˆå®¹æ˜“ç†è§£ï¼Œå®ƒå­˜å‚¨ä¸€äº›å¯†ç ã€å¯†é’¥ç­‰æ•æ„Ÿå®‰å…¨æ–‡ä»¶ã€‚æŒ‚è½½é›†ç¾¤é¢„å®šä¹‰çš„<code>Secret</code>å¯¹è±¡åˆ°å®¹å™¨å†…éƒ¨ã€‚</td>
</tr>
<tr>
<td>spec.volumes[].configMap</td>
<td>Object</td>
<td>æŒ‡å®šç±»å‹ä¸º<code>ConfigMap</code>çš„å­˜å‚¨å·ï¼Œè¡¨ç¤ºæŒ‚è½½é›†ç¾¤é¢„å®šä¹‰çš„<code>ConfigMap</code>å¯¹è±¡åˆ°å®¹å™¨å†…éƒ¨ã€‚</td>
</tr>
</tbody>
</table>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl explain deployment.spec.volumes  	<span style="color:#75715e"># è·å– deploymentå­˜å‚¨ä½¿ç”¨</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ kubectl explain deployment.spec.volumes.hostPath.type  	<span style="color:#75715e"># ç±»å‹å£°æ˜  </span></span></span></code></pre></div><ul>
<li><!-- raw HTML omitted -->ç®€å•å­˜å‚¨æ¨¡å¼â†’<!-- raw HTML omitted --><code>volume-emptydir</code></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Pod  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span> <span style="color:#f92672">name</span>: <span style="color:#ae81ff">volume-emptydir </span> <span style="color:#75715e"># å®šä¹‰åç§°</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">default</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:   	<span style="color:#75715e"># å¿…é€‰ï¼ŒPodä¸­å®¹å™¨çš„è¯¦ç»†å®šä¹‰</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">containers</span>:  	<span style="color:#75715e"># å¿…é€‰ï¼ŒPodä¸­å®¹å™¨åˆ—è¡¨</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginx:1.17.1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">imagePullPolicy</span>: <span style="color:#ae81ff">IfNotPresent</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">volumeMounts</span>: <span style="color:#75715e"># å°†logs-volumeæŒ‚è½½åˆ°nginxå®¹å™¨ä¸­å¯¹åº”çš„ç›®å½•ï¼Œè¯¥ç›®å½•ä¸º/var/log/nginx</span>
</span></span><span style="display:flex;"><span>          - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">logs-volume</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/log/nginx </span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">busybox</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">image</span>: <span style="color:#ae81ff">busybox:1.30  	# å¯ä»¥é€‰æ‹© 1.28.4ç‰ˆæœ¬</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">imagePullPolicy</span>: <span style="color:#ae81ff">IfNotPresent</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">command</span>: [<span style="color:#e6db74">&#34;/bin/sh&#34;</span>,<span style="color:#e6db74">&#34;-c&#34;</span>,<span style="color:#e6db74">&#34;tail -f /logs/access.log&#34;</span>] <span style="color:#75715e"># åˆå§‹å‘½ä»¤ï¼ŒåŠ¨æ€è¯»å–æŒ‡å®šæ–‡ä»¶</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">volumeMounts</span>: <span style="color:#75715e"># å°†logs-volumeæŒ‚è½½åˆ°busyboxå®¹å™¨ä¸­çš„å¯¹åº”ç›®å½•ï¼Œè¯¥ç›®å½•ä¸º/logs</span>
</span></span><span style="display:flex;"><span>          - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">logs-volume</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/logs</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">volumes</span>:   	<span style="color:#75715e"># å£°æ˜volumeï¼Œnameä¸ºlogs-volumeï¼Œç±»å‹ä¸ºemptyDir</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">logs-volume  	# å…±äº«å­˜å‚¨å·åç§° ï¼ˆvolumesç±»å‹æœ‰å¾ˆå¤šç§ï¼‰</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">emptyDir</span>: {}   		<span style="color:#75715e"># ç±»å‹ä¸ºemtyDirçš„å­˜å‚¨å·ï¼Œä¸PodåŒç”Ÿå‘½å‘¨æœŸçš„ä¸€ä¸ªä¸´æ—¶ç›®å½•ã€‚ä¸ºç©ºå€¼</span></span></span></code></pre></div><ul>
<li><!-- raw HTML omitted -->ç®€å•å­˜å‚¨æ¨¡å¼â†’<!-- raw HTML omitted --><code>volume-HostPath</code></li>
</ul>
<blockquote>
<ul>
<li><code>DirectoryOrCreate</code><!-- raw HTML omitted -->ï¼šç›®å½•å­˜åœ¨å°±ä½¿ç”¨ï¼Œä¸å­˜åœ¨å°±å…ˆåˆ›å»ºåä½¿ç”¨<!-- raw HTML omitted --></li>
<li><code>Directory</code><!-- raw HTML omitted -->ï¼šç›®å½•å¿…é¡»å­˜åœ¨<!-- raw HTML omitted --></li>
<li><code>FileOrCreate</code><!-- raw HTML omitted -->ï¼šæ–‡ä»¶å­˜åœ¨å°±ä½¿ç”¨ï¼Œä¸å­˜åœ¨å°±å…ˆåˆ›å»ºåä½¿ç”¨<!-- raw HTML omitted --></li>
<li><code>File</code><!-- raw HTML omitted -->ï¼šæ–‡ä»¶å¿…é¡»å­˜åœ¨<!-- raw HTML omitted --></li>
<li><code>Socket</code><!-- raw HTML omitted -->ï¼š<code>unix</code>å¥—æ¥å­—å¿…é¡»å­˜åœ¨<!-- raw HTML omitted --></li>
<li><code>CharDevice</code><!-- raw HTML omitted -->ï¼šå­—ç¬¦è®¾å¤‡å¿…é¡»å­˜åœ¨<!-- raw HTML omitted --></li>
<li><code>BlockDevice</code><!-- raw HTML omitted -->ï¼šå—è®¾å¤‡å¿…é¡»å­˜åœ¨<!-- raw HTML omitted --></li>
</ul>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Pod</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">volume-hostpath</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">default</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginx:1.17.1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">imagePullPolicy</span>: <span style="color:#ae81ff">IfNotPresent</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">volumeMounts</span>: <span style="color:#75715e"># å°†logs-volumeæŒ‚è½½åˆ°nginxå®¹å™¨ä¸­å¯¹åº”çš„ç›®å½•ï¼Œè¯¥ç›®å½•ä¸º/var/log/nginx</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">logs-volume</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/log/nginx</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">busybox</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">image</span>: <span style="color:#ae81ff">busybox:1.30</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">imagePullPolicy</span>: <span style="color:#ae81ff">IfNotPresent</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">command</span>: [<span style="color:#e6db74">&#34;/bin/sh&#34;</span>,<span style="color:#e6db74">&#34;-c&#34;</span>,<span style="color:#e6db74">&#34;tail -f /logs/access.log&#34;</span>] <span style="color:#75715e"># åˆå§‹å‘½ä»¤ï¼ŒåŠ¨æ€è¯»å–æŒ‡å®šæ–‡ä»¶</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">volumeMounts</span>: <span style="color:#75715e"># å°†logs-volumeæŒ‚è½½åˆ°busyboxå®¹å™¨ä¸­çš„å¯¹åº”ç›®å½•ï¼Œè¯¥ç›®å½•ä¸º/logs</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">logs-volume</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/logs</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">volumes</span>: <span style="color:#75715e"># å£°æ˜volumeï¼Œnameä¸ºlogs-volumeï¼Œç±»å‹ä¸ºhostPath</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">logs-volume</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">hostPath</span>:  <span style="color:#75715e"># ç±»å‹ä¸ºhostPathçš„å­˜å‚¨å·ï¼Œè¡¨ç¤ºæŒ‚è½½Podæ‰€åœ¨å®¿ä¸»æœºçš„ç›®å½•</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/root/logs </span> <span style="color:#75715e"># Podæ‰€åœ¨å®¿ä¸»æœºçš„ç›®å½•ï¼Œå°†è¢«ç”¨äºåŒæœŸä¸­mountçš„ç›®å½•</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">type</span>: <span style="color:#ae81ff">DirectoryOrCreate</span> <span style="color:#75715e"># ç›®å½•å­˜åœ¨å°±ä½¿ç”¨ï¼Œä¸å­˜åœ¨å°±å…ˆåˆ›å»ºå†ä½¿ç”¨ </span></span></span></code></pre></div><ul>
<li><!-- raw HTML omitted -->ç®€å•å­˜å‚¨æ¨¡å¼â†’<!-- raw HTML omitted --><code>volume-nfs</code></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Pod</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span> <span style="color:#f92672">name</span>: <span style="color:#ae81ff">volume-nfs</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">default</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span> <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginx:1.17.1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">imagePullPolicy</span>: <span style="color:#ae81ff">IfNotPresent</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">volumeMounts</span>:  	<span style="color:#75715e"># å°†logs-volumeæŒ‚è½½åˆ°nginxå®¹å™¨ä¸­å¯¹åº”çš„ç›®å½•ï¼Œè¯¥ç›®å½•ä¸º/var/log/nginx</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">logs-volume</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/log/nginx</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">busybox</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">image</span>: <span style="color:#ae81ff">busybox:1.30</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">imagePullPolicy</span>: <span style="color:#ae81ff">IfNotPresent</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">command</span>: [<span style="color:#e6db74">&#34;/bin/sh&#34;</span>,<span style="color:#e6db74">&#34;-c&#34;</span>,<span style="color:#e6db74">&#34;tail -f /logs/access.log&#34;</span>]  	<span style="color:#75715e"># åˆå§‹å‘½ä»¤ï¼ŒåŠ¨æ€è¯»å–æŒ‡å®šæ–‡ä»¶</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">volumeMounts</span>:  	<span style="color:#75715e"># å°†logs-volumeæŒ‚è½½åˆ°busyboxå®¹å™¨ä¸­çš„å¯¹åº”ç›®å½•ï¼Œè¯¥ç›®å½•ä¸º/logs</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">logs-volume</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/logs</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">volumes</span>:  	<span style="color:#75715e"># å£°æ˜volume</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">logs-volume</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">nfs</span>:  	<span style="color:#75715e"># å­˜å‚¨ç±»å‹ï¼Œå’Œåº•å±‚æ­£åˆ™çš„å­˜å‚¨å¯¹åº”</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">server</span>: <span style="color:#ae81ff">192.168.18.100</span>  	<span style="color:#75715e"># NFSæœåŠ¡å™¨åœ°å€</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/root/data/nfs  	# å…±äº«æ–‡ä»¶è·¯å¾„</span></span></span></code></pre></div><ul>
<li><!-- raw HTML omitted -->é«˜çº§å­˜å‚¨æ¨¡å¼â†’<!-- raw HTML omitted --><code>volume-pv</code></li>
</ul>
<blockquote>
<ul>
<li><code>PVï¼škubernetes</code><!-- raw HTML omitted -->ç®¡ç†å‘˜ç»´æŠ¤<!-- raw HTML omitted --></li>
</ul>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">PersistentVolume</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span> <span style="color:#f92672">name</span>: <span style="color:#ae81ff">pv2</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span> <span style="color:#f92672">nfs</span>:  	<span style="color:#75715e"># å­˜å‚¨ç±»å‹ï¼Œå’Œåº•å±‚æ­£åˆ™çš„å­˜å‚¨å¯¹åº”</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/root/data/pv1</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">server</span>: <span style="color:#ae81ff">192.168.18.100</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">capacity</span>:  	<span style="color:#75715e"># å­˜å‚¨èƒ½åŠ›ï¼Œç›®å‰åªæ”¯æŒå­˜å‚¨ç©ºé—´çš„è®¾ç½®</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">storage</span>: <span style="color:#ae81ff">2Gi</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">accessModes</span>:  	<span style="color:#75715e"># è®¿é—®æ¨¡å¼</span>
</span></span><span style="display:flex;"><span>   - <span style="color:#ae81ff">ReadWriteMany</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">storageClassName</span>:  	<span style="color:#75715e"># å­˜å‚¨ç±»åˆ«</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">persistentVolumeReclaimPolicy</span>: <span style="color:#ae81ff">Retain  	# å›æ”¶ç­–ç•¥</span></span></span></code></pre></div><ul>
<li><!-- raw HTML omitted -->é«˜çº§å­˜å‚¨â†’<!-- raw HTML omitted --><code>volume-pvc</code></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">PersistentVolumeClaim</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span> <span style="color:#f92672">name</span>: <span style="color:#ae81ff">pvc1</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">dev</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span> <span style="color:#f92672">accessModes</span>:  	<span style="color:#75715e"># è®¿å®¢æ¨¡å¼</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">ReadWriteMany</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:  	<span style="color:#75715e"># é‡‡ç”¨æ ‡ç­¾å¯¹PVé€‰æ‹©</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">storageClassName</span>:  	<span style="color:#75715e"># å­˜å‚¨ç±»åˆ«</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">resources</span>:  	<span style="color:#75715e"># è¯·æ±‚ç©ºé—´</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">requests</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">storage</span>: <span style="color:#ae81ff">1Gi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#################################################### åˆ›å»º Pod è®¿é—® PVC ç±»å‹å­˜å‚¨</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Pod</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">pod1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">dev</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">busybox</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">busybox:1.30</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">command</span>: [<span style="color:#e6db74">&#34;/bin/sh&#34;</span>,<span style="color:#e6db74">&#34;-c&#34;</span>,<span style="color:#e6db74">&#34;while true;do echo pod1 &gt;&gt; /root/out.txt; sleep 10; done;&#34;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumeMounts</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">volume</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/root/</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">volume</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">persistentVolumeClaim</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">claimName</span>: <span style="color:#ae81ff">pvc1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">readOnly</span>: <span style="color:#66d9ef">false</span></span></span></code></pre></div><ul>
<li><!-- raw HTML omitted -->é…ç½®å­˜å‚¨â†’<!-- raw HTML omitted --><code>volumes-secret</code></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Secret</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span> <span style="color:#f92672">name</span>: <span style="color:#ae81ff">secret</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">dev</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">type</span>: <span style="color:#ae81ff">Opaque</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">data</span>:  	<span style="color:#75715e"># æå‰ç¼–ç å®åï¼šdataã€ä½¿ç”¨Kubernetesè¿›è¡Œç¼–ç ä½¿ç”¨ï¼šstringData</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">username</span>: <span style="color:#ae81ff">YWRtaW4=  	# ä½¿ç”¨kubernetesè¿›è¡Œç¼–ç å†™åŸæ•°æ®ï¼šadmin</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">password</span>: <span style="color:#ae81ff">MTIzNDU2  	# ä½¿ç”¨kubernetesè¿›è¡Œç¼–ç å†™åŸæ•°æ®ï¼š123456</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">############################################## é…ç½® pod-secret</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Pod</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span> <span style="color:#f92672">name</span>: <span style="color:#ae81ff">pod-secret</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">dev</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span> <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginx:1.17.1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">volumeMounts</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/secret/config</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">name</span>: <span style="color:#ae81ff">config</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">config</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">secret</span>:  	<span style="color:#75715e"># ç±»å‹ä¸ºsecretçš„å­˜å‚¨å·ï¼ŒæŒ‚è½½é›†ç¾¤ä¸å®šä¹‰çš„secretå¯¹è±¡åˆ°å®¹å™¨å†…éƒ¨</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">secretName</span>: <span style="color:#ae81ff">secret</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">items</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">key</span>: <span style="color:#ae81ff">string</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">path</span>: <span style="color:#ae81ff">string</span></span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="10">
<li><!-- raw HTML omitted -->é¢å¤–çš„å‚æ•°å¯¹è±¡<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<table>
<thead>
<tr>
<th>å‚æ•°å</th>
<th>å‚æ•°ç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>spec.restartPolicy</td>
<td>String</td>
<td>å®šä¹‰<code>Pod</code>çš„é‡å¯ç­–ç•¥ï¼Œå¯é€‰å€¼ä¸º<code>Always</code>ã€<code>OnFailure</code>ï¼Œé»˜è®¤å€¼ä¸º<code>Always</code>ã€‚<!-- raw HTML omitted -->(1) <!-- raw HTML omitted --><code>Always</code><!-- raw HTML omitted -->ï¼š<code>Pod</code>ä¸€æ—¦ç»ˆæ­¢è¿è¡Œï¼Œæ— è®ºå®¹å™¨æ˜¯å¦‚ä½•ç»ˆæ­¢çš„ï¼Œ<code>kubelet</code>æœåŠ¡éƒ½å°†é‡å¯å®ƒ<!-- raw HTML omitted -->(2) <!-- raw HTML omitted --><code>OnFailure</code><!-- raw HTML omitted -->ï¼šåªæœ‰<code>Pod</code>ä»¥éé›¶é€€å‡ºç ç»ˆæ­¢æ—¶ï¼Œ<code>kubelet</code>æ‰ä¼šé‡å¯è¯¥å®¹å™¨ï¼Œå¦‚æœå®¹å™¨æ­£å¸¸ç»“æŸï¼ˆé€€å‡ºç ä¸º 0ï¼‰ï¼Œåˆ™<code>kubelet</code>å°†ä¸ä¼šé‡å¯å®ƒ<!-- raw HTML omitted --> (3)<!-- raw HTML omitted --><code>Never</code><!-- raw HTML omitted -->ï¼š<code>Pod</code>ç»ˆæ­¢åï¼Œ<code>kubelet</code>å°†é€€å‡ºç æŠ¥å‘Šç»™<code>master</code>ï¼Œä¸ä¼šé‡å¯è¯¥ <code>Pod</code></td>
</tr>
<tr>
<td>spec.nodeName</td>
<td></td>
<td>å®šå‘è°ƒåº¦</td>
</tr>
<tr>
<td>spec.nodeSelector</td>
<td>Object</td>
<td>å®šå‘è°ƒåº¦ï¼Œå®šä¹‰èŠ‚ç‚¹çš„è¿‡æ»¤æ ‡ç­¾ï¼ˆä»¥<code>key:value</code>æ ¼å¼æŒ‡å®šï¼‰ã€‚</td>
</tr>
<tr>
<td>pod.spec.affinity</td>
<td>äº²å’Œè°ƒåº¦</td>
<td></td>
</tr>
<tr>
<td>pod.spec.affinity.nodeAffinity</td>
<td></td>
<td>ï¼ˆnodeäº²å’Œæ€§ï¼‰ï¼šä»¥Nodeä¸ºç›®æ ‡ï¼Œè§£å†³Podå¯ä»¥è°ƒåº¦åˆ°é‚£äº›Nodeçš„é—®é¢˜ã€‚</td>
</tr>
<tr>
<td>pod.spec.affinity.podAffinity</td>
<td></td>
<td>ï¼ˆpodäº²å’Œæ€§ï¼‰ï¼šä»¥Podä¸ºç›®æ ‡ï¼Œè§£å†³Podå¯ä»¥å’Œé‚£äº›å·²å­˜åœ¨çš„Podéƒ¨ç½²åœ¨åŒä¸€ä¸ªæ‹“æ‰‘åŸŸä¸­çš„é—®é¢˜ã€‚</td>
</tr>
<tr>
<td>pod.spec.affinity.podAntiAffinity</td>
<td></td>
<td>ï¼ˆpodåäº²å’Œæ€§ï¼‰ï¼šä»¥Podä¸ºç›®æ ‡ï¼Œè§£å†³Podä¸èƒ½å’Œé‚£äº›å·²ç»å­˜åœ¨çš„Podéƒ¨ç½²åœ¨åŒä¸€æ‹“æ‰‘åŸŸä¸­çš„é—®é¢˜ã€‚</td>
</tr>
<tr>
<td>pod.spec.tolerations</td>
<td>å®¹å¿è°ƒåº¦</td>
<td>æ±¡ç‚¹å°±æ˜¯æ‹’ç»ï¼Œå®¹å¿å°±æ˜¯å¿½ç•¥ï¼ŒNodeé€šè¿‡æ±¡ç‚¹æ‹’ç»Podè°ƒåº¦ä¸Šå»ï¼ŒPodé€šè¿‡å®¹å¿å¿½ç•¥æ‹’ç»</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>spec.imagePullSecrets</td>
<td>List</td>
<td>å®šä¹‰æ‹‰å–é•œåƒæ—¶ä½¿ç”¨<code>Secret</code>åç§°ï¼ˆä»¥<code>name:secretkey</code>æ ¼å¼æŒ‡å®šï¼‰ã€‚</td>
</tr>
<tr>
<td>spec.hostNetwork</td>
<td>Boolean</td>
<td>å®šä¹‰æ˜¯å¦ä½¿ç”¨ä¸»æœºç½‘ç»œæ¨¡å¼ï¼Œé»˜è®¤å€¼ä¸º falseã€‚ è®¾ç½® true è¡¨ç¤ºä½¿ç”¨å®¿ä¸»æœºç½‘ç»œï¼Œä¸ä½¿ç”¨ Docker ç½‘æ¡¥ï¼ŒåŒæ—¶è®¾ç½®äº† true å°†æ— æ³•åœ¨åŒä¸€å°å®¿ä¸»æœºä¸Šå¯åŠ¨ç¬¬äºŒä¸ªå‰¯æœ¬ã€‚</td>
</tr>
<tr>
<td>service.spec.type</td>
<td></td>
<td><code>type</code>ç¡®å®šæœåŠ¡çš„å…¬å¼€æ–¹å¼ã€‚ é»˜è®¤ä¸º<code>ClusterIP</code>ã€‚æœ‰æ•ˆçš„é€‰é¡¹æ˜¯<code>ExternalName</code>ã€<code>ClusterIP</code>ã€<code>NodePort</code>å’Œ<code>LoadBalancer</code></td>
</tr>
<tr>
<td>service.spec.type.ClusterIP</td>
<td></td>
<td><code>ClusterIP</code>ä¸ºè´Ÿè½½å‡è¡¡åˆ†é…é›†ç¾¤å†…éƒ¨<code>IP</code>åœ°å€ç«¯ç‚¹ã€‚ ç«¯ç‚¹ç”±é€‰æ‹©å™¨ç¡®å®šï¼Œæˆ–è€…å¦‚æœä¸æ˜¯é€šè¿‡æ‰‹åŠ¨æ„é€ <code>Endpoints</code>å¯¹è±¡æˆ–<code>EndpointSlice</code>æŒ‡å®šå¯¹è±¡ã€‚ å¦‚æœ<code>clusterIP</code>ä¸º<code>None</code>ï¼Œåˆ™ä¸åˆ†é…è™šæ‹Ÿ<code>IP</code>ï¼Œå¹¶ä¸”ç«¯ç‚¹ä½œä¸ºä¸€ç»„ç«¯ç‚¹è€Œä¸æ˜¯è™šæ‹Ÿ<code>IP</code>å‘å¸ƒã€‚</td>
</tr>
<tr>
<td>service.spec.type.NodePort</td>
<td></td>
<td><code>NodePort</code>å»ºç«‹åœ¨<code>ClusterIP</code>ä¹‹ä¸Šï¼Œå¹¶åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šåˆ†é…ä¸€ä¸ªç«¯å£è·¯ç”±åˆ°ä¸<code>clusterIP</code>ç›¸åŒçš„ç«¯ç‚¹ã€‚</td>
</tr>
<tr>
<td>service.spec.type.LoadBalancer</td>
<td></td>
<td><code>LoadBalancer</code>å»ºç«‹åœ¨<code>NodePort</code>å¹¶åˆ›å»ºä¸€ä¸ªå¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨ï¼ˆå¦‚æœå½“å‰æ”¯æŒ<code>cloud</code>) è·¯ç”±åˆ°ä¸<code>clusterIP</code>ç›¸åŒçš„ç«¯ç‚¹ã€‚</td>
</tr>
<tr>
<td>service.spec.type.ExternalName</td>
<td></td>
<td><code>ExternalName</code>å°†æ­¤æœåŠ¡åˆ«åä¸ºæŒ‡å®šçš„<code>externalName</code>ã€‚ å…¶ä»–å‡ ä¸ªé¢†åŸŸä¸é€‚ç”¨äº<code>ExternalName</code>æœåŠ¡</td>
</tr>
</tbody>
</table>
<ul>
<li><code>tolerations</code><!-- raw HTML omitted -->(å®¹å¿)é…ç½®<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl explain deployment.spec.template.spec.tolerations</span></span></code></pre></div><ul>
<li><code>affinity</code><!-- raw HTML omitted -->(äº²å’Œæ€§)é…ç½®<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl explain deployment.spec.template.spec.affinity  	<span style="color:#75715e"># æŸ¥çœ‹ Deployment äº²å’Œæ€§ä½¿ç”¨</span></span></span></code></pre></div><blockquote>
<ul>
<li><code>nodeAffinity</code><!-- raw HTML omitted -->èŠ‚ç‚¹äº²å’Œæ€§<!-- raw HTML omitted --></li>
<li><code>requiredDuringSchedulingIgnoredDuringExecution:</code><!-- raw HTML omitted -->ç¡¬æ€§è¦æ±‚ï¼Œå¿…é¡»æ»¡è¶³æ¡ä»¶<!-- raw HTML omitted --></li>
<li><code>preferredDuringSchedulingIgnoredDuringExecution:</code><!-- raw HTML omitted -->è½¯æ€§è¦æ±‚ï¼Œä¸å¼ºåˆ¶æ»¡è¶³<!-- raw HTML omitted --></li>
<li><code>In</code><!-- raw HTML omitted -->ï¼šæ»¡è¶³æ¡ä»¶ä¹‹ä¸€<!-- raw HTML omitted --></li>
<li><code>NotIn</code><!-- raw HTML omitted -->ï¼šæ‰€æœ‰æ¡ä»¶éƒ½ä¸æ»¡è¶³ï¼Œåäº²å’Œæ€§<!-- raw HTML omitted --></li>
<li><code>Exists</code><!-- raw HTML omitted -->ï¼šå­˜åœ¨å°±æ»¡è¶³<!-- raw HTML omitted --></li>
<li><code>DoesNotExist</code><!-- raw HTML omitted -->ä¸å­˜åœ¨å°±æ»¡è¶³<!-- raw HTML omitted --></li>
<li><code>Gt</code><!-- raw HTML omitted -->å¤§äºèŠ‚ç‚¹ä¸Šçš„æ•°å€¼å°±æ»¡è¶³<!-- raw HTML omitted --></li>
<li><code>Lt</code><!-- raw HTML omitted -->å°äºèŠ‚ç‚¹ä¸Šçš„æ•°å€¼å°±æ»¡è¶³<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl explain deployment.spec.template.spec.affinity.nodeAffinity  	<span style="color:#75715e"># æŸ¥çœ‹Deployment nodesäº²å’Œæ€§ä½¿ç”¨</span></span></span></code></pre></div><div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Pod</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">with-affinity-anti-affinity</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">affinity</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">nodeAffinity</span>:  	<span style="color:#75715e"># èŠ‚ç‚¹äº²å’Œæ€§  </span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">requiredDuringSchedulingIgnoredDuringExecution</span>:  	<span style="color:#75715e"># å¿…é¡»æ»¡è¶³æ¡ä»¶</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">nodeSelectorTerms</span>:  	<span style="color:#75715e"># é€‰æ‹©å™¨ï¼ŒnodeSelectorTermsï¼šèŠ‚ç‚¹é€‰æ‹©å™¨ï¼ŒlabelSelectorï¼šæ ‡ç­¾é€‰æ‹©å™¨</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">matchExpressions</span>:  	<span style="color:#75715e"># è¡¨è¾¾å¼åŒ¹é…</span>
</span></span><span style="display:flex;"><span>          - <span style="color:#f92672">key</span>: <span style="color:#ae81ff">kubernetes.io/os  	# å¿…é¡»å­˜åœ¨çš„Key</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">operator</span>: <span style="color:#ae81ff">In  	# åœ¨Keyä¸­æ»¡è¶³ä¸€ä¸ªæ¡ä»¶ï¼ŒåŒ¹é…ç±»å‹ï¼šInã€NotInã€Existsã€DoesNotExistã€Gtã€Lt</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">values</span>:  	<span style="color:#75715e"># ä¸‹æ–¹ value åœ¨ Key ä¸­å¿…é¡»å­˜åœ¨å…¶ä¸­ä¹‹ä¸€(value)</span>
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">linux  	# å¿…é¡»æ˜¯Linuxæ‰éƒ¨ç½²  </span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">preferredDuringSchedulingIgnoredDuringExecution</span>:  	<span style="color:#75715e"># è½¯æ€§è¦æ±‚ï¼Œä¸å¼ºåˆ¶æ»¡è¶³ï¼Œä¼˜å…ˆé€‰æ‹©äº²å’Œæ€§ç›®æ ‡</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">weight</span>: <span style="color:#ae81ff">1</span>  	<span style="color:#75715e"># æƒé‡ï¼Œæ•°å€¼è¶Šå¤§ï¼Œä¼˜å…ˆéƒ¨ç½²</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">preference</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">matchExpressions</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#f92672">key</span>: <span style="color:#ae81ff">label-1</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">operator</span>: <span style="color:#ae81ff">In</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">values</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">key-1</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">weight</span>: <span style="color:#ae81ff">50</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">preference</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">matchExpressions</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#f92672">key</span>: <span style="color:#ae81ff">label-2</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">operator</span>: <span style="color:#ae81ff">In</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">values</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">key-2</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">with-node-affinity</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">registry.k8s.io/pause:2.0</span></span></span></code></pre></div><ul>
<li><code>podAffinity</code><!-- raw HTML omitted -->äº²å’Œæ€§<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl explain pod.spec.affinity.podAffinity</span></span></code></pre></div><div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Pod</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">with-pod-affinity</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">affinity</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">podAffinity</span>:  	<span style="color:#75715e"># Pod äº²å’Œæ€§</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">requiredDuringSchedulingIgnoredDuringExecution</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">labelSelector</span>:  	<span style="color:#75715e"># é€‰æ‹©å™¨ï¼š</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">matchExpressions</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#f92672">key</span>: <span style="color:#ae81ff">security</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">operator</span>: <span style="color:#ae81ff">In</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">values</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">S1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">topologyKey</span>: <span style="color:#ae81ff">topology.kubernetes.io/zone  	# åŒ¹é…èŠ‚ç‚¹æ ‡ç­¾äº²å’Œæ€§</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">podAntiAffinity</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">preferredDuringSchedulingIgnoredDuringExecution</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">weight</span>: <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">podAffinityTerm</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">labelSelector</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">matchExpressions</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#f92672">key</span>: <span style="color:#ae81ff">security</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">operator</span>: <span style="color:#ae81ff">In</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">values</span>:
</span></span><span style="display:flex;"><span>              - <span style="color:#ae81ff">S2</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">topologyKey</span>: <span style="color:#ae81ff">topology.kubernetes.io/zone</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">with-pod-affinity</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">registry.k8s.io/pause:2.0  </span></span></span></code></pre></div><ul>
<li><code>podAntiAffinity</code><!-- raw HTML omitted -->åäº²å’Œæ€§<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl explain pod.spec.affinity.podAntiAffinity  </span></span></code></pre></div></blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">spec</span>:  	<span style="color:#75715e"># å¿…é€‰ï¼ŒPodä¸­å®¹å™¨çš„è¯¦ç»†å®šä¹‰</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">replicas</span>: <span style="color:#ae81ff">2</span>  	<span style="color:#75715e"># åˆ›å»ºPodä¸ªæ•°</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">selector</span>:  	<span style="color:#75715e"># æ ‡ç­¾é€‰æ‹©å™¨</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">matchLabels</span>:  	<span style="color:#75715e"># æ ‡ç­¾é€‰æ‹©æ–¹å¼:ç›´æ¥ç»™å®šæ ‡ç­¾é”®å€¼,è¿™é‡Œæ˜¯å–äº¤é›†çš„,ä¹Ÿå°±æ˜¯Podå¿…é¡»æ»¡è¶³ä¸‹é¢ä¸¤ä¸ªæ ‡ç­¾æ‰èƒ½è¢«è°ƒåº¦</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">project</span>: <span style="color:#ae81ff">ms</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">app</span>: <span style="color:#ae81ff">product  	# æ­¤è¡Œä»¥ä¸Šå®šä¹‰æ§åˆ¶å™¨æœ¬èº«</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">template</span>:  	<span style="color:#75715e"># å®šä¹‰Deploymentæ›´æ–°å›æ»š</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>         - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">string</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">annotations</span>:  	<span style="color:#75715e"># æ³¨é‡Šï¼Œä¸èƒ½ä½œä¸ºè¢«ç­›é€‰</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">hostAliases</span>:  	<span style="color:#75715e"># /etc/hosts/æ‰‹åŠ¨æ·»åŠ è§£æ</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">ip</span>: <span style="color:#e6db74">&#34;192.168.4.110&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">hostnames</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#e6db74">&#34;k8s.com&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">containers</span>:   	<span style="color:#75715e"># å¿…é€‰ï¼ŒPodä¸­å®¹å™¨åˆ—è¡¨</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">restartPolicy</span>: [<span style="color:#ae81ff">Alwaysã€Neverã€OnFailure] </span> <span style="color:#75715e">#é»˜è®¤K8S-Podçš„é‡å¯ç­–ç•¥,æ­¤å®¹å™¨é€€å‡ºåç«‹å³åˆ›å»ºä¸€ä¸ªç›¸åŒå®¹å™¨</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">nodeName</span>: <span style="color:#ae81ff">k8s-node1</span> <span style="color:#75715e"># NodeNameè¡¨ç¤ºå°†è¯¥Podè°ƒåº¦åˆ°æŒ‡å®šåˆ°åç§°çš„nodeèŠ‚ç‚¹ä¸Š</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">nodeSelector</span>: <span style="color:#ae81ff">obeject</span> <span style="color:#75715e"># nodeSelectorç”¨äºå°†Podè°ƒåº¦åˆ°æ·»åŠ äº†æŒ‡å®šæ ‡ç­¾çš„NodeèŠ‚ç‚¹ä¸Š</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">imagePullSecrets</span>:  	<span style="color:#75715e"># é…ç½®ç™»å½• docker registry çš„ secret ä»“åº“</span>
</span></span><span style="display:flex;"><span>     - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">docker-harbor  	# æŒ‡å®šä½¿ç”¨çš„secretåº“æˆ¿åç§°</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">hostNetwork</span>: <span style="color:#66d9ef">false</span>   <span style="color:#75715e">#æ˜¯å¦ä½¿ç”¨ä¸»æœºç½‘ç»œæ¨¡å¼ï¼Œé»˜è®¤ä¸ºfalseï¼Œå¦‚æœè®¾ç½®ä¸ºtrueï¼Œè¡¨ç¤ºä½¿ç”¨å®¿ä¸»æœºç½‘ç»œ</span></span></span></code></pre></div></blockquote>
<hr>
<h3 id="replicasetrsç±»å‹æ§åˆ¶å™¨"><code>ReplicaSet(RS)</code>ç±»å‹æ§åˆ¶å™¨</h3>
<blockquote>
<ul>
<li><code>ReplicaSet</code><!-- raw HTML omitted -->ï¼šä¸»è¦ä½œç”¨æ˜¯ä¿è¯ä¸€å®šæ•°é‡çš„<code>Pod</code>èƒ½å¤Ÿæ­£å¸¸è¿è¡Œï¼Œå®ƒä¼šæŒç»­ç›‘å¬è¿™äº›<code>Pod</code>çš„è¿è¡ŒçŠ¶æ€ï¼Œä¸€æ—¦<code>Pod</code>å‘ç”Ÿæ•…éšœï¼Œå°±ä¼šé‡å¯æˆ–é‡å»ºã€‚åŒæ—¶å®ƒè¿˜æ”¯æŒå¯¹<code>Pod</code>æ•°é‡çš„æ‰©ç¼©å®¹å’Œç‰ˆæœ¬é•œåƒçš„å‡çº§<!-- raw HTML omitted --></li>
<li><a href="https://raw.githubusercontent.com/usermice/images/master/Kubernetes_Server/Template/ReplicaSet/kubernetes-replicaset-template.yaml" rel="external" target="_self"><code>Kubernetes replicaset Template</code>æ¨¡æ¿</a></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">apps/v1    </span> <span style="color:#75715e"># ç‰ˆæœ¬å· </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">ReplicaSet       </span> <span style="color:#75715e"># ç±»å‹ </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:       <span style="color:#75715e"># å…ƒæ•°æ® </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">replicaset-template    </span> <span style="color:#75715e"># åç§°ã€åœ¨ä¸€ä¸ªåç§°ç©ºé—´å†…ä¸èƒ½é‡å¤</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">default   </span> <span style="color:#75715e"># æŒ‡å®šåç§°ç©ºé—´ã€é»˜è®¤defalut</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">labels</span>:       <span style="color:#75715e"># æ ‡ç­¾ </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">replicaset-template</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:   <span style="color:#75715e"># è¯¦æƒ…æè¿° </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">replicas</span>: <span style="color:#ae81ff">3</span>   <span style="color:#75715e"># æŒ‡å®šå‰¯æœ¬æ•°é‡ï¼Œæ˜¯rsåˆ›å»ºå‡ºæ¥çš„Podçš„æ•°é‡ï¼Œé»˜è®¤ä¸º1.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:     <span style="color:#75715e"># é€‰æ‹©å™¨ï¼Œå®ƒçš„ä½œç”¨æ˜¯å»ºç«‹Podæ§åˆ¶å™¨å’ŒPodä¹‹é—´çš„å…³è”å…³ç³»ï¼Œé‡‡ç”¨äº†Label Selectoræœºåˆ¶ï¼ˆåœ¨Podæ¨¡å—ä¸Šå®šä¹‰Labelï¼Œåœ¨æ§åˆ¶å™¨ä¸Šå®šä¹‰é€‰æ‹©å™¨ï¼Œå°±å¯ä»¥è¡¨æ˜å½“å‰æ§åˆ¶å™¨èƒ½ç®¡ç†å“ªäº›Podäº†ï¼‰</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">matchLabels</span>:        <span style="color:#75715e"># LabelsåŒ¹é…è§„åˆ™ï¼ŒmatchExpressionsï¼šExpressionsåŒ¹é…è§„åˆ™</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">replicaset-template</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">template</span>:     <span style="color:#75715e"># æ¨¡å— å½“å‰¯æœ¬æ•°æ®ä¸è¶³çš„æ—¶å€™ï¼Œä¼šæ ¹æ®ä¸‹é¢çš„æ¨¡æ¿åˆ›å»ºPodå‰¯æœ¬</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">name</span>: <span style="color:#ae81ff">replicaset-template</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx    </span> <span style="color:#75715e"># å®¹å™¨åç§°</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginx:1.17.1    </span> <span style="color:#75715e"># å®¹å™¨éœ€è¦çš„é•œåƒåœ°å€</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">80</span>     <span style="color:#75715e"># å®¹å™¨æ‰€ç›‘å¬çš„ç«¯å£</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">protocol</span>: <span style="color:#ae81ff">TCP</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">resources</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">limits</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">cpu</span>: <span style="color:#ae81ff">100m</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">memory</span>: <span style="color:#ae81ff">128Mi</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">requests</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">cpu</span>: <span style="color:#ae81ff">50m</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">memory</span>: <span style="color:#ae81ff">128Mi</span></span></span></code></pre></div></blockquote>
<hr>
<h3 id="horizontalpodautoscalerç±»å‹"><code>HorizontalPodAutoscaler</code>ç±»å‹</h3>
<blockquote>
<ul>
<li><a href="https://raw.githubusercontent.com/usermice/images/master/Kubernetes_Server/Template/HPA/kubernetes-hpa-template.yaml" rel="external" target="_self"><code>Kubernetes HorizontalPodAutoscaler Template</code>æ¨¡æ¿</a></li>
</ul>
<blockquote>
<ul>
<li><code>deployment</code><!-- raw HTML omitted -->ï¼šç±»å‹æ§åˆ¶å™¨<!-- raw HTML omitted --></li>
<li><code>deployment-name</code><!-- raw HTML omitted -->ï¼š<code>Pod</code>çš„åç§°<!-- raw HTML omitted --></li>
<li><code>--cpu-percent</code><!-- raw HTML omitted -->ï¼šä½¿ç”¨<code>CPU</code>ç™¾åˆ†æ¯”<!-- raw HTML omitted --></li>
<li><code>--min</code><!-- raw HTML omitted -->ï¼š<code>Pod</code>æœ€å°‘æ•°é‡<!-- raw HTML omitted --></li>
<li><code>--max</code><!-- raw HTML omitted -->ï¼š<code>Pod</code>æœ€å¤šæ•°é‡<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl autoscale deployment deployment-name --cpu-percent<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span> --min<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> --max<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span></span></span></code></pre></div></blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">autoscaling/v2   </span> <span style="color:#75715e"># ç‰ˆæœ¬å·</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">HorizontalPodAutoscaler  </span> <span style="color:#75715e"># ç±»å‹</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:   <span style="color:#75715e"># å…ƒæ•°æ® </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">default   </span> <span style="color:#75715e"># æŒ‡å®šåç§°ç©ºé—´ã€é»˜è®¤default</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">hpa-template</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">minReplicas</span>: <span style="color:#ae81ff">2</span>   <span style="color:#75715e"># æœ€å°Podæ•°é‡</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">maxReplicas</span>: <span style="color:#ae81ff">10</span>    <span style="color:#75715e"># æœ€å¤§Podæ•°é‡</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">metrics</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">resource</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">cpu  	# æ‰©ç¼©å®¹åç§°</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">target</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">averageUtilization</span>: <span style="color:#ae81ff">30</span>  	<span style="color:#75715e"># è®¾ç½®CPUä½¿ç”¨ç™¾åˆ†æ¯”ï¼Œè¶…è¿‡å°±æ‰©å®¹</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">type</span>: <span style="color:#ae81ff">Utilization  	# åˆ©ç”¨ç‡ï¼šUtilizationï¼Œå¹³å‡å€¼ï¼šAverageValueï¼š1kã€1Mã€1G</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">type</span>: <span style="color:#ae81ff">Resource</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">scaleTargetRef</span>:    <span style="color:#75715e"># æŒ‡å®šè¦æ§åˆ¶Podã€Deploymentä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">apps/v1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Deployment</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">deployment-template</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Service</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span> <span style="color:#f92672">name</span>: <span style="color:#ae81ff">service-template</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">default</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">deployment-nginx-template</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  clusterIP: None       # å°†clusterIPè®¾ç½®ä¸ºNoneï¼Œå³å¯åˆ›å»ºheadliness Service</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">type</span>: <span style="color:#ae81ff">NodePort       </span> <span style="color:#75715e"># Podä½¿ç”¨çš„IPç±»å‹ï¼šClusterIPã€NodePort</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">port</span>: <span style="color:#ae81ff">80</span>    <span style="color:#75715e"># Serviceçš„ç«¯å£</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">targetPort</span>: <span style="color:#ae81ff">80</span>      <span style="color:#75715e"># StatefulSet çš„Podç«¯å£</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">apps/v1    </span> <span style="color:#75715e"># ç‰ˆæœ¬å· </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Deployment       </span> <span style="color:#75715e"># ç±»å‹ </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:       <span style="color:#75715e"># å…ƒæ•°æ® </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">deployment-template    </span> <span style="color:#75715e"># deploymentçš„åç§°</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">default   </span> <span style="color:#75715e"># æŒ‡å®šåç§°ç©ºé—´ã€é»˜è®¤default</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">labels</span>:       <span style="color:#75715e"># æ ‡ç­¾ </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">deployment-nginx-template</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:   <span style="color:#75715e"># è¯¦æƒ…æè¿° </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">replicas</span>: <span style="color:#ae81ff">3</span>   <span style="color:#75715e"># å‰¯æœ¬æ•°é‡ </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">revisionHistoryLimit</span>: <span style="color:#ae81ff">3</span>       <span style="color:#75715e"># ä¿ç•™å†å²ç‰ˆæœ¬ï¼Œé»˜è®¤ä¸º10 </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">paused</span>: <span style="color:#66d9ef">false</span>         <span style="color:#75715e"># æš‚åœéƒ¨ç½²ï¼Œé»˜è®¤æ˜¯false </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">progressDeadlineSeconds</span>: <span style="color:#ae81ff">600</span>          <span style="color:#75715e"># éƒ¨ç½²è¶…æ—¶æ—¶é—´ï¼ˆsï¼‰ï¼Œé»˜è®¤æ˜¯600</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">strategy</span>:     <span style="color:#75715e"># podæ›´æ–°ç­–ç•¥ï¼Œå³å¦‚ä½•æ›¿æ¢å·²æœ‰çš„pod</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">type</span>: <span style="color:#ae81ff">RollingUpdate        </span> <span style="color:#75715e"># æ›´æ–°ç­–ç•¥ã€æ”¯æŒ Recreate, RollingUpdateã€‚é»˜è®¤RollingUpdate</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">rollingUpdate</span>:      <span style="color:#75715e"># å½“typeä¸ºRollingUpdateçš„æ—¶å€™ç”Ÿæ•ˆï¼Œç”¨äºä¸ºrollingUpdateè®¾ç½®å‚æ•°</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">maxUnavailable</span>: <span style="color:#ae81ff">30</span><span style="color:#ae81ff">%      </span> <span style="color:#75715e"># ç”¨æ¥æŒ‡å®šåœ¨å‡çº§è¿‡ç¨‹ä¸­ä¸å¯ç”¨çš„Podçš„æœ€å¤§æ•°é‡ï¼Œé»˜è®¤ä¸º25%ã€‚</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">maxSurge</span>: <span style="color:#ae81ff">30</span><span style="color:#ae81ff">%    </span> <span style="color:#75715e"># ç”¨æ¥æŒ‡å®šåœ¨å‡çº§è¿‡ç¨‹ä¸­å¯ä»¥è¶…è¿‡æœŸæœ›çš„Podçš„æœ€å¤§æ•°é‡ï¼Œé»˜è®¤ä¸º25%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:     <span style="color:#75715e"># é€‰æ‹©å™¨ï¼Œé€šè¿‡å®ƒæŒ‡å®šè¯¥æ§åˆ¶å™¨ç®¡ç†å“ªäº›pod </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">matchLabels</span>:        <span style="color:#75715e"># LabelsåŒ¹é…è§„åˆ™ï¼ŒmatchExpressionsï¼šExpressionsåŒ¹é…è§„åˆ™ </span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">deployment-nginx-template </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">template</span>:     <span style="color:#75715e"># æ¨¡æ¿ï¼Œå½“å‰¯æœ¬æ•°é‡ä¸è¶³æ—¶ï¼Œä¼šæ ¹æ®ä¸‹é¢çš„æ¨¡æ¿åˆ›å»ºpodå‰¯æœ¬ </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">labels</span>:   <span style="color:#75715e"># Pod çš„æ ‡ç­¾</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">name</span>: <span style="color:#ae81ff">deployment-nginx-template</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">spec</span>:   <span style="color:#75715e"># Pod çš„æœŸæœ›ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">containers</span>:   <span style="color:#75715e"># Pod å®¹å™¨æè¿°</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx  </span> <span style="color:#75715e"># é•œåƒåç§°</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginx:1.17.1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">imagePullPolicy</span>: <span style="color:#ae81ff">IfNotPresent  </span> <span style="color:#75715e"># IfNotPresentï¼šå¦‚æœé•œåƒä¸å­˜åœ¨å°±æ‹‰å–</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">resources</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">limits</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">cpu</span>: <span style="color:#ae81ff">100m</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">memory</span>: <span style="color:#ae81ff">128Mi</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">requests</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">cpu</span>: <span style="color:#ae81ff">50m</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">memory</span>: <span style="color:#ae81ff">128Mi</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">restartPolicy</span>: <span style="color:#ae81ff">Always  </span> <span style="color:#75715e"># é‡å¯ç­–ç•¥ï¼ŒAlwaysï¼šä»£è¡¨ä¸€ç›´é‡å¯</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">terminationGracePeriodSeconds</span>: <span style="color:#ae81ff">30</span>   <span style="color:#75715e"># åˆ é™¤æ“ä½œå®½é™æ—¶é—´</span></span></span></code></pre></div></blockquote>
<hr>
<h3 id="deploymentdeployæ— çŠ¶æ€ç±»å‹"><code>Deployment(deploy)</code>æ— çŠ¶æ€ç±»å‹</h3>

<pre class="mermaid align-center zoomable">graph TD
A[&lt;p&gt;Deployment&lt;br&gt;seletor:env=dev] --&gt; A1((&lt;p&gt;Pod&lt;br&gt;label:env=dev))
A[&lt;p&gt;Deployment&lt;br&gt;seletor:env=dev] --&gt; A2((&lt;p&gt;Pod&lt;br&gt;label:env=dev))
A[&lt;p&gt;Deployment&lt;br&gt;seletor:env=dev] --&gt; A3((&lt;p&gt;Pod&lt;br&gt;label:env=dev))
    Z[Deploymentæ§åˆ¶Pod]  </pre><blockquote>
<ul>
<li><code>Deployment</code><!-- raw HTML omitted -->ï¼šä¸ºäº†æ›´å¥½çš„è§£å†³æœåŠ¡ç¼–æ’çš„é—®é¢˜ï¼Œ<!-- raw HTML omitted --><code>kubernetes</code>åœ¨<code>v1.2</code>ç‰ˆæœ¬å¼€å§‹ï¼Œå¼•å…¥äº†<code>Deployment</code>æ§åˆ¶å™¨ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œ<code>Deployment</code>æ§åˆ¶å™¨å¹¶ä¸ç›´æ¥ç®¡ç†<code>Pod</code>ï¼Œè€Œæ˜¯é€šè¿‡ç®¡ç†<code>ReplicaSet</code>æ¥é—´æ¥ç®¡ç†<code>Pod</code>ï¼Œå³ï¼š<code>Deployment</code>ç®¡ç†<code>ReplicaSet</code>ï¼Œ<code>ReplicaSet</code>ç®¡ç†<code>Pod</code>ã€‚æ‰€ä»¥<code>Deployment</code>çš„åŠŸèƒ½æ¯”<code>ReplicaSet</code>å¼ºå¤§</li>
<li>æ”¯æŒ<code>ReplicaSet</code>çš„æ‰€æœ‰åŠŸèƒ½</li>
<li><!-- raw HTML omitted -->æ”¯æŒå‘å¸ƒçš„åœæ­¢ã€ç»§ç»­<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->æ”¯æŒç‰ˆæœ¬æ»šåŠ¨æ›´æ–°å’Œç‰ˆæœ¬å›é€€<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li>
<p><code>Recreate</code><!-- raw HTML omitted -->é‡å»ºæ›´æ–°ï¼šåœ¨åˆ›å»ºå‡ºæ–°çš„<code>Pod</code>ä¹‹å‰ä¼šå…ˆæ€æ‰æ‰€æœ‰å·²ç»å­˜åœ¨çš„<!-- raw HTML omitted --><code>Pod</code></p>
</li>
<li>
<p><code>RollingUpdate</code><!-- raw HTML omitted -->æ»šåŠ¨æ›´æ–°ï¼šæ€æ­»ä¸€éƒ¨åˆ†ï¼Œå°±å¯åŠ¨ä¸€éƒ¨åˆ†ï¼Œåœ¨æ›´æ–°è¿‡ç¨‹ä¸­å­˜åœ¨ä¸¤ä¸ªç‰ˆæœ¬çš„<!-- raw HTML omitted --><code>Pod</code>ï¼Œå½“<code>type</code>ä¸º<code>RollingUpdate</code>çš„æ—¶å€™ç”Ÿæ•ˆï¼Œç”¨äºä¸º<code>rollingUpdate</code>è®¾ç½®å‚æ•°ï¼Œ  æ”¯æŒä¸¤ä¸ªå±æ€§ï¼š</p>
</li>
<li>
<p><code>maxSurge</code><!-- raw HTML omitted -->ï¼šç”¨æ¥æŒ‡å®šåœ¨å‡çº§è¿‡ç¨‹ä¸­å¯ä»¥è¶…è¿‡æœŸæœ›çš„<code>Pod</code>çš„æœ€å¤§æ•°é‡ï¼Œé»˜è®¤ä¸º25%<!-- raw HTML omitted --></p>
</li>
<li>
<p><code>maxUnavailable</code><!-- raw HTML omitted -->ï¼šç”¨æ¥æŒ‡å®šåœ¨å‡çº§è¿‡ç¨‹ä¸­ä¸å¯ç”¨çš„<code>Pod</code>çš„æœ€å¤§æ•°é‡ï¼Œé»˜è®¤ä¸º25%<!-- raw HTML omitted --></p>
</li>
</ul>
</blockquote>
<ul>
<li><a href="https://raw.githubusercontent.com/usermice/images/master/Kubernetes_Server/Template/Deployment/kubernetes-deployment-template.yaml" rel="external" target="_self"><code>Kubernetes Deployment Template</code>æ¨¡æ¿</a></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">apps/v1  	# ç‰ˆæœ¬å· </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Deployment  	# ç±»å‹ </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:  	<span style="color:#75715e"># å…ƒæ•°æ® </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">deployment-template  	# deploymentçš„åç§°</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">default  	# æŒ‡å®šåç§°ç©ºé—´ã€é»˜è®¤defalut</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">labels</span>:  	<span style="color:#75715e"># æ ‡ç­¾ </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">deployment-nginx-template</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:  	<span style="color:#75715e"># è¯¦æƒ…æè¿° </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">replicas</span>: <span style="color:#ae81ff">3</span>  	<span style="color:#75715e"># å‰¯æœ¬æ•°é‡ </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">revisionHistoryLimit</span>: <span style="color:#ae81ff">3</span>  	<span style="color:#75715e"># ä¿ç•™å†å²ç‰ˆæœ¬ï¼Œé»˜è®¤ä¸º10 </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">paused</span>: <span style="color:#66d9ef">false</span>  	<span style="color:#75715e"># æš‚åœéƒ¨ç½²ï¼Œé»˜è®¤æ˜¯false </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">progressDeadlineSeconds</span>: <span style="color:#ae81ff">600</span>  	<span style="color:#75715e"># éƒ¨ç½²è¶…æ—¶æ—¶é—´ï¼ˆsï¼‰ï¼Œé»˜è®¤æ˜¯600</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">strategy</span>:  	<span style="color:#75715e"># podæ›´æ–°ç­–ç•¥ï¼Œå³å¦‚ä½•æ›¿æ¢å·²æœ‰çš„pod</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">rollingUpdate</span>:  	<span style="color:#75715e"># å½“typeä¸ºRollingUpdateçš„æ—¶å€™ç”Ÿæ•ˆï¼Œç”¨äºä¸ºrollingUpdateè®¾ç½®å‚æ•°</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">maxUnavailable</span>: <span style="color:#ae81ff">30</span><span style="color:#ae81ff">%  	# ç”¨æ¥æŒ‡å®šåœ¨å‡çº§è¿‡ç¨‹ä¸­ä¸å¯ç”¨çš„Podçš„æœ€å¤§æ•°é‡ï¼Œé»˜è®¤ä¸º25%ã€‚</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">maxSurge</span>: <span style="color:#ae81ff">30</span><span style="color:#ae81ff">%  	# ç”¨æ¥æŒ‡å®šåœ¨å‡çº§è¿‡ç¨‹ä¸­å¯ä»¥è¶…è¿‡æœŸæœ›çš„Podçš„æœ€å¤§æ•°é‡ï¼Œé»˜è®¤ä¸º25%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">type</span>: <span style="color:#ae81ff">RollingUpdate  	# æ›´æ–°ç­–ç•¥ã€æ”¯æŒ Recreate, RollingUpdateã€‚é»˜è®¤RollingUpdate</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:  	<span style="color:#75715e"># é€‰æ‹©å™¨ï¼Œé€šè¿‡å®ƒæŒ‡å®šè¯¥æ§åˆ¶å™¨ç®¡ç†å“ªäº›pod </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">matchLabels</span>:  	<span style="color:#75715e"># LabelsåŒ¹é…è§„åˆ™ï¼ŒmatchExpressionsï¼šExpressionsåŒ¹é…è§„åˆ™ </span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">deployment-nginx-template </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">template</span>:  	<span style="color:#75715e"># æ¨¡æ¿ï¼Œå½“å‰¯æœ¬æ•°é‡ä¸è¶³æ—¶ï¼Œä¼šæ ¹æ®ä¸‹é¢çš„æ¨¡æ¿åˆ›å»ºpodå‰¯æœ¬ </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">labels</span>:   <span style="color:#75715e"># Pod çš„æ ‡ç­¾</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">name</span>: <span style="color:#ae81ff">deployment-nginx-template</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">spec</span>:   <span style="color:#75715e"># Pod çš„æœŸæœ›ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">containers</span>:   <span style="color:#75715e"># Pod å®¹å™¨æè¿°</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx  </span> <span style="color:#75715e"># é•œåƒåç§°</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginx:1.17.1    </span> <span style="color:#75715e"># fxgxxxxx/nginx:v1 åœ¨æ‰€æœ‰èŠ‚ç‚¹ç™»å½•è‡ªå·±çš„ hub.docker.com è´¦æˆ·</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">imagePullPolicy</span>: <span style="color:#ae81ff">IfNotPresent  </span> <span style="color:#75715e"># IfNotPresentï¼šå¦‚æœé•œåƒä¸å­˜åœ¨å°±æ‹‰å–</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">volumeMounts</span>:   <span style="color:#75715e"># æŒ‚è½½åˆ°å®¹å™¨å†…éƒ¨çš„å­˜å‚¨å·é…ç½®</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx_vhosts   </span> <span style="color:#75715e"># å¼•ç”¨podå®šä¹‰çš„å…±äº«å­˜å‚¨å·çš„åç§°ï¼Œéœ€ç”¨volumes[]éƒ¨åˆ†å®šä¹‰çš„çš„å·å</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/usr/local/nginx/conf/vhosts  </span> <span style="color:#75715e"># å­˜å‚¨å·åœ¨å®¹å™¨å†…mountçš„ç»å¯¹è·¯å¾„ï¼Œåº”å°‘äº512å­—ç¬¦</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx_logs</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/usr/local/nginx/logs</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx_html</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">resources</span>:      <span style="color:#75715e"># èµ„æºé™åˆ¶å’Œè¯·æ±‚çš„è®¾ç½®</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">limits</span>:   <span style="color:#75715e"># é™å®šPodæœ€å¤§ä½¿ç”¨ç¡¬ä»¶èµ„æºã€é€šå¸¸è®¾ç½®cpuå’Œmemory</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">cpu</span>: <span style="color:#e6db74">&#34;6&#34;</span>    <span style="color:#75715e"># Cpuçš„é™åˆ¶ï¼Œå•ä½ä¸ºcoreæ•°ï¼Œå°†ç”¨äºdocker run --cpu-shareså‚æ•°ï¼Œ1000mç­‰äºä¸€ä¸ªæ ¸å¿ƒ</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">memory</span>: <span style="color:#e6db74">&#34;128Mi&#34;</span>     <span style="color:#75715e"># å†…å­˜é™åˆ¶ï¼Œå•ä½å¯ä»¥ä¸ºMib/Gibï¼Œå°†ç”¨äºdocker run --memoryå‚æ•°</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">requests</span>:     <span style="color:#75715e"># æœ€ä½èµ„æºè¦æ±‚ï¼Œåœ¨schedulerä¸­è¢«ç”¨åˆ°ï¼Œé€šå¸¸è®¾ç½®cpuå’Œmemory</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">cpu</span>: <span style="color:#e6db74">&#34;3&#34;</span>    <span style="color:#75715e"># é™å®šä½¿ç”¨å‡ ä¸ªæ ¸å¿ƒCPUã€å®¹å™¨å¯åŠ¨çš„åˆå§‹å¯ç”¨æ•°é‡</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">memory</span>: <span style="color:#e6db74">&#34;64Mi&#34;</span>      <span style="color:#75715e"># è®¾å®šä½¿ç”¨å†…å­˜ã€å®¹å™¨å¯åŠ¨çš„åˆå§‹å¯ç”¨æ•°é‡</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">restartPolicy</span>: <span style="color:#ae81ff">Always  </span> <span style="color:#75715e"># é‡å¯ç­–ç•¥ï¼ŒAlwaysï¼šä»£è¡¨ä¸€ç›´é‡å¯</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">terminationGracePeriodSeconds</span>: <span style="color:#ae81ff">30</span>   <span style="color:#75715e"># åˆ é™¤æ“ä½œå®½é™æ—¶é—´</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">volumes</span>:      <span style="color:#75715e"># åœ¨è¯¥podä¸Šå®šä¹‰å…±äº«å­˜å‚¨å·åˆ—è¡¨</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx_vhosts    </span> <span style="color:#75715e"># å…±äº«å­˜å‚¨å·åç§° ï¼ˆvolumesç±»å‹æœ‰å¾ˆå¤šç§ï¼‰ </span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">hostPath</span>:   <span style="color:#75715e"># ç±»å‹ä¸ºhostPathçš„å­˜å‚¨å·ï¼Œè¡¨ç¤ºæŒ‚è½½Podæ‰€åœ¨å®¿ä¸»æœºçš„ç›®å½•</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/opt/data/nginx/vhosts</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">type</span>: <span style="color:#ae81ff">DirectoryOrCreate  </span> <span style="color:#75715e"># ç›®å½•å­˜åœ¨å°±ä½¿ç”¨ï¼Œä¸å­˜åœ¨å°±å…ˆåˆ›å»ºå†ä½¿ç”¨</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx_logs</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">hostPath</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/opt/data/nginx/logs</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">type</span>: <span style="color:#ae81ff">DirectoryOrCreate</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx_html</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">hostPath</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/opt/data/nginx/html</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">type</span>: <span style="color:#ae81ff">DirectoryOrCreate</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">status</span>: {}</span></span></code></pre></div></blockquote>
<hr>
<h3 id="statefulsetæœ‰çŠ¶æ€ç±»å‹"><code>StatefulSet</code>æœ‰çŠ¶æ€ç±»å‹</h3>
<blockquote>
<ul>
<li><!-- raw HTML omitted -->æ— çŠ¶æ€åº”ç”¨å®šä¹‰<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li>è®¤ä¸º<code>Pod</code>éƒ½æ˜¯ä¸€æ ·çš„</li>
<li>æ²¡æœ‰é¡ºåºè¦æ±‚</li>
<li>ä¸ç”¨è€ƒè™‘åœ¨å“ªä¸ª<code>Node</code>èŠ‚ç‚¹ä¸Šè¿è¡Œ</li>
<li>éšæ„è¿›è¡Œä¼¸ç¼©å’Œæ‰©å±•</li>
</ul>
</blockquote>
<ul>
<li><!-- raw HTML omitted -->æœ‰çŠ¶æ€åº”ç”¨å®šä¹‰<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li>æœ‰é¡ºåºè¦æ±‚</li>
<li>è®¤ä¸ºæ¯ä¸ª<code>Pod</code>éƒ½æ˜¯ä¸ä¸€æ ·çš„</li>
<li>éœ€è¦è€ƒè™‘åœ¨å“ªä¸ª<code>Node</code>èŠ‚ç‚¹ä¸Šè¿è¡Œ</li>
<li>éœ€è¦æŒ‰ç…§é¡ºåºè¿›è¡Œä¼¸ç¼©å’Œæ‰©å±•</li>
<li>è®©æ¯ä¸ª<code>Pod</code>éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œä¿æŒ<code>Pod</code>å¯åŠ¨é¡ºåºå’Œå”¯ä¸€æ€§</li>
</ul>
</blockquote>
<ul>
<li><code>StatefulSet</code> æ˜¯<code>Kubernetes</code><!-- raw HTML omitted -->æä¾›çš„ç®¡ç†æœ‰çŠ¶æ€åº”ç”¨çš„è´Ÿè½½ç®¡ç†æ§åˆ¶å™¨<!-- raw HTML omitted --></li>
<li><code>StatefulSet</code><!-- raw HTML omitted -->å¸¸ç”¨æ¥éƒ¨ç½²<!-- raw HTML omitted --><code>RabbitMQ</code>é›†ç¾¤ã€<code>Zookeeper</code>é›†ç¾¤ã€<code>MySQL</code>é›†ç¾¤ã€<code>Eureka</code>é›†ç¾¤ç­‰</li>
<li><code>StatefulSet</code><!-- raw HTML omitted -->éƒ¨ç½²éœ€è¦<!-- raw HTML omitted --><code>HeadLinessService</code>ï¼ˆæ— å¤´æœåŠ¡ï¼‰</li>
</ul>
<blockquote>
<ul>
<li>åœ¨ç”¨<code>Deployment</code>æ—¶ï¼Œæ¯ä¸€ä¸ª<code>Pod</code>åç§°æ˜¯æ²¡æœ‰é¡ºåºçš„ï¼Œæ˜¯éšæœºå­—ç¬¦ä¸²ï¼Œå› æ­¤æ˜¯<code>Pod</code>åç§°æ˜¯æ— åºçš„ï¼Œä½†æ˜¯åœ¨<code>StatefulSet</code>ä¸­è¦æ±‚å¿…é¡»æ˜¯æœ‰åº ï¼Œæ¯ä¸€ä¸ª<code>Pod</code>ä¸èƒ½è¢«éšæ„å–ä»£ï¼Œ<code>Pod</code>é‡å»ºå<code>pod</code>åç§°è¿˜æ˜¯ä¸€æ ·çš„</li>
<li>è€Œ<code>Pod IP</code>æ˜¯å˜åŒ–çš„ï¼Œæ‰€ä»¥æ˜¯ä»¥<code>Pod</code>åç§°æ¥è¯†åˆ«ã€‚<code>Pod</code>åç§°æ˜¯<code>Pod</code>å”¯ä¸€æ€§çš„æ ‡è¯†ç¬¦ï¼Œå¿…é¡»æŒä¹…ç¨³å®šæœ‰æ•ˆã€‚è¿™æ—¶å€™è¦ç”¨åˆ°<!-- raw HTML omitted -->æ— å¤´æœåŠ¡<!-- raw HTML omitted -->ï¼Œå®ƒå¯ä»¥ç»™æ¯ä¸ª<code>Pod</code>ä¸€ä¸ªå”¯ä¸€çš„åç§°</li>
</ul>
</blockquote>
<ul>
<li><code>Deployment</code>å’Œ<code>StatefulSet</code>åŒºåˆ«ï¼š<code>Deployment</code><!-- raw HTML omitted -->æ²¡æœ‰å”¯ä¸€æ ‡è¯†è€Œ<!-- raw HTML omitted --><code>StatefulSet</code>æœ‰å”¯ä¸€æ ‡è¯†</li>
<li><code>StatefulSet</code><!-- raw HTML omitted -->å”¯ä¸€æ ‡è¯†ç”Ÿæˆè§„åˆ™<!-- raw HTML omitted -->ï¼š  æ ¹æ®ä¸»æœºå+ä¸€å®šè§„åˆ™ç”Ÿæˆçš„ï¼š<!-- raw HTML omitted -->ä¸»æœºå.æ— å¤´<!-- raw HTML omitted --><code>Service</code>åç§°.å‘½åç©ºé—´<code>.svc.cluster.local</code></li>
<li><code>StatefulSet</code><!-- raw HTML omitted -->æ§åˆ¶å™¨æ”¯æŒä¸¤ç§æ›´æ–°ç­–ç•¥<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li><code>OnDelete</code>ï¼š <code>OnDelete</code><!-- raw HTML omitted -->è¡¨ç¤ºåˆ é™¤ä¹‹åæ‰æ›´æ–°<!-- raw HTML omitted --></li>
<li>(é»˜è®¤)<code>RollingUpdate</code>ï¼š<code>RollingUpdate</code><!-- raw HTML omitted -->è¡¨ç¤ºæ»šåŠ¨æ›´æ–°<!-- raw HTML omitted --></li>
</ul>
</blockquote>
<ul>
<li><a href="https://raw.githubusercontent.com/usermice/images/master/Kubernetes_Server/Template/StatefulSet/kubernetes-statefulset-template.yaml" rel="external" target="_self"><code>Kubernetes StatefulSet Template</code>æ¨¡æ¿</a></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Service</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span> <span style="color:#f92672">name</span>: <span style="color:#ae81ff">service-template</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">default</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">statefulset-template</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">clusterIP</span>: <span style="color:#ae81ff">None      </span> <span style="color:#75715e"># å°†clusterIPè®¾ç½®ä¸ºNoneï¼Œå³å¯åˆ›å»ºheadliness Service</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">type</span>: <span style="color:#ae81ff">ClusterIP  	# ç±»å‹ï¼šNodePort</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">port</span>: <span style="color:#ae81ff">80</span>    <span style="color:#75715e"># Serviceçš„ç«¯å£</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">protocol</span>: <span style="color:#ae81ff">TCP</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">targetPort</span>: <span style="color:#ae81ff">80</span>      <span style="color:#75715e"># StatefulSet çš„Podç«¯å£</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">apps/v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">StatefulSet</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">statefulset-template</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">default</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">replicas</span>: <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">serviceName</span>: <span style="color:#ae81ff">service-template  </span> <span style="color:#75715e"># ä½¿ç”¨é‚£ä¸ªServiceç®¡ç†DNS</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">updateStrategy</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">type</span>: <span style="color:#ae81ff">RollingUpdate        </span> <span style="color:#75715e"># æ»šåŠ¨æ›´æ–°ï¼ŒOnDeleteï¼šåˆ é™¤æ›´æ–°</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">rollingUpdate</span>:      <span style="color:#75715e"># å¦‚æœæ›´æ–°çš„ç­–ç•¥æ˜¯OnDeleteï¼Œé‚£ä¹ˆrollingUpdateå°±å¤±æ•ˆ</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">partition</span>: <span style="color:#ae81ff">2</span>      <span style="color:#75715e"># è¡¨ç¤ºä»ç¬¬2ä¸ªåˆ†åŒºå¼€å§‹æ›´æ–°ï¼Œé»˜è®¤æ˜¯0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">matchLabels</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">statefulset-template</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">template</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">name</span>: <span style="color:#ae81ff">statefulset-template</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginx:1.17.1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">80</span></span></span></code></pre></div></blockquote>
<hr>
<h3 id="daemonsetdså®ˆæŠ¤è¿›ç¨‹ç±»å‹"><code>DaemonSet(ds)</code>å®ˆæŠ¤è¿›ç¨‹ç±»å‹</h3>
<blockquote>
<ul>
<li>
<p><code>DaemonSet</code><!-- raw HTML omitted -->ï¼šæ§åˆ¶å™¨å¯ä»¥ä¿è¯é›†ç¾¤ä¸­çš„æ¯ä¸€å°ï¼ˆæˆ–æŒ‡å®šï¼‰èŠ‚ç‚¹ä¸Šéƒ½è¿è¡Œä¸€ä¸ªå‰¯æœ¬ï¼Œä¸€èˆ¬é€‚ç”¨äºæ—¥å¿—(<code>elk</code>)æ”¶é›†ã€èŠ‚ç‚¹ç›‘æ§(<code>zabbix</code>)ç­‰åœºæ™¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<!-- raw HTML omitted -->å¦‚æœä¸€ä¸ª<code>Pod</code>æä¾›çš„åŠŸèƒ½æ˜¯èŠ‚ç‚¹çº§åˆ«çš„ï¼ˆæ¯ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦ä¸”åªéœ€è¦ä¸€ä¸ªï¼‰ï¼Œé‚£ä¹ˆè¿™ç±»<code>Pod</code>å°±é€‚åˆä½¿ç”¨<code>DaemonSet</code>ç±»å‹çš„æ§åˆ¶å™¨åˆ›å»º</p>
</li>
<li>
<p><code>DaemonSet</code><!-- raw HTML omitted -->æ§åˆ¶å™¨çš„ç‰¹ç‚¹<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->  æ¯å‘é›†ç¾¤ä¸­æ·»åŠ ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼Œ<!-- raw HTML omitted -->æŒ‡å®šçš„<code>Pod</code>å‰¯æœ¬ä¹Ÿå°†æ·»åŠ åˆ°è¯¥èŠ‚ç‚¹ä¸Š</p>
<p><!-- raw HTML omitted -->å½“èŠ‚ç‚¹ä»é›†ç¾¤ä¸­ç§»é™¤çš„æ—¶å€™ï¼Œ<!-- raw HTML omitted --><code>Pod</code>ä¹Ÿä¼šè¢«åƒåœ¾å›æ”¶</p>
</li>
<li>
<p><a href="https://raw.githubusercontent.com/usermice/images/master/Kubernetes_Server/Template/DaemonSet/kubernetes-daemonset-template.yaml" rel="external" target="_self"><code>Kubernetes DaemonSet Template</code>æ¨¡æ¿</a></p>
</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">apps/v1  </span> <span style="color:#75715e"># ç‰ˆæœ¬å·</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">DaemonSet        </span> <span style="color:#75715e"># ç±»å‹</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:       <span style="color:#75715e"># å…ƒæ•°æ®</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">fluentd-daemonset      </span> <span style="color:#75715e"># Pod åç§°</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">default   </span> <span style="color:#75715e"># æŒ‡å®šåç§°ç©ºé—´ã€é»˜è®¤default</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">labels</span>:       <span style="color:#75715e"># æ ‡ç­¾</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#39;fluentd-es&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:   <span style="color:#75715e"># Pod è¯¦æƒ…æè¿°</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">revisionHistoryLimit</span>: <span style="color:#ae81ff">3</span>       <span style="color:#75715e"># ä¿ç•™å†å²ç‰ˆæœ¬ã€é»˜è®¤ä¸ºæœ€å¤§å€¼(2^32)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">updateStrategy</span>:       <span style="color:#75715e"># æ›´æ–°ç­–ç•¥</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">type</span>: <span style="color:#ae81ff">RollingUpdate        </span> <span style="color:#75715e"># æ»šåŠ¨æ›´æ–°ç­–ç•¥</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">rollingUpdate</span>:      <span style="color:#75715e"># æ»šåŠ¨æ›´æ–°</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">maxUnavailable</span>: <span style="color:#ae81ff">1</span>         <span style="color:#75715e"># æœ€å¤§ä¸å¯ç”¨çŠ¶æ€çš„Podçš„æœ€å¤§å€¼ï¼Œå¯ç”¨ä¸ºç™¾åˆ†æ¯”ï¼Œä¹Ÿå¯ä»¥ä¸ºæ•´æ•°</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:     <span style="color:#75715e"># é€‰æ‹©å™¨ï¼Œé€šè¿‡å®ƒæŒ‡å®šè¯¥æ§åˆ¶å™¨ç®¡ç†é‚£äº›Pod</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">matchLabels:        # LabelsåŒ¹é…è§„åˆ™ï¼ŒmatchExpressions</span>: <span style="color:#ae81ff">åŒ¹é…è§„åˆ™</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#39;fluentd-es&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">template</span>:     <span style="color:#75715e"># æ¨¡æ¿ï¼Œå½“å‰¯æœ¬æ•°é‡ä¸è¶³æ—¶ï¼Œä¼šæ ¹æ®ä¸‹é¢çš„æ¨¡æ¿åˆ›å»ºPodæ¨¡æ¿</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#39;fluentd-es&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">fluentd-es</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">image</span>: <span style="color:#ae81ff">agilestacks/fluentd-elasticsearch:v1.3.0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">env</span>:    <span style="color:#75715e"># ç¯å¢ƒå˜é‡é…ç½®</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">FLUENTD_ARGS   </span> <span style="color:#75715e"># ç¯å¢ƒå˜é‡çš„ key</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">value</span>: -<span style="color:#ae81ff">qq   </span> <span style="color:#75715e"># ç¯å¢ƒå˜é‡çš„ value</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">volumeMounts</span>:   <span style="color:#75715e"># åŠ è½½æ•°æ®å· é¿å…æ•°æ®ä¸¢å¤±</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">containers     </span> <span style="color:#75715e"># æ•°æ®å·åç§°</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/lib/docker/containers        </span> <span style="color:#75715e"># å°†æ•°æ®å·æŒ‚è½½åˆ°å®¹å™¨å†…é‚£ä¸ªç›®å½•</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">varlog</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/log</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">volumes</span>:          <span style="color:#75715e"># å®šä¹‰æ•°æ®å·</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">containers       </span> <span style="color:#75715e"># å®šä¹‰æ•°æ®å·çš„åç§°</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">hostPath</span>:       <span style="color:#75715e"># æ•°æ®å·ç±»å‹ï¼Œä¸»æœºè·¯å¾„æ¨¡å¼</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/var/lib/docker/containers     </span> <span style="color:#75715e"># node ä¸­å…±äº«ç›®å½•</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">varlog</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">hostPath</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/var/log</span></span></span></code></pre></div></blockquote>
<hr>
<h3 id="serviceç±»å‹æ§åˆ¶å™¨"><code>Service</code>ç±»å‹æ§åˆ¶å™¨</h3>
<blockquote>
<ul>
<li>åœ¨<code>kubernetes</code>ä¸­ï¼Œ<code>Pod</code>æ˜¯åº”ç”¨ç¨‹åºçš„è½½ä½“ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>Pod</code>çš„<code>IP</code>æ¥è®¿é—®åº”ç”¨ç¨‹åºï¼Œä½†æ˜¯<code>Pod</code>çš„<code>IP</code>åœ°å€ä¸æ˜¯å›ºå®šçš„ï¼Œè¿™å°±æ„å‘³ç€ä¸æ–¹ä¾¿ç›´æ¥é‡‡ç”¨<code>Pod</code>çš„<code>IP</code>å¯¹æœåŠ¡è¿›è¡Œè®¿é—®</li>
<li>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ<code>kubernetes</code>æä¾›äº†<code>Service</code>èµ„æºï¼Œ<code>Service</code>ä¼šå¯¹æä¾›åŒä¸€ä¸ªæœåŠ¡çš„å¤šä¸ª<code>Pod</code>è¿›è¡Œèšåˆï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ªç»Ÿä¸€çš„å…¥å£åœ°å€ï¼Œé€šè¿‡è®¿é—®<code>Service</code>çš„å…¥å£åœ°å€å°±èƒ½è®¿é—®åˆ°åé¢çš„<code>Pod</code>æœåŠ¡</li>
<li><code>Service</code>åœ¨å¾ˆå¤šæƒ…å†µä¸‹åªæ˜¯ä¸€ä¸ªæ¦‚å¿µï¼šçœŸæ­£èµ·ä½œç”¨çš„å…¶å®æ˜¯<code>kube-proxy</code>æœåŠ¡è¿›ç¨‹ï¼Œæ¯ä¸ª<code>Node</code>èŠ‚ç‚¹ä¸Šéƒ½è¿è¡Œäº†ä¸€ä¸ª<code>kube-proxy</code>çš„æœåŠ¡è¿›ç¨‹ã€‚å½“åˆ›å»º<code>Service</code>çš„æ—¶å€™ä¼šé€šè¿‡<code>API Server</code>å‘<code>etcd</code>å†™å…¥åˆ›å»ºçš„Serviceçš„ä¿¡æ¯ï¼Œè€Œ<code>kube-proxy</code>ä¼šåŸºäºç›‘å¬çš„æœºåˆ¶å‘ç°è¿™ç§<code>Service</code>çš„å˜åŒ–ï¼Œç„¶åå®ƒä¼šå°†æœ€æ–°çš„<code>Service</code>ä¿¡æ¯è½¬æ¢ä¸ºå¯¹åº”çš„è®¿é—®è§„åˆ™</li>
<li>å‡å¦‚ï¼š<code>10.97.97.97:80</code>æ˜¯<code>service</code>æä¾›çš„è®¿é—®å…¥å£ï¼šå½“è®¿é—®è¿™ä¸ªå…¥å£çš„æ—¶å€™ï¼Œå¯ä»¥å‘ç°åé¢æœ‰ä¸‰ä¸ª<code>pod</code>çš„æœåŠ¡åœ¨ç­‰å¾…è°ƒç”¨ï¼Œ<code>kube-proxy</code>ä¼šåŸºäº<code>rr</code>ï¼ˆè½®è¯¢ï¼‰çš„ç­–ç•¥ï¼Œå°†è¯·æ±‚åˆ†å‘åˆ°å…¶ä¸­ä¸€ä¸ª<code>pod</code>ä¸Šå»ï¼Œè¿™ä¸ªè§„åˆ™ä¼šåŒæ—¶åœ¨é›†ç¾¤å†…çš„æ‰€æœ‰èŠ‚ç‚¹ä¸Šéƒ½ç”Ÿæˆï¼Œæ‰€ä»¥åœ¨ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ä¸Šè®¿é—®éƒ½å¯ä»¥</li>
<li><code>ClusterIP</code><!-- raw HTML omitted -->é»˜è®¤å€¼ï¼šå®ƒæ˜¯<code>kubernetes</code>ç³»ç»Ÿè‡ªåŠ¨åˆ†é…çš„è™šæ‹Ÿ<code>IP</code>(<code>VIP</code>)ï¼Œåªèƒ½åœ¨é›†ç¾¤å†…éƒ¨ï¼ˆæ‰€æœ‰<code>Node</code>èŠ‚ç‚¹ï¼‰è®¿é—®<!-- raw HTML omitted --></li>
<li><code>NodePort</code><!-- raw HTML omitted -->ï¼šå°†<code>Service</code>é€šè¿‡æŒ‡å®šçš„<code>Node</code>ä¸Šçš„ç«¯å£æš´éœ²ç»™å¤–éƒ¨ï¼Œé€šè¿‡æ­¤æ–¹æ³•ï¼Œå°±å¯ä»¥åœ¨é›†ç¾¤å¤–éƒ¨è®¿é—®ï¼ˆä½¿ç”¨æµè§ˆå™¨åŸŸåæˆ–<code>IP</code>ç«¯å£è®¿é—®ï¼‰æœåŠ¡<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li>åˆ›å»ºçš„<code>Service</code>çš„<code>IP</code>åœ°å€åªèƒ½åœ¨é›†ç¾¤å†…éƒ¨æ‰å¯ä»¥è®¿é—®ï¼Œå¦‚æœå¸Œæœ›<code>Service</code>æš´éœ²ç»™é›†ç¾¤å¤–éƒ¨ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨åˆ°å¦å¤–ä¸€ç§ç±»å‹çš„<code>Service</code>ï¼Œç§°ä¸º<code>NodePort</code>ç±»å‹çš„<code>Service</code>ã€‚<code>NodePort</code>çš„å·¥ä½œåŸç†å°±æ˜¯å°†<code>Service</code>çš„ç«¯å£æ˜ å°„åˆ°<code>Node</code>çš„ä¸€ä¸ªç«¯å£ä¸Šï¼Œç„¶åå°±å¯ä»¥é€šè¿‡<code>NodeIP:NodePort</code>æ¥è®¿é—®<code>Service</code>äº†</li>
</ul>
</blockquote>
<ul>
<li><code>LoadBalancer</code><!-- raw HTML omitted -->ï¼šä½¿ç”¨å¤–æ¥è´Ÿè½½å‡è¡¡å™¨å®Œæˆåˆ°æœåŠ¡çš„è´Ÿè½½åˆ†å‘ï¼Œæ³¨æ„æ­¤æ¨¡å¼éœ€è¦å¤–éƒ¨äº‘ç¯å¢ƒçš„æ”¯æŒ<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li><code> LoadBalancer</code>å’Œ<code>NodePort</code>å¾ˆç›¸ä¼¼ï¼Œç›®çš„éƒ½æ˜¯å‘å¤–éƒ¨æš´éœ²ä¸€ä¸ªç«¯å£ï¼ŒåŒºåˆ«åœ¨äº<code>LoadBalancer</code>ä¼šåœ¨é›†ç¾¤çš„å¤–éƒ¨å†æ¥åšä¸€ä¸ªè´Ÿè½½å‡è¡¡è®¾å¤‡ï¼Œè€Œè¿™ä¸ªè®¾å¤‡éœ€è¦å¤–éƒ¨ç¯å¢ƒçš„æ”¯æŒï¼Œå¤–éƒ¨æœåŠ¡å‘é€åˆ°è¿™ä¸ªè®¾å¤‡ä¸Šçš„è¯·æ±‚ï¼Œä¼šè¢«è®¾å¤‡è´Ÿè½½ä¹‹åè½¬å‘åˆ°é›†ç¾¤ä¸­</li>
</ul>
</blockquote>
<ul>
<li><code>ExternalName</code><!-- raw HTML omitted -->ï¼šæŠŠé›†ç¾¤å¤–éƒ¨çš„æœåŠ¡å¼•å…¥é›†ç¾¤å†…éƒ¨ï¼Œç›´æ¥ä½¿ç”¨<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li><code>ExternalName</code>ç±»å‹çš„<code>Service</code>ç”¨äºå¼•å…¥é›†ç¾¤å¤–éƒ¨çš„æœåŠ¡ï¼Œå®ƒé€šè¿‡<code>externalName</code>å±æ€§æŒ‡å®šä¸€ä¸ªæœåŠ¡çš„åœ°å€ï¼Œç„¶ååœ¨é›†ç¾¤å†…éƒ¨è®¿é—®æ­¤<code>Service</code>å°±å¯ä»¥è®¿é—®åˆ°å¤–éƒ¨çš„æœåŠ¡äº†</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl explain service.spec.type  	<span style="color:#75715e"># </span></span></span></code></pre></div></blockquote>
<ul>
<li><a href="https://raw.githubusercontent.com/usermice/images/master/Kubernetes_Server/Template/Service/kubernetes-service-template.yaml" rel="external" target="_self"><code>Kubernetes Service Template</code>æ¨¡æ¿</a></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1         </span> <span style="color:#75715e"># ç‰ˆæœ¬</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Service  </span> <span style="color:#75715e"># ç±»å‹</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:       <span style="color:#75715e"># å…ƒæ•°æ®</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">service-template       </span> <span style="color:#75715e"># Service åå­—</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">default   </span> <span style="color:#75715e"># å‘½åç©ºé—´</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx        </span> <span style="color:#75715e"># Service è‡ªå·±æœ¬èº«çš„æ ‡ç­¾</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:     <span style="color:#75715e"># æ ‡ç­¾é€‰æ‹©å™¨ï¼Œç”¨äºç¡®å®šå½“å‰Serviceä»£ç†é‚£äº›Pod</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx-deploymen      </span> <span style="color:#75715e"># æ‰€æœ‰åŒ¹é…åˆ°è¿™äº›æ ‡ç­¾çš„Pod éƒ½å¯ä»¥è¿›è¡Œè®¿é—®</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">type</span>: <span style="color:#ae81ff">NodePort       </span> <span style="color:#75715e"># æŒ‡å®šServiceçš„ç±»å‹è®¿é—®æ–¹å¼ã€ClusterIPã€NodePortã€ExternalNameï¼ŒNodePortæ”¯æŒé›†ç¾¤å¤–éƒ¨è®¿é—®ï¼Œå¯ç”¨ingressè®¾ç½®ï¼šClusterIP</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">externalName</span>: <span style="color:#ae81ff">www.baidu.com  </span> <span style="color:#75715e"># æ”¹æˆIPåœ°å€ä¹Ÿå¯ä»¥,åªæœ‰typeç±»å‹ä¸ºï¼šExternalNameï¼ŒåŸŸåé…ç½®æ‰ç”Ÿæ•ˆ</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">clusterIP</span>: <span style="color:#ae81ff">10.64.0.47</span>        <span style="color:#75715e"># å®šservice IPï¼Œä¸æŒ‡å®šå°±éšæœºç”Ÿæˆï¼Œå¯ç”¨ingressè®¾ç½®ä¸ºï¼šNone</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">sessionAffinity</span>: <span style="color:#ae81ff">None     </span> <span style="color:#75715e"># åˆ†å‘ç­–ç•¥ã€sessionäº²å’Œæ€§ï¼Œæ”¯æŒClientIPã€Noneä¸¤ä¸ªé€‰é¡¹ï¼Œé»˜è®¤å€¼ä¸ºNone</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ports</span>:        <span style="color:#75715e"># ç«¯å£æ˜ å°„ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">port</span>: <span style="color:#ae81ff">80</span>          <span style="color:#75715e"># Service ç«¯å£ï¼Œåœ¨ä½¿ç”¨å†…ç½‘IPè®¿é—®æ—¶ä½¿ç”¨</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">protocol</span>: <span style="color:#ae81ff">TCP      </span> <span style="color:#75715e"># åè®®</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">targetPort </span>: <span style="color:#ae81ff">80</span>     <span style="color:#75715e"># ç›®æ ‡Podç«¯å£ï¼Œä¾‹å¦‚ï¼šdeploymentã€statefulsetç­‰ï¼ŒNginxï¼š80ï¼ŒTomcatï¼š8080</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">nodePort</span>: <span style="color:#ae81ff">30002</span>     <span style="color:#75715e"># ç»‘å®šåˆ°nodeä¸»æœºä¸Šçš„ç«¯å£(ç«¯å£ä½¿ç”¨èŒƒå›´ï¼š30000~32767)ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œä¼šé»˜è®¤åˆ†é…ï¼Œå¯ç”¨ingressåˆ é™¤æ­¤è¡Œ</span></span></span></code></pre></div><ul>
<li><code>kube-proxy</code>ç›®å‰æ”¯æŒçš„ä¸‰ç§å·¥ä½œæ¨¡å¼</li>
<li><code>userspace</code><!-- raw HTML omitted -->æ¨¡å¼<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li><code>userspace</code>æ¨¡å¼ä¸‹ï¼Œ<code>kube-proxy</code>ä¼šä¸ºæ¯ä¸€ä¸ª<code>Service</code>åˆ›å»ºä¸€ä¸ªç›‘å¬ç«¯å£ï¼Œå‘å‘<code>Cluster IP</code>çš„è¯·æ±‚è¢«<code>iptables</code>è§„åˆ™é‡å®šå‘åˆ°<code>kube-proxy</code>ç›‘å¬çš„ç«¯å£ä¸Šï¼Œ<code>kube-proxy</code>æ ¹æ®<code>LB</code>ç®—æ³•ï¼ˆè´Ÿè½½å‡è¡¡ç®—æ³•ï¼‰é€‰æ‹©ä¸€ä¸ªæä¾›æœåŠ¡çš„<code>Pod</code>å¹¶å’Œå…¶å»ºç«‹è¿æ¥ï¼Œä»¥ä¾¿å°†è¯·æ±‚è½¬å‘åˆ°<code>Pod</code>ä¸Š</li>
<li><code>userspace</code>æ¨¡å¼ä¸‹ï¼Œ<code>kube-proxy</code>å……å½“äº†ä¸€ä¸ªå››å±‚è´Ÿè½½å‡è¡¡å™¨çš„è§’è‰²ã€‚ç”±äº<code>kube-proxy</code>è¿è¡Œåœ¨<code>userspace</code>ä¸­ï¼Œåœ¨è¿›è¡Œè½¬å‘å¤„ç†çš„æ—¶å€™ä¼šå¢åŠ å†…æ ¸å’Œç”¨æˆ·ç©ºé—´ä¹‹é—´çš„æ•°æ®æ‹·è´ï¼Œè™½ç„¶æ¯”è¾ƒç¨³å®šï¼Œä½†æ˜¯æ•ˆç‡éå¸¸ä½ä¸‹</li>
</ul>
</blockquote>
<ul>
<li><code>iptables</code><!-- raw HTML omitted -->æ¨¡å¼<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li><code>iptables</code>æ¨¡å¼ä¸‹ï¼Œ<code>kube-proxy</code>ä¸º<code>Service</code>åç«¯çš„æ¯ä¸ª<code>Pod</code>åˆ›å»ºå¯¹åº”çš„<code>iptables</code>è§„åˆ™ï¼Œç›´æ¥å°†å‘å‘<code>Cluster IP</code>çš„è¯·æ±‚é‡å®šå‘åˆ°ä¸€ä¸ª<code>Pod</code>çš„<code>IP</code>ä¸Š</li>
<li><code>iptables</code>æ¨¡å¼ä¸‹<code>kube-proxy</code>ä¸æ‰¿æ‹…å››å±‚è´Ÿè½½å‡è¡¡å™¨çš„è§’è‰²ï¼Œåªè´Ÿè´£åˆ›å»º<code>iptables</code>è§„åˆ™ã€‚è¯¥æ¨¡å¼çš„ä¼˜ç‚¹åœ¨äºè¾ƒ<code>userspace</code>æ¨¡å¼æ•ˆç‡æ›´é«˜ï¼Œä½†æ˜¯ä¸èƒ½æä¾›çµæ´»çš„<code>LB</code>ç­–ç•¥ï¼Œå½“åç«¯<code>Pod</code>ä¸å¯ç”¨çš„æ—¶å€™æ— æ³•è¿›è¡Œé‡è¯•</li>
</ul>
</blockquote>
<ul>
<li><code>ipvs</code><!-- raw HTML omitted -->æ¨¡å¼<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li>
<p><code>ipvs</code>æ¨¡å¼å’Œ<code>iptables</code>ç±»ä¼¼ï¼Œ<code>kube-proxy</code>ç›‘æ§<code>Pod</code>çš„å˜åŒ–å¹¶åˆ›å»ºç›¸åº”çš„<code>ipvs</code>è§„åˆ™ã€‚<code>ipvs</code>ç›¸å¯¹<code>iptables</code>è½¬å‘æ•ˆç‡æ›´é«˜ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œ<code>ipvs</code>æ”¯æŒæ›´å¤šçš„<code>LB</code>ç®—æ³•</p>
</li>
<li>
<p><code>ipvs</code><!-- raw HTML omitted -->çš„æ˜ å°„è§„åˆ™ï¼Œ<code>rr</code>è¡¨ç¤ºè½®è¯¢<!-- raw HTML omitted --></p>
</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ipvsadm -Ln  	<span style="color:#75715e"># æŸ¥çœ‹kube-proxyå·¥ä½œæ¨¡å¼</span></span></span></code></pre></div></blockquote>
<ul>
<li>å¯¹<code>Service</code>çš„è®¿é—®è¢«åˆ†å‘åˆ°äº†åç«¯çš„<code>Pod</code>ä¸Šå»ï¼Œç›®å‰<code>kubernetes</code>æä¾›äº†<!-- raw HTML omitted -->ä¸¤ç§è´Ÿè½½åˆ†å‘<!-- raw HTML omitted -->ç­–ç•¥</li>
</ul>
<blockquote>
<ul>
<li><!-- raw HTML omitted -->é»˜è®¤ä½¿ç”¨<code>kube-proxy</code>çš„ç­–ç•¥ï¼Œæ¯”å¦‚éšæœºã€è½®è¯¢ç­‰<!-- raw HTML omitted --></li>
<li><code>sessionAffinity</code>ï¼šåŸºäºå®¢æˆ·ç«¯åœ°å€çš„ä¼šè¯ä¿æŒæ¨¡å¼ï¼Œå³æ¥è‡ªåŒä¸€ä¸ªå®¢æˆ·ç«¯å‘èµ·çš„æ‰€æœ‰è¯·æ±‚éƒ½ä¼šè½¬å‘åˆ°å›ºå®šçš„ä¸€ä¸ª<code>Pod</code>ä¸Šï¼Œè¿™å¯¹äºä¼ ç»ŸåŸºäº<code>Session</code>çš„è®¤è¯é¡¹ç›®æ¥è¯´å¾ˆå‹å¥½ï¼Œæ­¤æ¨¡å¼å¯ä»¥åœ¨<code>spec</code>ä¸­æ·»åŠ <code>sessionAffinity: ClusterIP</code>é€‰é¡¹</li>
</ul>
</blockquote>
<ul>
<li><code>HeadLiness</code>ç±»å‹è´Ÿè½½å‡çš„<code>Service</code></li>
</ul>
<blockquote>
<ul>
<li>åœ¨æŸäº›åœºæ™¯ä¸­ï¼Œå¼€å‘äººå‘˜å¯èƒ½ä¸æƒ³ä½¿ç”¨<code>Service</code>æä¾›çš„è´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼Œè€Œå¸Œæœ›è‡ªå·±æ¥æ§åˆ¶è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œé’ˆå¯¹è¿™ç§æƒ…å†µï¼Œ<code>kubernetes</code>æä¾›äº†<code>HeadLinesss Service</code>ï¼Œè¿™ç±»<code>Serviceä¸</code>ä¼šåˆ†é…<code>Cluster IP</code>ï¼Œå¦‚æœæƒ³è¦è®¿é—®<code>Service</code>ï¼Œåªèƒ½é€šè¿‡<code>Service</code>çš„åŸŸåè¿›è¡ŒæŸ¥è¯¢</li>
<li><code>clusterIP: None</code>ï¼šå°†<code>clusterIP</code>è®¾ç½®ä¸º<code>None</code>ï¼Œå³å¯åˆ›å»º<code>headliness Service</code></li>
</ul>
</blockquote>
</blockquote>
<hr>
<h3 id="endpointç±»å‹æ§åˆ¶å™¨"><code>Endpoint</code>ç±»å‹æ§åˆ¶å™¨</h3>
<blockquote>
<ul>
<li><!-- raw HTML omitted -->å®é™…ä¸­ä½¿ç”¨çš„ä¸å¤š<!-- raw HTML omitted --></li>
<li><code>Endpoint</code>ï¼šæ˜¯<code>kubernete</code>ä¸­çš„ä¸€ä¸ªèµ„æºå¯¹è±¡ï¼Œå­˜å‚¨åœ¨<code>etcd</code>ä¸­ï¼Œç”¨æ¥è®°å½•ä¸€ä¸ª<code>service</code>å¯¹åº”çš„æ‰€æœ‰<code>Pod</code>çš„è®¿é—®åœ°å€ï¼Œå®ƒæ˜¯æ ¹æ®<code>service</code>é…ç½®æ–‡ä»¶ä¸­çš„<code>selector</code>æè¿°äº§ç”Ÿçš„</li>
<li>ä¸€ä¸ª<code>service</code>ç”±ä¸€ç»„<code>Pod</code>ç»„æˆï¼Œè¿™äº›<code>Pod</code>é€šè¿‡<code>Endpoints</code>æš´éœ²å‡ºæ¥ï¼Œ<code>Endpoints</code>æ˜¯å®ç°å®é™…æœåŠ¡çš„ç«¯ç‚¹é›†åˆã€‚æ¢è¨€ä¹‹<code>servic</code>å’Œ<code>Pod</code>ä¹‹é—´çš„è”ç³»æ˜¯é€šè¿‡<code>Endpoints</code>å®ç°çš„</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl describe svc nginx-service -n app  
</span></span><span style="display:flex;"><span>$ kubectl get endpoints -n dev -o wide  </span></span></code></pre></div><ul>
<li><a href="https://raw.githubusercontent.com/usermice/images/master/Kubernetes_Server/Template/EndPoint/kubernetes-endpoint-template.yaml" rel="external" target="_self"><code>Kubernetes Endpoint Template</code>æ¨¡æ¿</a></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Endpoints</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">endpoints-template</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">default</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx        </span> <span style="color:#75715e"># æ ‡ç­¾å’ŒService é‡Œçš„labelsä¸€è‡´</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">subsets</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">addresses</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">ip</span>: <span style="color:#ae81ff">23.41.187.94</span>    <span style="color:#75715e"># ç›®æ ‡IPåœ°å€</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ports</span>:        <span style="color:#75715e"># ä¸ Serviceä¸€è‡´</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">port</span>: <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">protocol</span>: <span style="color:#ae81ff">TCP</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1         </span> <span style="color:#75715e"># ç‰ˆæœ¬</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Service  </span> <span style="color:#75715e"># ç±»å‹</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:       <span style="color:#75715e"># å…ƒæ•°æ®</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">service-template       </span> <span style="color:#75715e"># Service åå­—</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">default   </span> <span style="color:#75715e"># å‘½åç©ºé—´</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx        </span> <span style="color:#75715e"># Service è‡ªå·±æœ¬èº«çš„æ ‡ç­¾</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">type</span>: <span style="color:#ae81ff">ClusterIP       </span> <span style="color:#75715e"># æŒ‡å®šServiceçš„ç±»å‹è®¿é—®æ–¹å¼ã€ClusterIPã€NodePortã€ExternalName</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">sessionAffinity</span>: <span style="color:#ae81ff">None        </span> <span style="color:#75715e"># åˆ†å‘ç­–ç•¥ã€sessionäº²å’Œæ€§ï¼Œæ”¯æŒClientIPã€Noneä¸¤ä¸ªé€‰é¡¹ï¼Œé»˜è®¤å€¼ä¸ºNone</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ports</span>:        <span style="color:#75715e"># ç«¯å£æ˜ å°„ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">port</span>: <span style="color:#ae81ff">80</span>          <span style="color:#75715e"># Service ç«¯å£ï¼Œåœ¨ä½¿ç”¨å†…ç½‘IPè®¿é—®æ—¶ä½¿ç”¨</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">protocol</span>: <span style="color:#ae81ff">TCP      </span> <span style="color:#75715e"># åè®®</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">targetPort </span>: <span style="color:#ae81ff">80</span>     <span style="color:#75715e"># ç›®æ ‡Podç«¯å£ï¼Œä¾‹å¦‚ï¼šdeploymentã€statefulsetç­‰</span></span></span></code></pre></div></blockquote>
<hr>
<h3 id="jobç±»å‹æ§åˆ¶å™¨"><code>Job</code>ç±»å‹æ§åˆ¶å™¨</h3>
<blockquote>
<ul>
<li><code>Job</code><!-- raw HTML omitted -->ä¸»è¦ç”¨äºè´Ÿè´£æ‰¹é‡å¤„ç†çŸ­æš‚çš„ä¸€æ¬¡æ€§ä»»åŠ¡<!-- raw HTML omitted --></li>
<li><code>Job</code><!-- raw HTML omitted -->ç‰¹ç‚¹<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li>å½“<code>Job</code>åˆ›å»ºçš„<code>Pod</code>æ‰§è¡ŒæˆåŠŸç»“æŸæ—¶ï¼Œ<code>Job</code>å°†è®°å½•æˆåŠŸç»“æŸçš„<code>Pod</code>æ•°é‡</li>
<li>å½“æˆåŠŸç»“æŸçš„<code>Pod</code>è¾¾åˆ°æŒ‡å®šçš„æ•°é‡æ—¶ï¼Œ<code>Job</code>å°†å®Œæˆæ‰§è¡Œ</li>
</ul>
</blockquote>
<ul>
<li><code>Job</code><!-- raw HTML omitted -->æ¨¡æ¿ä½¿ç”¨é‡å¯ç­–ç•¥å®šä¹‰<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li><!-- raw HTML omitted -->è®¾ç½®ä¸ºï¼š<!-- raw HTML omitted --><code>OnFailure</code>ï¼Œ<code> Job</code>ä¼šåœ¨<code>Pod</code>å‡ºç°æ•…éšœçš„æ—¶å€™é‡å¯å®¹å™¨ï¼Œè€Œä¸æ˜¯åˆ›å»º<code>Pod</code>ï¼Œ<code>failed</code>æ¬¡æ•°ä¸å˜</li>
<li><!-- raw HTML omitted -->è®¾ç½®ä¸ºï¼š<!-- raw HTML omitted --><code>Never</code>ï¼Œ<code>Job</code>ä¼šåœ¨<code>Pod</code>å‡ºç°æ•…éšœçš„æ—¶å€™åˆ›å»ºæ–°çš„<code>Pod</code>ï¼Œå¹¶ä¸”æ•…éšœ<code>Pod</code>ä¸ä¼šæ¶ˆå¤±ä¹Ÿä¸ä¼šé‡å¯ï¼Œ<code>failed</code>æ¬¡æ•°+1</li>
<li><!-- raw HTML omitted -->è®¾ç½®ä¸ºï¼š<!-- raw HTML omitted --><code>Always</code>ï¼Œæ„å‘³<code>Job</code>ä¸€ç›´é‡å¯ï¼Œæ„å‘³<code>Pod</code>ä»»åŠ¡ä¼šé‡å¤æ‰§è¡Œï¼Œè¿™å’Œ<code>Job</code>çš„å®šä¹‰å†²çªï¼Œæ‰€ä»¥ä¸èƒ½è®¾ç½®ä¸º<code>Always</code></li>
</ul>
</blockquote>
<ul>
<li><code>Job</code><!-- raw HTML omitted -->èµ„æºæ¸…å•<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">batch/v1  	# ç‰ˆæœ¬å·</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Job  	# ç±»å‹</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:  	<span style="color:#75715e"># å…ƒæ•°æ®</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">name</span>: <span style="color:#ae81ff">job-template  	# åç§°</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">namespace</span>:  <span style="color:#ae81ff">default  	# å‘½åç©ºé—´</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">labels</span>:  	<span style="color:#75715e"># æ ‡ç­¾</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">controller</span>: <span style="color:#ae81ff">job</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:  	<span style="color:#75715e"># è¯¦æƒ…æè¿°</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">completions</span>: <span style="color:#ae81ff">1</span>  	<span style="color:#75715e"># æŒ‡å®šJobéœ€è¦æˆåŠŸè¿è¡ŒPodçš„æ€»æ¬¡æ•°ï¼Œé»˜è®¤ä¸º1</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">parallelism</span>: <span style="color:#ae81ff">1</span>  	<span style="color:#75715e"># æŒ‡å®šJobåœ¨ä»»ä¸€æ—¶åˆ»åº”è¯¥å¹¶å‘è¿è¡ŒPodçš„æ•°é‡ï¼Œé»˜è®¤ä¸º1</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">activeDeadlineSeconds</span>: <span style="color:#ae81ff">30</span>  	<span style="color:#75715e"># æŒ‡å®šJobå¯ä»¥è¿è¡Œçš„æ—¶é—´æœŸé™ï¼Œè¶…è¿‡æ—¶é—´è¿˜æ²¡ç»“æŸï¼Œç³»ç»Ÿå°†ä¼šå°è¯•è¿›è¡Œç»ˆæ­¢</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">backoffLimit</span>: <span style="color:#ae81ff">6</span>  	<span style="color:#75715e"># æŒ‡å®šJobå¤±è´¥åè¿›è¡Œé‡è¯•çš„æ¬¡æ•°ï¼Œé»˜è®¤ä¸º6</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">manualSelector</span>: <span style="color:#66d9ef">true</span>  	<span style="color:#75715e"># æ˜¯å¦å¯ä»¥ä½¿ç”¨selectoré€‰æ‹©å™¨é€‰æ‹©Podï¼Œé»˜è®¤ä¸ºfalse</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">selector</span>:  	<span style="color:#75715e"># é€‰æ‹©å™¨ï¼Œé€šè¿‡å®ƒæŒ‡å®šè¯¥æ§åˆ¶å™¨ç®¡ç†é‚£äº›Pod</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">matchLabels</span>:  	<span style="color:#75715e"># LabelsåŒ¹é…è§„åˆ™</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">app</span>: <span style="color:#ae81ff">counter-pod</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">matchExpressions</span>:  	<span style="color:#75715e"># ExpressionsåŒ¹é…è§„åˆ™</span>
</span></span><span style="display:flex;"><span>            - <span style="color:#f92672">key</span>: <span style="color:#ae81ff">app</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">operator</span>: <span style="color:#ae81ff">In</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">values</span>:
</span></span><span style="display:flex;"><span>              - <span style="color:#ae81ff">counter-pod</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">template</span>:  	<span style="color:#75715e"># æ¨¡æ¿ï¼Œå½“å‰¯æœ¬æ•°é‡ä¸è¶³æ—¶ï¼Œä¼šæ ¹æ®ä¸‹é¢çš„æ¨¡æ¿åˆ›å»ºPodæ¨¡æ¿</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">app</span>: <span style="color:#ae81ff">counter-pod</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">restartPolicy</span>: <span style="color:#ae81ff">Never  	# é‡å¯ç­–ç•¥åªèƒ½è®¾ç½®ä¸ºNeveræˆ–OnFailure</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>                - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">counter</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#f92672">image</span>: <span style="color:#ae81ff">busybox:1.30</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#f92672">command</span>: [<span style="color:#e6db74">&#34;/bin/sh&#34;</span>,<span style="color:#e6db74">&#34;-c&#34;</span>,<span style="color:#e6db74">&#34;for i in 9 8 7 6 5 4 3 2 1;do echo $i;sleep 20;done&#34;</span>]</span></span></code></pre></div></blockquote>
<hr>
<h3 id="cronjobç±»å‹æ§åˆ¶å™¨"><code>CronJob</code>ç±»å‹æ§åˆ¶å™¨</h3>
<blockquote>
<ul>
<li><!-- raw HTML omitted --><code>CronJob</code>æ§åˆ¶å™¨<!-- raw HTML omitted -->ï¼šä»¥<code>Job</code>æ§åˆ¶å™¨ä¸ºå…¶ç®¡æ§å¯¹è±¡ï¼Œå¹¶å€ŸåŠ©å®ƒç®¡ç†<code>Pod</code>èµ„æºå¯¹è±¡ï¼Œ<code>Job</code>æ§åˆ¶å™¨å®šä¹‰çš„ä½œä¸šä»»åŠ¡åœ¨å…¶æ§åˆ¶å™¨èµ„æºåˆ›å»ºä¹‹åä¾¿ä¼šç«‹å³æ‰§è¡Œï¼Œä½†<code>CronJob</code>å¯ä»¥ä»¥ç±»ä¼¼<code>Linux</code>æ“ä½œç³»ç»Ÿçš„å‘¨æœŸæ€§ä»»åŠ¡ä½œä¸šè®¡åˆ’çš„æ–¹å¼æ§åˆ¶å™¨è¿è¡Œæ—¶é—´ç‚¹åŠé‡å¤è¿è¡Œçš„æ–¹å¼ï¼Œæ¢è¨€ä¹‹ï¼Œ<code>CronJob</code>å¯ä»¥åœ¨ç‰¹å®šçš„æ—¶é—´ç‚¹åå¤å»æ‰§è¡Œ<code>Job</code>ä»»åŠ¡</li>
<li><code>scheduleï¼šcron</code><!-- raw HTML omitted -->è¡¨è¾¾å¼ï¼Œç”¨äºæŒ‡å®šä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li><code>/1  *</code><!-- raw HTML omitted -->ï¼šè¡¨ç¤ºåˆ†é’Ÿ  å°æ—¶  æ—¥  æœˆä»½  æ˜ŸæœŸ<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->åˆ†é’Ÿå€¼ä»<code>0</code>åˆ°<!-- raw HTML omitted --><code>59</code></li>
<li><!-- raw HTML omitted -->å°æ—¶å€¼ä»<code>0</code>åˆ°<!-- raw HTML omitted --><code>23</code></li>
<li><!-- raw HTML omitted -->æ—¥(å¤©)çš„å€¼ä»<code>1</code>åˆ°<!-- raw HTML omitted --><code>31</code></li>
<li><!-- raw HTML omitted -->æœˆçš„å€¼ä»<code>1</code>åˆ°<!-- raw HTML omitted --><code>12</code></li>
<li><!-- raw HTML omitted -->æ˜ŸæœŸçš„å€¼ä»<code>0</code>åˆ°<code>6</code>ï¼Œ<!-- raw HTML omitted --><code>0</code><!-- raw HTML omitted -->è¡¨ç¤ºæ˜ŸæœŸæ—¥<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->å¤šä¸ªæ—¶é—´å¯ä»¥ç”¨é€—å·éš”å¼€ï¼ŒèŒƒå›´å¯ä»¥ç”¨è¿å­—ç¬¦ç»™å‡ºï¼š* å¯ä»¥ä½œä¸ºé€šé…ç¬¦ï¼Œ/è¡¨ç¤ºæ¯&hellip;<!-- raw HTML omitted --></li>
</ul>
</blockquote>
<ul>
<li><code>concurrencyPolicy</code><!-- raw HTML omitted -->å¹¶å‘æ‰§è¡Œç­–ç•¥<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li><code>Allow</code><!-- raw HTML omitted -->ï¼šè¿è¡Œ<code>Job</code>å¹¶å‘è°ƒåº¦ï¼ˆé»˜è®¤ï¼‰<!-- raw HTML omitted --></li>
<li><code>Forbid</code><!-- raw HTML omitted -->ï¼šç¦æ­¢å¹¶å‘è¿è¡Œï¼Œå¦‚æœä¹‹å‰çš„ä»»åŠ¡æ²¡å®Œæˆï¼Œåˆ™è·³è¿‡ï¼Œç›´æ¥æ‰§è¡Œæ–°çš„<!-- raw HTML omitted --></li>
<li><code>Replace</code><!-- raw HTML omitted -->ï¼šæ›¿æ¢ï¼Œå–æ¶ˆå½“å‰æ­£åœ¨è¿è¡Œçš„ä½œä¸šå¹¶ä½¿ç”¨æ–°ä½œä¸šæ›¿æ¢å®ƒ<!-- raw HTML omitted --></li>
</ul>
</blockquote>
<ul>
<li><a href="https://raw.githubusercontent.com/usermice/images/master/Kubernetes_Server/Template/kubernetes-cronjob-template.yaml" rel="external" target="_self"><code>Kubernetes CronJob Template</code>æ¨¡æ¿</a></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">batch/v1   </span> <span style="color:#75715e"># ç‰ˆæœ¬å·</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">CronJob  </span> <span style="color:#75715e"># ç±»å‹</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:       <span style="color:#75715e"># å…ƒæ•°æ®</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">cronjob-template       </span> <span style="color:#75715e"># åç§°</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">default   </span> <span style="color:#75715e"># å‘½åç©ºé—´</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">controller</span>: <span style="color:#ae81ff">cronjob</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:   <span style="color:#75715e"># è¯¦æƒ…æè¿°</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">concurrencyPolicy</span>: <span style="color:#ae81ff">Allow   </span> <span style="color:#75715e"># å¹¶å‘æ‰§è¡Œç­–ç•¥ï¼ŒAllowï¼šå¹¶å‘è°ƒåº¦ï¼Œ</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">failedJobsHistoryLimit</span>: <span style="color:#ae81ff">1</span>   <span style="color:#75715e"># ä¿ç•™å¤šå°‘ä¸ªå¤±è´¥çš„ä»»åŠ¡ï¼Œé»˜è®¤ä¸º1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">successfulJobsHistoryLimit</span>: <span style="color:#ae81ff">3</span>   <span style="color:#75715e"># ä¿ç•™å¤šå°‘ä¸ªæˆåŠŸçš„ä»»åŠ¡ï¼Œé»˜è®¤ä¸º3</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># startingDeadlineSeconds: 30   # é—´éš”å¤šé•¿æ—¶é—´æ£€æµ‹å¤±è´¥çš„ä»»åŠ¡å¹¶é‡æ–°æ‰§è¡Œï¼Œæ—¶é—´ä¸èƒ½å°äºï¼š10</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">suspend</span>: <span style="color:#66d9ef">false</span>    <span style="color:#75715e"># æ˜¯å¦æŒ‚èµ·ä»»åŠ¡ï¼Œè‹¥ä¸ºï¼štrue åˆ™è¯¥ä»»åŠ¡ä¸æ‰§è¡Œ</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">schedule</span>: <span style="color:#e6db74">&#34;*/1 * * * * &#34;</span>    <span style="color:#75715e"># cronæ ¼å¼çš„ä½œä¸šè°ƒåº¦è¿è¡Œæ—¶é—´ç‚¹ï¼Œç”¨äºæ§åˆ¶ä»»åŠ¡ä»»åŠ¡æ—¶é—´æ‰§è¡Œ</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">jobTemplate</span>:          <span style="color:#75715e"># jobæ§åˆ¶å™¨æ¨¡æ¿ï¼Œç”¨äºä¸ºcronjobæ§åˆ¶å™¨ç”Ÿæˆjobå¯¹è±¡ï¼Œä¸‹é¢å…¶å®å°±æ˜¯jobçš„å®šä¹‰</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">metadata</span>: {}
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">completions</span>: <span style="color:#ae81ff">1</span>    <span style="color:#75715e"># æŒ‡å®šJobéœ€è¦æˆåŠŸè¿è¡ŒPodçš„æ€»æ¬¡æ•°ï¼Œé»˜è®¤ä¸º1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">parallelism</span>: <span style="color:#ae81ff">1</span>    <span style="color:#75715e"># æŒ‡å®šJobåœ¨ä»»ä¸€æ—¶åˆ»åº”è¯¥å¹¶å‘è¿è¡ŒPodçš„æ•°é‡ï¼Œé»˜è®¤ä¸º1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">activeDeadlineSeconds</span>: <span style="color:#ae81ff">30</span>         <span style="color:#75715e"># æŒ‡å®šJobå¯ä»¥è¿è¡Œçš„æ—¶é—´æœŸé™ï¼Œè¶…è¿‡æ—¶é—´è¿˜æ²¡ç»“æŸï¼Œç³»ç»Ÿå°†ä¼šå°è¯•è¿›è¡Œç»ˆæ­¢</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">backoffLimit</span>: <span style="color:#ae81ff">6</span>   <span style="color:#75715e"># æŒ‡å®šJobå¤±è´¥åè¿›è¡Œé‡è¯•çš„æ¬¡æ•°ï¼Œé»˜è®¤ä¸º6</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">template</span>:         <span style="color:#75715e"># æ¨¡æ¿ï¼Œå½“å‰¯æœ¬æ•°é‡ä¸è¶³æ—¶ï¼Œä¼šæ ¹æ®ä¸‹é¢çš„æ¨¡æ¿åˆ›å»ºPodæ¨¡æ¿</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">restartPolicy</span>: <span style="color:#ae81ff">Never         </span> <span style="color:#75715e"># é‡å¯ç­–ç•¥åªèƒ½è®¾ç½®ä¸ºNeveræˆ–OnFailure</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">container-name</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">image</span>: <span style="color:#ae81ff">busybox:1.30</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">command</span>: [ <span style="color:#e6db74">&#34;/bin/sh&#34;</span>,<span style="color:#e6db74">&#34;-c&#34;</span>,<span style="color:#e6db74">&#34;for i in 9 8 7 6 5 4 3 2 1;do echo $i;sleep 20;done&#34;</span> ]</span></span></code></pre></div></blockquote>
<hr>
<h3 id="æ¨¡æ¿è¯¦ç»†æè¿°">æ¨¡æ¿è¯¦ç»†æè¿°</h3>
<blockquote>
<table>
<thead>
<tr>
<th>åç§°åœ°å€</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/bitnami/" rel="external" target="_self"><code>Bitnami</code>æ¨¡æ¿åº“</a></td>
<td></td>
</tr>
<tr>
<td><a href="https://github.com/bitnami/charts/tree/main/bitnami" rel="external" target="_self"><code>Kubernetes</code>çš„<code>Bitnami</code>åº“</a></td>
<td><code>Helm</code>å®‰è£…<code>Kubernetes</code>æœåŠ¡<code>Zabbix</code>ã€<code>Redis</code>ã€<code>Mysql</code>æ¨¡æ¿</td>
</tr>
<tr>
<td><a href="https://github.com/bitnami/charts-docs/tree/main/charts" rel="external" target="_self"><code>Kubernetes</code>çš„<code>Charts-docs</code>åº“</a></td>
<td><code>Helm</code>å®‰è£…<code>Kubernetes</code>æœåŠ¡<code>Zabbix</code>ã€<code>Redis</code>ã€<code>Mysql</code>æ¨¡æ¿</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li><a href="https://raw.githubusercontent.com/usermice/images/master/Kubernetes_Server/Template/kubernetes-template.yaml" rel="external" target="_self"><code>Kubernetes Template</code>æ¨¡æ¿</a></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1   </span> <span style="color:#75715e"># ç‰ˆæœ¬å·ï¼Œä¾‹å¦‚v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Deployment   </span> <span style="color:#75715e"># èµ„æºç±»å‹ï¼Œä¾‹å¦‚ Podã€Deploymentã€Serviceã€ReplicaSetã€StatefulSet</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:   <span style="color:#75715e"># POdç›¸å…³çš„å…ƒæ•°æ®ï¼Œç”¨äºæè¿°Podæ•°æ®</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">java-demo  </span> <span style="color:#75715e"># Podåç§°ã€åœ¨åŒä¸€ä¸ªåç§°ç©ºé—´å†…ä¸èƒ½é‡å¤</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">string  </span> <span style="color:#75715e"># Podæ‰€å±çš„å‘½åç©ºé—´,é»˜è®¤ä¸º&#34;default&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">labels</span>:   <span style="color:#75715e"># å®šä¹‰Podçš„æ ‡ç­¾ï¼Œåªèƒ½ä½¿ç”¨å­—ç¬¦ä¸²ç±»å‹ï¼šstring</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">java-demo  </span> <span style="color:#75715e"># è‡ªå®šä¹‰labelæ ‡ç­¾ï¼Œkey(é”®)ä¸ºï¼šnameï¼Œvalue(å€¼)ä¸ºï¼šjava-demo</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">version</span>: <span style="color:#ae81ff">v1.1.0  </span> <span style="color:#75715e"># è‡ªå®šä¹‰ç‰ˆæœ¬</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">annotations</span>:    <span style="color:#75715e"># æ³¨é‡Šï¼Œä¸èƒ½ä½œä¸ºè¢«ç­›é€‰</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">java-demo</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:   <span style="color:#75715e"># Podä¸­å®¹å™¨çš„è¯¦ç»†å®šä¹‰</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">replicas</span>: <span style="color:#ae81ff">3</span>   <span style="color:#75715e"># åˆ›å»ºçš„å‰¯æœ¬æ•°é‡</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">revisionHistoryLimit</span>: <span style="color:#ae81ff">10</span>    <span style="color:#75715e"># æ»šåŠ¨æ›´æ–°åä¿ç•™çš„å†å²ç‰ˆæœ¬æ•°</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:   <span style="color:#75715e"># é€‰æ‹©å™¨ï¼Œç”¨äºæ‰¾åˆ°åŒ¹é…çš„ ReplicaSet(å‰¯æœ¬)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">matchLabels</span>:    <span style="color:#75715e"># æŒ‰ç…§Labelsæ ‡ç­¾åŒ¹é…å‰¯æœ¬</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">java-demo  </span> <span style="color:#75715e"># åŒ¹é…çš„keyï¼Œvalue</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">version</span>: <span style="color:#ae81ff">v1.1.0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">strategy</span>:   <span style="color:#75715e"># æ›´æ–°ç­–ç•¥ï¼ŒStatefulSetæ›´æ–°ä½¿ç”¨ï¼šupdateStrategy</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">rollingUpdate</span>:    <span style="color:#75715e"># æ»šåŠ¨æ›´æ–°é…ç½®</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">partition</span>: <span style="color:#ae81ff">3</span>    <span style="color:#75715e"># å®ç°ç°åº¦/é‡‘ä¸é›€å‘å¸ƒï¼ŒæŒ‰åºå·æ›´æ–°ï¼Œæ›´æ–°å¤§äºç­‰äº3çš„åºå·ï¼Œä¸å’Œç™¾åˆ†æ¯”å…±ç”¨</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">maxSurge</span>: <span style="color:#ae81ff">25</span><span style="color:#ae81ff">%  </span> <span style="color:#75715e"># å¤šå°‘ä¸ª/ç™¾åˆ†ä¹‹å¤šå°‘Podså¤„äºæ›´æ–°ï¼Œæ•°å€¼è¶Šå¤§æ›´æ–°è¶Šå¿«ï¼Œä¸ç¨³å®š</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">maxUnavailable</span>: <span style="color:#ae81ff">25</span><span style="color:#ae81ff">%  </span> <span style="color:#75715e"># å¤šå°‘ä¸ª/ç™¾åˆ†ä¹‹å¤šå°‘Podså¤„äºå…³é—­ï¼Œæ•°å€¼è¶Šå°æ›´æ–°æ…¢ï¼Œç¨³å®š</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">type</span>: <span style="color:#ae81ff">RollingUpdate  </span> <span style="color:#75715e"># æ›´æ–°ç±»å‹é€‰æ‹©å™¨ï¼Œé‡‡ç”¨æ»šåŠ¨æ›´æ–°ï¼ŒOnDeleteï¼šæ–¹å¼æ›´æ–°ï¼Œåˆ é™¤podsæ—¶æ›´æ–°</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">template</span>:   <span style="color:#75715e"># Pod æ¨¡æ¿</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">metadata</span>:   <span style="color:#75715e"># Pod çš„å…ƒä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">labels</span>:   <span style="color:#75715e"># Pod çš„æ ‡ç­¾ </span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">java-demo</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">version</span>: <span style="color:#ae81ff">v1.1.0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">spec</span>:   <span style="color:#75715e"># Podçš„æœŸæœ›ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">nodeName</span>: <span style="color:#ae81ff">k8s-node1  </span> <span style="color:#75715e"># è®¾ç½®NodeNameè¡¨ç¤ºå°†è¯¥Podè°ƒåº¦åˆ°æŒ‡å®šåˆ°åç§°çš„nodeèŠ‚ç‚¹ä¸Š</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">nodeSelector</span>: <span style="color:#ae81ff">obeject  </span> <span style="color:#75715e"># è®¾ç½®NodeSelectorè¡¨ç¤ºå°†è¯¥Podè°ƒåº¦åˆ°åŒ…å«è¿™ä¸ªlabelçš„nodeä¸Š</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">hostNetwork</span>: <span style="color:#66d9ef">false</span>    <span style="color:#75715e"># æ˜¯å¦ä½¿ç”¨ä¸»æœºç½‘ç»œæ¨¡å¼ï¼Œé»˜è®¤ä¸ºfalseï¼Œå¦‚æœè®¾ç½®ä¸ºtrueï¼Œè¡¨ç¤ºä½¿ç”¨å®¿ä¸»æœºç½‘ç»œ</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">tolerations</span>:  	<span style="color:#75715e"># å®¹å¿é…ç½®</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">effect</span>: <span style="color:#e6db74">&#34;æ±¡ç‚¹çš„ç±»å‹&#34;</span>  <span style="color:#75715e"># Noschedule</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">key</span>: <span style="color:#e6db74">&#34;æ±¡ç‚¹çš„Key&#34;</span>  	<span style="color:#75715e"># æ±¡ç‚¹çš„Key</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">operate</span>: <span style="color:#e6db74">&#34;Equal&#34;</span>  	<span style="color:#75715e"># Existsï¼šåŒ¹é…Keyï¼ŒEqualæ·»åŠ ï¼švalueé…ç½®ï¼Œ</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#34;æ±¡ç‚¹çš„value&#34;</span>  	<span style="color:#75715e"># æ±¡ç‚¹çš„value</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">imagePullSecrets</span>:   <span style="color:#75715e"># é…ç½®ç™»å½• docker registry çš„ secret ä»“åº“</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">docker-harbor  </span> <span style="color:#75715e"># æŒ‡å®šä½¿ç”¨çš„secretåº“æˆ¿åç§°</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">containers</span>:   <span style="color:#75715e"># å¯¹äº Podä¸­å®¹å™¨æè¿°</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">tomcat-demo  </span> <span style="color:#75715e"># æŒ‡å®šå®¹å™¨åç§°ï¼Œä¸å¯æ›´æ–°</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">image</span>: <span style="color:#ae81ff">192.168.80.210</span>:<span style="color:#ae81ff">8080</span><span style="color:#ae81ff">/test/tomcat-demo:v1   </span> <span style="color:#75715e"># é•œåƒä»“åº“åœ°å€</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">imagePullPolicy</span>: [ <span style="color:#ae81ff">Always | Never | IfNotPresent ]   </span> <span style="color:#75715e"># é•œåƒæ‹‰å–æ–¹å¼</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">command</span>: [<span style="color:#ae81ff">string]  </span> <span style="color:#75715e"># ä»¥æ•°ç»„æ–¹å¼æŒ‡å®šå®¹å™¨å¯åŠ¨å‘½ä»¤åˆ—è¡¨ï¼Œå¦‚ä¸æŒ‡å®šï¼Œä½¿ç”¨æ‰“åŒ…æ—¶ä½¿ç”¨çš„å¯åŠ¨å‘½ä»¤</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">args</span>:   <span style="color:#75715e"># ä»¥æ•°ç»„æ–¹å¼æŒ‡å®šå®¹å™¨å¯åŠ¨å‘½ä»¤å‚æ•°åˆ—è¡¨ï¼Œæ›¿ä»£dockerçš„CMDæŒ‡ä»¤</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#ae81ff">/bin/sh</span>
</span></span><span style="display:flex;"><span>        - -<span style="color:#ae81ff">c</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#ae81ff">touch /tmp/healthy; sleep 30; rm -fr /tmp/healthy; sleep 600   </span> <span style="color:#75715e"># ä¸èƒ½è¶…è¿‡æ¢é’ˆæ‰§è¡Œæ—¶é—´</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">workingDir</span>: <span style="color:#ae81ff">string   </span> <span style="color:#75715e"># å®¹å™¨å¯åŠ¨åè¿›å…¥çš„å·¥ä½œç›®å½•ï¼Œä¸æŒ‡å®šåˆ™ä½¿ç”¨é•œåƒé»˜è®¤å€¼</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">volumeMounts</span>:   <span style="color:#75715e"># æŒ‚è½½åˆ°å®¹å™¨å†…éƒ¨çš„å­˜å‚¨å·é…ç½®</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">data   </span> <span style="color:#75715e"># å¼•ç”¨podå®šä¹‰çš„å…±äº«å­˜å‚¨å·çš„åç§°ï¼Œéœ€ç”¨volumes[]éƒ¨åˆ†å®šä¹‰çš„çš„å·å</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/opt/data   </span> <span style="color:#75715e"># å­˜å‚¨å·åœ¨å®¹å™¨å†…mountçš„ç»å¯¹è·¯å¾„ï¼Œåº”å°‘äº512å­—ç¬¦</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">readOnly</span>: <span style="color:#ae81ff">boolean  </span> <span style="color:#75715e"># æ˜¯å¦ä¸ºåªè¯»æ¨¡å¼</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">ports</span>:    <span style="color:#75715e"># éœ€è¦æš´éœ²çš„ç«¯å£åº“å·åˆ—è¡¨</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">http   </span> <span style="color:#75715e"># ä¸ºç«¯å£å–åï¼Œè¯¥åç§°å¯ä»¥åœ¨serviceç§è¢«å¼•ç”¨</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">int   </span> <span style="color:#75715e"># å®¹å™¨éœ€è¦ç›‘å¬çš„ç«¯å£å·</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">hostPort</span>: <span style="color:#ae81ff">int  </span> <span style="color:#75715e"># å®¹å™¨æ‰€åœ¨ä¸»æœºéœ€è¦ç›‘å¬çš„ç«¯å£å·ï¼Œé»˜è®¤ä¸Containerç›¸åŒ</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">protocol</span>: <span style="color:#ae81ff">TCP  </span> <span style="color:#75715e"># ç«¯å£åè®®ï¼Œæ”¯æŒTCPå’ŒUDPï¼Œé»˜è®¤TCP</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">targetPort</span>: <span style="color:#ae81ff">80</span>    <span style="color:#75715e"># Pod æœ¬èº«æœåŠ¡ç«¯å£ï¼Œæ¯”å¦‚Nginxï¼š80ï¼ŒTomcatï¼š8080</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">nodePort</span>: <span style="color:#ae81ff">30001</span>   <span style="color:#75715e"># èŠ‚ç‚¹å¯¹å¤–ç«¯å£</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">env</span>:    <span style="color:#75715e"># å®¹å™¨è¿è¡Œå‰éœ€è®¾ç½®çš„ç¯å¢ƒå˜é‡åˆ—è¡¨</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">JAVA_OPTS  </span> <span style="color:#75715e"># ç¯å¢ƒå˜é‡åç§°</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#34;-Xmx1g&#34;</span>   <span style="color:#75715e"># ç¯å¢ƒå˜é‡çš„å€¼</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">resources</span>:    <span style="color:#75715e"># èµ„æºé™åˆ¶å’Œè¯·æ±‚çš„è®¾ç½®</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">limits</span>:   <span style="color:#75715e"># é™å®šPodæœ€å¤§ä½¿ç”¨ç¡¬ä»¶èµ„æºã€é€šå¸¸è®¾ç½®cpuå’Œmemory</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">cpu</span>: <span style="color:#e6db74">&#34;1&#34;</span>    <span style="color:#75715e"># Cpuçš„é™åˆ¶ï¼Œå•ä½ä¸ºcoreæ•°ï¼Œå°†ç”¨äºdocker run --cpu-shareså‚æ•°ï¼Œ1000mç­‰äºä¸€ä¸ªæ ¸å¿ƒ</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">memory</span>: <span style="color:#e6db74">&#34;1Gi&#34;</span>   <span style="color:#75715e"># å†…å­˜é™åˆ¶ï¼Œå•ä½å¯ä»¥ä¸ºMib/Gibï¼Œå°†ç”¨äºdocker run --memoryå‚æ•°</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">requests</span>:   <span style="color:#75715e"># æœ€ä½èµ„æºè¦æ±‚ï¼Œåœ¨schedulerä¸­è¢«ç”¨åˆ°ï¼Œé€šå¸¸è®¾ç½®cpuå’Œmemory</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">cpu</span>: <span style="color:#e6db74">&#34;0.5&#34;</span>    <span style="color:#75715e"># é™å®šä½¿ç”¨å‡ ä¸ªæ ¸å¿ƒCPUã€å®¹å™¨å¯åŠ¨çš„åˆå§‹å¯ç”¨æ•°é‡</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">memory</span>: <span style="color:#e6db74">&#34;256Mi&#34;</span>   <span style="color:#75715e"># è®¾å®šä½¿ç”¨å†…å­˜ã€å®¹å™¨å¯åŠ¨çš„åˆå§‹å¯ç”¨æ•°é‡</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">lifecycle</span>:    <span style="color:#75715e"># ç”Ÿå‘½å‘¨æœŸé’©å­</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">postStart</span>:    <span style="color:#75715e"># å®¹å™¨å¯åŠ¨åç«‹å³æ‰§è¡Œæ­¤é’©å­,å¦‚æœæ‰§è¡Œå¤±è´¥,ä¼šæ ¹æ®é‡å¯ç­–ç•¥è¿›è¡Œé‡å¯</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">exec</span>:
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">command</span>: [<span style="color:#e6db74">&#34;/bin/sh&#34;</span>,<span style="color:#e6db74">&#34;-c&#34;</span>,<span style="color:#e6db74">&#34;echo Hello from the postStart handler &gt;/usr/share/message&#34;</span>]
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">preStop</span>:    <span style="color:#75715e"># å®¹å™¨ç»ˆæ­¢å‰æ‰§è¡Œæ­¤é’©å­,æ— è®ºç»“æœå¦‚ä½•,å®¹å™¨éƒ½ä¼šç»ˆæ­¢</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">exec</span>:
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">command</span>: [<span style="color:#e6db74">&#34;/bin/sh&#34;</span>,<span style="color:#e6db74">&#34;-c&#34;</span>,<span style="color:#e6db74">&#34;nginx -s quit; while killall -0 nginx; do sleep 1; done&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">startupProbe</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">tcpSocket</span>:    <span style="color:#75715e"># ä½¿ç”¨TcpSocketã€httpGetå¥åº·æ£€æŸ¥</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">port</span>: <span style="color:#ae81ff">8010</span>    <span style="color:#75715e"># æ¢æµ‹8010ç«¯å£</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">failureThreshold</span>: <span style="color:#ae81ff">5</span>   <span style="color:#75715e"># æ£€æµ‹å¤±è´¥5æ¬¡è¡¨ç¤ºæœªå°±ç»ª</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">initialDelaySeconds</span>: <span style="color:#ae81ff">60</span>   <span style="color:#75715e"># æŒ‡å®šå®¹å™¨å¯åŠ¨60sä¹‹åå¼€å§‹æ‰§è¡ŒLivenessæ¢æµ‹ï¼Œ</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">periodSeconds</span>: <span style="color:#ae81ff">10</span>   <span style="color:#75715e"># æŒ‡å®šæ¯10ç§’æ‰§è¡Œä¸€æ¬¡Livenessæ¢æµ‹ã€‚</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">successThreshold</span>: <span style="color:#ae81ff">1</span>   <span style="color:#75715e"># æ£€æŸ¥æˆåŠŸä¸º2æ¬¡è¡¨ç¤ºå°±ç»ª</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">timeoutSeconds</span>: <span style="color:#ae81ff">5</span>   <span style="color:#75715e"># æ£€æµ‹å¤±è´¥1æ¬¡è¡¨ç¤ºæœªå°±ç»ª</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">livenessProbe</span>:    <span style="color:#75715e"># å¯¹Podå†…å„å®¹å™¨å¥åº·æ£€æŸ¥çš„è®¾ç½®ï¼Œå½“æ¢æµ‹æ— å“åº”å‡ æ¬¡åå°†è‡ªåŠ¨é‡å¯è¯¥å®¹å™¨</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">exec</span>:   <span style="color:#75715e"># å¯¹Podå®¹å™¨å†…æ£€æŸ¥æ–¹å¼è®¾ç½®ä¸ºexecæ–¹å¼</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">command</span>:    <span style="color:#75715e"># execæ–¹å¼éœ€è¦åˆ¶å®šçš„å‘½ä»¤æˆ–è„šæœ¬</span>
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">sh</span>
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">c</span>
</span></span><span style="display:flex;"><span>            - <span style="color:#e6db74">&#34;sleep 5; echo &#39;success&#39;;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">httpGet</span>:    <span style="color:#75715e"># å¯¹Podå†…ä¸ªå®¹å™¨å¥åº·æ£€æŸ¥æ–¹æ³•è®¾ç½®ä¸ºHttpGetï¼Œéœ€è¦åˆ¶å®šPathã€port</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/  </span> <span style="color:#75715e"># URIåœ°å€ï¼šhttp://:80/index.html</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">port</span>: <span style="color:#ae81ff">8010</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">host</span>: <span style="color:#ae81ff">192.168.109.100</span>   <span style="color:#75715e"># ä¸»æœºåœ°å€</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">scheme</span>: <span style="color:#ae81ff">HTTP   </span> <span style="color:#75715e"># æ”¯æŒçš„åè®®ï¼Œhttpæˆ–è€…https</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">HttpHeaders</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">string</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">value</span>: <span style="color:#ae81ff">string(å­—ç¬¦ä¸²)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">tcpSocket</span>:    <span style="color:#75715e"># å¯¹Podå†…ä¸ªå®¹å™¨å¥åº·æ£€æŸ¥æ–¹å¼è®¾ç½®ä¸ºtcpSocketæ–¹å¼</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">port</span>: <span style="color:#ae81ff">8010</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">initialDelaySeconds</span>: <span style="color:#ae81ff">60</span>   <span style="color:#75715e"># å®¹å™¨å¯åŠ¨å®Œæˆåé¦–æ¬¡æ¢æµ‹çš„æ—¶é—´ï¼Œå•ä½ä¸ºç§’</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">timeoutSeconds</span>: <span style="color:#ae81ff">5</span>   <span style="color:#75715e"># å¯¹å®¹å™¨å¥åº·æ£€æŸ¥æ¢æµ‹ç­‰å¾…å“åº”çš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½ç§’ï¼Œé»˜è®¤1ç§’</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">periodSeconds</span>: <span style="color:#ae81ff">10</span>   <span style="color:#75715e"># å¯¹å®¹å™¨ç›‘æ§æ£€æŸ¥çš„å®šæœŸæ¢æµ‹æ—¶é—´è®¾ç½®ï¼Œå•ä½ç§’ï¼Œé»˜è®¤10ç§’ä¸€æ¬¡</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">successThreshold</span>: <span style="color:#ae81ff">1</span>   <span style="color:#75715e"># é…ç½®ä¸ºï¼š1ï¼Œè¡¨ç¤ºæ£€æŸ¥ä¸€æ¬¡æˆåŠŸå°±æˆåŠŸï¼Œé…ç½®ä¸ºï¼š3ï¼Œè¡¨ç¤ºæ£€æŸ¥3æ¬¡</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">failureThreshold</span>: <span style="color:#ae81ff">5</span>   <span style="color:#75715e"># å¤±è´¥æ¬¡æ•°ï¼Œæ£€æŸ¥5æ¬¡å¤±è´¥è¡¨ç¤ºå¤±è´¥</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">securityContext</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">privileged</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">restartPolicy</span>: [<span style="color:#ae81ff">Always | Never | OnFailure]  </span> <span style="color:#75715e"># Podçš„é‡å¯ç­–ç•¥</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">terminationGracePeriodSeconds</span>: <span style="color:#ae81ff">30</span>   <span style="color:#75715e"># åˆ é™¤podsã€deploymentåç­‰å¾…æ—¶é—´</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">volumes</span>:    <span style="color:#75715e"># åœ¨è¯¥podä¸Šå®šä¹‰å…±äº«å­˜å‚¨å·åˆ—è¡¨</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">logs-volume  </span> <span style="color:#75715e"># å…±äº«å­˜å‚¨å·åç§° ï¼ˆvolumesç±»å‹æœ‰å¾ˆå¤šç§ï¼‰</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">emptyDir</span>: {}    <span style="color:#75715e"># ç±»å‹ä¸ºemtyDirçš„å­˜å‚¨å·ï¼Œä¸PodåŒç”Ÿå‘½å‘¨æœŸçš„ä¸€ä¸ªä¸´æ—¶ç›®å½•ã€‚ä¸ºç©ºå€¼</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">hostPath</span>:   <span style="color:#75715e"># ç±»å‹ä¸ºhostPathçš„å­˜å‚¨å·ï¼Œè¡¨ç¤ºæŒ‚è½½Podæ‰€åœ¨å®¿ä¸»æœºçš„ç›®å½•</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/root/logs   </span> <span style="color:#75715e"># Podæ‰€åœ¨å®¿ä¸»æœºçš„ç›®å½•ï¼Œå°†è¢«ç”¨äºåŒæœŸä¸­mountçš„ç›®å½•</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">type</span>: <span style="color:#ae81ff">DirectoryOrCreate  </span> <span style="color:#75715e"># ç›®å½•å­˜åœ¨å°±ä½¿ç”¨ï¼Œä¸å­˜åœ¨å°±å…ˆåˆ›å»ºå†ä½¿ç”¨</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">secret</span>:   <span style="color:#75715e"># ç±»å‹ä¸ºsecretçš„å­˜å‚¨å·ï¼ŒæŒ‚è½½é›†ç¾¤ä¸å®šä¹‰çš„secretå¯¹è±¡åˆ°å®¹å™¨å†…éƒ¨</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">scretname</span>: <span style="color:#ae81ff">secret</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">items</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#f92672">key</span>: <span style="color:#ae81ff">string</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">path</span>: <span style="color:#ae81ff">string</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">configMap</span>:    <span style="color:#75715e"># ç±»å‹ä¸ºconfigMapçš„å­˜å‚¨å·ï¼ŒæŒ‚è½½é¢„å®šä¹‰çš„configMapå¯¹è±¡åˆ°å®¹å™¨å†…éƒ¨</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">name</span>: <span style="color:#ae81ff">configmap</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">items</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#f92672">key</span>: <span style="color:#ae81ff">string</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">path</span>: <span style="color:#ae81ff">string</span></span></span></code></pre></div></blockquote>
<hr>
<h4 id="ç¼–å†™é€‚ç”¨javaçš„yaml">ç¼–å†™é€‚ç”¨<code>Java</code>çš„<code>yaml</code></h4>
<ul>
<li>
<ol>
<li>ä¸‹è½½<code>java demo</code>ä»£ç </li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ git clone https://github.com/frankinbj/tomcat-java-demo.git     </span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="2">
<li><!-- raw HTML omitted -->ä¿®æ”¹è¿æ¥æ•°æ®åº“é…ç½®æ–‡ä»¶<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cat &gt;tomcat-java-demo/src/main/resources/application.yml<span style="color:#e6db74">&lt;&lt;-EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">datasource:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    url: jdbc:mysql://192.168.80.215:3306/test?characterEncoding=utf-8
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    username: admin
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    password: admin
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span></span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="3">
<li>æ‰“åŒ…<code>java war</code>åŒ…</li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cd /opt/tomcat-java-demo/
</span></span><span style="display:flex;"><span>$ mvn clean package -Dmaven.test.skip<span style="color:#f92672">=</span>true
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç”ŸæˆwaråŒ…</span>
</span></span><span style="display:flex;"><span>$ ll /opt/tomcat-java-demo/target/ly-simple-tomcat-0.0.1-SNAPSHOT.war</span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="4">
<li><!-- raw HTML omitted -->æŠŠæ•°æ®å¯¼å…¥æ•°æ®åº“ï¼Œåˆ›å»ºæˆæƒè¿æ¥ç”¨æˆ·<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ mysql -uroot -p &lt; tomcat-java-demo/doc/db/tables_ly_tomcat.sql
</span></span><span style="display:flex;"><span>$ grant all privileges on *.* to admin@<span style="color:#e6db74">&#39;%&#39;</span> identified by <span style="color:#e6db74">&#39;admin&#39;</span>;</span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="5">
<li><code>JDK</code>ã€<code>Maven</code><!-- raw HTML omitted -->é…ç½®ç¯å¢ƒå˜é‡<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ echo <span style="color:#e6db74">&#34;#####  	JDK ç’°å¢ƒè®Šæ•¸  	#####
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">export JAVA_HOME=/usr/local/jdk
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">export JRE_HOME=</span><span style="color:#e6db74">${</span>JAVA_HOME<span style="color:#e6db74">}</span><span style="color:#e6db74">/jre
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">export CLASSPATH=</span><span style="color:#e6db74">${</span>JAVA_HOME<span style="color:#e6db74">}</span><span style="color:#e6db74">/lib:</span><span style="color:#e6db74">${</span>JAVA_HOME<span style="color:#e6db74">}</span><span style="color:#e6db74">/lib/tools.jar
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">export PATH=</span><span style="color:#e6db74">${</span>PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">${</span>JAVA_HOME<span style="color:#e6db74">}</span><span style="color:#e6db74">/bin:</span><span style="color:#e6db74">${</span>JAVA_HOME<span style="color:#e6db74">}</span><span style="color:#e6db74">/jre/bin
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">export PATH=</span><span style="color:#e6db74">${</span>PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">:/usr/local/maven/bin &#34;</span>&gt;&gt;/etc/profile</span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="6">
<li>ä¿®æ”¹<code>Dockerfile</code>é…ç½®æ–‡ä»¶ï¼Œ<code>docker build</code>æˆé•œåƒ</li>
</ol>
</li>
</ul>
<blockquote>
<ul>
<li>6.1 ä½¿ç”¨<code>Tomcat</code>æœåŠ¡æ‰“åŒ…å¯åŠ¨å®¹å™¨</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cat &gt;/opt/tomcat-java-demo/Dockerfile<span style="color:#e6db74">&lt;&lt;-EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">FROM lizhenliang/tomcat
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">RUN rm -rf /usr/local/tomcat/webapps/*
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">ADD target/*.war /usr/local/tomcat/webapps/ROOT.war
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># å£°æ˜æ—¶åŒº
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">RUN ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime &amp;&amp; echo &#39;Asia/Shanghai&#39; &gt;/etc/timezone
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span></span></span></code></pre></div><ul>
<li>6.2 ä½¿ç”¨<code>java -jar</code><!-- raw HTML omitted -->æ‰“åŒ…é•œåƒï¼Œå¯ä»¥ä½¿ç”¨<!-- raw HTML omitted --><code>xxl-job</code>çš„<code>jar</code>åŒ…</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span><span style="color:#e6db74"> openjdk</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">VOLUME</span><span style="color:#e6db74"> /tmp</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">COPY</span> ./target/live-server-1.0.0-SNAPSHOT.jar live-server-1.0.0-SNAPSHOT.jar<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> bash -c <span style="color:#e6db74">&#34;touch /live-server-1.0.0-SNAPSHOT.jar&#34;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e"># å£°æ˜æ—¶åŒº</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime <span style="color:#f92672">&amp;&amp;</span> echo <span style="color:#e6db74">&#39;Asia/Shanghai&#39;</span> &gt;/etc/timezone<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e"># å£°æ˜è¿è¡Œæ—¶å®¹å™¨æä¾›æœåŠ¡ç«¯å£ï¼Œè¿è¡Œæ—¶ä¸ä¼šå¼€å¯è¿™ä¸ªç«¯å£çš„æœåŠ¡ï¼Œéœ€è¦æŠŠç«¯å£æ˜ å°„</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">EXPOSE</span><span style="color:#e6db74"> 8080</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ENTRYPOINT</span> [<span style="color:#e6db74">&#34;java&#34;</span>,<span style="color:#e6db74">&#34;-jar&#34;</span>,<span style="color:#e6db74">&#34;/live-server-1.0.0-SNAPSHOT.jar&#34;</span>]</span></span></code></pre></div><ul>
<li>6.3 ç”Ÿæˆ<code>docker imagesï¼š</code>é•œåƒå¹¶æ¨é€åˆ°ç§äººä»“åº“</li>
</ul>
<blockquote>
<ul>
<li>
<p><code>-t,--tag list</code>ï¼šé•œåƒåç§°</p>
</li>
<li>
<p><code>-fï¼Œ--file string</code>ï¼šå¦‚æœæ–‡ä»¶åä¸æ˜¯<code>Dockerfile</code>ï¼Œ<code>-f</code>å¯ä»¥æŒ‡å®šå…¶ä»–æ–‡ä»¶</p>
</li>
<li>
<p><code>192.168.80.210:8080</code>ï¼šç§äººä»“åº“åœ°å€</p>
</li>
<li>
<p><code>test</code>ï¼šç§äººä»“åº“å</p>
</li>
<li>
<p><code>tomcat-demo:v1</code>ï¼šå®šä¹‰é•œåƒåç§°ä»¥åŠç‰ˆæœ¬</p>
</li>
<li>
<p>å¦‚æœæ‰“åŒ…æŠ¥é”™ï¼š<code>epository does not exist,</code>æ›´æ¢<code>Dockerfile</code>çš„<code>FROM</code>æºåœ°å€</p>
</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cd /opt/tomcat-java-demo/
</span></span><span style="display:flex;"><span>$ docker build -t 192.168.80.210:8080/test/tomcat-demo:v1 .  	<span style="color:#75715e"># æ‰“åŒ…é•œåƒ</span>
</span></span><span style="display:flex;"><span>$ docker push 192.168.80.210:8080/test/tomcat-demo:v1  	<span style="color:#75715e"># æ¨é€åˆ°ç§äººä»“åº“ </span></span></span></code></pre></div></blockquote>
</blockquote>
<hr>
<h4 id="éƒ¨ç½²elkæ—¥å¿—æœåŠ¡">éƒ¨ç½²<code>ELK</code>æ—¥å¿—æœåŠ¡</h4>
<blockquote>
<ul>
<li><a href="https://raw.githubusercontent.com/usermice/images/master/Kubernetes_Server/Template/devops/Logs/kubernetes-elasticsearch.yaml" rel="external" target="_self"><code>Kubernetes Elasticsearch Template</code>æ¨¡æ¿</a></li>
<li><a href="https://raw.githubusercontent.com/usermice/images/master/Kubernetes_Server/Template/devops/Logs/kubernetes-logstash.yaml" rel="external" target="_self"><code>Kubernetes Logstash Template</code>æ¨¡æ¿</a></li>
<li><a href="https://raw.githubusercontent.com/usermice/images/master/Kubernetes_Server/Template/devops/Logs/kubernetes-filebeat.yaml" rel="external" target="_self"><code>Kubernetes Filebeat Template</code>æ¨¡æ¿</a></li>
<li><a href="https://raw.githubusercontent.com/usermice/images/master/Kubernetes_Server/Template/devops/Logs/kubernetes-kibana.yaml" rel="external" target="_self"><code>Kubernetes Kibana Template</code>æ¨¡æ¿</a></li>
</ul>
</blockquote>
<hr>

            <footer class="footline">
            </footer>
          </article>

        </div>
      </main>
    </div>
    <script src="../../../../js/clipboard.min.js?1721045975" defer></script>
    <script src="../../../../js/perfect-scrollbar.min.js?1721045975" defer></script>
    <script src="../../../../js/d3/d3-color.min.js?1721045975" defer></script>
    <script src="../../../../js/d3/d3-dispatch.min.js?1721045975" defer></script>
    <script src="../../../../js/d3/d3-drag.min.js?1721045975" defer></script>
    <script src="../../../../js/d3/d3-ease.min.js?1721045975" defer></script>
    <script src="../../../../js/d3/d3-interpolate.min.js?1721045975" defer></script>
    <script src="../../../../js/d3/d3-selection.min.js?1721045975" defer></script>
    <script src="../../../../js/d3/d3-timer.min.js?1721045975" defer></script>
    <script src="../../../../js/d3/d3-transition.min.js?1721045975" defer></script>
    <script src="../../../../js/d3/d3-zoom.min.js?1721045975" defer></script>
    <script src="../../../../js/js-yaml.min.js?1721045975" defer></script>
    <script src="../../../../js/mermaid.min.js?1721045975" defer></script>
    <script>
      window.themeUseMermaid = JSON.parse("{ \"securityLevel\": \"loose\" }");
    </script>
    <script src="../../../../js/theme.js?1721045975" defer></script>
  </body>
</html>
