<!doctype html><html lang=zh-CN data-theme=light><head><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: light)"><meta name=generator content="Hugo 0.125.4"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="Configure Mysql"><meta itemprop=description content="Configure-Mysql"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://erge.blog/imgs/s2-1.jpg"><meta itemprop=keywords content="Databases,Mysql"><meta property="og:type" content="article"><meta property="og:title" content="Configure Mysql"><meta property="og:description" content="Configure-Mysql"><meta property="og:image" content="/imgs/s2-1.jpg"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://erge.blog/systems/linux/databases/configure-mysql/"><meta property="og:site_name" content="二哥"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="二哥"><meta property="article:published_time" content="2022-08-05 23:40:24 +0800 CST"><meta property="article:modified_time" content="2022-08-05 23:40:24 +0800 CST"><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.css><link rel=stylesheet href=/css/main.min.0d420b6f564e6674edd4354ea71c0458a83f95ad464a75114b23d72515b1456c.css><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":true,"isHome":false,"isPage":true,"path":"configure-mysql","permalink":"https://erge.blog/systems/linux/databases/configure-mysql/","title":"Configure Mysql","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>Configure Mysql - 二哥</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>二哥</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>Linux、Kubernetes、Docker、Python、CI/CD、Jenkins、Mysql、Nginx、Gitlab、Ansible、Zabbix</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-Home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-categories"><a href=/categories/ class=hvr-icon-pulse rel=section><i class="fa fa-th hvr-icon"></i>分类</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>0</span></a></li><li class="menu-item menu-item-tags"><a href=/tags/ class=hvr-icon-pulse rel=section><i class="fa fa-tags hvr-icon"></i>标签</a></li><li class="menu-item menu-item-tools"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-tools hvr-icon"></i>工具</a></li><li class="menu-item menu-item-flinks"><a href=/flinks.html class=hvr-icon-pulse rel=section><i class="fa fa-thumbs-up hvr-icon"></i>站点示例</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-Commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#数据库常用命令>数据库常用命令</a><ul><li><a href=#查询数据库连接数以及慢语句>查询数据库连接数以及慢语句</a></li><li><a href=#三种修改数据库密码>三种修改数据库密码</a></li><li><a href=#导出数据库表结构>导出数据库表结构</a></li><li><a href=#查看导出清理binlog日志>查看、导出、清理<code>binlog</code>日志</a></li><li><a href=#创建授权删除用户>创建、授权、删除用户</a></li><li><a href=#创建库创建表>创建库、创建表</a></li><li><a href=#其他命令>其他命令</a></li></ul></li><li><a href=#mysql查询锁表语句><code>MySQL</code>查询锁表语句</a></li><li><a href=#配置数据库主从复制>配置数据库主从复制</a></li><li><a href=#数据库开启gtid流程>数据库开启<code>GTID</code>流程</a></li><li><a href=#mysql开启日志审计><code>Mysql</code>开启日志审计</a></li><li><a href=#主从跳过复制错误>主从跳过复制错误</a></li><li><a href=#sql优化审核平台工具><code>SQL</code>优化、审核平台工具</a></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=二哥 src=/imgs/img-lazy-loading.gif data-src=/imgs/s2-1.jpg><p class=site-author-name itemprop=name>二哥</p><div class=site-description itemprop=description>The man who has made up his mind to win will never say impossible – Napoleon Bonaparte</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>0</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>51</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>149</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=qq%e5%8f%b7 title="QQ → qq号" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-qq fa-fw hvr-icon"></i>
QQ
</a></span><span class=links-of-social-item><a href=https://www.zhihu.com/people/lisenhui title="知乎 → https://www.zhihu.com/people/lisenhui" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎
</a></span><span class=links-of-social-item><a href=qq@qq.com title="E-Mail → qq@qq.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>
E-Mail
</a></span><span class=links-of-social-item><a href=https://weibo.com/yourname title="Weibo → https://weibo.com/yourname" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-weibo fa-fw hvr-icon"></i>
Weibo
</a></span><span class=links-of-social-item><a href="https://www.youtube.com/watch?v=RgKAFK5djSk" title="Youtube → https://www.youtube.com/watch?v=RgKAFK5djSk" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-youtube fa-fw hvr-icon"></i>
Youtube
</a></span><span class=links-of-social-item><a href=https://github.com/elkan1788 title="Github → https://github.com/elkan1788" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li><li class=links-of-blogroll-item><a href=https://lisenhui.cn title=https://lisenhui.cn target=_blank>凡梦星尘空间站</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=goto-gtranslate class=button title=多语言翻译><i class="fas fa-globe"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/hugo-next rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg>
</a><script type=text/javascript src=//sidecar.gitter.im/dist/sidecar.v1.js async></script><script type=text/javascript>((window.gitter={}).chat={}).options={room:"hugo-next/community"}</script><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://erge.blog/systems/linux/databases/configure-mysql/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/s2-1.jpg"><meta itemprop=name content="二哥"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="二哥"><meta itemprop=description content="The man who has made up his mind to win will never say impossible – Napoleon Bonaparte"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="Configure Mysql"><meta itemprop=description content="Configure-Mysql"></span><header class=post-header><h1 class=post-title itemprop="name headline">Configure Mysql
<a href=https://github.com/user-name/repo-name/tree/branch-name/subdirectory-name/Systems/Linux/Databases/Configure-Mysql.md rel="noopener external nofollow noreferrer" target=_blank class="exturl post-edit-link" title=编辑><i class="fa fa-pen-nib"></i></a></h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2022-08-05 23:40:24 +0800 CST" itemprop="dateCreated datePublished" datetime="2022-08-05 23:40:24 +0800 CST">2022-08-05
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/databases itemprop=url rel=index><span itemprop=name>Databases</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="far fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>5564</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="far fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>12分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="far fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=busuanzi_value_page_pv data-path=/systems/linux/databases/configure-mysql/><i class="fa fa-sync fa-spin"></i>
</span></span><span class=post-meta-item title><span class=post-meta-item-icon><i class="far fa-comments"></i>
</span><span class=post-meta-item-text title=评论>评论：
</span><span id=comments-count class=waline-comment-count data-path=/systems/linux/databases/configure-mysql/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><ul><li>1 <font color=red>数据库连接工具</font></li></ul><div class="note info"><blockquote><table><thead><tr><th>名称地址</th><th>描述</th></tr></thead><tbody><tr><td><a href=https://downloads.mysql.com/archives/workbench/ title="<code>WorkBenCh</code>" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>WorkBenCh</code>
<i class="fa fa-external-link-alt"></i></a></td><td></td></tr><tr><td><a href=https://downloads.mysql.com/archives/community/ title="<code>MySQL</code>产品档案" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>MySQL</code>产品档案
<i class="fa fa-external-link-alt"></i></a></td><td></td></tr><tr><td><a href=https://mirrors.cloud.tencent.com/mysql/downloads/MySQL-8.0/ title="下载<code>MySQL-8.0</code>的索引" rel="noopener external nofollow noreferrer" target=_blank class=exturl>下载<code>MySQL-8.0</code>的索引
<i class="fa fa-external-link-alt"></i></a></td><td></td></tr><tr><td><a href=http://www.notedeep.com/page/282 title="<code>Mysql</code>深入学习笔记" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>Mysql</code>深入学习笔记
<i class="fa fa-external-link-alt"></i></a></td><td></td></tr><tr><td><a href=https://sqlyog.softonic.cn/ title="<code>SQLyog</code>数据库客户端连接工具" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>SQLyog</code>数据库客户端连接工具
<i class="fa fa-external-link-alt"></i></a></td><td></td></tr><tr><td><a href=https://dbeaver.io/download/ title="<code>DBeaver</code>数据库客户端连接工具" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>DBeaver</code>数据库客户端连接工具
<i class="fa fa-external-link-alt"></i></a></td><td></td></tr><tr><td><a href=https://github.com/pifeifei/mysql-workbench-zh-cn title="<code>Mysql WorkBenCh</code>菜单中文汉化" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>Mysql WorkBenCh</code>菜单中文汉化
<i class="fa fa-external-link-alt"></i></a></td><td></td></tr><tr><td><a href=https://www.jianshu.com/p/4113cd5ef139 title="<code>Navicat Premium 15</code>安装与激活" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>Navicat Premium 15</code>安装与激活
<i class="fa fa-external-link-alt"></i></a></td><td></td></tr><tr><td><a href=https://learnku.com/articles/67706 title="<code>Navicat Premium 16</code>下载与安装破解教程" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>Navicat Premium 16</code>下载与安装破解教程
<i class="fa fa-external-link-alt"></i></a></td><td></td></tr><tr><td><a href=https://dev.mysql.com/doc/refman/8.0/en/binary-installation.html title="使用通用二进制文件在<code>Unix/Linux </code>安装<code>MySQL</code>" rel="noopener external nofollow noreferrer" target=_blank class=exturl>使用通用二进制文件在<code>Unix/Linux </code>安装<code>MySQL</code>
<i class="fa fa-external-link-alt"></i></a></td><td></td></tr><tr><td><a href=https://www.jianshu.com/p/523c132006aa title="<code>Navicat Premium 15</code>永久破解激活工具及安装教程" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>Navicat Premium 15</code>永久破解激活工具及安装教程
<i class="fa fa-external-link-alt"></i></a></td><td></td></tr><tr><td></td><td></td></tr></tbody></table></blockquote><ul><li><ol start=2><li><font color=red>数据结构可视化</font></li></ol></li></ul><blockquote><ul><li>2.1
<a href=https://www.cs.usfca.edu/~galles/visualization/ title=数据结构可视化 rel="noopener external nofollow noreferrer" target=_blank class=exturl>数据结构可视化
<i class="fa fa-external-link-alt"></i></a></li></ul></blockquote></div><h2 id=数据库常用命令>数据库常用命令
<a class=header-anchor href=#%e6%95%b0%e6%8d%ae%e5%ba%93%e5%b8%b8%e7%94%a8%e5%91%bd%e4%bb%a4></a></h2><ul><li><ol><li><font color=red>目录</font></li></ol></li></ul><blockquote><ul><li>1.1
<a href=#%e6%9f%a5%e8%af%a2%e6%95%b0%e6%8d%ae%e5%ba%93%e8%bf%9e%e6%8e%a5%e6%95%b0%e4%bb%a5%e5%8f%8a%e6%85%a2%e8%af%ad%e5%8f%a5 title=查询数据库连接数以及慢语句>查询数据库连接数以及慢语句</a></li><li>1.2
<a href=#%e4%b8%89%e7%a7%8d%e4%bf%ae%e6%94%b9%e6%95%b0%e6%8d%ae%e5%ba%93%e5%af%86%e7%a0%81 title=三种修改数据库密码>三种修改数据库密码</a></li><li>1.3
<a href=#%e6%95%b0%e6%8d%ae%e5%ba%93%e5%a4%87%e4%bb%bd%e3%80%81%e8%bf%98%e5%8e%9f%e3%80%81%e5%af%bc%e5%87%ba%e8%a1%a8%e7%bb%93%e6%9e%84 title=数据库备份、还原、导出表结构>数据库备份、还原、导出表结构</a></li><li>1.4
<a href=#%e6%9f%a5%e7%9c%8b%e3%80%81%e5%af%bc%e5%87%ba%e3%80%81%e6%b8%85%e7%90%86%60binlog%60%e6%97%a5%e5%bf%97 title="查看、导出、清理<code>binlog</code>日志">查看、导出、清理<code>binlog</code>日志</a></li><li>1.5
<a href=#%e5%88%9b%e5%bb%ba%e3%80%81%e6%8e%88%e6%9d%83%e3%80%81%e5%88%a0%e9%99%a4%e7%94%a8%e6%88%b7 title=创建、授权、删除用户>创建、授权、删除用户</a></li><li>1.6
<a href=#%e5%88%9b%e5%bb%ba%e5%ba%93%e3%80%81%e5%88%9b%e5%bb%ba%e8%a1%a8 title=创建库、创建表>创建库、创建表</a></li><li>1.7
<a href=#%e5%85%b6%e4%bb%96%e5%91%bd%e4%bb%a4 title=其他命令>其他命令</a></li></ul></blockquote><div class="note info"><blockquote><table><thead><tr><th>数据库命令</th><th>说明</th><th>举例</th></tr></thead><tbody><tr><td><code>select</code></td><td>从数据库中提取数据</td><td>查看用户数据：<code>select user,host from mysql.user \G;</code></td></tr><tr><td><code>update</code></td><td>更新数据库中的数据</td><td></td></tr><tr><td><code>delete</code></td><td>从数据库中删除数据</td><td></td></tr><tr><td><code>insert into</code></td><td>向数据库中插入数据</td><td>插入数据：<code>insert into tiantian.tt1 values(1,'lisi');</code></td></tr><tr><td><code>create database</code></td><td>创建新数据库</td><td>创建数据库：<code>create database tiantian;</code></td></tr><tr><td><code>alter database</code></td><td>更改数据库</td><td></td></tr><tr><td><code>create table</code></td><td>创建表</td><td>创建数据表：<code>create table tiantian.tt1(id int, name varchar(50));</code></td></tr><tr><td><code>alter table</code></td><td>更改表</td><td></td></tr><tr><td><code>drop table</code></td><td>删除表</td><td></td></tr><tr><td><code>create index</code></td><td>创建索引(搜索键)</td><td></td></tr><tr><td><code>drop index</code></td><td>删除索引</td><td></td></tr></tbody></table><table><thead><tr><th><code>Where</code>语句中的运算符</th><th>说明</th><th>举例</th></tr></thead><tbody><tr><td><code>=</code></td><td>等于</td><td></td></tr><tr><td><code>&lt;></code></td><td>不等于：在<code>SQL</code>的一些版本中，改操作符被写成<code>!=</code></td><td></td></tr><tr><td><code>></code></td><td>大于</td><td></td></tr><tr><td><code>&lt;</code></td><td>小于</td><td></td></tr><tr><td><code>>=</code></td><td>大于等于</td><td></td></tr><tr><td><code>&lt;=</code></td><td>小于等于</td><td></td></tr><tr><td><code>BETWEEN</code></td><td>在某个范围内</td><td></td></tr><tr><td><code>LIKE</code></td><td>搜索某种模式</td><td></td></tr><tr><td><code>IN</code></td><td>指定针对某个列的多个可能值</td><td></td></tr></tbody></table></blockquote></div><h3 id=查询数据库连接数以及慢语句>查询数据库连接数以及慢语句
<a class=header-anchor href=#%e6%9f%a5%e8%af%a2%e6%95%b0%e6%8d%ae%e5%ba%93%e8%bf%9e%e6%8e%a5%e6%95%b0%e4%bb%a5%e5%8f%8a%e6%85%a2%e8%af%ad%e5%8f%a5></a></h3><div class="note info"><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>show</span> status <span style=color:#66d9ef>like</span>  <span style=color:#e6db74>&#39;Threads%&#39;</span>;  	<span style=color:#75715e># Threads_cached：线程缓存中的线程数，\
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>										<span style=color:#75715e># Threads_connected：当前打开的连接数，\
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>										<span style=color:#75715e># Threads_created：为处理连接而创建的线程数。如果Threads_created很大，您可能需要增加thread_cache_size的值。缓存失误率可以通过Threads_created/Connections计算
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e># 显示用户正在运行的线程
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>show</span> full processlist;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看最大链接数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>show</span> variables <span style=color:#66d9ef>like</span> <span style=color:#e6db74>&#39;%max_connections%&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 临时增加连接数，配置文件增加参数：max_connections=4000
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>set</span> GLOBAL max_connections<span style=color:#f92672>=</span><span style=color:#ae81ff>4000</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看连接的用户和IP以及超时时间，或者使用：count(*) 统计总统连接数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> information_schema.processlist;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查询占用超时慢语句
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> information_schema.processlist <span style=color:#66d9ef>where</span> Command <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;Sleep&#39;</span> <span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> <span style=color:#66d9ef>Time</span> <span style=color:#66d9ef>desc</span> <span style=color:#960050;background-color:#1e0010>\</span>G;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看连接的用户和每个IP的连接总数地址
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>SELECT</span> <span style=color:#a6e22e>substring_index</span>(host, <span style=color:#e6db74>&#39;:&#39;</span>,<span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>AS</span> host_ip,<span style=color:#f92672>`</span><span style=color:#66d9ef>user</span><span style=color:#f92672>`</span>,db,state,<span style=color:#a6e22e>count</span>(<span style=color:#f92672>*</span>) <span style=color:#66d9ef>FROM</span> information_schema.processlist <span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> state,host_ip,<span style=color:#f92672>`</span><span style=color:#66d9ef>user</span><span style=color:#f92672>`</span>,db;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查询所有库容量大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>SELECT</span> 
</span></span><span style=display:flex><span>table_schema <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;数据库&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#a6e22e>sum</span>(table_rows) <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;记录数&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#a6e22e>sum</span>(<span style=color:#a6e22e>truncate</span>(data_length<span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span>, <span style=color:#ae81ff>2</span>)) <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;数据容量(MB)&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#a6e22e>sum</span>(<span style=color:#a6e22e>truncate</span>(index_length<span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span>, <span style=color:#ae81ff>2</span>)) <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;索引容量(MB)&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#a6e22e>sum</span>(<span style=color:#a6e22e>truncate</span>(DATA_FREE<span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span>, <span style=color:#ae81ff>2</span>)) <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;碎片占用(MB)&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> information_schema.<span style=color:#66d9ef>tables</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> table_schema
</span></span><span style=display:flex><span><span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> <span style=color:#a6e22e>sum</span>(data_length) <span style=color:#66d9ef>desc</span>, <span style=color:#a6e22e>sum</span>(index_length) <span style=color:#66d9ef>desc</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看 MySQL「指定库」的容量大小：database_name 更改为要查询的库
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>SELECT</span> 
</span></span><span style=display:flex><span>table_schema <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;数据库&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#a6e22e>sum</span>(table_rows) <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;记录数&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#a6e22e>sum</span>(<span style=color:#a6e22e>truncate</span>(data_length<span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span>, <span style=color:#ae81ff>2</span>)) <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;数据容量(MB)&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#a6e22e>sum</span>(<span style=color:#a6e22e>truncate</span>(index_length<span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span>, <span style=color:#ae81ff>2</span>)) <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;索引容量(MB)&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#a6e22e>sum</span>(<span style=color:#a6e22e>truncate</span>(DATA_FREE<span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span>, <span style=color:#ae81ff>2</span>)) <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;碎片占用(MB)&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> information_schema.<span style=color:#66d9ef>tables</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>where</span> table_schema<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;database_name&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> data_length <span style=color:#66d9ef>desc</span>, index_length <span style=color:#66d9ef>desc</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看 MySQL「指定库」中「所有表」的容量大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>table_schema <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;数据库&#39;</span>,
</span></span><span style=display:flex><span>table_name <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;表名&#39;</span>,
</span></span><span style=display:flex><span>table_rows <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;记录数&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#a6e22e>truncate</span>(data_length<span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span>, <span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;数据容量(MB)&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#a6e22e>truncate</span>(index_length<span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span>, <span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;索引容量(MB)&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#a6e22e>truncate</span>(DATA_FREE<span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span>, <span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;碎片占用(MB)&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> information_schema.<span style=color:#66d9ef>tables</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>where</span> table_schema<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;database_name&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> data_length <span style=color:#66d9ef>desc</span>, index_length <span style=color:#66d9ef>desc</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看 MySQL「指定库」中「指定表」的容量大小：将代码中 database_name 数据库名改为你要查询的数据库名，tables_name 改为你要查询的表名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>table_schema <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;数据库&#39;</span>,
</span></span><span style=display:flex><span>table_name <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;表名&#39;</span>,
</span></span><span style=display:flex><span>table_rows <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;记录数&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#a6e22e>truncate</span>(data_length<span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span>, <span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;数据容量(MB)&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#a6e22e>truncate</span>(index_length<span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span>, <span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;索引容量(MB)&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#a6e22e>truncate</span>(DATA_FREE<span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1024</span>, <span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>as</span> <span style=color:#e6db74>&#39;碎片占用(MB)&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> information_schema.<span style=color:#66d9ef>tables</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>where</span> table_schema<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;database_name&#39;</span><span style=color:#66d9ef>and</span> table_name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;tables_name&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> data_length <span style=color:#66d9ef>desc</span>, index_length <span style=color:#66d9ef>desc</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查询并且进行AES解码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#a6e22e>aes_decrypt</span>(<span style=color:#a6e22e>from_base64</span>(mobile),<span style=color:#e6db74>&#39;key&#39;</span>,<span style=color:#e6db74>&#39;加密掩码&#39;</span>) <span style=color:#66d9ef>from</span> yl_users <span style=color:#66d9ef>where</span> member <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span></code></pre></div></blockquote><ul><li><ol start=2><li><font color=red>排查</font><code>Mysql</code><font color=red>占用内存原因</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 查看MySQL的Pid</span>
</span></span><span style=display:flex><span>$ ps -ef | grep -i mysqld
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看MySQL实时操作系统线程Pid</span>
</span></span><span style=display:flex><span>$ top -p <span style=color:#e6db74>&#34;Mysql Pid&#34;</span> -H
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 数据库中查看Pid 具体操作内容</span>
</span></span><span style=display:flex><span>Mysql&gt; SELECT THREAD_ID,name ,PROCESSLIST_ID FROM <span style=color:#e6db74>`</span>performance_schema<span style=color:#e6db74>`</span>.threads WHERE THREAD_OS_ID <span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Mysql Pid&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 根据获取到MySQL中的 Thread_id 获取SQL</span>
</span></span><span style=display:flex><span>mysql&gt; SELECT SQL_TEXT FROM <span style=color:#e6db74>`</span>performance_schema<span style=color:#e6db74>`</span>.events_statements_current WHERE THREAD_ID <span style=color:#f92672>=</span> Thread_id;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>###########################</span>
</span></span><span style=display:flex><span>mysql&gt; SELECT VARIABLE_NAME,VARIABLE_VALUE, CONCAT<span style=color:#f92672>(</span>VARIABLE_VALUE/1024/1024,<span style=color:#e6db74>&#39; MB&#39;</span><span style=color:#f92672>)</span> AS VARIABLE_VALUE_MB FROM information_schema.SESSION_VARIABLES WHERE VARIABLE_NAME IN <span style=color:#f92672>(</span><span style=color:#e6db74>&#39;innodb_buffer_pool_size&#39;</span>,<span style=color:#e6db74>&#39;innodb_log_buffer_size&#39;</span>,<span style=color:#e6db74>&#39;innodb_additional_mem_pool_size&#39;</span>,<span style=color:#e6db74>&#39;key_buffer_size&#39;</span>,<span style=color:#e6db74>&#39;query_cache_size&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql&gt; SHOW VARIABLES LIKE <span style=color:#e6db74>&#39;%show_compatibility_56%&#39;</span>;
</span></span><span style=display:flex><span>mysql&gt; SET GLOBAL show_compatibility_56<span style=color:#f92672>=</span>on;
</span></span></code></pre></div></blockquote></div><h3 id=三种修改数据库密码>三种修改数据库密码
<a class=header-anchor href=#%e4%b8%89%e7%a7%8d%e4%bf%ae%e6%94%b9%e6%95%b0%e6%8d%ae%e5%ba%93%e5%af%86%e7%a0%81></a></h3><div class="note info"><ul><li><ol><li><font color=red>第一种修改方式，<code>8.0</code>用此方法</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>user</span> <span style=color:#e6db74>&#39;root&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span> <span style=color:#66d9ef>identified</span> <span style=color:#66d9ef>by</span> <span style=color:#e6db74>&#39;123&#39;</span>;
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>user</span> <span style=color:#e6db74>&#39;root&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span> <span style=color:#66d9ef>identified</span> <span style=color:#66d9ef>with</span> mysql_native_password <span style=color:#66d9ef>by</span> <span style=color:#e6db74>&#39;newpassword&#39;</span>;
</span></span></code></pre></div></blockquote><ul><li><ol start=2><li><font color=red>第二种修改方式</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>set</span> password <span style=color:#66d9ef>for</span> <span style=color:#e6db74>&#39;root&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span><span style=color:#f92672>=</span><span style=color:#a6e22e>password</span>(<span style=color:#e6db74>&#39;newpassword&#39;</span>);
</span></span></code></pre></div></blockquote><ul><li><ol start=3><li><font color=red>第三种修改方式</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>update</span> mysql.<span style=color:#66d9ef>user</span> <span style=color:#66d9ef>set</span> authentication_string<span style=color:#f92672>=</span><span style=color:#a6e22e>password</span>(<span style=color:#e6db74>&#39;123qwe&#39;</span>) <span style=color:#66d9ef>where</span> <span style=color:#66d9ef>user</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;root&#39;</span> <span style=color:#66d9ef>and</span> Host <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;localhost&#39;</span>; 
</span></span></code></pre></div></blockquote><ul><li><ol start=4><li><font color=red>更改密码为</font><code>123456</code></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>update</span> destoon_member <span style=color:#66d9ef>set</span> password<span style=color:#f92672>=</span><span style=color:#960050;background-color:#1e0010>’</span><span style=color:#ae81ff>14</span>e1b600b1fd579f47433b88e8d85291<span style=color:#960050;background-color:#1e0010>′</span> <span style=color:#66d9ef>where</span>
</span></span><span style=display:flex><span>username<span style=color:#f92672>=</span><span style=color:#960050;background-color:#1e0010>’</span>admin<span style=color:#960050;background-color:#1e0010>’</span>;
</span></span></code></pre></div></blockquote><ul><li><ol start=5><li><font color=red>忘记数据库密码</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ cat &gt;/etc/my.cnf<span style=color:#e6db74>&lt;&lt;-EOF
</span></span></span><span style=display:flex><span><span style=color:#e6db74>[mysqld]  	# 在配置文件中最上面添加
</span></span></span><span style=display:flex><span><span style=color:#e6db74>skip-grant-tables
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 重启mysql服务  直接使用 mysql -uroot -p 不输入密码直接回车进入 修改密码</span>
</span></span><span style=display:flex><span>mysql&gt; update user set authentication_string<span style=color:#f92672>=</span>password<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;root&#39;</span><span style=color:#f92672>)</span>;
</span></span></code></pre></div></blockquote></div><h3 id=导出数据库表结构>导出数据库表结构
<a class=header-anchor href=#%e5%af%bc%e5%87%ba%e6%95%b0%e6%8d%ae%e5%ba%93%e8%a1%a8%e7%bb%93%e6%9e%84></a></h3><div class="note info"><ul><li><ol><li><font color=red>导出表结构加</font><code>-d</code><font color=red>参数</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ /bin/mysqldump -d -uroot -p<span style=color:#e6db74>&#39;passowrd&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>-S /opt/data/data_16303/mysql.sock database &gt; database.sql  
</span></span></code></pre></div></blockquote></div><h3 id=查看导出清理binlog日志>查看、导出、清理<code>binlog</code>日志
<a class=header-anchor href=#%e6%9f%a5%e7%9c%8b%e5%af%bc%e5%87%ba%e6%b8%85%e7%90%86binlog%e6%97%a5%e5%bf%97></a></h3><div class="note info"><ul><li><ol><li><font color=red>查看</font><code>binlog</code></font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e># 指定查询 mysql-bin.000002这个文件，从pos点:624开始查起，偏移2行（即中间跳过2个），查询10条
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>show</span> binlog events <span style=color:#66d9ef>in</span> <span style=color:#e6db74>&#39;mysql-bin.000002&#39;</span> <span style=color:#66d9ef>from</span> <span style=color:#ae81ff>624</span> <span style=color:#66d9ef>limit</span> <span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>10</span><span style=color:#960050;background-color:#1e0010>\</span>G;
</span></span></code></pre></div></blockquote><ul><li><ol start=2><li><font color=red>导出数据库</font><code>binlog</code><font color=red>日志</font></li></ol></li></ul><blockquote><ul><li><code>--base64-output=</code>：<code>decode-rows</code><font color=red>将行事件解码为注释伪<code>SQL</code>语句</font></li><li><code>--no-defaults</code></li><li><code>--database="数据库名"</code>：<font color=red>仅列出此数据库的条目(仅限本地日志)</font></li><li><code>--start-datetime=''</code>：<font color=red><mark>开始时间</mark>参数必须是本地时区的日期和时间，格式不限<code>MySQL</code>服务器接受<code>DATETIME</code>和<code>TIMESTAMP</code>类型，例如：</font><code>2004-12-25 11:25:56</code></li><li><code>--stop-datetime=''</code>：<font color=red><mark>结束时间</mark>参数必须是本地时区的日期和时间，格式不限<code>MySQL</code>服务器接受<code>DATETIME</code>和<code>TIMESTAMP</code>类型，例如：</font><code>2004-12-25 11:25:56</code></li><li><code>--start-position=875</code>：<font color=red>偏移量开始读取位置</font></li><li><code>--stop-position=954</code>：<mark>偏移量停止读取位置</mark></li><li><code>-v</code>：<font color=red>从行事件中重建伪<code>SQL</code>语句，<code>-vv</code>添加对列数据类型的注释</font></li><li><code>-r</code>：<font color=red>直接输出到给定的文件</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ /bin/mysqlbinlog <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--base64-output<span style=color:#f92672>=</span>decode-rows <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--no-defaults --database<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;数据库名&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--start-datetime<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;2019-04-11 00:00:00&#39;</span> <span style=color:#ae81ff>\ </span> 	<span style=color:#75715e># 开始时间</span>
</span></span><span style=display:flex><span>--stop-datetime<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;2019-04-11 15:00:00&#39;</span> <span style=color:#ae81ff>\ </span> 	<span style=color:#75715e># 结束时间</span>
</span></span><span style=display:flex><span>-v /opt/data/mysql/mysql-bin.000007 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>-r /opt/binlog<span style=color:#e6db74>`</span>date <span style=color:#e6db74>&#39;+%F&#39;</span><span style=color:#e6db74>`</span>.sql
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 方法二</span>
</span></span><span style=display:flex><span>$ /bin/mysqlbinlog <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--no-defaults --database<span style=color:#f92672>=</span>db <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--start-datetime<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;2019-04-11 00:00:00&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--stop-datetime<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;2019-04-11 15:00:00&#39;</span> mysql-bin.000007 | more
</span></span><span style=display:flex><span>mysqlbinlog <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--base64-output<span style=color:#f92672>=</span>decode-rows <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--start-position<span style=color:#f92672>=</span><span style=color:#ae81ff>2966</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--stop-position<span style=color:#f92672>=</span><span style=color:#ae81ff>2966</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>-v mysql-bin.000125
</span></span></code></pre></div><ul><li>2.1 <font color=red>从<code>binlog</code>日志中得<code>DELETE</code>删除换成<code>INSERT INTO</code>插入语句</font></li></ul><blockquote><p><a href=https://www.jianshu.com/p/aecc8ba3a5e4 title="<code>mysql</code>不小心删除数据解决方案" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>mysql</code>不小心删除数据解决方案
<i class="fa fa-external-link-alt"></i></a></p><p><a href=https://www.cnblogs.com/yhq1314/p/13970044.html title="<code>mysql binlg delete</code>语句解析为<code>insert</code>语句" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>mysql binlg delete</code>语句解析为<code>insert</code>语句
<i class="fa fa-external-link-alt"></i></a></p><p><a href=https://blog.csdn.net/enhengaha/article/details/123022104 title="<code>mysql</code>回滚操作<code>delete</code>操作误删数据库记录后根据<code>binlog</code>恢复数据" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>mysql</code>回滚操作<code>delete</code>操作误删数据库记录后根据<code>binlog</code>恢复数据
<i class="fa fa-external-link-alt"></i></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 过滤非删除语句</span>
</span></span><span style=display:flex><span>$ sed -n <span style=color:#e6db74>&#39;/^###/&#39;</span>p /opt/binlog<span style=color:#e6db74>`</span>date <span style=color:#e6db74>&#39;+%F&#39;</span><span style=color:#e6db74>`</span>.sql  &gt;/opt/binlog<span style=color:#e6db74>`</span>date <span style=color:#e6db74>&#39;+%F&#39;</span><span style=color:#e6db74>`</span>.sql
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 去掉#号</span>
</span></span><span style=display:flex><span>$ sed <span style=color:#e6db74>&#39;s/### //g&#39;</span> /opt/binlog<span style=color:#e6db74>`</span>date <span style=color:#e6db74>&#39;+%F&#39;</span><span style=color:#e6db74>`</span>.sql &gt;/opt/binlog<span style=color:#e6db74>`</span>date <span style=color:#e6db74>&#39;+%F&#39;</span><span style=color:#e6db74>`</span>.sql
</span></span><span style=display:flex><span>$ sed <span style=color:#e6db74>&#39;s#/\*.*\*/#,#g&#39;</span> c.txt &gt;d.txt
</span></span><span style=display:flex><span><span style=color:#75715e># 如果有富文本里面含注释语句容易出错可以更精细匹配</span>
</span></span><span style=display:flex><span>$ sed <span style=color:#e6db74>&#39;s#/\*.*\*/###   @#,#g&#39;</span> c.txt &gt;d.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cat /opt/binlog<span style=color:#e6db74>`</span>date <span style=color:#e6db74>&#39;+%F&#39;</span><span style=color:#e6db74>`</span>.sql
</span></span></code></pre></div></blockquote></blockquote><ul><li><ol start=3><li><font color=red>清理<code>binlog</code></font></li></ol></li></ul><blockquote><ul><li>3.1
<a href=https://www.cnblogs.com/xxoome/p/9802684.html title="<code>mysql binlog</code>日志自动清理及手动删除" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>mysql binlog</code>日志自动清理及手动删除
<i class="fa fa-external-link-alt"></i>
</a>、
<a href=https://developer.aliyun.com/article/712256 title="<code>Mysql</code>清理<code>binlog</code>" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>Mysql</code>清理<code>binlog</code>
<i class="fa fa-external-link-alt"></i></a></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e># 清除MySQL-bin.010日志
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>PURGE</span> MASTER LOGS <span style=color:#66d9ef>TO</span> <span style=color:#e6db74>&#39;MySQL-bin.010&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 清除2008-06-22 13:00:00前binlog日志
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>PURGE</span> MASTER LOGS <span style=color:#66d9ef>BEFORE</span> <span style=color:#e6db74>&#39;2008-06-22 13:00:00&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 清除3天前binlog日志BEFORE，变量的date自变量可以为&#39;YYYY-MM-DD hh:mm:ss&#39;格式。 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>PURGE</span> MASTER LOGS <span style=color:#66d9ef>BEFORE</span> <span style=color:#a6e22e>DATE_SUB</span>( <span style=color:#a6e22e>NOW</span>( ), <span style=color:#66d9ef>INTERVAL</span> <span style=color:#ae81ff>3</span> DAY);
</span></span></code></pre></div></blockquote></div><h3 id=创建授权删除用户>创建、授权、删除用户
<a class=header-anchor href=#%e5%88%9b%e5%bb%ba%e6%8e%88%e6%9d%83%e5%88%a0%e9%99%a4%e7%94%a8%e6%88%b7></a></h3><div class="note info"><ul><li><ol><li><font color=red>创建、授权</font></li></ol></li></ul><blockquote><ul><li>1.1 <font color=red><code>5.7.*</code>一下创建以及授权</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>grant</span> <span style=color:#66d9ef>all</span> <span style=color:#66d9ef>on</span> <span style=color:#f92672>*</span>.<span style=color:#f92672>*</span> <span style=color:#66d9ef>to</span> root<span style=color:#f92672>@</span><span style=color:#e6db74>&#39;10.14.23.%&#39;</span> <span style=color:#66d9ef>identified</span> <span style=color:#66d9ef>by</span> <span style=color:#e6db74>&#39;123456&#39;</span>;
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>grant</span> <span style=color:#66d9ef>all</span> <span style=color:#66d9ef>privileges</span> <span style=color:#66d9ef>on</span> <span style=color:#66d9ef>database</span>.<span style=color:#66d9ef>tables</span> <span style=color:#66d9ef>to</span> <span style=color:#e6db74>&#39;user&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span> <span style=color:#66d9ef>identified</span> <span style=color:#66d9ef>by</span> <span style=color:#e6db74>&#34;password&#34;</span>;
</span></span></code></pre></div><ul><li>1.2 <code>Myslq 8.0</code><font color=red>语句执行，<code>8.0</code>版本之后创建用户和授权分开了</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e># 创建用户
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>USER</span> <span style=color:#e6db74>&#39;username&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;127.0.0.1&#39;</span> <span style=color:#66d9ef>IDENTIFIED</span> <span style=color:#66d9ef>BY</span> <span style=color:#e6db74>&#39;passowrd&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#75715e># 授予权限
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>GRANT</span> <span style=color:#66d9ef>ALL</span> <span style=color:#66d9ef>ON</span> <span style=color:#f92672>*</span>.<span style=color:#f92672>*</span> <span style=color:#66d9ef>TO</span> <span style=color:#e6db74>&#39;username&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;127.0.0.1&#39;</span> <span style=color:#66d9ef>WITH</span> <span style=color:#66d9ef>GRANT</span> <span style=color:#66d9ef>OPTION</span>;
</span></span><span style=display:flex><span><span style=color:#75715e># 删除权限
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>REVOKE</span> <span style=color:#66d9ef>all</span> <span style=color:#66d9ef>privileges</span> <span style=color:#66d9ef>ON</span> databasename.tablename <span style=color:#66d9ef>FROM</span> <span style=color:#e6db74>&#39;username&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;host&#39;</span>; 
</span></span></code></pre></div></blockquote><ul><li><ol start=2><li><font color=red>创建从库用户并授复制权限</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>MySQL<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>grant</span> replication slave, replication client <span style=color:#66d9ef>on</span> <span style=color:#f92672>*</span>.<span style=color:#f92672>*</span> <span style=color:#66d9ef>to</span> <span style=color:#e6db74>&#39;lisi&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;10.14.23.%&#39;</span> <span style=color:#66d9ef>identified</span> <span style=color:#66d9ef>by</span> <span style=color:#e6db74>&#39;123456&#39;</span>;
</span></span></code></pre></div></blockquote><ul><li><ol start=3><li><font color=red>撤销用户权限</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>REVOKE</span> privilege <span style=color:#66d9ef>ON</span> databasename.tablename <span style=color:#66d9ef>FROM</span> <span style=color:#e6db74>&#39;username&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;host&#39;</span>;  
</span></span></code></pre></div></blockquote><ul><li><ol start=4><li><font color=red>删除用户、数据</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>drop</span> <span style=color:#66d9ef>user</span> <span style=color:#e6db74>&#39;username&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;host&#39;</span>;  	<span style=color:#75715e># 如果是当前登陆用户用SET PASSWORD = PASSWORD(&#34;newpassword&#34;); 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>delete</span> <span style=color:#66d9ef>from</span> <span style=color:#960050;background-color:#1e0010>表名</span> <span style=color:#66d9ef>where</span> <span style=color:#960050;background-color:#1e0010>列名</span><span style=color:#f92672>=</span><span style=color:#960050;background-color:#1e0010>‘</span>xx<span style=color:#960050;background-color:#1e0010>’</span> <span style=color:#66d9ef>and</span> <span style=color:#960050;background-color:#1e0010>列名</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;xx&#39;</span>;  	<span style=color:#75715e># 授权查看数据库用户（clint） 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>delete</span> <span style=color:#66d9ef>from</span> mysql.<span style=color:#66d9ef>user</span> <span style=color:#66d9ef>where</span> <span style=color:#66d9ef>user</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;slave&#34;</span> <span style=color:#66d9ef>and</span> host<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;10.14.23.%&#34;</span>;  
</span></span></code></pre></div></blockquote></div><h3 id=创建库创建表>创建库、创建表
<a class=header-anchor href=#%e5%88%9b%e5%bb%ba%e5%ba%93%e5%88%9b%e5%bb%ba%e8%a1%a8></a></h3><div class="note info"><ul><li><ol><li><font color=red>创建库</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>create</span> <span style=color:#66d9ef>database</span> db2 <span style=color:#66d9ef>character</span> <span style=color:#66d9ef>set</span> utf8 <span style=color:#66d9ef>collate</span> utf8_general_ci;
</span></span></code></pre></div></blockquote><ul><li><ol start=2><li><font color=red>创建表</font></li></ol></li></ul><blockquote><ul><li>2.1 <code>NOT NULL</code>：<font color=red>每一行都必须含有值（不能为空），<code>null</code>值是不允许的</font></li><li>2.2 <code>DEFAULT value</code>：<font color=red>设置默认值</font></li><li>2.3 <code>UNSIGNED</code>：<font color=red>使用无符号数值类型，0及正数</font></li><li>2.4 <code>AUTO INCREMENT</code>：<font color=red>设置 MySQL字段的值在新增记录时每次自动增长 1</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> databases_name.<span style=color:#a6e22e>tables_name</span>(id <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span>, name <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>50</span>)<span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>Query OK, <span style=color:#ae81ff>1</span> row <span style=color:#a6e22e>affected</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)  	<span style=color:#75715e># not null 不为空
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置数据表中每条记录的唯一标识。 通常列的 PRIMARY KEY 设置为 ID 数值，与AUTO_INCREMENT 一起使用。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> <span style=color:#f92672>`</span>databases_name<span style=color:#f92672>`</span>.<span style=color:#f92672>`</span>tables_name<span style=color:#f92672>`</span>(name) <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;lisi&#39;</span>);
</span></span><span style=display:flex><span>Query OK, <span style=color:#ae81ff>1</span> row <span style=color:#a6e22e>affected</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)  	<span style=color:#75715e># 不写id
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> <span style=color:#f92672>`</span>databases_name<span style=color:#f92672>`</span>.<span style=color:#f92672>`</span>tables_name<span style=color:#f92672>`</span>(id,content,add_time) <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>4</span>,<span style=color:#e6db74>&#39;Text&#39;</span>,<span style=color:#e6db74>&#39;2023-01-11 02:52:54&#39;</span>);
</span></span></code></pre></div></blockquote></div><h3 id=其他命令>其他命令
<a class=header-anchor href=#%e5%85%b6%e4%bb%96%e5%91%bd%e4%bb%a4></a></h3><div class="note info"><ul><li><ol><li><font color=red></font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e># MySQL-master,查看数据库偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>show</span> master status;
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> reset master;  <span style=color:#75715e># 清理reset日志
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e># 从库执行，测试连接主库
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span><span style=color:#66d9ef>show</span> grants;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> mysql_secure_installation  	<span style=color:#75715e># mysql安全配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Enter current password <span style=color:#66d9ef>for</span> <span style=color:#a6e22e>root</span> (enter <span style=color:#66d9ef>for</span> none):  	<span style=color:#75715e># 输入进入数据库密码，默认为空，按回车
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>Set</span> root password<span style=color:#f92672>?</span> [Y<span style=color:#f92672>/</span>n]  	<span style=color:#75715e># 设置mysql数据库root用户的密码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Remove anonymous users<span style=color:#f92672>?</span> [Y<span style=color:#f92672>/</span>n]  	<span style=color:#75715e># 移除匿名用户Y
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Disallow root login remotely<span style=color:#f92672>?</span> [Y<span style=color:#f92672>/</span>n]  	<span style=color:#75715e># 不允许root用户远程登陆Y
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Remove test <span style=color:#66d9ef>database</span> <span style=color:#66d9ef>and</span> access <span style=color:#66d9ef>to</span> it<span style=color:#f92672>?</span> [Y<span style=color:#f92672>/</span>n]  	<span style=color:#75715e># 移除test数据库和访问Y
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Reload privilege <span style=color:#66d9ef>tables</span> now<span style=color:#f92672>?</span> [Y<span style=color:#f92672>/</span>n]   
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 筛选数据不同值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#66d9ef>distinct</span> <span style=color:#960050;background-color:#1e0010>列名</span> <span style=color:#66d9ef>from</span> <span style=color:#960050;background-color:#1e0010>表名</span>;
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> <span style=color:#960050;background-color:#1e0010>表名</span> <span style=color:#66d9ef>where</span> <span style=color:#960050;background-color:#1e0010>列名</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>15</span> <span style=color:#66d9ef>and</span> (<span style=color:#960050;background-color:#1e0010>列名</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;选项&#39;</span> <span style=color:#66d9ef>or</span> <span style=color:#960050;background-color:#1e0010>列名</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;选项&#39;</span>);
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> <span style=color:#960050;background-color:#1e0010>表名</span> <span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> <span style=color:#960050;background-color:#1e0010>列名、列名</span> <span style=color:#66d9ef>desc</span>(<span style=color:#960050;background-color:#1e0010>降序</span>)<span style=color:#960050;background-color:#1e0010>、</span><span style=color:#66d9ef>asc</span>(<span style=color:#960050;background-color:#1e0010>升序、默认升序</span>);
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> <span style=color:#960050;background-color:#1e0010>表名</span> <span style=color:#66d9ef>limit</span> <span style=color:#ae81ff>2</span>  	<span style=color:#75715e># 查看前两条数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> <span style=color:#960050;background-color:#1e0010>表名</span> <span style=color:#66d9ef>where</span> <span style=color:#960050;background-color:#1e0010>列名</span> <span style=color:#66d9ef>like</span> <span style=color:#e6db74>&#39;首个关键字%&#39;</span>;  	<span style=color:#75715e># %匹配所有
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> <span style=color:#960050;background-color:#1e0010>表名</span> <span style=color:#66d9ef>where</span> <span style=color:#960050;background-color:#1e0010>列名</span> <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>like</span> <span style=color:#e6db74>&#39;%xx%&#39;</span>;  	<span style=color:#75715e># 反向查找
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> <span style=color:#960050;background-color:#1e0010>表名</span> <span style=color:#66d9ef>where</span> <span style=color:#960050;background-color:#1e0010>列名</span> <span style=color:#66d9ef>in</span> (<span style=color:#e6db74>&#39;关键字&#39;</span>,<span style=color:#960050;background-color:#1e0010>‘关键字’</span>)<span style=color:#960050;background-color:#1e0010>；</span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> <span style=color:#960050;background-color:#1e0010>表名</span> <span style=color:#66d9ef>where</span> <span style=color:#960050;background-color:#1e0010>列名</span> <span style=color:#66d9ef>between</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>and</span> <span style=color:#ae81ff>20</span>;  	<span style=color:#75715e># 选取1到20之间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> <span style=color:#960050;background-color:#1e0010>表名</span> <span style=color:#66d9ef>where</span> <span style=color:#960050;background-color:#1e0010>列名</span> <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>between</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>and</span> <span style=color:#ae81ff>20</span>;  	<span style=color:#75715e># 取反
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> <span style=color:#960050;background-color:#1e0010>表名</span> <span style=color:#66d9ef>where</span> (<span style=color:#960050;background-color:#1e0010>列名</span> <span style=color:#66d9ef>between</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>and</span> <span style=color:#ae81ff>20</span>) <span style=color:#66d9ef>and</span> <span style=color:#960050;background-color:#1e0010>列名</span> <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>in</span> (<span style=color:#e6db74>&#39;关键字&#39;</span>)<span style=color:#960050;background-color:#1e0010>；</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 更新、更改数据数据以及用户权限
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>update</span> <span style=color:#960050;background-color:#1e0010>表名</span> <span style=color:#66d9ef>set</span> <span style=color:#960050;background-color:#1e0010>列名</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;333&#39;</span>, <span style=color:#960050;background-color:#1e0010>列名</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;cn&#39;</span> <span style=color:#66d9ef>where</span> <span style=color:#960050;background-color:#1e0010>列名</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;xxx&#39;</span>;
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>update</span> <span style=color:#66d9ef>user</span> <span style=color:#66d9ef>set</span> host <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;%&#39;</span> <span style=color:#66d9ef>where</span> <span style=color:#66d9ef>user</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;root&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 修改数据库同步线程mysql
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>set</span> global sync_binlog<span style=color:#f92672>=</span><span style=color:#ae81ff>20</span>;
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>set</span> global innodb_flush_log_at_trx_commit<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 修改sql线程数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> STOP SLAVE SQL_THREAD;
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>SET</span> GLOBAL slave_parallel_type<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;LOGICAL_CLOCK&#39;</span>;
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>SET</span> GLOBAL slave_parallel_workers<span style=color:#f92672>=</span><span style=color:#ae81ff>8</span>;  	
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> START SLAVE SQL_THREAD;	
</span></span></code></pre></div></blockquote></div><h2 id=mysql查询锁表语句><code>MySQL</code>查询锁表语句
<a class=header-anchor href=#mysql%e6%9f%a5%e8%af%a2%e9%94%81%e8%a1%a8%e8%af%ad%e5%8f%a5></a></h2><div class="note info"><ul><li><ol><li><a href=https://www.cnblogs.com/better-farther-world2099/articles/14721482.html title="<code>MySQL</code>查询锁表语句" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>MySQL</code>查询锁表语句
<i class="fa fa-external-link-alt"></i></a></li></ol></li></ul><blockquote><ul><li>1.1 <font color=red>查询是否锁表</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>show</span> OPEN <span style=color:#66d9ef>TABLES</span> <span style=color:#66d9ef>where</span> In_use <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>;
</span></span></code></pre></div><ul><li>1.2 <font color=red>查看正在锁的事务</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> INFORMATION_SCHEMA.INNODB_LOCKS; 
</span></span></code></pre></div><ul><li>1.3 <font color=red>查看等待锁的事务</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> INFORMATION_SCHEMA.INNODB_LOCK_WAITS;
</span></span></code></pre></div><ul><li>1.4 <font color=red>查看当前的事务</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> INFORMATION_SCHEMA.INNODB_TRX;
</span></span></code></pre></div><ul><li>1.5 <font color=red>查看当前锁定的事务</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> INFORMATION_SCHEMA.INNODB_LOCKS;
</span></span></code></pre></div><ul><li>1.6 <font color=red>查看当前等锁的事务</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> INFORMATION_SCHEMA.INNODB_LOCK_WAITS;
</span></span></code></pre></div><ul><li>1.7 <font color=red>查询死锁详情</font></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>SELECT</span> r.trx_id waiting_trx_id,r.trx_mysql_thread_id waiting_thread,
</span></span><span style=display:flex><span><span style=color:#a6e22e>TIMESTAMPADD</span>(SECOND,r.trx_wait_started,<span style=color:#66d9ef>CURRENT_TIMESTAMP</span>) wait_time,
</span></span><span style=display:flex><span>r.trx_query waiting_query,
</span></span><span style=display:flex><span>l.lock_table waiting_table_lock,
</span></span><span style=display:flex><span>b.trx_id blocking_trx_id,b.trx_mysql_thread_id blocking_thread,
</span></span><span style=display:flex><span><span style=color:#a6e22e>SUBSTRING</span>(p.<span style=color:#f92672>`</span>HOST<span style=color:#f92672>`</span>,<span style=color:#ae81ff>1</span>,<span style=color:#a6e22e>INSTR</span>(p.<span style=color:#f92672>`</span>HOST<span style=color:#f92672>`</span>,<span style=color:#e6db74>&#39;:&#39;</span>)<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) blocking_host,
</span></span><span style=display:flex><span><span style=color:#a6e22e>SUBSTRING</span>(p.<span style=color:#f92672>`</span>HOST<span style=color:#f92672>`</span>,<span style=color:#a6e22e>INSTR</span>(p.<span style=color:#f92672>`</span>HOST<span style=color:#f92672>`</span>,<span style=color:#e6db74>&#39;:&#39;</span>)<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>) blocking_port,
</span></span><span style=display:flex><span><span style=color:#66d9ef>IF</span>(p.COMMAND <span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Sleep&#39;</span>,p.<span style=color:#66d9ef>TIME</span>,<span style=color:#ae81ff>0</span>) idle_in_trx,
</span></span><span style=display:flex><span>b.trx_query blocking_query
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> information_schema.INNODB_LOCK_WAITS w
</span></span><span style=display:flex><span><span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> information_schema.INNODB_TRX b <span style=color:#66d9ef>ON</span> b.trx_id <span style=color:#f92672>=</span> w.blocking_lock_id
</span></span><span style=display:flex><span><span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> information_schema.INNODB_TRX r <span style=color:#66d9ef>ON</span> r.trx_id <span style=color:#f92672>=</span> w.requesting_trx_id
</span></span><span style=display:flex><span><span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> information_schema.INNODB_LOCKS l <span style=color:#66d9ef>ON</span> l.lock_id <span style=color:#f92672>=</span> w.requested_lock_id
</span></span><span style=display:flex><span><span style=color:#66d9ef>LEFT</span> <span style=color:#66d9ef>JOIN</span> information_schema.<span style=color:#f92672>`</span>PROCESSLIST<span style=color:#f92672>`</span> p <span style=color:#66d9ef>ON</span> p.id <span style=color:#f92672>=</span> b.trx_mysql_thread_id
</span></span><span style=display:flex><span><span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> wait_time <span style=color:#66d9ef>desc</span>;
</span></span></code></pre></div></blockquote></div><h2 id=配置数据库主从复制>配置数据库主从复制
<a class=header-anchor href=#%e9%85%8d%e7%bd%ae%e6%95%b0%e6%8d%ae%e5%ba%93%e4%b8%bb%e4%bb%8e%e5%a4%8d%e5%88%b6></a></h2><div class="note info"><ul><li><ol><li><font color=red>主数据库配置以及授权</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 修改ID</span>
</span></span><span style=display:flex><span>$ server_id<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>hostname -I |awk <span style=color:#e6db74>&#34;{print </span>$1<span style=color:#e6db74>}&#34;</span>|awk -F<span style=color:#e6db74>&#34;.&#34;</span> <span style=color:#e6db74>&#34;{print </span>$4<span style=color:#e6db74>}&#34;</span><span style=color:#e6db74>`</span>  
</span></span><span style=display:flex><span>$ sed -i <span style=color:#e6db74>&#34;s/server-id = 16303110/server-id = 16303</span>$server_id<span style=color:#e6db74>/g&#34;</span> /etc/my.cnf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 授权从库连接账户密码</span>
</span></span><span style=display:flex><span>mysql&gt; grant replication slave on *.* to myuser@<span style=color:#e6db74>&#39;host IP&#39;</span> identified by <span style=color:#e6db74>&#39;password&#39;</span>;
</span></span><span style=display:flex><span>mysql&gt; flush privileges;
</span></span><span style=display:flex><span>mysql&gt; reset master; <span style=color:#e6db74>&#34;
</span></span></span></code></pre></div></blockquote><ul><li><ol start=2><li><font color=red>配置从库连接主库</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 修改ID</span>
</span></span><span style=display:flex><span>$ server_id<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>hostname -I |awk <span style=color:#e6db74>&#39;{print $1}&#39;</span>|awk -F<span style=color:#e6db74>&#39;.&#39;</span> <span style=color:#e6db74>&#39;{print $4}&#39;</span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>$ sed -i <span style=color:#e6db74>&#34;s/server-id = 16303110/server-id = 16303</span>$server_id<span style=color:#e6db74>/g&#34;</span> /etc/my.cnf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 配置连接主库</span>
</span></span><span style=display:flex><span>$ /usr/local/mysql/bin/mysql -uroot -p -S /tmp/mysql.sock <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> -e <span style=color:#e6db74>&#34;CHANGE MASTER TO MASTER_HOST=&#39;127.0.0.1&#39;, \
</span></span></span><span style=display:flex><span><span style=color:#e6db74> MASTER_USER=&#39;myuser&#39;, \
</span></span></span><span style=display:flex><span><span style=color:#e6db74> MASTER_PASSWORD=&#39;password&#39;, \
</span></span></span><span style=display:flex><span><span style=color:#e6db74> MASTER_PORT=16303, \
</span></span></span><span style=display:flex><span><span style=color:#e6db74> MASTER_LOG_FILE=&#39;mysql-bin.000001&#39;, \  	# 主机show master status;中的File
</span></span></span><span style=display:flex><span><span style=color:#e6db74> MASTER_LOG_POS=154,MASTER_CONNECT_RETRY=15;&#34;</span>  	<span style=color:#75715e># 主机show master status;中的Position.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ /usr/local/mysql/bin/mysql -uroot -p -S /tmp/mysql.sock -e <span style=color:#e6db74>&#34;start slave;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ /usr/local/mysql/bin/mysql -uroot -p -S /tmp/mysql.sock -e <span style=color:#e6db74>&#34;show slave status\G&#34;</span>
</span></span></code></pre></div><ul><li>2.1 <font color=red>配置多源复制</font></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ /usr/local/mysql/bin/mysql -uroot -p -S /tmp/mysql.sock <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> -e <span style=color:#e6db74>&#34;CHANGE MASTER TO MASTER_HOST=&#39;127.0.0.1&#39;, \
</span></span></span><span style=display:flex><span><span style=color:#e6db74> MASTER_USER=&#39;myuser&#39;, \
</span></span></span><span style=display:flex><span><span style=color:#e6db74> MASTER_PASSWORD=&#39;password&#39;, \
</span></span></span><span style=display:flex><span><span style=color:#e6db74> MASTER_PORT=16303, \
</span></span></span><span style=display:flex><span><span style=color:#e6db74> master_auto_position=1  for  channel &#39;rep_master_1&#39;;&#34;</span>  	<span style=color:#75715e># 协商、定义频道几个主机定义几次。</span>
</span></span></code></pre></div></blockquote></blockquote></div><h2 id=数据库开启gtid流程>数据库开启<code>GTID</code>流程
<a class=header-anchor href=#%e6%95%b0%e6%8d%ae%e5%ba%93%e5%bc%80%e5%90%afgtid%e6%b5%81%e7%a8%8b></a></h2><div class="note info"><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 如果可以先暂停业务，查询是否还有业务连接</span>
</span></span><span style=display:flex><span>mysql&gt; show processlist;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 主从依次执行：主库执行好后，去从库执行 ，再执行下一个命令</span>
</span></span><span style=display:flex><span>mysql&gt; SET @@GLOBAL.ENFORCE_GTID_CONSISTENCY<span style=color:#f92672>=</span>WARN;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查询主从错误日志，看看是否有报错，在做下一步</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 主库执行好后，去从库执行 ，再执行下一个命令</span>
</span></span><span style=display:flex><span>mysql&gt; SET @@GLOBAL.ENFORCE_GTID_CONSISTENCY<span style=color:#f92672>=</span>ON;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 主库执行好后，去从库执行 ，再执行下一个命令</span>
</span></span><span style=display:flex><span>mysql&gt; SET @@GLOBAL.GTID_MODE<span style=color:#f92672>=</span>OFF_PERMISSIVE;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 主库执行好后，去从库执行 ，再执行下一个命令</span>
</span></span><span style=display:flex><span>mysql&gt; SET @@GLOBAL.GTID_MODE<span style=color:#f92672>=</span>ON_PERMISSIVE;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 从库查询：等待从库这个状态变为0</span>
</span></span><span style=display:flex><span>mysql&gt; show status like <span style=color:#e6db74>&#39;ONGOING_ANONYMOUS_TRANSACTION_COUNT&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 主从执行：</span>
</span></span><span style=display:flex><span>mysql&gt; SET @@GLOBAL.gtid_mode<span style=color:#f92672>=</span>on;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 从库执行：</span>
</span></span><span style=display:flex><span>mysql&gt; stop slave;
</span></span><span style=display:flex><span>mysql&gt; change master to master_auto_position<span style=color:#f92672>=</span>1;
</span></span><span style=display:flex><span>mysql&gt; start slave;
</span></span></code></pre></div></blockquote></div><h2 id=mysql开启日志审计><code>Mysql</code>开启日志审计
<a class=header-anchor href=#mysql%e5%bc%80%e5%90%af%e6%97%a5%e5%bf%97%e5%ae%a1%e8%ae%a1></a></h2><div class="note info"><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 连接数据库执行语句：</span>
</span></span><span style=display:flex><span>mysql&gt; CREATE TABLE <span style=color:#e6db74>`</span>mysql<span style=color:#e6db74>`</span>.<span style=color:#e6db74>`</span>audit_login<span style=color:#e6db74>`</span> <span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>`</span>ID<span style=color:#e6db74>`</span> bigint NOT NULL AUTO_INCREMENT COMMENT <span style=color:#e6db74>&#39;自增ID&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>`</span>USER<span style=color:#e6db74>`</span> varchar<span style=color:#f92672>(</span>128<span style=color:#f92672>)</span>  NOT NULL COMMENT <span style=color:#e6db74>&#39;数据库中的用户&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>`</span>HOST<span style=color:#e6db74>`</span> varchar<span style=color:#f92672>(</span>64<span style=color:#f92672>)</span>  DEFAULT NULL COMMENT <span style=color:#e6db74>&#39;登录的IP&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>`</span>DB<span style=color:#e6db74>`</span> varchar<span style=color:#f92672>(</span>64<span style=color:#f92672>)</span>  DEFAULT NULL COMMENT <span style=color:#e6db74>&#39;访问的数据库&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>`</span>PROCESSLIST_ID<span style=color:#e6db74>`</span> bigint NOT NULL COMMENT <span style=color:#e6db74>&#39;用户连接&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>`</span>LOGIN_TIME<span style=color:#e6db74>`</span> datetime<span style=color:#f92672>(</span>3<span style=color:#f92672>)</span> DEFAULT CURRENT_TIMESTAMP<span style=color:#f92672>(</span>3<span style=color:#f92672>)</span> COMMENT <span style=color:#e6db74>&#39;登录时间&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>`</span>UPDATE_TIME<span style=color:#e6db74>`</span> datetime<span style=color:#f92672>(</span>3<span style=color:#f92672>)</span> DEFAULT CURRENT_TIMESTAMP<span style=color:#f92672>(</span>3<span style=color:#f92672>)</span> ON UPDATE CURRENT_TIMESTAMP<span style=color:#f92672>(</span>3<span style=color:#f92672>)</span> COMMENT <span style=color:#e6db74>&#39;记录这行数据上次被修改的时间,默认等于LOGIN_TIME&#39;</span>,
</span></span><span style=display:flex><span>  PRIMARY KEY <span style=color:#f92672>(</span><span style=color:#e6db74>`</span>ID<span style=color:#e6db74>`</span><span style=color:#f92672>)</span>,
</span></span><span style=display:flex><span>  KEY <span style=color:#e6db74>`</span>IDX_USER<span style=color:#e6db74>`</span> <span style=color:#f92672>(</span><span style=color:#e6db74>`</span>USER<span style=color:#e6db74>`</span><span style=color:#f92672>)</span>,
</span></span><span style=display:flex><span>  KEY <span style=color:#e6db74>`</span>IDX_HOST<span style=color:#e6db74>`</span> <span style=color:#f92672>(</span><span style=color:#e6db74>`</span>HOST<span style=color:#e6db74>`</span><span style=color:#f92672>)</span>,
</span></span><span style=display:flex><span>  KEY <span style=color:#e6db74>`</span>IDX_LOGIN_TIME<span style=color:#e6db74>`</span> <span style=color:#f92672>(</span><span style=color:#e6db74>`</span>LOGIN_TIME<span style=color:#e6db74>`</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>)</span> ENGINE<span style=color:#f92672>=</span>InnoDB COMMENT <span style=color:#e6db74>&#34;用户登录审计日志表&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查询授权SQL，复制查询出来的SQL语句，执行授权</span>
</span></span><span style=display:flex><span>mysql&gt; <span style=color:#66d9ef>select</span> concat<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;grant select,insert on mysql.audit_login to &#39;&#34;</span>,user,<span style=color:#e6db74>&#34;&#39;@&#39;&#34;</span>,host,<span style=color:#e6db74>&#34;&#39;;&#34;</span><span style=color:#f92672>)</span> grants_sql from mysql.user where user not in <span style=color:#f92672>(</span><span style=color:#e6db74>&#39;mysql.session&#39;</span>,<span style=color:#e6db74>&#39;mysql.sys&#39;</span><span style=color:#f92672>)</span> and Super_priv<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;N&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 执行：</span>
</span></span><span style=display:flex><span>mysql&gt; set global init_connect<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;insert into mysql.audit_login(USER,HOST,DB,PROCESSLIST_ID) values(current_user(),substring_index(user(),&#39;@&#39;,-1),database(),connection_id());&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 配置参数文件：</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>mysqld<span style=color:#f92672>]</span> 
</span></span><span style=display:flex><span>init_connect<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;insert into mysql.audit_login(USER,HOST,DB,PROCESSLIST_ID) values(current_user(),substring_index(user(),&#39;@&#39;,-1),database(),connection_id());&#34;</span>;  <span style=color:#75715e>#DBA add</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 最后执行看看有没有数据：</span>
</span></span><span style=display:flex><span>mysql&gt; <span style=color:#66d9ef>select</span> * from mysql.audit_login;
</span></span></code></pre></div></blockquote></div><h2 id=主从跳过复制错误>主从跳过复制错误
<a class=header-anchor href=#%e4%b8%bb%e4%bb%8e%e8%b7%b3%e8%bf%87%e5%a4%8d%e5%88%b6%e9%94%99%e8%af%af></a></h2><div class="note info"><blockquote><ul><li><ol><li><a href=https://blog.51cto.com/arthur376/1969935 title=主从跳过复制错误 rel="noopener external nofollow noreferrer" target=_blank class=exturl>主从跳过复制错误
<i class="fa fa-external-link-alt"></i></a></li></ol></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e># 停止复制
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> slave stop;
</span></span><span style=display:flex><span><span style=color:#75715e># 设定跳过一个事务
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>SET</span> GLOBAL SQL_SLAVE_SKIP_COUNTER <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 重新开启复制
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span>slave start
</span></span><span style=display:flex><span><span style=color:#75715e># 这样就正常了，但是，当然还是要把数据修改上去
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span><span style=color:#66d9ef>update</span> <span style=color:#66d9ef>tables</span> <span style=color:#66d9ef>set</span> <span style=color:#960050;background-color:#1e0010>。。。。。。。</span>
</span></span></code></pre></div></blockquote></div><h2 id=sql优化审核平台工具><code>SQL</code>优化、审核平台工具
<a class=header-anchor href=#sql%e4%bc%98%e5%8c%96%e5%ae%a1%e6%a0%b8%e5%b9%b3%e5%8f%b0%e5%b7%a5%e5%85%b7></a></h2><div class="note info"><ul><li><ol><li><font color=red>安装
<a href=https://guide.yearning.io/install.html title="<code>Yearning</code>" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>Yearning</code>
<i class="fa fa-external-link-alt"></i>
</a><code>SQL</code>审核工具</font></li></ol></li></ul><blockquote><ul><li>1.1 <font color=red>默认账号/密码：</font><code>admin/Yearning_admin</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ yum -y install wget unzip
</span></span><span style=display:flex><span>$ wget -P /opt/src/ https://github.com/cookieY/Yearning/releases/download/v3.1.0/Yearning-v3.1.0-linux-amd64.zip  
</span></span><span style=display:flex><span>$ unzip -d /opt/yearning /opt/src/Yearning-v3.1.0-linux-amd64.zip  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>$ sed -i <span style=color:#e6db74>&#34;s/Port = &#34;</span>3306<span style=color:#e6db74>&#34;/Port = &#34;</span>16303<span style=color:#e6db74>&#34;/g&#34;</span> /opt/apps/yearning/conf.toml  
</span></span><span style=display:flex><span>$ sed -i <span style=color:#e6db74>&#34;s/Password = &#39;xxxx&#39;/Password = &#39;p@ssw0rd&#39;/g&#34;</span> /opt/apps/yearning/conf.toml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ /bin/mysql -uroot <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> -S /opt/data/data_16303/mysql.sock <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> -p -e <span style=color:#e6db74>&#34;create database Yearning DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ bin/mysql -uroot <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> -S /opt/data/data_16303/mysql.sock <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> -p -e <span style=color:#e6db74>&#34;grant all on *.* to root@&#39;127.0.0.1&#39; identified by &#34;</span>p@ssw0rd<span style=color:#e6db74>&#34;;&#34;</span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ ./Yearning install  	<span style=color:#75715e># 先初始化</span>
</span></span><span style=display:flex><span>$ ./Yearning run
</span></span><span style=display:flex><span>$ ./Yearning run --push <span style=color:#e6db74>&#34;域名、或者IP地址&#34;</span> --port <span style=color:#e6db74>&#34;8000&#34;</span>  	<span style=color:#75715e># 指定域名端口方式启动</span>
</span></span></code></pre></div></blockquote><ul><li><ol start=2><li><font color=red>安装美团<code>SQL</code>优化工具
<a href=https://github.com/Meituan-Dianping/SQLAdvisor/blob/master/doc/QUICK_START.md title="<code>SQL-Advisor</code>" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>SQL-Advisor</code>
<i class="fa fa-external-link-alt"></i></a></font></li></ol></li></ul><blockquote><ul><li>2.1
<a href=https://segmentfault.com/a/1190000022883633 title="<code>MySQL-SQLAdvisor</code>的简单安装使用" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>MySQL-SQLAdvisor</code>的简单安装使用
<i class="fa fa-external-link-alt"></i></a></li><li>2.2
<a href=https://tech.meituan.com/2017/03/09/sqladvisor-pr.html title="美团点评<code>SQL</code>优化工具<code>SQLAdvisor</code>开源" rel="noopener external nofollow noreferrer" target=_blank class=exturl>美团点评<code>SQL</code>优化工具<code>SQLAdvisor</code>开源
<i class="fa fa-external-link-alt"></i></a></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ yum -y install git wget cmake libaio-devel libffi-devel glib2 glib2-devel  
</span></span><span style=display:flex><span>$ yum -y install --enablerepo<span style=color:#f92672>=</span>Percona56 Percona-Server-shared-56  
</span></span><span style=display:flex><span>$ git clone https://github.com/Meituan-Dianping/SQLAdvisor.git /opt/src/sqladvisor  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cd /opt/src/sqladvisor
</span></span><span style=display:flex><span>$ cmake -DBUILD_CONFIG<span style=color:#f92672>=</span>mysql_release <span style=color:#ae81ff>\ </span>
</span></span><span style=display:flex><span> -DCMAKE_BUILD_TYPE<span style=color:#f92672>=</span>debug <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> -DCMAKE_INSTALL_PREFIX<span style=color:#f92672>=</span>/usr/local/sqlparser ./
</span></span><span style=display:flex><span>$ make <span style=color:#f92672>&amp;&amp;</span> make install
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 1. DCMAKE_INSTALL_PREFIX为sqlparser库文件和头文件的安装目录，其中lib目录包含库文件libsqlparser.so，include目录包含所需的所有头文件。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. DCMAKE_INSTALL_PREFIX值尽量不要修改，后面安装依赖这个目录。  </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cd SQLAdvisor/sqladvisor/
</span></span><span style=display:flex><span>$ cmake -DCMAKE_BUILD_TYPE<span style=color:#f92672>=</span>debug ./
</span></span><span style=display:flex><span>$ make
</span></span><span style=display:flex><span><span style=color:#75715e># 在本路径下生成一个sqladvisor可执行文件，这即是我们想要</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cat &gt;sql.cnf<span style=color:#e6db74>&lt;&lt;-EOF
</span></span></span><span style=display:flex><span><span style=color:#e6db74>[sqladvisor]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>username=xx
</span></span></span><span style=display:flex><span><span style=color:#e6db74>password=xx
</span></span></span><span style=display:flex><span><span style=color:#e6db74>host=xx
</span></span></span><span style=display:flex><span><span style=color:#e6db74>port=xx
</span></span></span><span style=display:flex><span><span style=color:#e6db74>dbname=xx
</span></span></span><span style=display:flex><span><span style=color:#e6db74># sqls=sql1;sql2;sql3....
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># cmd: ./sqladvisor -f sql.cnf  -v 1</span>
</span></span></code></pre></div></blockquote><ul><li><ol start=3><li><a href=https://www.justdojava.com/2021/07/20/canal/ title="监听<code>MySQL binlog</code>实现数据变化后的实时通知" rel="noopener external nofollow noreferrer" target=_blank class=exturl>监听<code>MySQL binlog</code>实现数据变化后的实时通知
<i class="fa fa-external-link-alt"></i></a></li></ol></li></ul><blockquote><ul><li>3.1
<a href=https://github.com/alibaba/canal title="<code>Github Alibaba Canal</code>" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>Github Alibaba Canal</code>
<i class="fa fa-external-link-alt"></i></a></li></ul></blockquote><ul><li><ol start=4><li><code>explain</code><font color=red>的使用</font></li></ol></li></ul><blockquote><ul><li>4.1
<a href=https://developer.aliyun.com/article/1104750#slide-12 title="<code>Mysql</code>优化高级篇" rel="noopener external nofollow noreferrer" target=_blank class=exturl><code>Mysql</code>优化高级篇
<i class="fa fa-external-link-alt"></i></a></li><li>4.2 <code>explain</code>+<code>sql</code>语句</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>explain</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> Tables_name;
</span></span></code></pre></div><blockquote><ul><li>4.2.1 <code>id</code>：表的读取顺序</li><li>4.2.2 <code>select_type</code>：数据读取操作的操作类型</li><li>4.2.3 <code>possible_keys</code>：哪些索引可以使用</li><li>4.2.4 <code>key</code>：哪些索引被实际使用</li><li>4.2.5 <code>ref</code>：表之间的引用</li><li>4.2.6 <code>rows</code>：每张表有多少行被优化器查询</li></ul></blockquote></blockquote></div></div><footer class=post-footer><div class=post-tags><a href=/tags/databases>Databases
</a><a href=/tags/mysql>Mysql</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=reward-container><div><i class="fa-solid fa-mug-hot"></i>请我喝杯咖啡吧 ヾ(^▽^*)))</div><button>
赞赏</button><div class=post-reward><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/ali-pay.png alt="二哥 - 支付宝">
<span>支付宝</span></div><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/wechat-pay.png alt="二哥 - 微信">
<span>微信</span></div></div></div><div class=post-copyright><img src=/imgs/cc/cc.svg width=75 height=75 align=right alt=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
Configure Mysql</li><li class=post-copyright-author><strong>本文作者： </strong>二哥</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://erge.blog/systems/linux/databases/configure-mysql/ title="Configure Mysql">https://erge.blog/systems/linux/databases/configure-mysql/</a></li><li class=post-copyright-license><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=/images/wechat_channel.jpg><span class=icon><i class="fab fa-weixin"></i>
</span><span class=label>WeChat</span></a></div><div class=social-item><a target=_blank class=social-link href=/atom.xml><span class=icon><i class="fa fa-rss"></i>
</span><span class=label>RSS</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/systems/linux/firewalld/use-firewalld/ rel=next title="Use Firewalld"><i class="fa fa-chevron-left"></i> Use Firewalld</a></div><div class="post-nav-prev post-nav-item"><a href=/systems/linux/databases/update-mysql5-7-to-mysql8/ rel=prev title="Update Mysql5 7 to Mysql8">Update Mysql5 7 to Mysql8
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div><div class=comment-switch><span class=first-comment>Giscus</span>
<span class=switch-btn></span>
<span class=second-comment>Waline</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=waline-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div id=gtranslate class=google-translate><i class="fa fa-language"></i><div id=google_translate_element></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2010 - 2024
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>二哥</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.125.4 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.5.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>粤ICP备 18047355-1 号</a>
<img src=/imgs/gongan.png alt=沪公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011402009770" target=_blank>沪公网安备 31011402009770 号</a></div><div class=vendors-list><a target=_blank href=https://vercel.com title=Vercel><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/vercel.svg alt=Vercel>
</a><a target=_blank href=https://upyun.com title=又拍云><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/upyun.png alt=又拍云>
</a><a target=_blank href=https://webify.cloudbase.net title=Webify>Webify
</a><span>提供CDN/云资源支持</span></div></div></footer><script type=text/javascript src=https://cdn.staticfile.org/animejs/3.2.1/anime.min.js defer></script><script type=text/javascript src=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.js defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":false,"giscus":{"cfg":{"category":"Comments","categoryid":null,"emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"username/repo-name","repoid":null,"theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"https://erge.blog/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":true,"plugin":"waline"},"views":{"enable":true,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"qiniu","router":"https://cdn.staticfile.org"},"version":"4.5.3","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":null,"sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"waline","file":"dist/waline.css","name":"@waline/client","version":"2.13.0"},"js":{"alias":"waline","file":"dist/waline.js","name":"@waline/client","version":"2.13.0"}}}</script><script type=text/javascript src=/js/main.min.b0c78e5a4df586ee46d02716ffa91a4a322e56763e04e91eb2ba052c9469ed02.js defer></script></body></html>