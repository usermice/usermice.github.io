<!DOCTYPE html>
<html lang="en" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.125.4">
    <meta name="generator" content="Relearn 6.0.0+tip">
    <meta name="robots" content="noindex, nofollow, noarchive, noimageindex">
    <meta name="description" content="é…ç½®é˜²ç«å¢™ é…ç½®Firewalldé˜²ç«å¢™ Linuxé…ç½®Firewalldé˜²ç«å¢™çš„è·¯ç”±è½¬å‘ CentOS7ä¸‹firewallçš„ipseté…ç½®ä½¿ç”¨è¯¦è§£ CentOS7å¼€å¯è·¯ç”±è½¬å‘ å¸¸è§å¤±è´¥åŸå› ï¼šç”µè„‘æœ¬èº«æ²¡æœ‰å¼€å¯è™šæ‹ŸåŒ–æ”¯æŒï¼Œéœ€è¦åœ¨é‡å¯æ—¶è¿›å…¥BIOSé‡Œè®¾ç½® # ä¸´æ—¶å¼€å¯è·¯ç”±è½¬å‘ $ echo &#34;1&#34; &gt; /proc/sys/net/ipv4/ip_forward # æ°¸ä¹…å¼€å¯è·¯ç”±è½¬å‘ $ echo &#34;net.">
    <meta name="author" content="äºŒå“¥">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://erge.blog/images/s2-1.png">
    <meta name="twitter:title" content="Use_Firewalld :: Hugo Relearn Theme">
    <meta name="twitter:description" content="é…ç½®é˜²ç«å¢™ é…ç½®Firewalldé˜²ç«å¢™ Linuxé…ç½®Firewalldé˜²ç«å¢™çš„è·¯ç”±è½¬å‘ CentOS7ä¸‹firewallçš„ipseté…ç½®ä½¿ç”¨è¯¦è§£ CentOS7å¼€å¯è·¯ç”±è½¬å‘ å¸¸è§å¤±è´¥åŸå› ï¼šç”µè„‘æœ¬èº«æ²¡æœ‰å¼€å¯è™šæ‹ŸåŒ–æ”¯æŒï¼Œéœ€è¦åœ¨é‡å¯æ—¶è¿›å…¥BIOSé‡Œè®¾ç½® # ä¸´æ—¶å¼€å¯è·¯ç”±è½¬å‘ $ echo &#34;1&#34; &gt; /proc/sys/net/ipv4/ip_forward # æ°¸ä¹…å¼€å¯è·¯ç”±è½¬å‘ $ echo &#34;net.">
    <meta property="og:url" content="https://erge.blog/systems/linux/firewalld/use_firewalld/">
    <meta property="og:site_name" content="Hugo Relearn Theme">
    <meta property="og:title" content="Use_Firewalld :: Hugo Relearn Theme">
    <meta property="og:description" content="é…ç½®é˜²ç«å¢™ é…ç½®Firewalldé˜²ç«å¢™ Linuxé…ç½®Firewalldé˜²ç«å¢™çš„è·¯ç”±è½¬å‘ CentOS7ä¸‹firewallçš„ipseté…ç½®ä½¿ç”¨è¯¦è§£ CentOS7å¼€å¯è·¯ç”±è½¬å‘ å¸¸è§å¤±è´¥åŸå› ï¼šç”µè„‘æœ¬èº«æ²¡æœ‰å¼€å¯è™šæ‹ŸåŒ–æ”¯æŒï¼Œéœ€è¦åœ¨é‡å¯æ—¶è¿›å…¥BIOSé‡Œè®¾ç½® # ä¸´æ—¶å¼€å¯è·¯ç”±è½¬å‘ $ echo &#34;1&#34; &gt; /proc/sys/net/ipv4/ip_forward # æ°¸ä¹…å¼€å¯è·¯ç”±è½¬å‘ $ echo &#34;net.">
    <meta property="og:locale" content="en">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Systems">
    <meta property="article:published_time" content="2024-06-17T22:29:01+08:00">
    <meta property="article:modified_time" content="2024-06-17T22:29:01+08:00">
    <meta property="og:image" content="https://erge.blog/images/s2-1.png">
    <meta itemprop="name" content="Use_Firewalld :: Hugo Relearn Theme">
    <meta itemprop="description" content="é…ç½®é˜²ç«å¢™ é…ç½®Firewalldé˜²ç«å¢™ Linuxé…ç½®Firewalldé˜²ç«å¢™çš„è·¯ç”±è½¬å‘ CentOS7ä¸‹firewallçš„ipseté…ç½®ä½¿ç”¨è¯¦è§£ CentOS7å¼€å¯è·¯ç”±è½¬å‘ å¸¸è§å¤±è´¥åŸå› ï¼šç”µè„‘æœ¬èº«æ²¡æœ‰å¼€å¯è™šæ‹ŸåŒ–æ”¯æŒï¼Œéœ€è¦åœ¨é‡å¯æ—¶è¿›å…¥BIOSé‡Œè®¾ç½® # ä¸´æ—¶å¼€å¯è·¯ç”±è½¬å‘ $ echo &#34;1&#34; &gt; /proc/sys/net/ipv4/ip_forward # æ°¸ä¹…å¼€å¯è·¯ç”±è½¬å‘ $ echo &#34;net.">
    <meta itemprop="datePublished" content="2024-06-17T22:29:01+08:00">
    <meta itemprop="dateModified" content="2024-06-17T22:29:01+08:00">
    <meta itemprop="wordCount" content="1003">
    <meta itemprop="image" content="https://erge.blog/images/s2-1.png">
    <title>Use_Firewalld :: Hugo Relearn Theme</title>
    <link href="../../../../images/favicon.ico?1721991565" rel="icon" type="image/x-icon" sizes="any">
    <link href="../../../../css/fontawesome-all.min.css?1721991566" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/fontawesome-all.min.css?1721991566" rel="stylesheet"></noscript>
    <link href="../../../../css/nucleus.css?1721991566" rel="stylesheet">
    <link href="../../../../css/auto-complete.css?1721991566" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/auto-complete.css?1721991566" rel="stylesheet"></noscript>
    <link href="../../../../css/perfect-scrollbar.min.css?1721991566" rel="stylesheet">
    <link href="../../../../css/fonts.css?1721991566" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/fonts.css?1721991566" rel="stylesheet"></noscript>
    <link href="../../../../css/theme.css?1721991566" rel="stylesheet">
    <link href="../../../../css/theme-relearn-auto.css?1721991566" rel="stylesheet" id="R-variant-style">
    <link href="../../../../css/chroma-relearn-auto.css?1721991566" rel="stylesheet" id="R-variant-chroma-style">
    <link href="../../../../css/variant.css?1721991566" rel="stylesheet">
    <link href="../../../../css/print.css?1721991566" rel="stylesheet" media="print">
    <link href="../../../../css/format-print.css?1721991566" rel="stylesheet">
    <script src="../../../../js/variant.js?1721991566"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..\/..\/..';
      window.relearn.relBaseUri='..\/..\/..\/..';
      window.relearn.absBaseUri='https:\/\/erge.blog';
      window.index_js_url="../../../../index.search.js";
      // variant stuff
      window.variants && variants.init( [ 'relearn-auto', 'relearn-light', 'relearn-dark', 'relearn-bright', 'zen-auto', 'zen-light', 'zen-dark', 'retro-auto', 'neon', 'learn', 'blue', 'green', 'red', 'my-branding' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>Partial intended to be overwritten to add custom headers, like CSS or any other info
<style>
    
</style>


  </head>
  <body class="mobile-support print disableInlineCopyToClipboard" data-url="../../../../systems/linux/firewalld/use_firewalld/">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="show" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>



          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../../../systems/"><span itemprop="name">Systems</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../../../systems/linux/"><span itemprop="name">Linux</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../../../systems/linux/firewalld/"><span itemprop="name">Firewalld</span></a><meta itemprop="position" content="3">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Use_Firewalld</span><meta itemprop="position" content="4"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">


            <div class="topbar-button topbar-button-prev" data-content-empty="show" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="../../../../systems/linux/firewalld/" title="Firewalld (ğŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>

            <div class="topbar-button topbar-button-next" data-content-empty="show" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="../../../../systems/linux/gitlab/" title="Gitlab (ğŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>



          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>

<h1 id="use_firewalld">Use_Firewalld</h1>

<h2 id="é…ç½®é˜²ç«å¢™">é…ç½®é˜²ç«å¢™</h2>
<h3 id="é…ç½®firewalldé˜²ç«å¢™">é…ç½®<code>Firewalld</code>é˜²ç«å¢™</h3>
<ul>
<li>
<ol>
<li><code>Linux</code><!-- raw HTML omitted -->é…ç½®<!-- raw HTML omitted --><code>Firewalld</code><!-- raw HTML omitted -->é˜²ç«å¢™çš„è·¯ç”±è½¬å‘<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<ul>
<li><a href="https://blog.csdn.net/github_36904248/article/details/82012579" rel="external" target="_self"><code>CentOS7</code>ä¸‹<code>firewall</code>çš„<code>ipset</code>é…ç½®ä½¿ç”¨è¯¦è§£</a></li>
<li><a href="https://blog.csdn.net/qianye_111/article/details/78987161" rel="external" target="_self"><code>CentOS7</code>å¼€å¯è·¯ç”±è½¬å‘</a></li>
<li>å¸¸è§å¤±è´¥åŸå› ï¼š<!-- raw HTML omitted -->ç”µè„‘æœ¬èº«æ²¡æœ‰å¼€å¯è™šæ‹ŸåŒ–æ”¯æŒï¼Œéœ€è¦åœ¨é‡å¯æ—¶è¿›å…¥BIOSé‡Œè®¾ç½®</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># ä¸´æ—¶å¼€å¯è·¯ç”±è½¬å‘</span>
</span></span><span style="display:flex;"><span>$ echo <span style="color:#e6db74">&#34;1&#34;</span> &gt; /proc/sys/net/ipv4/ip_forward
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ°¸ä¹…å¼€å¯è·¯ç”±è½¬å‘</span>
</span></span><span style="display:flex;"><span>$ echo <span style="color:#e6db74">&#34;net.ipv4.ip_forward = 1&#34;</span> &gt;&gt;/etc/sysctl.conf
</span></span><span style="display:flex;"><span>$ sysctl -p  	<span style="color:#75715e"># åŠ è½½ä¸€ä¸‹</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ sysctl -a |grep <span style="color:#e6db74">&#34;ip_forward&#34;</span>  	<span style="color:#75715e"># æŸ¥çœ‹ä¸€ä¸‹</span>
</span></span><span style="display:flex;"><span>net.ipv4.ip_forward <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>net.ipv4.ip_forward_use_pmtu <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span></span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="2">
<li><!-- raw HTML omitted -->é…ç½®<!-- raw HTML omitted --><code>Linux</code><!-- raw HTML omitted -->çš„<!-- raw HTML omitted --><code>Firewalld</code></li>
</ol>
</li>
</ul>
<blockquote>
<ul>
<li>é…ç½®<!-- raw HTML omitted --><code>Firewalld</code><!-- raw HTML omitted -->è½¬å‘<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># å¤–ç½‘å¡</span>
</span></span><span style="display:flex;"><span>$ firewall-cmd --permanent --zone<span style="color:#f92672">=</span>external --change-interface<span style="color:#f92672">=</span>eth0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å†…ç½‘ç½‘å¡</span>
</span></span><span style="display:flex;"><span>$ firewall-cmd --permanent --zone<span style="color:#f92672">=</span>internal --change-interface<span style="color:#f92672">=</span>eth1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># IPåœ°å€ä¼ªè£…</span>
</span></span><span style="display:flex;"><span>$ firewall-cmd --zone<span style="color:#f92672">=</span>external --add-masquerade --permanent
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ firewall-cmd --permanent --direct --passthrough ipv4 -t nat POSTROUTING -o eth0# å¤–ç½‘å¡ -j MASQUERADE -s 192.168.100.0/24# å†…ç½‘ç½‘æ®µ
</span></span><span style="display:flex;"><span>$ firewall-cmd --reload</span></span></code></pre></div><ul>
<li><!-- raw HTML omitted -->é…ç½®<!-- raw HTML omitted --><code>Firewalld</code><!-- raw HTML omitted -->è®¿é—®è§„åˆ™<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ firewall-cmd --add-service<span style="color:#f92672">={</span>http,https<span style="color:#f92672">}</span> --permanent
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ firewall-cmd --permanent --new-ipset<span style="color:#f92672">=</span>ssh_whitelist --type<span style="color:#f92672">=</span>hash:ip
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ firewall-cmd --permanent --add-rich-rule<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;rule family=&#39;ipv4&#39; source ipset=&#39;ssh_whitelist port port=&#39;22&#39; protocol=&#39;tcp&#39; accept&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ firewall-cmd --permanent --add-rich-rule<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;rule family=&#39;ipv4&#39; source ipset=&#39;redis_whitelist&#39; port port=&#39;17693-17695&#39; protocol=&#39;tcp&#39; accept&#34;</span>  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ firewall-cmd --permanent --add-rich-rule<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;rule family=&#39;ipv4&#39; source ipset=&#39;redis_whitelist&#39; port port=&#39;27693-27695&#39; protocol=&#39;tcp&#39; accept&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># é‡æ–°è½½å…¥é…ç½®</span>
</span></span><span style="display:flex;"><span>$ firewall-cmd --reload &gt;/dev/null
</span></span><span style="display:flex;"><span>$ systemctl status firewalld &gt;/dev/null 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æŸ¥çœ‹å·²ç»å¼€æ”¾ç«¯å£</span>
</span></span><span style="display:flex;"><span>$ firewallport<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>firewall-cmd --zone<span style="color:#f92672">=</span>public --list-ports<span style="color:#e6db74">`</span></span></span></code></pre></div></blockquote>
<hr>
<h3 id="é…ç½®iptablesé˜²ç«å¢™">é…ç½®<code>Iptables</code>é˜²ç«å¢™</h3>
<ul>
<li>
<ol>
<li><code>Linux</code><!-- raw HTML omitted -->çš„<!-- raw HTML omitted --><code>Iptables</code><!-- raw HTML omitted -->é…ç½®è§„åˆ™<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<ul>
<li><code>Iptables</code><!-- raw HTML omitted -->è§„åˆ™4è¡¨<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li><code>filter(è¿‡æ»¤è§„åˆ™è¡¨)</code><!-- raw HTML omitted -->ï¼šæ§åˆ¶æ•°æ®åŒ…æ˜¯å¦å…è®¸è¿›å‡ºåŠè½¬å‘ï¼Œå¯ä»¥æ§åˆ¶çš„é“¾è·¯æœ‰<!-- raw HTML omitted --><code>INPUT</code>ã€<code>OUTPUT</code>å’Œ<code>FORWARD</code></li>
<li><code>nat(åœ°å€è½¬æ¢è§„åˆ™è¡¨)</code><!-- raw HTML omitted -->ï¼šæ§åˆ¶æ•°æ®åŒ…ä¸­åœ°å€è½¬æ¢ï¼Œå¯ä»¥æ§åˆ¶çš„é“¾è·¯æœ‰<!-- raw HTML omitted --><code>INPUT</code>ã€<code>OUTPUT</code>ã€<code>PREROUTING</code>å’Œ<code>POSTROUTING</code></li>
<li><code>mangle(ä¿®æ”¹æ•°æ®æ ‡è®°ä½è§„åˆ™è¡¨)</code><!-- raw HTML omitted -->ï¼šä¿®æ”¹æ•°æ®åŒ…ä¸­çš„åŸæ•°æ®ï¼Œå¯ä»¥æ§åˆ¶çš„é“¾è·¯æœ‰<!-- raw HTML omitted --><code>INPUT</code>ã€<code>OUTPUT</code>ã€<code>FORWARD</code>ã€<code>PREROUTING</code>å’Œ<code>POSTROUTING</code></li>
<li><code>raw(è·Ÿè¸ªæ•°æ®è¡¨è§„åˆ™è¡¨)</code>ï¼šæ§åˆ¶<code>nat</code><!-- raw HTML omitted -->è¡¨ä¸­è¿æ¥è¿½è¸ªæœºåˆ¶çš„å¯ç”¨çŠ¶å†µï¼Œå¯ä»¥æ§åˆ¶çš„é“¾è·¯æœ‰<!-- raw HTML omitted --><code>OUTPUT</code>ã€<code>PREROUTING</code></li>
</ul>
</blockquote>
<ul>
<li><code>Iptables</code><!-- raw HTML omitted -->è§„åˆ™5é“¾<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li><code>INPUT</code><!-- raw HTML omitted -->(å…¥ç«™æ•°æ®è¿‡æ»¤é“¾)<!-- raw HTML omitted --></li>
<li><code>OUTPUT</code><!-- raw HTML omitted -->(å‡ºç«™æ•°æ®è¿‡æ»¤é“¾)<!-- raw HTML omitted --></li>
<li><code>FORWARD</code><!-- raw HTML omitted -->(è½¬å‘æ•°æ®è¿‡æ»¤é“¾)<!-- raw HTML omitted --></li>
<li><code>PREROUTING</code><!-- raw HTML omitted -->(è·¯ç”±å‰è¿‡æ»¤é“¾)<!-- raw HTML omitted --></li>
<li><code>POSTROUTING</code><!-- raw HTML omitted -->(è·¯ç”±åè¿‡æ»¤é“¾)<!-- raw HTML omitted --></li>
</ul>
</blockquote>
<ul>
<li><!-- raw HTML omitted -->é€‰é¡¹å‚æ•°<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<table>
<thead>
<tr>
<th>é€‰é¡¹/å‚æ•°</th>
<th>å…·ä½“ä½œç”¨</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-A</code></td>
<td>åœ¨è§„åˆ™é“¾çš„æœ«å°¾åŠ å…¥æ–°è§„åˆ™</td>
</tr>
<tr>
<td><code>-D</code></td>
<td>åˆ é™¤æŸä¸€æ¡è§„åˆ™</td>
</tr>
<tr>
<td><code>-I</code></td>
<td>åœ¨è§„åˆ™é“¾çš„å¤´éƒ¨åŠ å…¥æ–°è§„åˆ™</td>
</tr>
<tr>
<td><code>-F</code></td>
<td>æ¸…ç©ºè§„åˆ™é“¾</td>
</tr>
<tr>
<td><code>-L</code></td>
<td>æŸ¥çœ‹è§„åˆ™é“¾</td>
</tr>
<tr>
<td><code>-R</code></td>
<td>æ›¿æ¢é˜²ç«å¢™è§„åˆ™</td>
</tr>
<tr>
<td><code>-Z</code></td>
<td>æ¸…ç©ºé˜²ç«å¢™æ•°æ®è¡¨ç»Ÿè®¡ä¿¡æ¯</td>
</tr>
<tr>
<td><code>-P</code></td>
<td>è®¾ç½®é»˜è®¤ç­–ç•¥:<code>iptables -P INPUT (DROP</code></td>
</tr>
<tr>
<td><code>-p</code></td>
<td>åŒ¹é…åè®®ï¼Œ! è¡¨ç¤ºå–å</td>
</tr>
<tr>
<td><code>-s</code></td>
<td>åŒ¹é…æºåœ°å€</td>
</tr>
<tr>
<td><code>--sport</code></td>
<td>åŒ¹é…æºç«¯å£</td>
</tr>
<tr>
<td><code>--sports</code></td>
<td>åŒ¹é…æºç«¯å£</td>
</tr>
<tr>
<td><code>--src-range</code></td>
<td>åŒ¹é…ç›®æ ‡åœ°å€èŒƒå›´</td>
</tr>
<tr>
<td><code>-d</code></td>
<td>åŒ¹é…ç›®æ ‡åœ°å€</td>
</tr>
<tr>
<td><code>--dport</code></td>
<td>åŒ¹é…ç›®æ ‡ç«¯å£</td>
</tr>
<tr>
<td><code>--dports</code></td>
<td>åŒ¹é…ç›®æ ‡ç«¯å£</td>
</tr>
<tr>
<td><code>--dst-range</code></td>
<td>åŒ¹é…ç›®æ ‡åœ°å€èŒƒå›´</td>
</tr>
<tr>
<td><code>-i</code></td>
<td>åŒ¹é…å…¥ç«™ç½‘å¡æ¥å£</td>
</tr>
<tr>
<td><code>-o</code></td>
<td>åŒ¹é…å‡ºç«™ç½‘å¡æ¥å£</td>
</tr>
<tr>
<td><code>--limit</code></td>
<td>å››é…æ•°æ®è¡¨é€Ÿç‡</td>
</tr>
<tr>
<td><code>--mac-cource</code></td>
<td>åŒ¹é…æº<code>MAC</code>åœ°å€</td>
</tr>
<tr>
<td><code>--stste</code></td>
<td>åŒ¹é…çŠ¶æ€ï¼ˆINVALIDã€ESTABLISHEDã€NEWã€RELATED)</td>
</tr>
<tr>
<td><code>--string</code></td>
<td>åŒ¹é…åº”ç”¨å±‚å­—ä¸²</td>
</tr>
<tr>
<td><code>-m comment --comment &quot;æˆ‘æ˜¯æ³¨é‡Š&quot;</code></td>
<td>æ·»åŠ æ³¨é‡Š</td>
</tr>
</tbody>
</table>
</blockquote>
<ul>
<li><!-- raw HTML omitted -->è§¦å‘è§„åˆ™<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<table>
<thead>
<tr>
<th>è§¦å‘åŠ¨ä½œ</th>
<th>æ›´èƒ½</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ACCEPT</code></td>
<td>å…è®¸æ•°æ®åŒ…é€šè¿‡</td>
</tr>
<tr>
<td><code>DROP</code></td>
<td>ä¸¢å¼ƒæ•°æ®åŒ…</td>
</tr>
<tr>
<td><code>REJECT</code></td>
<td>æ‹’ç»æ•°æ®åŒ…é€šè¿‡</td>
</tr>
<tr>
<td><code>LOG</code></td>
<td>å°†æ•°æ®åŒ…ä¿¡æ¯è®°å½•<code>syslog</code>æ›°å¿—</td>
</tr>
<tr>
<td><code>DNAT</code></td>
<td>ç›®æ ‡åœ°å€è½¬æ¢</td>
</tr>
<tr>
<td><code>SNAT</code></td>
<td>æºåœ°å€è½¬æ¢</td>
</tr>
<tr>
<td><code>MASQUERADE</code></td>
<td>åœ°å€æ¬ºéª—</td>
</tr>
<tr>
<td><code>REDIRECT</code></td>
<td>é‡å®šå‘</td>
</tr>
</tbody>
</table>
</blockquote>
</blockquote>
<ul>
<li>
<ol start="2">
<li><!-- raw HTML omitted -->å‘½ä»¤é€‰é¡¹è¾“å…¥é¡ºåº<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<ul>
<li><code>-t</code><!-- raw HTML omitted -->ï¼šåé¢è·Ÿ4è¡¨ä¸­çš„è¡¨å<!-- raw HTML omitted --></li>
<li><code>-A/I/D/R</code><!-- raw HTML omitted -->ï¼šåé¢è·Ÿ5é“¾ä¸­çš„é“¾å<!-- raw HTML omitted --></li>
<li><code>-i/o</code><!-- raw HTML omitted -->ï¼šè·Ÿç½‘å¡å<!-- raw HTML omitted --></li>
<li><code>-p</code><!-- raw HTML omitted -->ï¼šåè®®åï¼š<!-- raw HTML omitted --><code>tcp/udp</code></li>
<li><code>-s</code><!-- raw HTML omitted -->ï¼šæº<code>IP</code>/æºå­ç½‘<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ iptables -tï¼šè¡¨å<span style="color:#f92672">(</span>filter/nat/mangle/raw<span style="color:#f92672">)</span> -A/I/D/Rï¼šè§„åˆ™é“¾å<span style="color:#f92672">[</span>è§„åˆ™å·<span style="color:#f92672">]</span> -i/oï¼šç½‘å¡å -pï¼šåè®®å<span style="color:#f92672">(</span>tcp/udp<span style="color:#f92672">)</span> -sï¼šæºIP/æºå­ç½‘ --sportï¼šæºç«¯å£ -dï¼šç›®æ ‡IP/ç›®æ ‡å­ç½‘ --dportï¼šç›®æ ‡ç«¯å£ -j åŠ¨ä½œ<span style="color:#f92672">(</span>ACCEPT/DROP/DNAT/SNAT/...<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ service iptables save
</span></span><span style="display:flex;"><span>$ systemctl reload iptables</span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="3">
<li><!-- raw HTML omitted -->é…ç½®<!-- raw HTML omitted --><code>Iptables</code><!-- raw HTML omitted -->çš„<!-- raw HTML omitted --><code>INPUT</code>è§„åˆ™</li>
</ol>
</li>
</ul>
<blockquote>
<ul>
<li>æ”¾è¡Œç«¯å£ï¼Œå¦‚æœéœ€è¦é’ˆå¯¹<code>IP</code>é™åˆ¶åŠ ï¼š<code>-s</code></li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ iptables -A INPUT -p tcp -m tcp --dport <span style="color:#ae81ff">21</span> -j ACCEPT  	<span style="color:#75715e"># å¼€æ”¾21ç«¯å£</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ cat &gt;/etc/sysconfig/iptables<span style="color:#e6db74">&lt;&lt;-EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">-A INPUT -p tcp -m tcp --dport 21 -j ACCEPT
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span></span></span></code></pre></div></blockquote>
<ul>
<li>æ”¾è¡Œå¤šç«¯å£ï¼Œå¦‚æœéœ€è¦é’ˆå¯¹<code>IP</code>é™åˆ¶åŠ ï¼š<code>-s</code></li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ iptables -A INPUT -p tcp -m multiport --dports 3306,6379 -j ACCEPT 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ cat &gt;/etc/sysconfig/iptables<span style="color:#e6db74">&lt;&lt;-EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">-A INPUT -p tcp -m multiport --dports 3306,6379 -j ACCEPT
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span></span></span></code></pre></div></blockquote>
<ul>
<li>æ”¾è¡Œ<code>IP</code>ç½‘æ®µ</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ iptables -A INPUT -s 192.168.0.0/32 -j ACCEPT
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ cat &gt;/etc/sysconfig/iptables<span style="color:#e6db74">&lt;&lt;-EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">-A INPUT -s 192.168.0.0/32 -j ACCEPT
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span></span></span></code></pre></div></blockquote>
</blockquote>
<ul>
<li>
<ol start="4">
<li><!-- raw HTML omitted -->é…ç½®<!-- raw HTML omitted --><code>Iptables</code><!-- raw HTML omitted -->è½¬å‘è§„åˆ™<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ iptables -P FORWARDACCEPT  	<span style="color:#75715e"># ç¼ºçœå…è®¸IPè½¬å‘</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ©ç”¨iptables å®ç°nat MASQUERADE å…±äº«ä¸Šç½‘</span>
</span></span><span style="display:flex;"><span>$ iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ iptables -t nat -A PREROUTING -p tcp --dport <span style="color:#ae81ff">6379</span> -j DNAT --to-destination ç›®æ ‡IP:ç›®æ ‡ç«¯å£
</span></span><span style="display:flex;"><span>$ iptables -t nat -A POSTROUTING -p tcp -d ç›®æ ‡IP --dport ç›®æ ‡ç«¯å£ -j SNAT --to-source æºIP  	<span style="color:#75715e"># æºIPéœ€å’Œç›®æ ‡IPåŒä¸€ç½‘æ®µ</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ cat &gt;<span style="color:#e6db74">&lt;&lt;-EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">-A PREROUTING -p tcp -m tcp --dport 6379 -j DNAT --to-destination ç›®æ ‡IP:ç›®æ ‡ç«¯å£
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">-A POSTROUTING -p tcp -d ç›®æ ‡IP -m tcp --dport ç›®æ ‡ç«¯å£ -j SNAT --to-source æºIP
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æŸ¥çœ‹ç°æœ‰è½¬å‘è§„åˆ™</span>
</span></span><span style="display:flex;"><span>$ iptables -t nat -L</span></span></code></pre></div></blockquote>
<ul>
<li>
<ol start="5">
<li><!-- raw HTML omitted -->æ¸…é™¤ã€ä¿®æ”¹è§„åˆ™<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<ul>
<li>ä¿®æ”¹è§„åˆ™</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># ä¿®æ”¹è§„åˆ™,1ä»£è¡¨ç¬¬ä¸€è¡Œ</span>
</span></span><span style="display:flex;"><span>$ iptables -R INPUT <span style="color:#ae81ff">1</span> -s IP -p tcp --dport ç«¯å£ -j DROP</span></span></code></pre></div></blockquote>
<ul>
<li>åˆ é™¤è§„åˆ™</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ iptables -L -n --line-number  	<span style="color:#75715e"># æŸ¥çœ‹è§„åˆ™è¡Œå·</span>
</span></span><span style="display:flex;"><span>$ iptables -D INPUT <span style="color:#ae81ff">9</span>  	<span style="color:#75715e"># æŒ‰è¡Œå·åˆ é™¤è§„åˆ™</span></span></span></code></pre></div></blockquote>
<ul>
<li>æ¸…é™¤è§„åˆ™</li>
</ul>
<blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ iptables -F  	<span style="color:#75715e"># æ¸…é™¤æ‰€æœ‰</span>
</span></span><span style="display:flex;"><span>$ iptables-t nat -F  	<span style="color:#75715e"># æ¸…é™¤natè¡¨æ‰€æœ‰ </span></span></span></code></pre></div></blockquote>
</blockquote>
<ul>
<li>
<ol start="5">
<li><code>Iptables</code><!-- raw HTML omitted -->é˜²å¾¡è§„åˆ™<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<ul>
<li><!-- raw HTML omitted -->é˜»æ­¢<!-- raw HTML omitted --><code>Windows</code><!-- raw HTML omitted -->è •è™«çš„æ”»å‡»<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ iptables -I INPUT -j DROP -p tcp -s 0.0.0.0/0 -m string --algo kmp --string <span style="color:#e6db74">&#34;cmd.exe&#34;</span></span></span></code></pre></div><ul>
<li><!-- raw HTML omitted -->é˜²æ­¢<!-- raw HTML omitted --><code>SYN</code><!-- raw HTML omitted -->æ´ªæ°´æ”»å‡»<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ iptables -A INPUT -p tcp --syn -m limit --limit 5/second -j ACCEPT</span></span></code></pre></div><ul>
<li><!-- raw HTML omitted -->æ·»åŠ <!-- raw HTML omitted --><code>SECMARK</code><!-- raw HTML omitted -->è®°å½•<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ iptables -t mangle -A INPUT -p tcp --src 192.168.1.2 --dport <span style="color:#ae81ff">443</span> -j SECMARK --selctx system_u:object_r:myauth_packet_t
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å‘ä» 192.168.1.2:443 ä»¥TCPæ–¹å¼å‘å‡ºåˆ°æœ¬æœºçš„åŒ…æ·»åŠ MACå®‰å…¨ä¸Šä¸‹æ–‡ system_u:object_r:myauth_packet_t</span></span></span></code></pre></div><ul>
<li><!-- raw HTML omitted -->é˜²<!-- raw HTML omitted --><code>CC</code><!-- raw HTML omitted -->æ”»å‡»<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ iptables -L -F -A -D <span style="color:#75715e"># list flush append delete</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åœºæ™¯ä¸€</span>
</span></span><span style="display:flex;"><span>$ iptables -I INPUT -p tcp --dport <span style="color:#ae81ff">80</span> -j ACCEPT <span style="color:#75715e"># å…è®¸ tcp 80 ç«¯å£</span>
</span></span><span style="display:flex;"><span>$ iptables -I INPUT -p tcp --dport 10:22 -j ACCEPT <span style="color:#75715e"># å…è®¸ tcp 10-22 ç«¯å£</span>
</span></span><span style="display:flex;"><span>$ iptables -I INPUT -p icmp -j ACCEPT <span style="color:#75715e"># å…è®¸ icmp</span>
</span></span><span style="display:flex;"><span>$ iptables -A INPUT -j REJECT <span style="color:#75715e"># æ·»åŠ ä¸€æ¡è§„åˆ™, ä¸å…è®¸æ‰€æœ‰</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä¼˜åŒ–åœºæ™¯ä¸€</span>
</span></span><span style="display:flex;"><span>$ iptables -I INPUT -i lo -j ACCEPT <span style="color:#75715e"># å…è®¸æœ¬æœºè®¿é—®</span>
</span></span><span style="display:flex;"><span>$ iptables -I INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT <span style="color:#75715e"># å…è®¸è®¿é—®å¤–ç½‘</span>
</span></span><span style="display:flex;"><span>$ iptables -I INPUT -p tcp --dport <span style="color:#ae81ff">80</span> -s 10.10.188.233 -j ACCEPT <span style="color:#75715e"># åªå…è®¸å›ºå®šipè®¿é—®80</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åœºæ™¯äºŒ</span>
</span></span><span style="display:flex;"><span>$ vi /etc/vsftpd/vsftpd.conf <span style="color:#75715e"># ä½¿ç”¨ vsftpd å¼€å¯ ftp ä¸»åŠ¨æ¨¡å¼</span>
</span></span><span style="display:flex;"><span>port_enable<span style="color:#f92672">=</span>yes
</span></span><span style="display:flex;"><span>connect_from_port_20<span style="color:#f92672">=</span>YES
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ iptables -I INPUT -p tcp --dport <span style="color:#ae81ff">21</span> -j ACCEPT
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ vi /etc/vsftpd/vsftpd.conf <span style="color:#75715e"># å»ºè®®ä½¿ç”¨ ftp è¢«åŠ¨æ¨¡å¼</span>
</span></span><span style="display:flex;"><span>pasv_min_port<span style="color:#f92672">=</span><span style="color:#ae81ff">50000</span>
</span></span><span style="display:flex;"><span>pasv_max_port<span style="color:#f92672">=</span><span style="color:#ae81ff">60000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ iptables -I INPUT -p tcp --dport <span style="color:#ae81ff">21</span> -j ACCEPT
</span></span><span style="display:flex;"><span>$ iptables -I INPUT -p tcp --dport 50000:60000 -j ACCEPT
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è¿˜å¯ä»¥ä½¿ç”¨ iptables æ¨¡å—è¿½è¸ªæ¥è‡ªåŠ¨å¼€å‘å¯¹åº”çš„ç«¯å£</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åœºæ™¯ä¸‰</span>
</span></span><span style="display:flex;"><span>$ iptables -I INPUT -i lo -j ACCEPT <span style="color:#75715e"># å…è®¸æœ¬æœºè®¿é—®</span>
</span></span><span style="display:flex;"><span>$ iptables -I INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT <span style="color:#75715e"># å…è®¸è®¿é—®å¤–ç½‘</span>
</span></span><span style="display:flex;"><span>$ iptables -I INPUT -s 10.10.155.0/24 -j ACCEPT <span style="color:#75715e"># å…è®¸å†…ç½‘è®¿é—®</span>
</span></span><span style="display:flex;"><span>$ iptables -I INPUT -p tcp -m multiport --dports 80,1723 -j ACCEPT <span style="color:#75715e"># å…è®¸ç«¯å£, 80 -&gt; http, 1723 -&gt; vpn</span>
</span></span><span style="display:flex;"><span>$ iptables -A INPUT -j REJECT <span style="color:#75715e"># æ·»åŠ ä¸€æ¡è§„åˆ™, ä¸å…è®¸æ‰€æœ‰</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ iptables-save <span style="color:#75715e"># ä¿å­˜è®¾ç½®åˆ°é…ç½®æ–‡ä»¶</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åœºæ™¯å››</span>
</span></span><span style="display:flex;"><span>$ iptables -t nat -L <span style="color:#75715e"># æŸ¥çœ‹ nat é…ç½®</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ iptables -t nat -A POST_ROUTING -s 10.10.177.0/24 -j SNAT --to 10.10.188.232 <span style="color:#75715e"># SNAT</span>
</span></span><span style="display:flex;"><span>$ vi /etc/sysconfig/network <span style="color:#75715e"># é…ç½®ç½‘å…³</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ iptables -t nat -A POST_ROUTING -d 10.10.188.232 -p tcp --dport <span style="color:#ae81ff">80</span> -j DNAT --to 10.10.177.232:80 <span style="color:#75715e"># DNAT</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#åœºæ™¯äº”</span>
</span></span><span style="display:flex;"><span>$ iptables -I INPUT -p tcp --syn --dport <span style="color:#ae81ff">80</span> -m connlimit --connlimit-above <span style="color:#ae81ff">100</span> -j REJECT <span style="color:#75715e"># é™åˆ¶å¹¶å‘è¿æ¥è®¿é—®æ•°</span>
</span></span><span style="display:flex;"><span>$ iptables -I INPUT -m limit --limit 3/hour --limit-burst <span style="color:#ae81ff">10</span> -j ACCEPT <span style="color:#75715e"># limitæ¨¡å—; --limit-burst é»˜è®¤ä¸º5</span></span></span></code></pre></div></blockquote>
<hr>
<h3 id="é…ç½®ipset">é…ç½®<code>Ipset</code></h3>
<ul>
<li>
<ol>
<li><!-- raw HTML omitted -->ä½¿ç”¨<!-- raw HTML omitted --><code>ipset</code><!-- raw HTML omitted -->æé«˜<!-- raw HTML omitted --><code>iptables</code><!-- raw HTML omitted -->çš„æ§åˆ¶æ•ˆç‡<!-- raw HTML omitted --></li>
</ol>
</li>
</ul>
<blockquote>
<ul>
<li>
<p><a href="https://www.cnblogs.com/faberbeta/p/ipset.html" rel="external" target="_self">ä½¿ç”¨<code>ipset</code>æé«˜<code>iptables</code>çš„æ§åˆ¶æ•ˆç‡ </a></p>
</li>
<li>
<p><code>ipset</code><!-- raw HTML omitted -->ä½¿ç”¨<!-- raw HTML omitted --><code>method</code><!-- raw HTML omitted -->(æ–¹æ³•)<!-- raw HTML omitted --></p>
</li>
</ul>
<blockquote>
<ul>
<li>
<p><code>bitmap</code><!-- raw HTML omitted -->ï¼šä½¿ç”¨å›ºå®šå¤§å°çš„å­˜å‚¨<!-- raw HTML omitted --></p>
</li>
<li>
<p><code>hash</code><!-- raw HTML omitted -->ï¼šä½¿ç”¨hashè¡¨æ¥å­˜å‚¨å…ƒç´ <!-- raw HTML omitted --></p>
</li>
<li>
<p><code>list</code><!-- raw HTML omitted -->ï¼šä½¿ç”¨å›ºå®šå¤§å°çš„å­˜å‚¨<!-- raw HTML omitted --></p>
</li>
</ul>
</blockquote>
<ul>
<li><code>ipset</code><!-- raw HTML omitted -->ä½¿ç”¨<!-- raw HTML omitted --><code>datatype</code><!-- raw HTML omitted -->(æ•°æ®ç±»å‹)<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li><code>ip</code><!-- raw HTML omitted -->ï¼šä½¿ç”¨å“ˆå¸Œå­˜å‚¨<code>ip</code>ä¸»æœºåœ°å€(é»˜è®¤)æˆ–ç½‘ç»œåœ°å€ã€‚é›¶å€¼<code>IP</code>åœ°å€ä¸èƒ½å­˜å‚¨åœ¨æ•£åˆ—ä¸­<!-- raw HTML omitted --></li>
<li><code>net</code><!-- raw HTML omitted -->ï¼šä½¿ç”¨é›†åˆå­˜å‚¨ä¸åŒå¤§å°çš„<code>IP</code>ç½‘ç»œæ®µã€‚å‰ç¼€å¤§å°ä¸ºé›¶çš„ç½‘ç»œåœ°å€ä¸èƒ½å­˜å‚¨åœ¨è¿™ç§ç±»å‹çš„é›†åˆä¸­<!-- raw HTML omitted --></li>
<li><code>mac</code></li>
<li><code>port</code><!-- raw HTML omitted -->ï¼šä½¿ç”¨<code>hash</code>å­˜å‚¨<code>IP</code>åœ°å€å’Œç«¯å£å·å¯¹ã€‚ç«¯å£å·ä¸åè®®(é»˜è®¤<code>TCP</code>)ä¸€èµ·ï¼Œä¸èƒ½ä½¿ç”¨é›¶åè®®å·<!-- raw HTML omitted --></li>
<li><code>iface</code></li>
</ul>
</blockquote>
<ul>
<li><!-- raw HTML omitted --><code>create</code>åˆ›å»º<code>ipset</code>é›†åˆã€<code>add</code>æ·»åŠ æ¡ç›®<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li><code>timeout</code><!-- raw HTML omitted -->ï¼šè¶…æ—¶æ—¶é—´ï¼Œå¦‚æœè®¾ç½®ä¸º0ï¼Œè¡¨ç¤ºæ°¸ä¹…ç”Ÿæ•ˆï¼Œè¶…æ—¶æ—¶é—´å¯ä»¥é€šè¿‡<code>-exist</code>æ¥è¿›è¡Œä¿®æ”¹<!-- raw HTML omitted --></li>
<li><code>counters</code><!-- raw HTML omitted -->ï¼šæ”¯æŒ<code>packets</code>åŒ…å’Œ<code>bytes</code>å­—èŠ‚åˆ›å»ºé›†åˆ<!-- raw HTML omitted --></li>
<li><code>comment</code><!-- raw HTML omitted -->ï¼šå¤‡æ³¨ï¼Œæ³¨é‡Šä¸èƒ½åŒ…å«ä»»ä½•å¼•å·ï¼Œé€šå¸¸çš„è½¬ä¹‰å­—ç¬¦<code>()</code>æ²¡æœ‰ä»»ä½•æ„ä¹‰<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ipset create SetName TypeName  	<span style="color:#75715e"># SetNameï¼šä¸ºè‡ªå®šä¹‰åç§°ï¼ŒTypeNameï¼šä¸ºmethod:datatype</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä¸¾ä¾‹è¯´æ˜</span>
</span></span><span style="display:flex;"><span>$ ipset create mysql hash:ip timeout <span style="color:#ae81ff">3600</span>
</span></span><span style="display:flex;"><span>$ ipset create php hash:ip,port
</span></span><span style="display:flex;"><span>$ ipset create Nginx hash:net
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ·»åŠ æ¡ç›®</span>
</span></span><span style="display:flex;"><span>$ ipset -exist add mysql 127.0.0.1 timeout <span style="color:#ae81ff">7200</span>
</span></span><span style="display:flex;"><span>$ ipset add php 127.0.0.1,9000
</span></span><span style="display:flex;"><span>$ ipset add Nginx 127.0.0.0/8</span></span></code></pre></div></blockquote>
<ul>
<li><code>list</code><!-- raw HTML omitted -->åˆ—å‡ºé›†åˆã€<!-- raw HTML omitted --><code>test</code><!-- raw HTML omitted -->æ£€æŸ¥æ¡ç›®<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ipset list  	<span style="color:#75715e"># åˆ—å‡ºæ‰€æœ‰é›†åˆ</span>
</span></span><span style="display:flex;"><span>$ ipset list mysql  	<span style="color:#75715e"># åˆ—å‡ºæŒ‡å®šé›†åˆ</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ ipset test mysql 127.0.0.1</span></span></code></pre></div><ul>
<li><code>del</code><!-- raw HTML omitted -->æŸæ¡ï¼Œ<!-- raw HTML omitted --><code>flush</code><!-- raw HTML omitted -->æ¸…ç©ºé›†åˆæ¡ç›®<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ipset del mysql 127.0.0.1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ ipset flush Nginx</span></span></code></pre></div><ul>
<li><code>destroy</code><!-- raw HTML omitted -->åˆ é™¤é›†åˆ<!-- raw HTML omitted --></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ipset destroy  	<span style="color:#75715e"># åˆ é™¤æ‰€æœ‰é›†åˆ</span>
</span></span><span style="display:flex;"><span>$ ipset destroy mysql  	<span style="color:#75715e"># åˆ é™¤æŒ‡å®šé›†åˆ</span></span></span></code></pre></div><ul>
<li><!-- raw HTML omitted -->åœ¨<!-- raw HTML omitted --><code>iptables</code><!-- raw HTML omitted -->ä¸­ä½¿ç”¨<!-- raw HTML omitted --><code>ipse</code>ï¼Œ<!-- raw HTML omitted -->åªè¦åŠ ä¸Š<!-- raw HTML omitted --><code>-m set --match-set</code><!-- raw HTML omitted -->å³å¯<!-- raw HTML omitted --></li>
</ul>
<blockquote>
<ul>
<li><!-- raw HTML omitted -->ç›®çš„<!-- raw HTML omitted --><code>ip</code><!-- raw HTML omitted -->ä½¿ç”¨<!-- raw HTML omitted --><code>ipset</code></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ iptables -I INPUT -s 192.168.88.110 -m set --match-set Nginx dst -j DROP</span></span></code></pre></div><ul>
<li><!-- raw HTML omitted -->æº<!-- raw HTML omitted --><code>ip</code><!-- raw HTML omitted -->ä½¿ç”¨<!-- raw HTML omitted --><code>ipset</code></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ iptables -I INPUT -m set --match-set Nginx src -d 192.168.88.110  -j DROP</span></span></code></pre></div><ul>
<li><!-- raw HTML omitted -->æºå’Œç›®çš„éƒ½ä½¿ç”¨<!-- raw HTML omitted --><code>ipset</code></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ iptables -I INPUT -m set --match-set Nginx src -m set --match-set mysql dst -j DROP</span></span></code></pre></div></blockquote>
</blockquote>
<hr>
<h3 id="é…ç½®hostsallowå’Œhostsdeny">é…ç½®<code>hosts.allow</code>å’Œ<code>hosts.deny</code></h3>
<ul>
<li>
<ol>
<li><code>/etc/hosts.allow</code>ï¼šæ–‡ä»¶é…ç½®</li>
</ol>
</li>
</ul>
<blockquote>
<ul>
<li>
<p><a href="https://www.cnblogs.com/EasonJim/p/8338931.html" rel="external" target="_self">ä½¿ç”¨<code>hosts.allow</code>å’Œ<code>hosts.deny</code>å®ç°ç®€å•çš„é˜²ç«å¢™</a></p>
</li>
<li>
<p><a href="https://cloud.tencent.com/developer/article/1533595" rel="external" target="_self"><code>SSH</code>ä¹‹<code>hosts.allow</code>å’Œ<code>hosts.deny</code>æ–‡ä»¶</a></p>
</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cat &gt;/etc/hosts.allow<span style="color:#e6db74">&lt;&lt;EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># Jenkins
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">sshd:IP:allow 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># jumpserver
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">sshd:IP:allow 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># local ç½‘æ®µ
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">sshd:192.168.0.:allow
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># å†…è¿æ•°æ®åº“
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">sshd:IP:allow
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">nfsd:ALL
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">sshd:all:deny
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span></span></span></code></pre></div></blockquote>
<hr>

            <footer class="footline">
            </footer>
          </article>

        </div>
      </main>
    </div>
    <script src="../../../../js/clipboard.min.js?1721991566" defer></script>
    <script src="../../../../js/perfect-scrollbar.min.js?1721991566" defer></script>
    <script src="../../../../js/theme.js?1721991566" defer></script>
  </body>
</html>
