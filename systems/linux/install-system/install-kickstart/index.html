<!doctype html><html lang=zh-CN data-theme=light><head><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: light)"><meta name=generator content="Hugo 0.125.4"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="Install Kickstart"><meta itemprop=description content="Install-Kickstart"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://erge.blog/imgs/s2-1.jpg"><meta itemprop=keywords content="System,Kickstart"><meta property="og:type" content="article"><meta property="og:title" content="Install Kickstart"><meta property="og:description" content="Install-Kickstart"><meta property="og:image" content="/imgs/s2-1.jpg"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://erge.blog/systems/linux/install-system/install-kickstart/"><meta property="og:site_name" content="二哥"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="二哥"><meta property="article:published_time" content="2022-11-19 17:43:00 +0800 CST"><meta property="article:modified_time" content="2022-11-19 17:43:00 +0800 CST"><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.css><link rel=stylesheet href=/css/main.min.0d420b6f564e6674edd4354ea71c0458a83f95ad464a75114b23d72515b1456c.css><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":true,"isHome":false,"isPage":true,"path":"install-kickstart","permalink":"https://erge.blog/systems/linux/install-system/install-kickstart/","title":"Install Kickstart","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>Install Kickstart - 二哥</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>二哥</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>Linux、Kubernetes、Docker、Python、CI/CD、Jenkins、Mysql、Nginx、Gitlab、Ansible、Zabbix</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-Home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-categories"><a href=/categories/ class=hvr-icon-pulse rel=section><i class="fa fa-th hvr-icon"></i>分类</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>0</span></a></li><li class="menu-item menu-item-tags"><a href=/tags/ class=hvr-icon-pulse rel=section><i class="fa fa-tags hvr-icon"></i>标签</a></li><li class="menu-item menu-item-tools"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-tools hvr-icon"></i>工具</a></li><li class="menu-item menu-item-flinks"><a href=/flinks.html class=hvr-icon-pulse rel=section><i class="fa fa-thumbs-up hvr-icon"></i>站点示例</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-Commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#kickstart无人值守安装linux><code>KICKSTART</code>无人值守安装<code>Linux</code></a><ul><li><a href=#名词介绍>名词介绍</a></li><li><a href=#pxekickstart工作流程><code>PXE</code>+<code>Kickstart</code>工作流程</a></li><li><a href=#安装>安装</a><ul><li><a href=#dhcp安装配置><code>DHCP</code>安装配置</a></li><li><a href=#解释配置>解释配置</a></li><li><a href=#tftp安装配置><code>TFTP</code>安装配置</a></li><li><a href=#http安装配置><code>HTTP</code>安装配置</a></li><li><a href=#配置解释>配置解释</a></li><li><a href=#创建kscfg文件>创建<code>ks.cfg</code>文件</a></li><li><a href=#编写kscfg文件>编写<code>ks.cfg</code>文件</a></li><li><a href=#无人值守安装系统>无人值守安装系统</a></li></ul></li></ul></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=二哥 src=/imgs/img-lazy-loading.gif data-src=/imgs/s2-1.jpg><p class=site-author-name itemprop=name>二哥</p><div class=site-description itemprop=description>The man who has made up his mind to win will never say impossible – Napoleon Bonaparte</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>0</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>51</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>149</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=qq%e5%8f%b7 title="QQ → qq号" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-qq fa-fw hvr-icon"></i>
QQ
</a></span><span class=links-of-social-item><a href=https://www.zhihu.com/people/lisenhui title="知乎 → https://www.zhihu.com/people/lisenhui" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎
</a></span><span class=links-of-social-item><a href=qq@qq.com title="E-Mail → qq@qq.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>
E-Mail
</a></span><span class=links-of-social-item><a href=https://weibo.com/yourname title="Weibo → https://weibo.com/yourname" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-weibo fa-fw hvr-icon"></i>
Weibo
</a></span><span class=links-of-social-item><a href="https://www.youtube.com/watch?v=RgKAFK5djSk" title="Youtube → https://www.youtube.com/watch?v=RgKAFK5djSk" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-youtube fa-fw hvr-icon"></i>
Youtube
</a></span><span class=links-of-social-item><a href=https://github.com/elkan1788 title="Github → https://github.com/elkan1788" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li><li class=links-of-blogroll-item><a href=https://lisenhui.cn title=https://lisenhui.cn target=_blank>凡梦星尘空间站</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=goto-gtranslate class=button title=多语言翻译><i class="fas fa-globe"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/hugo-next rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg>
</a><script type=text/javascript src=//sidecar.gitter.im/dist/sidecar.v1.js async></script><script type=text/javascript>((window.gitter={}).chat={}).options={room:"hugo-next/community"}</script><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://erge.blog/systems/linux/install-system/install-kickstart/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/s2-1.jpg"><meta itemprop=name content="二哥"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="二哥"><meta itemprop=description content="The man who has made up his mind to win will never say impossible – Napoleon Bonaparte"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="Install Kickstart"><meta itemprop=description content="Install-Kickstart"></span><header class=post-header><h1 class=post-title itemprop="name headline">Install Kickstart
<a href=https://github.com/user-name/repo-name/tree/branch-name/subdirectory-name/Systems/Linux/Install-System/Install-Kickstart.md rel="noopener external nofollow noreferrer" target=_blank class="exturl post-edit-link" title=编辑><i class="fa fa-pen-nib"></i></a></h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2022-11-19 17:43:00 +0800 CST" itemprop="dateCreated datePublished" datetime="2022-11-19 17:43:00 +0800 CST">2022-11-19
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/system itemprop=url rel=index><span itemprop=name>System</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="far fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>5209</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="far fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>11分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="far fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=busuanzi_value_page_pv data-path=/systems/linux/install-system/install-kickstart/><i class="fa fa-sync fa-spin"></i>
</span></span><span class=post-meta-item title><span class=post-meta-item-icon><i class="far fa-comments"></i>
</span><span class=post-meta-item-text title=评论>评论：
</span><span id=comments-count class=waline-comment-count data-path=/systems/linux/install-system/install-kickstart/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><h2 id=kickstart无人值守安装linux><code>KICKSTART</code>无人值守安装<code>Linux</code>
<a class=header-anchor href=#kickstart%e6%97%a0%e4%ba%ba%e5%80%bc%e5%ae%88%e5%ae%89%e8%a3%85linux></a></h2><h3 id=名词介绍>名词介绍
<a class=header-anchor href=#%e5%90%8d%e8%af%8d%e4%bb%8b%e7%bb%8d></a></h3><div class="note info"><ul><li><ol><li><code>pxe</code></li></ol></li></ul><blockquote><ul><li><code>PXE</code>使用<code>DHCP</code>（动态主机配置协议）和<code>TFTP</code>（普通文件传送协议）从网络上查找并装载引导程序。<code>PXE</code>环境从<code>NIC</code>（<code>Network Interface Card</code>）上的<code>BIOS</code>装载。预引导服务使用<code>PXE</code>来发现设备是否存在为其指定的预引导服务工作，并向设备提供执行指派工作所需的文件。通过使用预引导服务，可以自动将映像放置到设备上，即使设备的硬盘为空</li></ul></blockquote><ul><li><ol start=2><li><code>pxelinux.0</code></li></ol></li></ul><blockquote><ul><li>主要作用是装载执行指派的预引导工作所需的操作系统。<code>pxelinux.0</code>文件是<code>syslinux</code>这一开放源代码项目的一部分的改进版本。虽然<code>pxelinux.0</code>主要是<code>Linux</code>加载器，但它也可以装载其他操作系统。它的工作方式是使用位于<code>TFTP</code>服务器上的配置文件来提供引导指令</li></ul></blockquote><ul><li><ol start=3><li><code>vmlinuz</code></li></ol></li></ul><blockquote><ul><li><code>vmlinuz</code>是<code>Linux</code>内核的镜像文件,可以被引导程序加载,从而启动<code>Linux</code>系统</li></ul></blockquote><ul><li><ol start=4><li><code>initrd</code></li></ol></li></ul><blockquote><ul><li><p><code>initrd</code>&mdash;-<code>boot loader initialized RAM disk</code>(全称)，是一种启动<code>Linux</code>系统的方式，当前流行的<code>Linux</code>版本一般都采用模块化的内核,这种方式可以在不重新编译构建内核的情形下增加功能模块，但是如果你的<code>Linux</code>的<code>root</code>文件系统所在设备的驱动是一个模块(没有编译进内核映象),就不能被引导程序(例如<code>loadlin</code>)直接加载，这时会用到<code>initrd</code>方式来启动你的<code>Linux</code>系统</p><p>这种方式包括两个阶段:</p><ol><li>在一个<code>RAM disk</code>上建立一个临时的<code>root</code>文件系统,在这个<code>RAM disk</code>上包含着你需要的驱动模块</li></ol><p>2)载入所需驱动模块,挂载实际的<code>root</code>文件系统 ,启动<code>Linux</code></p></li></ul></blockquote><ul><li><ol start=5><li><code>initrd.img</code></li></ol></li></ul><blockquote><ul><li>就是<code>RAM disk</code>的映象</li></ul></blockquote></div><h3 id=pxekickstart工作流程><code>PXE</code>+<code>Kickstart</code>工作流程
<a class=header-anchor href=#pxekickstart%e5%b7%a5%e4%bd%9c%e6%b5%81%e7%a8%8b></a></h3><div class="note info"><ul><li><ol><li><code>Kickstart</code>是一种无人值守的安装方式。它的工作原理是在安装过程中记录典型的需要人工干预填写的各种参数，并生成一个名为<code>ks.cfg</code>的文件。如果在安装过程中（不只局限于生成<code>Kickstart</code>安装文件的机器）出现要填写参数的情况，安装程序首先会去查找<code>Kickstart</code>生成的文件，如果找到合适的参数，就采用所找到的参数；如果没有找到合适的参数，便需要安装者手工干预了。所以，如果<code>Kickstart</code>文件涵盖了安装过程中可能出现的所有需要填写的参数，那么安装者完全可以只告诉安装程序从何处取<code>ks.cfg</code>文件，然后就去忙自己的事情。等安装完毕，安装程序会根据<code>ks.cfg</code>中的设置重启系统，并结束安装</li></ol></li><li><ol start=2><li><code>PXE</code>+<code>Kickstart</code>无人值守安装操作系统完整过程如下</li></ol></li></ul><blockquote><p><img src=/imgs/img-lazy-loading.gif data-src=https://raw.githubusercontent.com/usermice/images/master/Deploy_Server/PXE+Kickstart.png alt></p></blockquote><ul><li><ol start=3><li><code>PXE Client</code>向<code>DHCP</code>发送请求</li></ol></li></ul><blockquote><ul><li><code>PXE Client</code>从自己的<code>PXE</code>网卡启动，通过<code>PXE BootROM</code>(自启动芯片)会以<code>UDP</code>(简单用户数据报协议)发送一个广播请求，向本网络中的<code>DHCP</code>服务器索取<code>IP</code></li></ul></blockquote><ul><li><ol start=4><li><code>DHCP</code>服务器提供信息</li></ol></li></ul><blockquote><ul><li><code>DHCP</code>服务器收到客户端的请求，验证是否来至合法的<code>PXE Client</code>的请求，验证通过它将给客户端一个<code>提供</code>响应，这个<code>提供</code>响应中包含了为客户端分配的<code>IP</code>地址、<code>pxelinux</code>启动程序(<code>TFTP</code>)位置，以及配置文件所在位置</li></ul></blockquote><ul><li><ol start=5><li><code>PXE</code>客户端请求下载启动文件</li></ol></li></ul><blockquote><ul><li>客户端收到服务器的<code>回应</code>后，会回应一个帧，以请求传送启动所需文件。这些启动文件包括：<code>pxelinux.0</code>、<code>pxelinux.cfg/default</code>、<code>vmlinuz</code>、<code>initrd.img</code>等文件</li></ul></blockquote><ul><li><ol start=6><li><code>Boot Server</code>响应客户端请求并传送文件</li></ol></li></ul><blockquote><ul><li>当服务器收到客户端的请求后，他们之间之后将有更多的信息在客户端与服务器之间作应答, 用以决定启动参数。<code>BootROM</code>由<code>TFTP</code>通讯协议从<code>Boot Server</code>下载启动安装程序所必须的文件(<code>pxelinux.0</code>、<code>pxelinux.cfg/default</code>)。<code>default</code>文件下载完成后，会根据该文件中定义的引导顺序，启动<code>Linux</code>安装程序的引导内核</li></ul></blockquote><ul><li><ol start=7><li>请求下载自动应答文件</li></ol></li></ul><blockquote><ul><li>客户端通过<code>pxelinux.cfg/default</code>文件成功的引导<code>Linux</code>安装内核后，安装程序首先必须确定你通过什么安装介质来安装<code>linux</code>，如果是通过网络安装(<code>NFS</code>, <code>FTP</code>, <code>HTTP</code>)，则会在这个时候初始化网络，并定位安装源位置。接着会读取<code>default</code>文件中指定的自动应答文件<code>ks.cfg</code>所在位置，根据该位置请求下载该文件</li></ul></blockquote><ul><li><ol start=8><li>客户端安装操作系统</li></ol></li></ul><blockquote><ul><li><p>将<code>ks.cfg</code>文件下载回来后，通过该文件找到<code>OS Server</code>，并按照该文件的配置请求下载安装过程需要的软件包。</p><p><code>OS Server</code>和客户端建立连接后，将开始传输软件包，客户端将开始安装操作系统。安装完成后，将提示重新引导计算机</p></li></ul></blockquote></div><h3 id=安装>安装
<a class=header-anchor href=#%e5%ae%89%e8%a3%85></a></h3><div class="note info"><ul><li><ol><li><code>Kickstart</code>的安装方式有多种组合，<code>Kickstart</code>+<code>DHCP</code>+<code>TFTP</code>+<code>HTTP/NFS/FTP</code>等，不管是<code>HTTP、NFS</code>或者<code>FTP</code>，都是为了寻找到系统引导后需要安装的包组等文件。下面的安装方式是<code>Kickstart</code>+<code>DHCP</code>+<code>TFTP</code>+<code>HTTP</code></li></ol></li></ul></div><h4 id=dhcp安装配置><code>DHCP</code>安装配置
<a class=header-anchor href=#dhcp%e5%ae%89%e8%a3%85%e9%85%8d%e7%bd%ae></a></h4><div class="note info"><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ yum -y install dhcp
</span></span><span style=display:flex><span>$ vim /etc/dhcp/dhcpd.conf
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># DHCP Server Configuration file.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#  see /usr/share/doc/dhcp*/dhcpd.conf.sample</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#  see &#39;man 5 dhcpd.conf&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span>subnet 10.0.0.0 netmask 255.255.255.0 <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    range 10.0.0.201 10.0.0.210;
</span></span><span style=display:flex><span>    option subnet-mask 255.255.255.0;
</span></span><span style=display:flex><span>    default-lease-time 21600;
</span></span><span style=display:flex><span>    max-lease-time 43200;
</span></span><span style=display:flex><span>    next-server 10.0.0.61;
</span></span><span style=display:flex><span>    filename <span style=color:#e6db74>&#34;/pxelinux.0&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;/etc/dhcp/dhcpd.conf&#34;</span> 13L, 360C 已写入
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ /etc/init.d/dhcpd start
</span></span><span style=display:flex><span>正在启动 dhcpd：                      <span style=color:#f92672>[</span>确定<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>$ netstat -lntup|grep dhcp
</span></span><span style=display:flex><span>udp    <span style=color:#ae81ff>0</span>   <span style=color:#ae81ff>0</span> 0.0.0.0:67         0.0.0.0:*                2040/dhcpd
</span></span></code></pre></div></blockquote></div><h4 id=解释配置>解释配置
<a class=header-anchor href=#%e8%a7%a3%e9%87%8a%e9%85%8d%e7%bd%ae></a></h4><div class="note info"><blockquote><ul><li><ol><li><code>/etc/dhcp/dhcpd.conf</code></li></ol></li><li><ol start=2><li><code>range 10.0.0.100 10.0.0.200;</code> # 可分配的起始<code>IP</code>-结束<code>IP</code></li></ol></li><li><ol start=3><li><code>option subnet-mask 255.255.255.0;</code> # 设定<code>netmask</code></li></ol></li><li><ol start=4><li><code>default-lease-time 21600;</code> # 设置默认的<code>IP</code>租用期限</li></ol></li><li><ol start=5><li><code>max-lease-time 43200;</code> # 设置最大的<code>IP</code>租用期限</li></ol></li><li><ol start=6><li><code>next-server 10.0.0.7;</code> # 告知客户端<code>TFTP</code>服务器的<code>ip</code></li></ol></li><li><ol start=7><li><code>filename "/pxelinux.0";</code> # 告知客户端从<code>TFTP</code>根目录下载<code>pxelinux.0</code>文件</li></ol></li><li><ol start=8><li>注意：</li></ol></li></ul><blockquote><ul><li>8.1 如果机器数量过多的话，注意<code>dhcp</code>服务器的地址池，不要因为耗尽<code>IP</code>而导致<code>dhcpd</code>服务器没有<code>IP</code>地址<code>release</code>的情况</li><li>8.2 本来软件装完后都要加入开机自启动，但这个<code>Kickstart</code>系统就不能开机自启动，而且用完后服务都要关闭，防止未来重启服务器自动重装系统了</li></ul></blockquote></blockquote></div><h4 id=tftp安装配置><code>TFTP</code>安装配置
<a class=header-anchor href=#tftp%e5%ae%89%e8%a3%85%e9%85%8d%e7%bd%ae></a></h4><div class="note info"><ul><li><ol><li><code>TFTP</code>服务器提供文件使用简单文件传输协议。<code>TFTP</code>协议通常用于启动无盘工作站，下载配置文件到客户端，并开始对部分操作系统的安装过程</li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ yum -y install tftp.server
</span></span><span style=display:flex><span>$ vim /etc/xinetd.d/tftp 
</span></span><span style=display:flex><span><span style=color:#75715e># default: off</span>
</span></span><span style=display:flex><span><span style=color:#75715e># description: The tftp server serves files using the trivial file transfer \</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#    protocol. The tftp protocol is often used to boot diskless \</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#    workstations, download configuration files to network-aware printers, \</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#    and to start the installation process for some operating systems.</span>
</span></span><span style=display:flex><span>service tftp
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    socket_type       <span style=color:#f92672>=</span> dgram
</span></span><span style=display:flex><span>    protocol        <span style=color:#f92672>=</span> udp
</span></span><span style=display:flex><span>    wait          <span style=color:#f92672>=</span> yes
</span></span><span style=display:flex><span>    user          <span style=color:#f92672>=</span> root
</span></span><span style=display:flex><span>    server         <span style=color:#f92672>=</span> /usr/sbin/in.tftpd
</span></span><span style=display:flex><span>    server_args       <span style=color:#f92672>=</span> -s /var/lib/tftpboot
</span></span><span style=display:flex><span>    disable         <span style=color:#f92672>=</span> no
</span></span><span style=display:flex><span>    per_source       <span style=color:#f92672>=</span> <span style=color:#ae81ff>11</span>
</span></span><span style=display:flex><span>    cps           <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    flags          <span style=color:#f92672>=</span> IPv4
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;/etc/xinetd.d/tftp&#34;</span> 18L, 517C 已写入
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ /etc/init.d/xinetd restart
</span></span><span style=display:flex><span>停止 xinetd：                       <span style=color:#f92672>[</span>确定<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>正在启动 xinetd：                     <span style=color:#f92672>[</span>确定<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ netstat -lntup|grep xinetd
</span></span><span style=display:flex><span>udp    <span style=color:#ae81ff>0</span>   <span style=color:#ae81ff>0</span> 0.0.0.0:69         0.0.0.0:*                2066/xinetd
</span></span></code></pre></div></blockquote><ul><li><ol start=2><li>配置解释</li></ol></li></ul><blockquote><ul><li>2.1 <code>server_args</code> = <code>-s /var/lib/tftpboot</code> # 指定<code>boot</code>启动目录，保持默认</li><li>2.2 <code>disable</code> = <code>yes</code> # <code>no</code>改为<code>yes</code></li></ul></blockquote></div><h4 id=http安装配置><code>HTTP</code>安装配置
<a class=header-anchor href=#http%e5%ae%89%e8%a3%85%e9%85%8d%e7%bd%ae></a></h4><div class="note info"><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ yum -y install httpd
</span></span><span style=display:flex><span>$ sed -i <span style=color:#e6db74>&#34;277i ServerName 127.0.0.1:80&#34;</span> /etc/httpd/conf/httpd.conf
</span></span><span style=display:flex><span>$ /etc/init.d/httpd start
</span></span><span style=display:flex><span>正在启动 httpd：                      <span style=color:#f92672>[</span>确定<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ netstat -lntup|grep <span style=color:#e6db74>&#34;httpd&#34;</span>
</span></span><span style=display:flex><span>tcp    <span style=color:#ae81ff>0</span>   <span style=color:#ae81ff>0</span> :::80            :::*            LISTEN   2085/httpd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ mkdir /var/www/html/CentOS-6.7
</span></span><span style=display:flex><span>$ mount /dev/cdrom /var/www/html/CentOS-6.7/
</span></span><span style=display:flex><span>mount: block device /dev/sr0 is write-protected, mounting read-only
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ df -h
</span></span><span style=display:flex><span>Filesystem   Size Used Avail Use% Mounted on
</span></span><span style=display:flex><span>/dev/sda3    8.8G 1.5G 6.9G 18% /
</span></span><span style=display:flex><span>tmpfs      495M   <span style=color:#ae81ff>0</span> 495M  0% /dev/shm
</span></span><span style=display:flex><span>/dev/sda1    190M  36M 145M 20% /boot
</span></span><span style=display:flex><span>/dev/sr0    3.7G 3.7G   <span style=color:#ae81ff>0</span> 100% /var/www/html/CentOS-6.7
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cat nginx.conf
</span></span><span style=display:flex><span>worker_processes 1;
</span></span><span style=display:flex><span>events <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  worker_connections 1024;
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>http <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  include    mime.types;
</span></span><span style=display:flex><span>  default_type application/octet-stream;
</span></span><span style=display:flex><span>  sendfile    on;
</span></span><span style=display:flex><span>  keepalive_timeout 65;
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>\#</span>include set
</span></span><span style=display:flex><span>  include extra/www.conf;
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cat extra/www.conf 
</span></span><span style=display:flex><span>server <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    listen    80;
</span></span><span style=display:flex><span>    server_name www.ky.com;
</span></span><span style=display:flex><span>    autoindex on;
</span></span><span style=display:flex><span>    location / <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>      root  /var/www/html/;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ fuser -k 80/tcp 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 杀死因前面开启httpd服务占用80的端口进程，然后就可以开启nginx服务</span>
</span></span></code></pre></div></blockquote></div><h4 id=配置解释>配置解释
<a class=header-anchor href=#%e9%85%8d%e7%bd%ae%e8%a7%a3%e9%87%8a></a></h4><div class="note info"><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ sed -i <span style=color:#e6db74>&#34;277i ServerName 127.0.0.1:80&#34;</span> /etc/httpd/conf/httpd.conf
</span></span></code></pre></div></blockquote><ul><li><ol><li><code>ServerName</code>指定<code>Nginx</code>用于识别自身的名字和端口号。通常这个值是自动指定的，但是我们推荐你显式的指定它以防止启动时出错。如果你为你的主机指定了一个无效的<code>DNS</code>名，<code>server-generated</code>重定向将不能工作</li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ mount /dev/cdrom /var/www/html/CentOS-6.7/
</span></span></code></pre></div></blockquote><ul><li><ol start=2><li>将<code>CentOS-6.7</code>挂载到<code>http</code>服务下</li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ cat extra/www.conf 
</span></span><span style=display:flex><span>server <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    listen    80;
</span></span><span style=display:flex><span>    server_name www.ky.com;  	<span style=color:#75715e># 域名设置</span>
</span></span><span style=display:flex><span>    autoindex on;  	<span style=color:#75715e># 不找首页文件，展示目录结构</span>
</span></span><span style=display:flex><span>    location / <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>         root  /var/www/html/;  	<span style=color:#75715e># 显示网页内容的文件目录路径</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div></blockquote><ul><li><ol start=3><li>访问浏览器<code>10.0.0.61/CentOS-6.7/</code>查看配置是否正确</li></ol></li></ul><blockquote><p><img src=/imgs/img-lazy-loading.gif data-src=https://raw.githubusercontent.com/usermice/images/master/Deploy_Server/Index.png alt></p></blockquote></div><h5 id=syslinux安装配置><code>syslinux</code>安装配置
<a class=header-anchor href=#syslinux%e5%ae%89%e8%a3%85%e9%85%8d%e7%bd%ae></a></h5><div class="note info"><blockquote><ul><li><ol><li><code>syslinux</code>是一个功能强大的引导加载程序，而且兼容各种介质。<code>SYSLINUX</code>是一个小型的<code>Linux</code>操作系统，它的目的是简化首次安装<code>Linux</code>的时间，并建立修护或其它特殊用途的启动盘。如果没有找到<code>pxelinux.0</code>这个文件,可以安装一下</li></ol></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ yum -y install syslinux
</span></span><span style=display:flex><span>$ cp /usr/share/syslinux/pxelinux.0 /var/lib/tftpboot/
</span></span><span style=display:flex><span>$ cp -a /var/www/html/CentOS-6.7/isolinux/* /var/lib/tftpboot/
</span></span><span style=display:flex><span>$ mkdir -p /var/lib/tftpboot/pxelinux.cfg
</span></span><span style=display:flex><span>$ cp /var/www/html/CentOS-6.7/isolinux/isolinux.cfg /var/lib/tftpboot/pxelinux.cfg/default
</span></span></code></pre></div></blockquote></div><h5 id=编辑default文件>编辑<code>default</code>文件
<a class=header-anchor href=#%e7%bc%96%e8%be%91default%e6%96%87%e4%bb%b6></a></h5><div class="note info"><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ cat /var/lib/tftpboot/pxelinux.cfg/default  
</span></span><span style=display:flex><span>default ks
</span></span><span style=display:flex><span>prompt <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>label ks
</span></span><span style=display:flex><span> kernel vmlinuz
</span></span><span style=display:flex><span> append initrd<span style=color:#f92672>=</span>initrd.img ks<span style=color:#f92672>=</span>http://10.0.0.61/ks_config/CentOS-6.7-ks.cfg ksdevice<span style=color:#f92672>=</span>eth0
</span></span></code></pre></div></blockquote></div><h5 id=解释配置-1>解释配置
<a class=header-anchor href=#%e8%a7%a3%e9%87%8a%e9%85%8d%e7%bd%ae-1></a></h5><div class="note info"><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ cp /usr/share/syslinux/pxelinux.0 /var/lib/tftpboot/ 
</span></span></code></pre></div><ul><li><ol><li>将<code>sysliunx</code>的<code>pxelinux.0</code>文件拷贝到<code>tftp</code>启动目录下</li></ol></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ cp -a /var/www/html/CentOS-6.7/isolinux/* /var/lib/tftpboot/
</span></span></code></pre></div><ul><li><ol start=2><li>将<code>/var/www/html/CentOS-6.7/isolinux/*</code>下的所有系统引导安装的文件拷贝到<code>tftp</code>启动目录下</li></ol></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ mkdir -p /var/lib/tftpboot/pxelinux.cfg
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cp /var/www/html/CentOS-6.7/isolinux/isolinux.cfg /var/lib/tftpboot/pxelinux.cfg/default
</span></span></code></pre></div><ul><li><ol start=3><li>将<code>isolinux.cfg</code>文件拷贝到<code>tftp</code>启动目录下的<code>pxelinux.cfg</code>目录下并改名为<code>default</code></li></ol></li></ul></blockquote></div><h5 id=说明>说明
<a class=header-anchor href=#%e8%af%b4%e6%98%8e></a></h5><div class="note info"><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ cat /var/www/html/CentOS-6.7/isolinux/isolinux.cfg 
</span></span><span style=display:flex><span>default vesamenu.c32 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 默认加载一个菜单</span>
</span></span><span style=display:flex><span><span style=color:#75715e># prompt 1 </span>
</span></span><span style=display:flex><span><span style=color:#75715e># 开启会显示命令行&#39;boot: &#39;提示符。prompt值为0时则不提示，将会直接启动&#39;default&#39;参数中指定的内容</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>timeout <span style=color:#ae81ff>600</span> 
</span></span><span style=display:flex><span><span style=color:#75715e># timeout时间是引导时等待用户手动选择的时间，设为1可直接引导，单位为1/10秒</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>display boot.msg 
</span></span><span style=display:flex><span><span style=color:#75715e># 菜单背景图片、标题、颜色</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>menu background splash.jpg
</span></span><span style=display:flex><span>menu title Welcome to CentOS 6.7!
</span></span><span style=display:flex><span>menu color border <span style=color:#ae81ff>0</span> <span style=color:#75715e>#ffffffff #00000000</span>
</span></span><span style=display:flex><span>menu color sel <span style=color:#ae81ff>7</span> <span style=color:#75715e>#ffffffff #ff000000</span>
</span></span><span style=display:flex><span>menu color title <span style=color:#ae81ff>0</span> <span style=color:#75715e>#ffffffff #00000000</span>
</span></span><span style=display:flex><span>menu color tabmsg <span style=color:#ae81ff>0</span> <span style=color:#75715e>#ffffffff #00000000</span>
</span></span><span style=display:flex><span>menu color unsel <span style=color:#ae81ff>0</span> <span style=color:#75715e>#ffffffff #00000000</span>
</span></span><span style=display:flex><span>menu color hotsel <span style=color:#ae81ff>0</span> <span style=color:#75715e>#ff000000 #ffffffff</span>
</span></span><span style=display:flex><span>menu color hotkey <span style=color:#ae81ff>7</span> <span style=color:#75715e>#ffffffff #ff000000</span>
</span></span><span style=display:flex><span>menu color scrollbar <span style=color:#ae81ff>0</span> <span style=color:#75715e>#ffffffff #00000000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>label linux
</span></span><span style=display:flex><span><span style=color:#75715e># label指定在boot:提示符下输入的关键字，比如boot:linux[ENTER]，这个会启动label linux下标记的kernel和initrd.img文件</span>
</span></span><span style=display:flex><span> menu label ^Install or upgrade an existing system
</span></span><span style=display:flex><span> menu default
</span></span><span style=display:flex><span><span style=color:#75715e># 一个标签就是前面图片的一行选项</span>
</span></span><span style=display:flex><span> kernel vmlinuz 
</span></span><span style=display:flex><span><span style=color:#75715e># 指定要启动的内核。同样要注意路径，默认是/tftpboot目录</span>
</span></span><span style=display:flex><span> append initrd<span style=color:#f92672>=</span>initrd.img 
</span></span><span style=display:flex><span><span style=color:#75715e># 指定追加给内核的参数，initrd.img是一个最小的linux系统</span>
</span></span><span style=display:flex><span>label vesa
</span></span><span style=display:flex><span> menu label Install system with ^basic video driver
</span></span><span style=display:flex><span> kernel vmlinuz
</span></span><span style=display:flex><span> append initrd<span style=color:#f92672>=</span>initrd.img nomodeset
</span></span><span style=display:flex><span>label rescue
</span></span><span style=display:flex><span> menu label ^Rescue installed system
</span></span><span style=display:flex><span> kernel vmlinuz
</span></span><span style=display:flex><span> append initrd<span style=color:#f92672>=</span>initrd.img rescue
</span></span><span style=display:flex><span>label local
</span></span><span style=display:flex><span> menu label Boot from ^local drive
</span></span><span style=display:flex><span> localboot 0xffff
</span></span><span style=display:flex><span>label memtest86
</span></span><span style=display:flex><span> menu label ^Memory test
</span></span><span style=display:flex><span> kernel memtest
</span></span><span style=display:flex><span> append -
</span></span></code></pre></div><ul><li><ol><li>这个文件就是实现下图这个界面的功能</li></ol></li></ul><p><img src=/imgs/img-lazy-loading.gif data-src=https://raw.githubusercontent.com/usermice/images/master/Deploy_Server/Install-Centos6.png alt></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ cat /var/lib/tftpboot/pxelinux.cfg/default  
</span></span><span style=display:flex><span>default ks
</span></span><span style=display:flex><span>prompt <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>label linux
</span></span><span style=display:flex><span> kernel vmlinuz
</span></span><span style=display:flex><span> append initrd<span style=color:#f92672>=</span>initrd.img ks<span style=color:#f92672>=</span>http://10.0.0.61/ks_config/CentOS-6.7-ks.cfg ksdevice<span style=color:#f92672>=</span>eth0  	<span style=color:#75715e># 告诉安装程序ks.cfg文件在哪里，ksdevice=eth0代表当客户端有多块网卡的时候，设置从eth0安装</span>
</span></span></code></pre></div></blockquote></div><h4 id=创建kscfg文件>创建<code>ks.cfg</code>文件
<a class=header-anchor href=#%e5%88%9b%e5%bb%bakscfg%e6%96%87%e4%bb%b6></a></h4><div class="note info"><blockquote><ul><li><ol><li>通常，我们在安装操作系统的过程中，需要大量的和服务器交互操作，为了减少这个交互过程，<code>kickstart</code>就诞生了。使用这种<code>kickstart</code>，只需事先定义好一个<code>Kickstart</code>自动应答配置文件<code>ks.cfg</code>（通常存放在安装服务器上），并让安装程序知道该配置文件的位置，在安装过程中安装程序就可以自己从该文件中读取安装配置，这样就避免了在安装过程中多次的人机交互，从而实现无人值守的自动化安装</li></ol></li><li><ol start=2><li>生成<code>kickstart</code>配置文件的三种方法：</li></ol></li></ul><blockquote><ul><li>2.1 方法1、 每安装好一台<code>Centos</code>机器，<code>Centos</code>安装程序都会创建一个<code>kickstart</code>配置文件，记录你的真实安装配置。如果你希望实现和某系统类似的安装，可以基于该系统的<code>kickstart</code>配置文件来生成你自己的<code>kickstart</code>配置文件。（生成的文件名字叫<code>anaconda-ks.cfg位于/root/anaconda-ks.cfg</code>）</li><li>2.2 方法2、<code>Centos</code>提供了一个图形化的<code>kickstart</code>配置工具。在任何一个安装好的<code>Linux</code>系统上运行该工具，就可以很容易地创建你自己的<code>kickstart</code>配置文件。<code>kickstart</code>配置工具命令为<code>redhat-config-kickstart</code>（<code>RHEL3</code>）或<code>system-config-kickstart</code>（<code>RHEL4</code>，<code>RHEL5</code>）.网上有很多用<code>CentOS</code>桌面版生成<code>ks</code>文件的文章，如果有现成的系统就没什么可说。但没有现成的，也没有必要去用桌面版，命令行也很简单</li><li>2.3 方法3、阅读<code>kickstart</code>配置文件的手册。用任何一个文本编辑器都可以创建你自己的<code>kickstart</code>配置文件</li></ul></blockquote></blockquote></div><h4 id=编写kscfg文件>编写<code>ks.cfg</code>文件
<a class=header-anchor href=#%e7%bc%96%e5%86%99kscfg%e6%96%87%e4%bb%b6></a></h4><div class="note info"><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ grub-crypt 
</span></span><span style=display:flex><span><span style=color:#75715e># 生成一个密码</span>
</span></span><span style=display:flex><span>Password:
</span></span><span style=display:flex><span>Retype password: 
</span></span><span style=display:flex><span>$6$PqVOBDIH4wHJ.JyH$6/xoqOGnm3DnEJyyXgWxCdmscsWrGKbTmMYYE/lgVgzIep999j8z9s7Ci5V5TG16TALy/Grtk6Vh/jj2WLnEn1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cat /var/www/html/ks_config/CentOS-6.7-ks.cfg
</span></span><span style=display:flex><span><span style=color:#75715e># Kickstart Configurator for CentOS 6.7 by ky</span>
</span></span><span style=display:flex><span>install
</span></span><span style=display:flex><span><span style=color:#75715e># 告知安装程序，这是一次全新安装，而不是升级upgrade</span>
</span></span><span style=display:flex><span>url --url<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://10.0.0.61/CentOS-6.7/&#34;</span>       
</span></span><span style=display:flex><span><span style=color:#75715e># 指定系统安装的包组等的路径</span>
</span></span><span style=display:flex><span>text 
</span></span><span style=display:flex><span><span style=color:#75715e># 文本模式安装</span>
</span></span><span style=display:flex><span>lang en_US.UTF-8 
</span></span><span style=display:flex><span><span style=color:#75715e># 安装使用的语言</span>
</span></span><span style=display:flex><span>keyboard us 
</span></span><span style=display:flex><span><span style=color:#75715e># 设置系统键盘类型</span>
</span></span><span style=display:flex><span>zerombr
</span></span><span style=display:flex><span><span style=color:#75715e># 清楚mbr引导信息</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>bootloader --location<span style=color:#f92672>=</span>mbr --driveorder<span style=color:#f92672>=</span>sda --append<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;crashkernel=auto rhgb quiet&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># --location=,指定引导记录被写入的位置.有效的值如下:mbr(缺省),partition(在包含内核的分区的第一个扇区安装引导装载程序)或none(不安装引导装载程序；--driveorder,指定在BIOS引导顺序中居首的驱动器；--append=,指定内核参数.要指定多个参数,使用空格分隔它们</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>network --bootproto<span style=color:#f92672>=</span>dhcp --device<span style=color:#f92672>=</span>eth0 --onboot<span style=color:#f92672>=</span>yes --noipv6 --hostname<span style=color:#f92672>=</span>CentOS6
</span></span><span style=display:flex><span><span style=color:#75715e># 指定ip地址为dhcp分发，网卡eth0启动，是否在引导时启用该设备，禁用此设备的IPv6安装的系统的主机名</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>timezone --utc Asia/Shanghai
</span></span><span style=display:flex><span><span style=color:#75715e># 设置系统时区</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>authconfig --enableshadow --passalgo<span style=color:#f92672>=</span>sha512
</span></span><span style=display:flex><span><span style=color:#75715e># 系统认证信息，设置密码加密方式为sha512 启用shadow文件</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rootpw --iscrypted $6$X20eRtuZhkHznTb4$dK0BJByOSAWSDD8jccLVFz0CscijS9ldMWwpoCw/ZE
</span></span><span style=display:flex><span>jYw2BTQYGWlgKsn945fFTjRC658UXjuocwJbAjVI5D6/
</span></span><span style=display:flex><span><span style=color:#75715e># root密码</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>clearpart --all –initlabel
</span></span><span style=display:flex><span><span style=color:#75715e># 清空分区</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>part /boot --fstype<span style=color:#f92672>=</span>ext4 --asprimary --size<span style=color:#f92672>=</span><span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span>part swap --size<span style=color:#f92672>=</span><span style=color:#ae81ff>800</span>
</span></span><span style=display:flex><span>part / --fstype<span style=color:#f92672>=</span>ext4 --grow --asprimary --size<span style=color:#f92672>=</span><span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span><span style=color:#75715e># --fstype=,为分区设置文件系统类型.有效的类型，--asprimary,强迫把分区分配为主分区,否则提示分区失败，--size=,以MB为单位的分区最小值.在此处指定一个整数值,如500.不要在数字后面加MB</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>firstboot –disable
</span></span><span style=display:flex><span><span style=color:#75715e># 负责协助配置redhat一些重要的信息</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>selinux --disabled
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>firewall –disabled
</span></span><span style=display:flex><span><span style=color:#75715e># 关闭selinux、防火墙</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>logging --level<span style=color:#f92672>=</span>info
</span></span><span style=display:flex><span><span style=color:#75715e># 设置日志级别</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>reboot
</span></span><span style=display:flex><span><span style=color:#75715e># 设定安装完成后重启,此选项必须存在，不然kickstart显示一条消息，并等待用户按任意键后才重新引导，也可以选择halt关机</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>%packages
</span></span><span style=display:flex><span>@base
</span></span><span style=display:flex><span>@compat-libraries
</span></span><span style=display:flex><span>@debugging
</span></span><span style=display:flex><span>@development
</span></span><span style=display:flex><span><span style=color:#75715e># 要安装的包组</span>
</span></span><span style=display:flex><span>tree
</span></span><span style=display:flex><span>nmap
</span></span><span style=display:flex><span>sysstat
</span></span><span style=display:flex><span>lrzsz
</span></span><span style=display:flex><span>telnet
</span></span><span style=display:flex><span><span style=color:#75715e># 要安装的软件</span>
</span></span><span style=display:flex><span>%end
</span></span></code></pre></div></blockquote></div><h4 id=无人值守安装系统>无人值守安装系统
<a class=header-anchor href=#%e6%97%a0%e4%ba%ba%e5%80%bc%e5%ae%88%e5%ae%89%e8%a3%85%e7%b3%bb%e7%bb%9f></a></h4><div class="note info"><ul><li><ol><li>新建一个虚拟机加电，即可开始无人值守安装<code>linux</code>系统</li></ol></li></ul><blockquote><p><img src=/imgs/img-lazy-loading.gif data-src=https://raw.githubusercontent.com/usermice/images/master/Deploy_Server/configure.png alt></p><p><img src=/imgs/img-lazy-loading.gif data-src=https://raw.githubusercontent.com/usermice/images/master/Deploy_Server/Retrieving.png alt></p><p><img src=/imgs/img-lazy-loading.gif data-src=https://raw.githubusercontent.com/usermice/images/master/Deploy_Server/Packages.png alt></p><ul><li>1.1 <code>Rpm</code>打包</li><li>1.2 <code>Yum</code>仓库</li></ul></blockquote></div></div><footer class=post-footer><div class=post-tags><a href=/tags/system>System
</a><a href=/tags/kickstart>Kickstart</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=reward-container><div><i class="fa-solid fa-mug-hot"></i>请我喝杯咖啡吧 ヾ(^▽^*)))</div><button>
赞赏</button><div class=post-reward><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/ali-pay.png alt="二哥 - 支付宝">
<span>支付宝</span></div><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/wechat-pay.png alt="二哥 - 微信">
<span>微信</span></div></div></div><div class=post-copyright><img src=/imgs/cc/cc.svg width=75 height=75 align=right alt=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
Install Kickstart</li><li class=post-copyright-author><strong>本文作者： </strong>二哥</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://erge.blog/systems/linux/install-system/install-kickstart/ title="Install Kickstart">https://erge.blog/systems/linux/install-system/install-kickstart/</a></li><li class=post-copyright-license><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=/images/wechat_channel.jpg><span class=icon><i class="fab fa-weixin"></i>
</span><span class=label>WeChat</span></a></div><div class=social-item><a target=_blank class=social-link href=/atom.xml><span class=icon><i class="fa fa-rss"></i>
</span><span class=label>RSS</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/systems/linux/codes/install-sonarqube/ rel=next title="Install SonarQube"><i class="fa fa-chevron-left"></i> Install SonarQube</a></div><div class="post-nav-prev post-nav-item"><a href=/systems/linux/install-system/install-cobbler/ rel=prev title="Install Cobbler">Install Cobbler
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div><div class=comment-switch><span class=first-comment>Giscus</span>
<span class=switch-btn></span>
<span class=second-comment>Waline</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=waline-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div id=gtranslate class=google-translate><i class="fa fa-language"></i><div id=google_translate_element></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2010 - 2024
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>二哥</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.125.4 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.5.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>粤ICP备 18047355-1 号</a>
<img src=/imgs/gongan.png alt=沪公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011402009770" target=_blank>沪公网安备 31011402009770 号</a></div><div class=vendors-list><a target=_blank href=https://vercel.com title=Vercel><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/vercel.svg alt=Vercel>
</a><a target=_blank href=https://upyun.com title=又拍云><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/upyun.png alt=又拍云>
</a><a target=_blank href=https://webify.cloudbase.net title=Webify>Webify
</a><span>提供CDN/云资源支持</span></div></div></footer><script type=text/javascript src=https://cdn.staticfile.org/animejs/3.2.1/anime.min.js defer></script><script type=text/javascript src=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.js defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":false,"giscus":{"cfg":{"category":"Comments","categoryid":null,"emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"username/repo-name","repoid":null,"theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"https://erge.blog/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":true,"plugin":"waline"},"views":{"enable":true,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"qiniu","router":"https://cdn.staticfile.org"},"version":"4.5.3","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":null,"sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"waline","file":"dist/waline.css","name":"@waline/client","version":"2.13.0"},"js":{"alias":"waline","file":"dist/waline.js","name":"@waline/client","version":"2.13.0"}}}</script><script type=text/javascript src=/js/main.min.b0c78e5a4df586ee46d02716ffa91a4a322e56763e04e91eb2ba052c9469ed02.js defer></script></body></html>