<!doctype html><html lang=zh-CN data-theme=light><head><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: light)"><meta name=generator content="Hugo 0.125.4"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="Install Cobbler"><meta itemprop=description content="Install-Cobbler"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://erge.blog/imgs/s2-1.jpg"><meta itemprop=keywords content="System,Cobbler"><meta property="og:type" content="article"><meta property="og:title" content="Install Cobbler"><meta property="og:description" content="Install-Cobbler"><meta property="og:image" content="/imgs/s2-1.jpg"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://erge.blog/systems/linux/install-system/install-cobbler/"><meta property="og:site_name" content="二哥"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="二哥"><meta property="article:published_time" content="2022-11-18 17:45:52 +0800 CST"><meta property="article:modified_time" content="2022-11-18 17:45:52 +0800 CST"><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.css><link rel=stylesheet href=/css/main.min.0d420b6f564e6674edd4354ea71c0458a83f95ad464a75114b23d72515b1456c.css><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":true,"isHome":false,"isPage":true,"path":"install-cobbler","permalink":"https://erge.blog/systems/linux/install-system/install-cobbler/","title":"Install Cobbler","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>Install Cobbler - 二哥</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>二哥</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>Linux、Kubernetes、Docker、Python、CI/CD、Jenkins、Mysql、Nginx、Gitlab、Ansible、Zabbix</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-Home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-categories"><a href=/categories/ class=hvr-icon-pulse rel=section><i class="fa fa-th hvr-icon"></i>分类</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>0</span></a></li><li class="menu-item menu-item-tags"><a href=/tags/ class=hvr-icon-pulse rel=section><i class="fa fa-tags hvr-icon"></i>标签</a></li><li class="menu-item menu-item-tools"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-tools hvr-icon"></i>工具</a></li><li class="menu-item menu-item-flinks"><a href=/flinks.html class=hvr-icon-pulse rel=section><i class="fa fa-thumbs-up hvr-icon"></i>站点示例</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-Commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#cobbler自动化部署最佳实践><code>Cobbler</code>自动化部署最佳实践</a><ul><li><a href=#cobbler简介><code>Cobbler</code>简介</a></li><li><a href=#cobbler功能><code>Cobbler</code>功能</a></li><li><a href=#基础环境准备>基础环境准备</a><ul><li><a href=#安装cobbler>安装<code>Cobbler</code></a></li><li><a href=#检测cobbler>检测<code>Cobbler</code></a></li><li><a href=#配置dhcp>配置<code>DHCP</code></a></li><li><a href=#同步cobbler>同步<code>Cobbler</code></a></li><li><a href=#管理cobbler>管理<code>Cobbler</code></a></li><li><a href=#署操作系统>署操作系统</a></li></ul></li></ul></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=二哥 src=/imgs/img-lazy-loading.gif data-src=/imgs/s2-1.jpg><p class=site-author-name itemprop=name>二哥</p><div class=site-description itemprop=description>The man who has made up his mind to win will never say impossible – Napoleon Bonaparte</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>0</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>51</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>149</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=qq%e5%8f%b7 title="QQ → qq号" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-qq fa-fw hvr-icon"></i>
QQ
</a></span><span class=links-of-social-item><a href=https://www.zhihu.com/people/lisenhui title="知乎 → https://www.zhihu.com/people/lisenhui" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎
</a></span><span class=links-of-social-item><a href=qq@qq.com title="E-Mail → qq@qq.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>
E-Mail
</a></span><span class=links-of-social-item><a href=https://weibo.com/yourname title="Weibo → https://weibo.com/yourname" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-weibo fa-fw hvr-icon"></i>
Weibo
</a></span><span class=links-of-social-item><a href="https://www.youtube.com/watch?v=RgKAFK5djSk" title="Youtube → https://www.youtube.com/watch?v=RgKAFK5djSk" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-youtube fa-fw hvr-icon"></i>
Youtube
</a></span><span class=links-of-social-item><a href=https://github.com/elkan1788 title="Github → https://github.com/elkan1788" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li><li class=links-of-blogroll-item><a href=https://lisenhui.cn title=https://lisenhui.cn target=_blank>凡梦星尘空间站</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=goto-gtranslate class=button title=多语言翻译><i class="fas fa-globe"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/hugo-next rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg>
</a><script type=text/javascript src=//sidecar.gitter.im/dist/sidecar.v1.js async></script><script type=text/javascript>((window.gitter={}).chat={}).options={room:"hugo-next/community"}</script><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://erge.blog/systems/linux/install-system/install-cobbler/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/s2-1.jpg"><meta itemprop=name content="二哥"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="二哥"><meta itemprop=description content="The man who has made up his mind to win will never say impossible – Napoleon Bonaparte"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="Install Cobbler"><meta itemprop=description content="Install-Cobbler"></span><header class=post-header><h1 class=post-title itemprop="name headline">Install Cobbler
<a href=https://github.com/user-name/repo-name/tree/branch-name/subdirectory-name/Systems/Linux/Install-System/Install-Cobbler.md rel="noopener external nofollow noreferrer" target=_blank class="exturl post-edit-link" title=编辑><i class="fa fa-pen-nib"></i></a></h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2022-11-18 17:45:52 +0800 CST" itemprop="dateCreated datePublished" datetime="2022-11-18 17:45:52 +0800 CST">2022-11-18
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/system itemprop=url rel=index><span itemprop=name>System</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="far fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>5830</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="far fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>12分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="far fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=busuanzi_value_page_pv data-path=/systems/linux/install-system/install-cobbler/><i class="fa fa-sync fa-spin"></i>
</span></span><span class=post-meta-item title><span class=post-meta-item-icon><i class="far fa-comments"></i>
</span><span class=post-meta-item-text title=评论>评论：
</span><span id=comments-count class=waline-comment-count data-path=/systems/linux/install-system/install-cobbler/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><h2 id=cobbler自动化部署最佳实践><code>Cobbler</code>自动化部署最佳实践
<a class=header-anchor href=#cobbler%e8%87%aa%e5%8a%a8%e5%8c%96%e9%83%a8%e7%bd%b2%e6%9c%80%e4%bd%b3%e5%ae%9e%e8%b7%b5></a></h2><div class="note info"><blockquote><ul><li><ol><li><p>运维自动化在生产环境中占据着举足轻重的地位，尤其是面对几百台，几千台甚至几万台的服务器时，仅仅是安装操作系统，如果不通过自动化来完成，根本是不可想象的。</p><p>面对生产环境中不同服务器的需求，该如何实现批量部署多版本的操作系统呢？<code>Cobbler</code>便可以的满足这一实际需求，实现多版本操作系统批量部署</p></li></ol></li></ul></blockquote></div><h3 id=cobbler简介><code>Cobbler</code>简介
<a class=header-anchor href=#cobbler%e7%ae%80%e4%bb%8b></a></h3><div class="note info"><blockquote><ul><li><ol><li><code>Cobbler</code>是一个快速网络安装<code>linux</code>的服务，而且在经过调整也可以支持网络安装<code>windows</code>。该工具使用<code>python</code>开发，小巧轻便（才<code>15k</code>行<code>python</code>代码），使用简单的命令即可完成<code>PXE</code>网络安装环境的配置，同时还可以管理<code>DHCP</code>、<code>DNS</code>、<code>TFTP</code>、<code>RSYNC</code>以及<code>yum</code>仓库、构造系统<code>ISO</code>镜像</li></ol></li></ul></blockquote><ul><li><ol><li><code>Cobbler</code>支持命令行管理，<code>web</code>界面管理，还提供了<code>API</code>接口，可以方便二次开发使用</li></ol></li><li><ol start=2><li><code>Cobbler</code>客户端<code>Koan</code>支持虚拟机安装和操作系统重新安装，使重装系统更便捷</li></ol></li><li><ol start=3><li><code>Cobbler</code>各个组件之间关系</li></ol></li></ul><blockquote><p><img src=/imgs/img-lazy-loading.gif data-src=https://raw.githubusercontent.com/usermice/images/master/Cobbler_Server/cobbler.png alt></p><ul><li>3.1 <code>distro</code>-><code>profile-system</code>(可选)</li></ul></blockquote><ul><li><ol start=4><li><code>distro</code>发行版</li></ol></li></ul><blockquote><ul><li>面对不同的操作系统</li><li>面对同一个操作系统不同的版本</li></ul></blockquote><ul><li><ol start=5><li><code>profile</code></li></ol></li></ul><blockquote><ul><li>核心特性是通过<code>kickstart</code>来部署</li></ul></blockquote><ul><li><ol start=6><li><code>system</code></li></ol></li></ul><blockquote><ul><li>主要目的配置网络接口</li></ul></blockquote></div><h3 id=cobbler功能><code>Cobbler</code>功能
<a class=header-anchor href=#cobbler%e5%8a%9f%e8%83%bd></a></h3><div class="note info"><blockquote><ul><li><ol><li>使用<code>Cobbler</code>，您无需进行人工干预即可安装机器。<code>Cobbler</code>设置一个<code>PXE</code>引导环境（它还可使用<code>yaboot</code>支持<code>PowerPC</code>），并控制与安装相关的所有方面，比如网络引导服务（<code>DHCP</code>和<code>TFTP</code>）与存储库镜像。当希望安装一台新机器时，<code>Cobbler</code>可以：使用一个以前定义的模板来配置<code>DHCP</code>服务（如果启用了管理<code>DHCP</code>）将一个存储库（<code>yum</code>或<code>rsync</code>）建立镜像或解压缩一个媒介，以注册一个新操作系统，在<code>DHCP</code>配置文件中为需要安装的机器创建一个条目，并使用您指定的参数（<code>IP</code>和<code>MAC</code>地址），在<code>TFTFP</code>服务目录下创建适当的<code>PXE</code>文件，重新启动<code>DHCP</code>服务以反映更改，重新启动机器以开始安装（如果电源管理已启用）</li></ol></li><li><ol start=2><li><code>Cobbler</code>支持众多的发行版：<code>Red Hat</code>、<code>Fedora</code>、<code>CentOS</code>、<code>Debian</code>、<code>Ubuntu</code>和<code>SuSE</code>。当添加一个操作系统（通常通过使用<code>ISO</code>文件）时，<code>Cobbler</code>知道如何解压缩合适的文件并调整网络服务，以正确引导机器。</li></ol></li><li><ol start=3><li><code>Cobbler</code>可使用<code>kickstart</code>模板。基于<code>Red Hat</code>或<code>Fedora</code>的系统使用<code>kickstart</code>文件来自动化安装流程。通过使用模板，您就会拥有基本的<code>kickstart</code>模板，然后定义如何针对一种配置文件或机器配置而替换其中的变量。例如，一个模板可能包含两个变量<code>$domain</code>和<code>$machine_name</code>。在 <code>Cobbler</code>配置中，一个配置文件指定<code>domain=mydomain.com</code>，并且每台使用该配置文件的机器在<code>machine_name</code>变量中指定其名称。该配置文件中的所有机器都使用相同的<code>kickstart</code>安装且针对 <code>domain=mydomain.com</code>进行配置，但每台机器拥有其自己的机器名称。您仍然可以使用<code>kickstart</code>模板在不同的域中安装其他机器并使用不同的机器名称。</li></ol></li><li><ol start=4><li>为了协助管理系统，Cobbler 可通过 fence scripts 连接到各种电源管理环境。</li></ol></li><li><ol start=5><li><code>Cobbler</code>支持<code>apc_snmp</code>、<code>bladecenter</code>、<code>bullpap</code>、<code>drac</code>、<code>ether_wake</code>、<code>ilo</code>、<code>integrity</code>、<code>ipmilan</code>、<code>ipmitool</code>、<code>lpar</code>、<code>rsa</code>、<code>virsh</code>和<code>wti</code>。要重新安装一台机器，可运行<code>reboot system foo</code>命令，而且<code>Cobbler</code>会使用必要的凭据和信息来为您运行恰当的<code>fence scripts</code>（比如机器插槽数）</li></ol></li><li><ol start=6><li>除了这些特性，还可使用一个配置管理系统 (<code>CMS</code>)。您有两种选择：该工具内的一个内部系统，或者集成一个现有的外部<code>CMS</code>，比如<code>Chef</code>或<code>Puppet</code>。借助内部系统，您可以指定文件模板，这些模板会依据配置参数进行处理（与<code>kickstart</code>模板的处理方式一样），然后复制到您指定的位置。如果必须自动将配置文件部署到特定机器，那么此功能很有用</li></ol></li><li><ol start=7><li>使用<code>koan</code>客户端，<code>Cobbler</code>可从客户端配置虚拟机并重新安装系统。我不会讨论配置管理和<code>koan</code>特性，因为它们不属于本文的介绍范畴。但是，它们是值得研究的有用特性</li></ol></li></ul></blockquote></div><h3 id=基础环境准备>基础环境准备
<a class=header-anchor href=#%e5%9f%ba%e7%a1%80%e7%8e%af%e5%a2%83%e5%87%86%e5%a4%87></a></h3><div class="note info"><ul><li><ol><li><font color=red>提示：虚拟机网卡采用</font><code>NAT</code><font color=red>模式，因为我们会搭建</font><code>DHCP</code><font color=red>服务器，在同一局域网多个</font><code>DHCP</code><font color=red>服务会有冲突，并且导致实践失败</font></li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ cat /etc/redhat-release  	<span style=color:#75715e># 系统版本</span>
</span></span><span style=display:flex><span>$ uname –r  	<span style=color:#75715e># 内核版本</span>
</span></span><span style=display:flex><span>$ getenforce  	<span style=color:#75715e># 检测selinux是否关闭(必须关闭)</span>
</span></span><span style=display:flex><span>$ systemctl stop firewalld  	<span style=color:#75715e># 关闭防火墙</span>
</span></span><span style=display:flex><span>$ ifconfig eth0|awk -F <span style=color:#e6db74>&#39;[ :]+&#39;</span> <span style=color:#e6db74>&#39;NR==2 {print $3}&#39;</span>  	<span style=color:#75715e># 查看IP地址</span>
</span></span><span style=display:flex><span>$ hostname  	<span style=color:#75715e># 查看主机名</span>
</span></span><span style=display:flex><span>$ wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo  	<span style=color:#75715e># cobbler安装必须使用到epel源</span>
</span></span></code></pre></div></blockquote></div><h4 id=安装cobbler>安装<code>Cobbler</code>
<a class=header-anchor href=#%e5%ae%89%e8%a3%85cobbler></a></h4><div class="note info"><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ yum install cobbler cobbler-web pykickstart httpd tftp dhcp xinetd
</span></span><span style=display:flex><span>cobbler  	<span style=color:#75715e># cobbler程序包</span>
</span></span><span style=display:flex><span>cobbler-web  	<span style=color:#75715e># cobbler的web服务包</span>
</span></span><span style=display:flex><span>pykickstart  	<span style=color:#75715e># cobbler检查kickstart语法错误</span>
</span></span><span style=display:flex><span>httpd  	<span style=color:#75715e># Apache web服务</span>
</span></span><span style=display:flex><span>tftp  	<span style=color:#75715e># tftp服务</span>
</span></span><span style=display:flex><span>dhcp  	<span style=color:#75715e># dhcp服务</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/etc/cobbler  	<span style=color:#75715e># 配置文件目录</span>
</span></span><span style=display:flex><span>/etc/cobbler/settings  	<span style=color:#75715e># cobbler主配置文件</span>
</span></span><span style=display:flex><span>/etc/cobbler/dhcp.template  	<span style=color:#75715e># DHCP服务的配置模板</span>
</span></span><span style=display:flex><span>/etc/cobbler/tftpd.template  	<span style=color:#75715e># tftp服务的配置模板</span>
</span></span><span style=display:flex><span>/etc/cobbler/rsync.template  	<span style=color:#75715e># rsync服务的配置模板</span>
</span></span><span style=display:flex><span>/etc/cobbler/iso  	<span style=color:#75715e># iso模板配置文件目录</span>
</span></span><span style=display:flex><span>/etc/cobbler/pxe  	<span style=color:#75715e># pxe模板文件目录</span>
</span></span><span style=display:flex><span>/etc/cobbler/power  	<span style=color:#75715e># 电源的配置文件目录</span>
</span></span><span style=display:flex><span>/etc/cobbler/users.conf  	<span style=color:#75715e># Web服务授权配置文件</span>
</span></span><span style=display:flex><span>/etc/cobbler/users.digest  	<span style=color:#75715e># web访问的用户名密码配置文件</span>
</span></span><span style=display:flex><span>/etc/cobbler/dnsmasq.template  	<span style=color:#75715e># DNS服务的配置模板</span>
</span></span><span style=display:flex><span>/etc/cobbler/modules.conf  	<span style=color:#75715e># Cobbler模块配置文件</span>
</span></span><span style=display:flex><span>/var/lib/cobbler  	<span style=color:#75715e># Cobbler数据目录</span>
</span></span><span style=display:flex><span>/var/lib/cobbler/config  	<span style=color:#75715e># 配置文件</span>
</span></span><span style=display:flex><span>/var/lib/cobbler/kickstarts  	<span style=color:#75715e># 默认存放kickstart文件</span>
</span></span><span style=display:flex><span>/var/lib/cobbler/loaders  	<span style=color:#75715e># 存放的各种引导程序</span>
</span></span><span style=display:flex><span>/var/www/cobbler  	<span style=color:#75715e># 系统安装镜像目录</span>
</span></span><span style=display:flex><span>/var/www/cobbler/ks_mirror  	<span style=color:#75715e># 导入的系统镜像列表</span>
</span></span><span style=display:flex><span>/var/www/cobbler/images  	<span style=color:#75715e># 导入的系统镜像启动文件</span>
</span></span><span style=display:flex><span>/var/www/cobbler/repo_mirror  	<span style=color:#75715e># yum源存储目录</span>
</span></span><span style=display:flex><span>/var/log/cobbler  	<span style=color:#75715e># 日志目录</span>
</span></span><span style=display:flex><span>/var/log/cobbler/install.log  	<span style=color:#75715e># 客户端系统安装日志</span>
</span></span><span style=display:flex><span>/var/log/cobbler/cobbler.log  	<span style=color:#75715e># cobbler日志</span>
</span></span></code></pre></div></blockquote></div><h4 id=检测cobbler>检测<code>Cobbler</code>
<a class=header-anchor href=#%e6%a3%80%e6%b5%8bcobbler></a></h4><div class="note info"><ul><li><ol><li><code>cobbler</code>的运行依赖于<code>dhcp</code>、<code>tftp</code>、<code>rsync</code>及<code>dns</code>服务，其中<code>dhcp</code>可由<code>dhcpd（isc）</code>提供，也可由<code>dnsmasq</code>提供；<code>tftp</code>可由<code>tftp-server</code>程序包提供，也可由<code>cobbler</code>功能提供，<code>rsync</code>有<code>rsync</code>程序包提供，<code>dns</code>可由<code>bind</code>提供，也可由<code>dnsmasq</code>提供</li></ol></li><li><ol start=2><li><code>cobbler</code>可自行管理这些服务中的部分甚至是全部，但需要配置<code>/etc/cobbler/settings</code>文件中的<code>manange_dhcp</code>、<code>manager_tftpd</code>、<code>manager_rsync</code>、<code>manager_dns</code>分别来进行定义，另外，由于各种服务都有着不同的实现方式，如若需要进行自定义，需要通过修改<code>/etc/cobbler/modules.conf</code>配置文件中各服务的模块参数的值来实现</li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ systemctl start httpd  	<span style=color:#75715e># 启动apache服务</span>
</span></span><span style=display:flex><span>$ systemctl start cobblerd  	<span style=color:#75715e># 启动cobbler程序</span>
</span></span></code></pre></div><ul><li>2.1 检查配置文件，需要在<code>cobblerd</code>和<code>httpd</code>启动的情况下检查</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ systemctl start httpd  	<span style=color:#75715e># 启动apache服务</span>
</span></span><span style=display:flex><span>$ systemctl start cobblerd  	<span style=color:#75715e># 启动cobbler程序</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 检查配置文件，需要在cobblerd和httpd启动的情况下检查</span>
</span></span><span style=display:flex><span>$ cobbler check  	<span style=color:#75715e># 检查存在的问题,逐一解决</span>
</span></span><span style=display:flex><span>The following are potential configuration items that you may want to fix:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> : The <span style=color:#e6db74>&#39;server&#39;</span> field in /etc/cobbler/settings must be set to something other than localhost, or kickstarting features will not work.  This should be a resolvable hostname or IP <span style=color:#66d9ef>for</span> the boot server as reachable by all machines that will use it.
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> : For PXE to be functional, the <span style=color:#e6db74>&#39;next_server&#39;</span> field in /etc/cobbler/settings must be set to something other than 127.0.0.1, and should match the IP of the boot server on the PXE network.
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> : change <span style=color:#e6db74>&#39;disable&#39;</span> to <span style=color:#e6db74>&#39;no&#39;</span> in /etc/xinetd.d/tftp
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span> : some network boot-loaders are missing from /var/lib/cobbler/loaders, you may run <span style=color:#e6db74>&#39;cobbler get-loaders&#39;</span> to download them, or, <span style=color:#66d9ef>if</span> you only want to handle x86/x86_64 netbooting, you may ensure that you have installed a *recent* version of the syslinux package installed and can ignore this message entirely.  Files in this directory, should you want to support all architectures, should include pxelinux.0, menu.c32, elilo.efi, and yaboot. The <span style=color:#e6db74>&#39;cobbler get-loaders&#39;</span> command is the easiest way to resolve these requirements.
</span></span><span style=display:flex><span><span style=color:#ae81ff>5</span> : enable and start rsyncd.service with systemctl
</span></span><span style=display:flex><span><span style=color:#ae81ff>6</span> : debmirror package is not installed, it will be required to manage debian deployments and repositories
</span></span><span style=display:flex><span><span style=color:#ae81ff>7</span> : The default password used by the sample templates <span style=color:#66d9ef>for</span> newly installed machines <span style=color:#f92672>(</span>default_password_crypted in /etc/cobbler/settings<span style=color:#f92672>)</span> is still set to <span style=color:#e6db74>&#39;cobbler&#39;</span> and should be changed, try: <span style=color:#e6db74>&#34;openssl passwd -1 -salt &#39;random-phrase-here&#39; &#39;your-password-here&#39;&#34;</span> to generate new one
</span></span><span style=display:flex><span><span style=color:#ae81ff>8</span> : fencing tools were not found, and are required to use the <span style=color:#f92672>(</span>optional<span style=color:#f92672>)</span> power management features. install cman or fence-agents to use them
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Restart cobblerd and <span style=color:#66d9ef>then</span> run <span style=color:#e6db74>&#39;cobbler sync&#39;</span> to apply changes.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 如上各问题的解决方法如下所示：</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 1. 修改/etc/cobbler/settings文件中的server参数的值为提供cobbler服务的主机相应的IP地址或主机名，如server: 10.0.0.101；</span>
</span></span><span style=display:flex><span>$  sed -i <span style=color:#e6db74>&#39;s/server: 127.0.0.1/server: 10.0.0.101/&#39;</span> /etc/cobbler/settings
</span></span><span style=display:flex><span><span style=color:#75715e># 2. 修改/etc/cobbler/settings文件中的next_server参数的值为提供PXE服务的主机相应的IP地址，如next_server: 10.0.0.101；</span>
</span></span><span style=display:flex><span>$ sed -i <span style=color:#e6db74>&#39;s/next_server: 127.0.0.1/next_server: 10.0.0.101/&#39;</span> /etc/cobbler/settings
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 3. 修改/etc/xinetd.d/tftp文件中的disable参数修改为 disable = no</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 4. 执行 cobbler get-loaders 命令即可；否则，需要安装syslinux程序包，而后复制/usr/share/syslinux/{pxelinux.0,memu.c32}等文件至/var/lib/cobbler/loaders/目录中；</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 5. 执行 systemctl enable rsyncd命令即可；</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 6. 如果有强迫症可以选择 yum –y install debmirror 然后根据错误进行解决,一般错误如下。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 注释/etc/dedmirror.conf文件中的  @dists=”sid”;  @arches=”i386”; </span>
</span></span><span style=display:flex><span>$ openssl passwd -1 -salt <span style=color:#e6db74>&#39;$(openssl rand -hex 4)&#39;</span> <span style=color:#e6db74>&#39;xuliangwei&#39;</span> 
</span></span><span style=display:flex><span><span style=color:#75715e># $1$$(openss$.wbDUBV/STL0YaNuAcusK/  	# 返回参数</span>
</span></span><span style=display:flex><span>$ grep <span style=color:#e6db74>&#34;default_password_crypted&#34;</span> /etc/cobbler/settings  	<span style=color:#75715e># 替换/etc/cobbler/setting内的default_password_crypted default_password_crypted: &#34;$1$$(openss$.wbDUBV/STL0YaNuAcusK/&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 7. yum –y install cman fence-agents</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 最后重启Cobbler：systemctl restart cobblerd </span>
</span></span></code></pre></div></blockquote></div><h4 id=配置dhcp>配置<code>DHCP</code>
<a class=header-anchor href=#%e9%85%8d%e7%bd%aedhcp></a></h4><div class="note info"><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ sed -i <span style=color:#e6db74>&#39;s#manage_dhcp: 0#manage_dhcp: 1#g&#39;</span> /etc/cobbler/settings  	<span style=color:#75715e># 使用cobbler管理dhcp</span>
</span></span><span style=display:flex><span>$ vim /etc/cobbler/dhcp.template  	<span style=color:#75715e># 修改cobbler的dhcp模版，因为cobbler会替换。</span>
</span></span><span style=display:flex><span>subnet 10.0.0.0 netmask 255.255.255.0 <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>     option routers             10.0.0.2;
</span></span><span style=display:flex><span>     option domain-name-servers 10.0.0.2;
</span></span><span style=display:flex><span>     option subnet-mask         255.255.255.0;
</span></span><span style=display:flex><span>     range dynamic-bootp        10.0.0.200 10.0.0.250;
</span></span><span style=display:flex><span>     default-lease-time         21600;
</span></span><span style=display:flex><span>     max-lease-time             43200;
</span></span><span style=display:flex><span>     next-server                $next_server;
</span></span></code></pre></div></blockquote></div><h4 id=同步cobbler>同步<code>Cobbler</code>
<a class=header-anchor href=#%e5%90%8c%e6%ad%a5cobbler></a></h4><div class="note info"><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ systemctl restart xinetd  	<span style=color:#75715e># 重启xinetd</span>
</span></span><span style=display:flex><span>$ systemctl restart cobblerd  	<span style=color:#75715e># 重启cobbler</span>
</span></span><span style=display:flex><span>$ cobbler sync  	<span style=color:#75715e># 同步最新cobbler配置，可以看具体做了哪些操作</span>
</span></span><span style=display:flex><span>task started: 2016-04-29_234117_sync
</span></span><span style=display:flex><span>task started <span style=color:#f92672>(</span>id<span style=color:#f92672>=</span>Sync, time<span style=color:#f92672>=</span>Fri Apr <span style=color:#ae81ff>29</span> 23:41:17 2016<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>running pre-sync triggers
</span></span><span style=display:flex><span>cleaning trees
</span></span><span style=display:flex><span>removing: /var/lib/tftpboot/pxelinux.cfg/default
</span></span><span style=display:flex><span>removing: /var/lib/tftpboot/grub/images
</span></span><span style=display:flex><span>removing: /var/lib/tftpboot/grub/grub-x86.efi
</span></span><span style=display:flex><span>removing: /var/lib/tftpboot/grub/grub-x86_64.efi
</span></span><span style=display:flex><span>removing: /var/lib/tftpboot/grub/efidefault
</span></span><span style=display:flex><span>removing: /var/lib/tftpboot/s390x/profile_list
</span></span><span style=display:flex><span>copying bootloaders
</span></span><span style=display:flex><span>trying hardlink /var/lib/cobbler/loaders/grub-x86.efi -&gt; /var/lib/tftpboot/grub/grub-x86.efi
</span></span><span style=display:flex><span>trying hardlink /var/lib/cobbler/loaders/grub-x86_64.efi -&gt; /var/lib/tftpboot/grub/grub-x86_64.efi
</span></span><span style=display:flex><span>copying distros to tftpboot
</span></span><span style=display:flex><span>copying images
</span></span><span style=display:flex><span>generating PXE configuration files
</span></span><span style=display:flex><span>generating PXE menu structure
</span></span><span style=display:flex><span>rendering DHCP files
</span></span><span style=display:flex><span>generating /etc/dhcp/dhcpd.conf
</span></span><span style=display:flex><span>rendering TFTPD files
</span></span><span style=display:flex><span>generating /etc/xinetd.d/tftp
</span></span><span style=display:flex><span>cleaning link caches
</span></span><span style=display:flex><span>running post-sync triggers
</span></span><span style=display:flex><span>running python triggers from /var/lib/cobbler/triggers/sync/post/*
</span></span><span style=display:flex><span>running python trigger cobbler.modules.sync_post_restart_services
</span></span><span style=display:flex><span>running: dhcpd -t -q
</span></span><span style=display:flex><span>received on stdout: 
</span></span><span style=display:flex><span>received on stderr: 
</span></span><span style=display:flex><span>running: service dhcpd restart
</span></span><span style=display:flex><span>received on stdout: 
</span></span><span style=display:flex><span>received on stderr: Redirecting to /bin/systemctl restart  dhcpd.service
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>running shell triggers from /var/lib/cobbler/triggers/sync/post/*
</span></span><span style=display:flex><span>running python triggers from /var/lib/cobbler/triggers/change/*
</span></span><span style=display:flex><span>running python trigger cobbler.modules.scm_track
</span></span><span style=display:flex><span>running shell triggers from /var/lib/cobbler/triggers/change/*
</span></span><span style=display:flex><span>*** TASK COMPLETE ***
</span></span></code></pre></div></blockquote></div><h4 id=管理cobbler>管理<code>Cobbler</code>
<a class=header-anchor href=#%e7%ae%a1%e7%90%86cobbler></a></h4><div class="note info"><ul><li><ol><li>管理<code>distro</code></li></ol></li></ul><blockquote><ul><li>1.1 <code>cobbler</code>变得可用的第一步为定义<code>distro</code>，其可以通过为其指定外部的安装引导内核及<code>ramdisk文</code>件的方式实现。如果已经有完成的安装树（如<code>os</code>的安装镜像）则推荐使用<code>improt</code>之间导入的方式进行</li><li>1.2 如果有<code>kickstart</code>文件，也可以使用<code>--kickstart=/path/to/kickstart_file</code>进行导入，因此<code>import</code>会自动为导入的<code>distro</code>生成一个<code>profile</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ mount /dev/cdrom /mnt/  	<span style=color:#75715e># 挂在ISO光盘至服务器</span>
</span></span><span style=display:flex><span>mount: /dev/sr0 is write-protected, mounting read-only
</span></span><span style=display:flex><span>$ cobbler import --path<span style=color:#f92672>=</span>/mnt/ --name<span style=color:#f92672>=</span>CentOS-7.1-x86_64-distro --arch<span style=color:#f92672>=</span>x86_64
</span></span><span style=display:flex><span><span style=color:#75715e># --path 镜像路径</span>
</span></span><span style=display:flex><span><span style=color:#75715e># --name 为安装源定义一个名字</span>
</span></span><span style=display:flex><span><span style=color:#75715e># --arch 指定安装源是32位、64位、ia64, 目前支持的选项有: x86│x86_64│ia64</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 安装源的唯一标示就是根据name参数来定义，本例导入成功后，安装源的唯一标示就是：CentOS-7.1-distro-x86_64。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 镜像存放目录，cobbler会将镜像中的所有安装文件拷贝到本地一份，放在/var/www/cobbler/ks_mirror下的CentOS-7.1-x86_64-distro-x86_64目录下。因此/var/www/cobbler目录必须具有足够容纳安装文件的空间。</span>
</span></span><span style=display:flex><span>task started: 2016-04-30_010122_import
</span></span><span style=display:flex><span>task started <span style=color:#f92672>(</span>id<span style=color:#f92672>=</span>Media import, time<span style=color:#f92672>=</span>Sat Apr <span style=color:#ae81ff>30</span> 01:01:22 2016<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Found a candidate signature: breed<span style=color:#f92672>=</span>redhat, version<span style=color:#f92672>=</span>rhel6
</span></span><span style=display:flex><span>Found a candidate signature: breed<span style=color:#f92672>=</span>redhat, version<span style=color:#f92672>=</span>rhel7
</span></span><span style=display:flex><span>Found a matching signature: breed<span style=color:#f92672>=</span>redhat, version<span style=color:#f92672>=</span>rhel7
</span></span><span style=display:flex><span>Adding distros from path /var/www/cobbler/ks_mirror/CentOS-7.1-x86_64-distro-x86_64:
</span></span><span style=display:flex><span>creating new distro: CentOS-7.1-distro-x86_64
</span></span><span style=display:flex><span>trying symlink: /var/www/cobbler/ks_mirror/CentOS-7.1-x86_64-distro-x86_64 -&gt; /var/www/cobbler/links/CentOS-7.1-distro-x86_64
</span></span><span style=display:flex><span>creating new profile: CentOS-7.1-distro-x86_64
</span></span><span style=display:flex><span>associating repos
</span></span><span style=display:flex><span>checking <span style=color:#66d9ef>for</span> rsync repo<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>checking <span style=color:#66d9ef>for</span> rhn repo<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>checking <span style=color:#66d9ef>for</span> yum repo<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>starting descent into /var/www/cobbler/ks_mirror/CentOS-7.1-x86_64-distro-x86_64 <span style=color:#66d9ef>for</span> CentOS-7.1-distro-x86_64
</span></span><span style=display:flex><span>processing repo at : /var/www/cobbler/ks_mirror/CentOS-7.1-x86_64-distro-x86_64
</span></span><span style=display:flex><span>need to process repo/comps: /var/www/cobbler/ks_mirror/CentOS-7.1-x86_64-distro-x86_64
</span></span><span style=display:flex><span>looking <span style=color:#66d9ef>for</span> /var/www/cobbler/ks_mirror/CentOS-7.1-x86_64-distro-x86_64/repodata/*comps*.xml
</span></span><span style=display:flex><span>Keeping repodata as-is :/var/www/cobbler/ks_mirror/CentOS-7.1-x86_64-distro-x86_64/repodata
</span></span><span style=display:flex><span>*** TASK COMPLETE ***
</span></span><span style=display:flex><span>$ cobbler distro list  	<span style=color:#75715e># 列出所有的distro</span>
</span></span><span style=display:flex><span>   CentOS-7.1-distro-x86_64
</span></span><span style=display:flex><span>$ cobbler profile list  	<span style=color:#75715e># 导入distro会自动生成profile</span>
</span></span><span style=display:flex><span>   CentOS-7.1-distro-x86_64
</span></span></code></pre></div></blockquote><ul><li><ol start=2><li>管理<code>profile</code></li></ol></li></ul><blockquote><ul><li>2.1 <code>cobbler</code>使用<code>profile</code>来为特定的需求类别提供锁需要安装的配置，即在<code>distro</code>的基础上通过提供<code>kiskstart</code>文件来生成一个特定的系统安装配置。<code>distro</code>的<code>profile</code>可以出现在<code>pxe</code>的引导菜单中作为安装的选择之一</li><li>2.2 <code>Cobbler-CentOS-7.1-x86_64.cfg</code>配置文件我会上传至至附件，默认是有<code>kickstart</code>文件的，所以<code>edit</code>，如果没有<code>kickstart</code>文件可以<code>add</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ cobbler profile edit --name<span style=color:#f92672>=</span>Centos7.1-distro-x86_64 --kickstart<span style=color:#f92672>=</span>/var/lib/cobbler/kickstarts/Cobbler-CentOS-7.1-x86_64.cfg  	<span style=color:#75715e># 指定ks路径</span>
</span></span></code></pre></div><ul><li>2.3 <code>CentOS7</code>系统网卡名变成<code>eno...</code>这种，为了运维标准化，我们需要修改为我们常用的<code>eth0</code>，使用下面的参数。但要注意是<code>CentOS7</code>才需要下面的步骤，<code>CentOS6</code>不需要</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ cobbler profile edit --name<span style=color:#f92672>=</span>Centos7.1-distro-x86_64 --kopts<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;net.ifnames=0 biosdevname=0&#39;</span>  	<span style=color:#75715e># 修改centos7内核</span>
</span></span></code></pre></div><ul><li>2.4 新部署机器安装<code>yum</code>源，并同步。建议使用内网<code>yum</code>源，在这里使用阿里云<code>yum</code>源</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ cobbler repo add --name<span style=color:#f92672>=</span>base --mirror<span style=color:#f92672>=</span>http://mirrors.aliyun.com/centos/7/os/x86_64/Packages/ --arch<span style=color:#f92672>=</span>x86_64 --breed<span style=color:#f92672>=</span>yum  	<span style=color:#75715e># 添加yum源</span>
</span></span><span style=display:flex><span>$ cobbler reposync  	<span style=color:#75715e># 同步yum源</span>
</span></span><span style=display:flex><span>$ cobbler sync  	<span style=color:#75715e># 每次修改profile都需要同步</span>
</span></span></code></pre></div></blockquote></div><h4 id=署操作系统>署操作系统
<a class=header-anchor href=#%e7%bd%b2%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f></a></h4><div class="note info"><ul><li><ol><li>新建一台虚拟机，通过网络启动即可。（我这里虚拟机使用的是<code>NAT</code>模式,并且关闭<code>DHCP</code>功能）</li></ol></li></ul><blockquote><ul><li>1.1 用户：<code>root</code></li><li>1.2 密码：<code>xuliangwei</code></li><li>1.3 <code>openssl</code>生成时指定</li></ul><p><img src=/imgs/img-lazy-loading.gif data-src=https://raw.githubusercontent.com/usermice/images/master/Deploy_Server/Cobbler.png alt></p></blockquote><ul><li><ol start=2><li>定制化安装</li></ol></li></ul><blockquote><ul><li>2.1 由于<code>kickstart</code>指定某台服务器使用某个<code>ks</code>文件比较复杂，所以引用<code>Cobbler</code>就很简单。通过物理<code>MAC</code>地址来区分</li><li>2.2 自定义安装：<code>system</code>主要目的配置网络接口，通过<code>system</code>来固定机器的<code>IP</code>、掩码、网关、<code>DNS</code>、主机名、等等实现基础环境标准化</li><li>2.3 根据机器的<code>MAC</code>地址，自动绑定<code>IP</code>，网关，<code>dns</code>等</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ cobbler system add --name<span style=color:#f92672>=</span>xuliangwei-pc --mac<span style=color:#f92672>=</span>00:0C:29:6E:41:CB --profile<span style=color:#f92672>=</span>Centos7.1-profile-x86_64 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--ip-address<span style=color:#f92672>=</span>10.0.0.110 --subnet<span style=color:#f92672>=</span>255.255.255.0 --gateway<span style=color:#f92672>=</span>10.0.0.2 --interface<span style=color:#f92672>=</span>eth0 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--static<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> --hostname<span style=color:#f92672>=</span>xuliangwei.com --name-servers<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;114.114.114.114 8.8.8.8&#34;</span>
</span></span><span style=display:flex><span>$ cobbler sync
</span></span><span style=display:flex><span>$ cobbler system list
</span></span><span style=display:flex><span>   xuliangwei-pc
</span></span></code></pre></div><p><img src=/imgs/img-lazy-loading.gif data-src=https://raw.githubusercontent.com/usermice/images/master/Deploy_Server/Cobbler.png alt></p></blockquote><ul><li><ol start=3><li>自定义登陆界面</li></ol></li></ul><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>$ grep <span style=color:#e6db74>&#34;xuliangwei&#34;</span> /etc/cobbler/pxe/pxedefault.template  	<span style=color:#75715e># 自定义装机页面</span>
</span></span><span style=display:flex><span>MENU TITLE Xuliangwei | http://xuliangwei.com
</span></span><span style=display:flex><span>$ cobbler sync  	<span style=color:#75715e># 同步</span>
</span></span></code></pre></div><p><img src=/imgs/img-lazy-loading.gif data-src=https://raw.githubusercontent.com/usermice/images/master/Deploy_Server/xuliangwe.png alt></p></blockquote><ul><li><ol start=4><li><code>web</code>管理<code>Cobbler</code></li></ol></li></ul><blockquote><ul><li><p>4.1 新版<code>cobbler</code>的<code>web</code>界面使用的是<code>https</code>，登录https://10.0.0.7/cobbler_web</p><p><code>cobbler_web</code>支持多种认证方式，如<code>authn_configfil</code>、<code>authn_ldap</code>或<code>authn_pam</code>等，默认为<code>authn_denyall</code>即拒绝所有用户登陆，下面说明三种能认证用户登录<code>cobbler_web</code>的方式</p></li><li><p>4.2 <strong>使用<code>authn_pam</code>模块认证<code>cobbler_web</code>用户</strong></p></li></ul><blockquote><ul><li>4.2.1 首先修改<code>modules</code>中的<code>authentication</code>段中的<code>module</code>参数的值为<code>authn_pam</code>
接着创建系统用户，并为用户设定密码而后将设定的系统用户添加至<code>cobbler_web</code>的<code>admin</code>组中，修改<code>/etc/cobbler/users.conf</code>文件，将设定的用户添加为<code>admin</code>参数的值即可</li></ul></blockquote><ul><li>4.3 <strong>使用<code>authn_configfile</code>模块认证<code>cobbler_web</code>用户</strong></li></ul><blockquote><ul><li>4.3.1 首先修改<code>modules</code>中的<code>authentication</code>段中的<code>module</code>参数的值为<code>authn_configfile</code>
添加第一用户时，需要为<code>htdigest</code>命令使用<code>"-c" etc/cobbler/users.digest</code>，后续添加其他用户则不能再使用，同步<code>cobbler</code>重启<code>httpd</code>以及<code>cobbler</code></li></ul></blockquote><ul><li>4.4 <strong>使用<code>cobbler</code>默认的<code>web</code>账号密码认证</strong></li></ul><blockquote><ul><li>4.4.1 <code>user</code>：<code>cobbler</code></li><li>4.4.2 <code>pass</code>：<code>cobbler</code></li></ul><p><img src=/imgs/img-lazy-loading.gif data-src=https://raw.githubusercontent.com/usermice/images/master/Deploy_Server/Cobbler_web.png alt></p><p><img src=/imgs/img-lazy-loading.gif data-src=https://raw.githubusercontent.com/usermice/images/master/Deploy_Server/Cobbler_web_1.png alt></p><p><img src=/imgs/img-lazy-loading.gif data-src=https://raw.githubusercontent.com/usermice/images/master/Deploy_Server/Cobbler_web_2.png alt></p><p><img src=/imgs/img-lazy-loading.gif data-src=https://raw.githubusercontent.com/usermice/images/master/Deploy_Server/Cobbler_web_3.png alt></p><p><img src=/imgs/img-lazy-loading.gif data-src=https://raw.githubusercontent.com/usermice/images/master/Deploy_Server/Cobbler_web_4.png alt></p><p><img src=/imgs/img-lazy-loading.gif data-src=https://raw.githubusercontent.com/usermice/images/master/Deploy_Server/Cobbler_web_5.png alt></p><p><img src=/imgs/img-lazy-loading.gif data-src=https://raw.githubusercontent.com/usermice/images/master/Deploy_Server/Cobbler_web_6.png alt></p></blockquote></blockquote></div></div><footer class=post-footer><div class=post-tags><a href=/tags/system>System
</a><a href=/tags/cobbler>Cobbler</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=reward-container><div><i class="fa-solid fa-mug-hot"></i>请我喝杯咖啡吧 ヾ(^▽^*)))</div><button>
赞赏</button><div class=post-reward><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/ali-pay.png alt="二哥 - 支付宝">
<span>支付宝</span></div><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/wechat-pay.png alt="二哥 - 微信">
<span>微信</span></div></div></div><div class=post-copyright><img src=/imgs/cc/cc.svg width=75 height=75 align=right alt=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
Install Cobbler</li><li class=post-copyright-author><strong>本文作者： </strong>二哥</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://erge.blog/systems/linux/install-system/install-cobbler/ title="Install Cobbler">https://erge.blog/systems/linux/install-system/install-cobbler/</a></li><li class=post-copyright-license><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=/images/wechat_channel.jpg><span class=icon><i class="fab fa-weixin"></i>
</span><span class=label>WeChat</span></a></div><div class=social-item><a target=_blank class=social-link href=/atom.xml><span class=icon><i class="fa fa-rss"></i>
</span><span class=label>RSS</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/systems/linux/install-system/install-kickstart/ rel=next title="Install Kickstart"><i class="fa fa-chevron-left"></i> Install Kickstart</a></div><div class="post-nav-prev post-nav-item"><a href=/systems/windows/windows-office-visio-keys/ rel=prev title="Windows Office Visio Keys">Windows Office Visio Keys
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div><div class=comment-switch><span class=first-comment>Giscus</span>
<span class=switch-btn></span>
<span class=second-comment>Waline</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=waline-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div id=gtranslate class=google-translate><i class="fa fa-language"></i><div id=google_translate_element></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2010 - 2024
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>二哥</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.125.4 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.5.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>粤ICP备 18047355-1 号</a>
<img src=/imgs/gongan.png alt=沪公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011402009770" target=_blank>沪公网安备 31011402009770 号</a></div><div class=vendors-list><a target=_blank href=https://vercel.com title=Vercel><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/vercel.svg alt=Vercel>
</a><a target=_blank href=https://upyun.com title=又拍云><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/upyun.png alt=又拍云>
</a><a target=_blank href=https://webify.cloudbase.net title=Webify>Webify
</a><span>提供CDN/云资源支持</span></div></div></footer><script type=text/javascript src=https://cdn.staticfile.org/animejs/3.2.1/anime.min.js defer></script><script type=text/javascript src=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.js defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":false,"giscus":{"cfg":{"category":"Comments","categoryid":null,"emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"username/repo-name","repoid":null,"theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"https://erge.blog/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":true,"plugin":"waline"},"views":{"enable":true,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"qiniu","router":"https://cdn.staticfile.org"},"version":"4.5.3","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":null,"sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"waline","file":"dist/waline.css","name":"@waline/client","version":"2.13.0"},"js":{"alias":"waline","file":"dist/waline.js","name":"@waline/client","version":"2.13.0"}}}</script><script type=text/javascript src=/js/main.min.b0c78e5a4df586ee46d02716ffa91a4a322e56763e04e91eb2ba052c9469ed02.js defer></script></body></html>